import{bB as g,kl as j,bx as O}from"./ShadowCastClear.glsl.js";import{c as Y,j as b,b as p,m as k,Y as q}from"./Point2D.js";import{C as A,aY as I,a3 as P,c as X}from"./ProjectionTransformation.js";import{Envelope2D as y}from"./Envelope2D.js";import"./jsonConverter.js";import{fromGeometry as d,getSpatialReference as w,fromSpatialReference as D,toGeometry as C}from"./apiConverter.js";class ${getOperatorType(){return 10003}supportsCurves(){return!0}accelerateGeometry(e,r,o){return!1}canAccelerateGeometry(e){return!1}executeMany(e,r,o,n){return new F(e,r,o,n)}execute(e,r,o,n){const i=new g([e]),m=new g([r]),s=this.executeMany(i,m,o,n).next();return s||Y("null output"),s}}function z(t,e,r,o){const n=t.getDimension(),i=e.getDimension();if(n!==i)return n>i?t:e;if(t.isEmpty())return e;if(e.isEmpty())return t;const m=new y,s=new y,u=new y;t.queryEnvelope(m),e.queryEnvelope(s),u.setCoords({env2D:m}),u.mergeEnvelope2D(s);const c=A(r,u,!0),f=t.getGeometryType(),l=e.getGeometryType();return f===p.enumPoint&&l===p.enumPoint?B(t,e,c):f===p.enumPoint&&l===p.enumMultiPoint?v(e,t,c):f===p.enumMultiPoint&&l===p.enumPoint?v(t,e,c):I(t,e,r,o)}function B(t,e,r,o){const n=P(r),i=n*n,m=t.getXY(),s=e.getXY(),u=new X({vd:t.getDescription()});return k.sqrDistance(m,s)>i&&(u.add(t),u.add(e)),u}function v(t,e,r,o){const n=t.getImpl().getAttributeStreamRef(0),i=t.getPointCount(),m=e.getXY(),s=t.createInstance(),u=P(r),c=new y;if(t.queryEnvelope(c),c.inflateCoords(u,u),c.contains(m)){const f=u*u;let l=!1;const h=q(i,!1);for(let a=0;a<i;a++){const S=n.read(2*a),T=n.read(2*a+1),x=S-m.x,G=T-m.y;x*x+G*G<=f&&(l=!0,h[a]=!0)}if(l)for(let a=0;a<i;a++)h[a]||s.addPoints(t,a,a+1);else s.addPoints(t,0,i),s.add(e)}else s.addPoints(t,0,i),s.add(e);return s}class F extends j{constructor(e,r,o,n){super(),this.m_progressTracker=n,this.m_index=-1,this.m_inputGeoms=e,this.m_spatialReference=o,this.m_rightGeom=r.next(),this.m_bEmpty=!this.m_rightGeom,b(this.m_rightGeom)}tock(){return!0}getRank(){return 1}next(){if(this.m_bEmpty)return null;const e=this.m_inputGeoms.next();return e?(b(e),this.m_index=this.m_inputGeoms.getGeometryID(),z(e,this.m_rightGeom,this.m_spatialReference,this.m_progressTracker)):null}getGeometryID(){return this.m_index}}const _=new $;function N(t,e,r){return _.execute(t,e,r,null)}function Z(t,e,r){const o=_.executeMany(new g(t),new g([e]),r,null);return Array.from(o)}function H(){return _.supportsCurves()}function E(t,e){const r=w(t);return C(N(d(t),d(e),D(r)),r)}function M(t,e){const r=t.map(d),o=w(t);return Z(r,d(e),D(o)).map(n=>C(n,o)).filter(O)}const R=H(),W=Object.freeze(Object.defineProperty({__proto__:null,execute:E,executeMany:M,supportsCurves:R},Symbol.toStringTag,{value:"Module"})),ee=Object.freeze(Object.defineProperty({__proto__:null,execute:E,executeMany:M,supportsCurves:R},Symbol.toStringTag,{value:"Module"}));export{W as i,ee as s};
