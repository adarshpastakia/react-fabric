import{_ as ee,C as ce,H as ue}from"./index-DPKHNOa8.js";import{aO as de,_ as q,r as l,v as J,bs as me,j as o,m as T,O as G,bt as te,F as fe,l as Q,bu as pe,w as ve,G as be,z as ge,y as he,x as xe,I as je,K as ye,J as Oe,bv as Ie,L as Ce,bw as we,bx as ke,N as Pe,by as Ne,bz as Fe,Q as Re,U as $e,W as Ee}from"./iframe-DL5PLccW.js";import{c as Se}from"./cloneElement-_d6a3Gjs.js";import{g as Me,a as Te,H as De,b as Ke}from"./Button-B4MR9BdT.js";import{I as X,T as Le}from"./Tooltip-BPKa3gaw.js";var He=function(e){for(var n=arguments.length,t=new Array(n>1?n-1:0),v=1;v<n;v++)t[v-1]=arguments[v];return de(e)&&"type"in e&&t.includes(e.type)},Ae=["as","label","color","className","icon","iconBg","iconColor","appendLabel","rtlFlip","altIcon","id","active","disabled","onClick","badge","hotKey","tabIndex","minimal","data-open","ref"],Be=["children"];function Y(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(v){return Object.getOwnPropertyDescriptor(s,v).enumerable})),n.push.apply(n,t)}return n}function y(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Y(Object(n),!0).forEach(function(t){ee(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Y(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var Z=function(e){var n=e.as,t=e.label,v=e.color,D=v===void 0?"primary":v,A=e.className,O=e.icon,R=e.iconBg,I=e.iconColor,N=e.appendLabel,$=e.rtlFlip,K=e.altIcon,L=e.id,d=e.active,F=e.disabled,E=e.onClick,C=e.badge,b=e.hotKey,S=e.tabIndex,x=S===void 0?-1:S,c=e.minimal,i=e["data-open"],j=e.ref,g=q(e,Ae),a=l.useRef(null),w=J(),M=l.useMemo(function(){return Me(C)},[C]);l.useEffect(function(){var m;x===0&&((m=a.current)===null||m===void 0||m.focus())},[x]);var k=l.useMemo(function(){var m,u=O;return c&&!u&&(u=me(t)),o.jsx(X,{className:T("fabric-menuIcon",c&&"minimal"),icon:(m=u)!==null&&m!==void 0?m:"",bg:R,color:I,rtlFlip:$})},[O,R,I,$,c,t]),h=l.useCallback(function(m){var u=m.children,P=q(m,Be);return c?o.jsx(Le,y(y({content:t,placement:"right",disabled:i},P),{},{children:u})):o.jsx(l.Fragment,{children:u})},[c,t,i]),B=l.useMemo(function(){return o.jsxs("div",{className:"flex flex-nowrap text-start items-center",children:[k,!c&&o.jsx("label",{className:"flex-1 pe-4 py-[0.375em] truncate",children:t}),N&&o.jsx("span",{className:T("font-bold whitespace-nowrap text-center leading-none mx-1",c&&"absolute inset-x-0 bottom-0 overflow-clip",c?"text-[0.5rem]":"text-[0.625rem]",d?"text-white/50":"text-tint-600/50"),children:N}),C&&o.jsx(Te,y(y({},M),{},{placement:c?"end":"",className:T("me-1",M.className)})),b&&o.jsx(De,{keyCombo:b}),!c&&K&&o.jsx(X,{className:"text-muted px-1",icon:K,rtlFlip:!0})]})},[k,c,N,t,C,M,b,d]),W=n??"button";return o.jsx(h,y(y({},g),{},{children:o.jsxs(W,y(y({ref:G(j,a),"data-dropdown-dismiss":!0,"data-color":D,className:T("fabric-menuItem cursor-pointer",A,d&&"active",c&&"minimal",F&&"disabled","rounded relative max-w-[50vw] my-0.5"),"data-active":d,"data-open":i,disabled:F,"data-id":L,tabIndex:x,onClick:function(u){(E==null?void 0:E(u))!==!1&&(w==null||w.events.emit("click"))}},c?{}:g),{},{children:[b&&o.jsx(Ke,{keyCombo:b,handler:function(){var u,P;return(u=a.current)===null||u===void 0||(P=u.click)===null||P===void 0?void 0:P.call(u)}}),B]}))}))},We=["children","minimal","menuClassName","onClick","trigger","ref"];function _(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(v){return Object.getOwnPropertyDescriptor(s,v).enumerable})),n.push.apply(n,t)}return n}function p(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_(Object(n),!0).forEach(function(t){ee(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):_(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var V=function s(e){var n,t,v=e.children,D=e.minimal,A=e.menuClassName,O=e.onClick,R=e.trigger,I=R===void 0?"hover":R,N=e.ref,$=q(e,We),K=l.useState(!1),L=Q(K,2),d=L[0],F=L[1],E=l.useState(null),C=Q(E,2),b=C[0],S=C[1],x=l.useRef([]),c=l.useRef([]),i=J(),j=pe(),g=te(),a=g!==null,w=ve({nodeId:j,open:!a||d,onOpenChange:function(f,H,U){a&&F(f),U==="outside-press"&&I==="click"&&(i==null||i.events.emit("close"))},placement:a?"right-start":"bottom-start",middleware:[ge({mainAxis:a?0:4,alignmentAxis:a?-4:0}),he(),xe()],whileElementsMounted:be}),M=w.floatingStyles,k=w.refs,h=w.context,B=je(h,{enabled:I==="hover",delay:{open:75},handleClose:ye({blockPointerEvents:!0})}),W=Oe(h,{event:"mousedown",toggle:I==="click"||!a,ignoreMouse:I==="hover"&&!a}),m=Ie(h,{role:"menu"}),u=Ce(h,{bubbles:!0}),P=we(h,{listRef:x,activeIndex:b,nested:a,onNavigate:S}),ne=ke(h,{listRef:c,onMatch:d?S:void 0,activeIndex:b}),z=Pe([W,B,m,u,P,ne]),ae=z.getReferenceProps,re=z.getFloatingProps,oe=z.getItemProps;l.useEffect(function(){if(!i||!g)return;function r(){F(!1)}function f(H){H.nodeId!==j&&H.parentId===g&&F(!1)}return i.events.on("click",r),i.events.on("close",r),i.events.on("menuopen",f),function(){i.events.off("click",r),i.events.off("close",r),i.events.off("menuopen",f)}},[i,j,g]),l.useEffect(function(){d&&i&&i.events.emit("menuopen",{parentId:g,nodeId:j})},[i,d,j,g]);var se=l.useCallback(function(r){var f=r.target;f.dataset.id&&(O==null||O(f.dataset.id))},[O]),ie=a?Re:l.Fragment,le=a?{root:(n=(t=k.domReference.current)===null||t===void 0?void 0:t.closest(".theme-base"))!==null&&n!==void 0?n:void 0}:{};return l.useEffect(function(){setTimeout(function(){var r;return(r=k.floating.current)===null||r===void 0||(r=r.querySelector('[data-active="true"]'))===null||r===void 0?void 0:r.scrollIntoView({block:"nearest"})},100)},[d]),l.useEffect(function(){(!a||d)&&b&&setTimeout(function(){var r;(r=x.current[b])===null||r===void 0||r.scrollIntoView({block:"nearest"})},100)},[d,b]),o.jsxs(Ne,{id:j,children:[a&&o.jsx(Z,p(p({},ae(p(p({},$),{},{id:void 0,"data-dropdown-dismiss":!1,onClick:function(f){return f.stopPropagation(),!1}}))),{},{"data-open":d,minimal:D,altIcon:ce.chevronRight,ref:G(k.setReference,N)})),o.jsx(Fe,{elementsRef:x,labelsRef:c,children:(!a||d)&&o.jsxs(ie,p(p({},le),{},{children:[a&&o.jsx($e,{}),o.jsx(ue,{children:o.jsx(Ee,{context:h,modal:!a,initialFocus:a?-1:0,returnFocus:!a,children:o.jsx("div",p(p({className:T(A,"flex flex-col bg-base p-1 menu-list",a&&"outline shadow-lg rounded-capped max-h-96 overflow-auto scroll-thin z-(--z-popover)"),autoFocus:!0,ref:G(a?k.setFloating:N)},re({onClick:a?void 0:se})),{},{style:a?M:$.style,children:Se(v,function(r,f){return c.current[f]=r.props.label,l.cloneElement(r,He(r,Z,ze,s)?p({minimal:!a&&D,"data-focus":b===f,ref:function(U){return x.current[f]=U}},oe({onClick:r.props.onClick,tabIndex:b===f?0:-1})):{})})}))})})]}))})]})},ze=function(e){var n=te(),t=J();return t?o.jsx(V,p(p({},e),{},{menuClassName:e.className})):n===null?o.jsx(fe,{children:o.jsx(V,p(p({},e),{},{menuClassName:e.className}))}):o.jsx(V,p({},e))};export{ze as M,Z as a,He as n};
