import{E as e,V as u,b6 as c,F as i,_ as m,kM as _,oV as w,er as g,bj as y,bo as d,h3 as f,kz as V,b as D}from"./ShadowCastClear.glsl.js";import{n as b}from"./AnalysisView.js";import{o as P,l as z,i as k,a as T,k as $,n as O,u as S,b as E,L as U}from"./ElevationProfileTool.js";import"./iframe-DwvN93Ge.js";import"./index.js";import"./Viewport.js";import"./Section.js";import"./ErrorBoundary.js";import"./createClass.js";import"./Global.js";import"./useIsDark.js";import"./debounce.js";import"./index2.js";import"./createUtils.js";import"./distanceOperator.js";import"./Point2D.js";import"./Distance2DCalculator-CXhBP-8I.js";import"./ProjectionTransformation.js";import"./Envelope2D.js";import"./Transformation2D.js";import"./OperatorDefinitions.js";import"./apiConverter.js";import"./jsonConverter.js";import"./simplifyOperator2.js";import"./operatorSimplify.js";import"./ExclusiveOperationManager.js";import"./SketchViewModel.js";import"./SketchOptions.js";import"./euclideanLengthMeasurementUtils.js";import"./geometry2dUtils.js";import"./geodeticLengthOperator.js";import"./geodeticCurveType.js";import"./automaticAreaMeasurementUtils.js";import"./geodesicAreaMeasurementUtils.js";import"./earcut.js";import"./automaticLengthMeasurementUtils.js";let h=class extends b{};h=e([u("esri.views.2d.analysis.AnalysisView2D")],h);let n=class extends c{constructor(t){super(t)}initialize(){this.addHandles(P({analysisViewData:this.analysisViewData,remove:()=>{},show:()=>{}}))}get updating(){return!1}};e([i({constructOnly:!0})],n.prototype,"view",void 0),e([i({constructOnly:!0})],n.prototype,"analysisViewData",void 0),e([i()],n.prototype,"updating",null),n=e([u("esri.views.2d.analysis.ElevationProfile.ElevationProfileInputVisualization2D")],n);let a=class extends c{constructor(t){super(t),this._graphic=new m,this._layer=new _({listMode:"hide",internal:!0}),this._updateGeometryThrottled=w(s=>{var v;if(!s)return void(this._graphic.visible=!1);const o=this._layer,l=(v=this.view.map)==null?void 0:v.layers;l&&(l.includes(o)||l.add(o),l.reorder(o,0)),this._graphic.visible=!0,this._graphic.geometry=z(s.samples,s.spatialReference)},k().profileLinesUpdateThrottleMillis)}initialize(){this._layer.add(this._graphic),this.addHandles([g(()=>!this.analysisViewData.visible,()=>{this._graphic.visible=!1}),y(()=>this._colorUpdateParameters,t=>this._updateColor(t),d),y(()=>this.analysisViewData.analysis.geometry,()=>{this._graphic.visible=!1},d),y(()=>this._geometryUpdateParameters,t=>this._updateGeometryThrottled(t),d),this._updateGeometryThrottled])}destroy(){var t;(t=this.view.map)==null||t.remove(this._layer),this._layer.destroy(),this._graphic.destroy()}get updating(){return this._updateGeometryThrottled.hasPendingUpdates()}get _result(){const{analysisViewData:t}=this;return t.visible?t.results.find(({available:s,computation:o,rawResult:l})=>s&&o.profile.viewOptions.lineVisible&&(l==null?void 0:l.hasZ)===!0):null}get _geometryUpdateParameters(){const t=this._result;return(t==null?void 0:t.progress)!==1?null:{samples:t.samples,spatialReference:this.view.spatialReference}}get _colorUpdateParameters(){var s;const t=(s=this._result)==null?void 0:s.computation.profile.color;return t?{color:t.toArray(),contrastColor:f(t).toArray()}:null}_updateColor(t){t&&(this._graphic.symbol=new V({data:{type:"CIMSymbolReference",symbol:{type:"CIMLineSymbol",symbolLayers:[{type:"CIMSolidStroke",capStyle:"Butt",color:t.color,effects:[{type:"CIMGeometricEffectDashes",dashTemplate:[5,4],lineDashEnding:"FullGap",controlPointEnding:"NoConstraint"}],joinStyle:"Round",width:1.5},{type:"CIMSolidStroke",capStyle:"Butt",color:t.contrastColor,joinStyle:"Round",width:1.5}]}}}))}};e([i({constructOnly:!0})],a.prototype,"view",void 0),e([i({constructOnly:!0})],a.prototype,"analysisViewData",void 0),e([i()],a.prototype,"updating",null),e([i()],a.prototype,"_result",null),e([i()],a.prototype,"_geometryUpdateParameters",null),e([i()],a.prototype,"_colorUpdateParameters",null),a=e([u("esri.views.2d.analysis.ElevationProfile.ElevationProfileLineVisualization2D")],a);let p=class extends c{constructor(t){super(t)}initialize(){const{view:t,analysisViewData:s}=this;this._hoveredPointsVisualization=new T({view:t,analysisViewData:s}),this._inputVisualization=new n({view:t,analysisViewData:s}),this._lineVisualization=new a({view:t,analysisViewData:s})}destroy(){this._inputVisualization.destroy(),this._hoveredPointsVisualization.destroy(),this._lineVisualization.destroy()}get updating(){return this._hoveredPointsVisualization.updating||this._inputVisualization.updating||this._lineVisualization.updating}};e([i()],p.prototype,"view",void 0),e([i()],p.prototype,"analysisViewData",void 0),e([i()],p.prototype,"updating",null),p=e([u("esri.views.2d.analysis.ElevationProfile.ElevationProfileVisualization2D")],p);let r=class extends h{constructor(t){super(t),this.type="elevation-profile-view-2d",this.analysis=null,this.hoveredPosition=null}initialize(){const{analysis:t,view:s}=this;this._controller=new $({analysis:t,analysisViewData:this,view:s,computationFactory:{create:o=>{switch(o.profile.type){case"ground":return new E(o);case"input":return new S(o);case"query":return new O(o);case"scene":throw new D("elevation-profile-analysis-view-2d:unsupported","The scene profile line type is not supported in 2D views.")}}}}),this._visualization=new p({view:s,analysisViewData:this}),this._sketchTool=new U({view:s,analysisViewData:this})}destroy(){var t,s,o;(t=this._controller)==null||t.destroy(),(s=this._visualization)==null||s.destroy(),(o=this._sketchTool)==null||o.destroy()}get effectiveDisplayUnits(){var t;return((t=this._controller)==null?void 0:t.effectiveDisplayUnits)??{distance:"meters",elevation:"meters"}}get error(){var t;return(t=this._controller)==null?void 0:t.error}get hoveredPoints(){var t;return((t=this._controller)==null?void 0:t.hoveredPoints)??[]}get interactive(){return super.interactive}set interactive(t){super.interactive=t}get progress(){var t;return((t=this._controller)==null?void 0:t.progress)??0}get results(){var t;return((t=this._controller)==null?void 0:t.results)??[]}get statistics(){var t;return(t=this._controller)==null?void 0:t.statistics}get updating(){var t,s,o;return((t=this._controller)==null?void 0:t.updating)===!0||((s=this._visualization)==null?void 0:s.updating)===!0||((o=this._sketchTool)==null?void 0:o.updating)===!0}get visible(){return super.visible}set visible(t){super.visible=t}get sketchGraphic(){var t;return(t=this._sketchTool)==null?void 0:t.sketchGraphic}get toolState(){var t;return((t=this._sketchTool)==null?void 0:t.state)??"idle"}place(t){return this._sketchTool.place(t)}pickFeature(t){return this._sketchTool.pickFeature(t)}};e([i({readOnly:!0})],r.prototype,"type",void 0),e([i({constructOnly:!0,nonNullable:!0})],r.prototype,"analysis",void 0),e([i({readOnly:!0})],r.prototype,"effectiveDisplayUnits",null),e([i({readOnly:!0})],r.prototype,"error",null),e([i()],r.prototype,"hoveredPosition",void 0),e([i()],r.prototype,"hoveredPoints",null),e([i({readOnly:!0})],r.prototype,"progress",null),e([i({readOnly:!0})],r.prototype,"results",null),e([i({readOnly:!0})],r.prototype,"statistics",null),e([i({readOnly:!0})],r.prototype,"updating",null),e([i()],r.prototype,"sketchGraphic",null),e([i()],r.prototype,"toolState",null),e([i()],r.prototype,"_controller",void 0),e([i()],r.prototype,"_visualization",void 0),e([i()],r.prototype,"_sketchTool",void 0),r=e([u("esri.views.2d.analysis.ElevationProfileAnalysisView2D")],r);const mt=r;export{mt as default};
