import{r as c,j as i}from"./iframe-DL5PLccW.js";import{$ as u,o as S}from"./Playground.stories-FeWRsiXD.js";import{o as b,O as _,t as f,h as N,a as R,x as D}from"./LexicalLink.prod-DtTh_WlC.js";import{c as T}from"./LexicalNestedComposer.prod-D_pNlcvQ.js";import{m as L,a as q}from"./mdi-D9-EwTA7.js";import{I as h}from"./Tooltip-BPKa3gaw.js";import"./index-DPKHNOa8.js";import"./Viewport-v3RQO1q4.js";import"./ErrorBoundary-Bl2NAeUv.js";import"./createClass-DjEsl4fx.js";import"./Global-Dhvrkiym.js";import"./HeadFoot-BOKBTLfn.js";import"./ThemeProvider-7wvBaeKK.js";import"./ButtonGroup-CcmBan6Y.js";import"./cloneElement-_d6a3Gjs.js";import"./Dropdown-BkPoAgTO.js";import"./Button-B4MR9BdT.js";import"./ToggleButtonGroup-D0cpnvS6.js";import"./Divider-DeNf5KPC.js";import"./Menu-CcUoW62j.js";import"./ColorPicker-Cc5ydKIF.js";import"./Google-B5-g4RDV.js";import"./zh-CN-FY2s-MwU.js";import"./endOfDay-BUPtmEN8.js";import"./index-B0-PBx-s.js";import"./index-HqHJXvHv.js";import"./floating-ui.react-CT9AAP4P.js";import"./InputWrapper-M6su9Q9e.js";import"./_getByPath-TSIqsuP9.js";import"./_debounce-BHO_GiD4.js";function k(l,s){const n=l.style;n.top=`${s.y}px`,n.left=`${s.x}px`}const P=({x:l=0,y:s=0,nodeKey:n,color:E,state:y,user:C})=>{const[m]=b(),a=c.useRef(null),d=c.useRef({isDragging:!1,offsetX:0,offsetY:0,rootElementRect:{left:8,top:8},x:8,y:8});c.useEffect(()=>{const t=d.current;t.x=l,t.y=s;const o=a.current;o!==null&&(d.current.rootElementRect={left:l,top:s},k(o,t))},[l,s]),c.useEffect(()=>{const t=a.current;t!==null&&setTimeout(()=>{t.style.setProperty("transition","top 300ms ease 0s, left 300ms ease 0s")},500)},[]);const x=t=>{const o=a.current,e=d.current,r=e.rootElementRect;o!==null&&e.isDragging&&r!==null&&(e.x=r.left+(t.pageX-e.offsetX),e.y=r.top+(t.pageY-e.offsetY),e.x<0&&(e.x=0),e.x>642&&(e.x=642-o.offsetWidth),e.y<0&&(e.y=0),k(o,e))},g=t=>{const o=a.current,e=d.current;o!==null&&(e.isDragging=!1,o.classList.remove("dragging"),m.update(()=>{const r=f(n);u(r)&&r.setPosition(e.x,e.y)})),document.removeEventListener("pointermove",x),document.removeEventListener("pointerup",g)},v=()=>{m.update(()=>{const t=f(n);u(t)&&t.remove()})},j=()=>{m.update(()=>{const t=f(n);u(t)&&t.toggleColor()})},p=c.useMemo(()=>{const t=_({editable:!0});if(y){const o=t.parseEditorState(y);t.setEditorState(o)}return t},[]);return c.useEffect(()=>{if(p._editable){const t=p.registerUpdateListener(({editorState:o})=>{m.update(()=>{const e=f(n);u(e)&&e.updateState(p.getEditorState().toJSON())})});return()=>{t()}}},[p._editable]),i.jsxs("div",{ref:a,className:"sticky__container",children:[i.jsx("div",{className:"sticky__handle",onPointerDown:t=>{const o=a.current;if(o==null||t.button===2||t.target!==o.firstChild)return;const e=o,r=d.current;e!==null&&(r.offsetX=t.clientX,r.offsetY=t.clientY,r.rootElementRect={left:r.x,top:r.y},r.isDragging=!0,e.classList.add("dragging"),document.addEventListener("pointermove",x),document.addEventListener("pointerup",g),t.preventDefault())}}),i.jsxs("div",{className:`sticky-note ${E}`,children:[i.jsxs("div",{className:"sticky__tools",children:[i.jsx("button",{onClick:j,className:"sticky--color","aria-label":"Change sticky note color",title:"Color",children:i.jsx(h,{icon:L})}),i.jsx("button",{onClick:v,className:"sticky--delete","aria-label":"Delete sticky note",title:"Delete",children:i.jsx(h,{icon:q})})]}),i.jsx("div",{className:"text-sm font-semibold",children:C}),i.jsxs(T,{initialEditor:p,initialTheme:{paragraph:"sticky__paragraph",text:{bold:"editor-textBold",code:"editor-textCode",italic:"editor-textItalic",strikethrough:"editor-textStrikethrough",subscript:"editor-textSubscript",superscript:"editor-textSuperscript",underline:"editor-textUnderline",underlineStrikethrough:"editor-textUnderlineStrikethrough"}},children:[i.jsx(N,{contentEditable:i.jsx(D,{className:"sticky__editor"}),placeholder:i.jsx("div",{className:"sticky-placeholder",children:"Sticky note..."}),ErrorBoundary:R}),i.jsx(S,{})]})]})]})};P.__docgenInfo={description:"",methods:[],displayName:"StickyComponent",props:{user:{required:!0,tsType:{name:"string"},description:""},state:{required:!1,tsType:{name:"AnyObject"},description:""},color:{required:!0,tsType:{name:"union",raw:'"pink" | "yellow"',elements:[{name:"literal",value:'"pink"'},{name:"literal",value:'"yellow"'}]},description:""},nodeKey:{required:!0,tsType:{name:"NodeKey"},description:""},x:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},y:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}}}};export{P as StickyComponent};
