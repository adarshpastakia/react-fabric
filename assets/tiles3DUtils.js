import{K as I,b0 as b,fa as z,fb as g,fc as ee,bK as m,fd as W,fe as Q,bP as G,ff as N,fg as Y,fh as Z,bJ as E,fi as u,au as R}from"./ShadowCastClear.glsl.js";function k(n,f){if(!Array.isArray(n)||n.length<f)return!1;for(const h of n)if(typeof h!="number")return!1;return!0}const C=7645211,te={xmin:-180,ymin:-90,zmin:-450,xmax:180,ymax:90,zmax:8850},ne=new Map([[5773,new R({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"EGM96_Geoid"})],[3855,new R({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"EGM2008_Geoid"})],[115700,new R({heightModel:"ellipsoidal",heightUnit:"meters",vertCRS:"WGS_1984"})],[115701,new R({heightModel:"ellipsoidal",heightUnit:"meters",vertCRS:"ETRS_1989"})],[6360,new R({heightModel:"gravity-related-height",heightUnit:"us-feet",vertCRS:"NAVD88_height_(ftUS)"})],[7837,new R({heightModel:"gravity-related-height",heightUnit:"meters",vertCRS:"DHHN2016_(height) "})]]);function se(n){if(!n)return null;const f=n.vcsWkid||n.latestVcsWkid;return f?ne.get(f):null}function ie(n){var f,h,r,S,c,_,w,p,M,y,A,V,U,v;return!(!((h=(f=n.extensions)==null?void 0:f.ESRI_crs)!=null&&h.wkid||(S=(r=n.extensions)==null?void 0:r.ESRI_crs)!=null&&S.latestWkid||(_=(c=n.extensions)==null?void 0:c.ESRI_crs)!=null&&_.wkt)||!((y=(M=(p=(w=n.root)==null?void 0:w.extensions)==null?void 0:p.ESRI_crs)==null?void 0:M.boundingVolume)!=null&&y.box)&&!((v=(U=(V=(A=n.root)==null?void 0:A.extensions)==null?void 0:V.ESRI_crs)==null?void 0:U.boundingVolume)!=null&&v.sphere))}function oe(n,f=!1){var w,p,M,y,A,V,U,v,L,X,D,H,K,q,J,P,T,j,B,F,O;let h=new I({wkid:4326,vcsWkid:115700}),r=(w=n.root)==null?void 0:w.boundingVolume,S=!1,c=(p=n==null?void 0:n.root)==null?void 0:p.transform;if(f&&((y=(M=n.extensions)==null?void 0:M.ESRI_crs)!=null&&y.wkid||(V=(A=n.extensions)==null?void 0:A.ESRI_crs)!=null&&V.latestWkid||(v=(U=n.extensions)==null?void 0:U.ESRI_crs)!=null&&v.wkt)&&((H=(D=(X=(L=n.root)==null?void 0:L.extensions)==null?void 0:X.ESRI_crs)==null?void 0:D.boundingVolume)!=null&&H.box||(P=(J=(q=(K=n.root)==null?void 0:K.extensions)==null?void 0:q.ESRI_crs)==null?void 0:J.boundingVolume)!=null&&P.sphere))h=new I((T=n.extensions)==null?void 0:T.ESRI_crs),r=(F=(B=(j=n.root)==null?void 0:j.extensions)==null?void 0:B.ESRI_crs)==null?void 0:F.boundingVolume,c=(O=n.root)==null?void 0:O.transform,S=!0;else if(!r)return new b(-180,-90,180,90,h);if(r.box){const t=r==null?void 0:r.box;if(t[3]>C&&t[7]>C&&t[11]>C)return new b({...te,spatialReference:h})}const _=E();if(!S&&r.region&&k(r.region,6)){const t=r.region,a=z(t[0]),o=z(t[1]),s=t[4],i=z(t[2]),e=z(t[3]),l=t[5];return new b({xmin:a,ymin:o,zmin:s,xmax:i,ymax:e,zmax:l,spatialReference:h})}if(r.sphere&&k(r.sphere,4)){const t=r.sphere,a=g(t[0],t[1],t[2]),o=t[3]/Math.sqrt(3),s=E();ee(s,a,g(o,o,o));const i=E();if(m(i,a,g(o,o,o)),c&&k(c,16)){const d=c;W(_,s,d),Q(s,_),W(_,i,d),Q(i,_)}S||(G(s,N,0,s,I.WGS84,0),G(i,N,0,i,I.WGS84,0));const e=E(),l=E();return Y(e,s,i),Z(l,s,i),new b({xmin:e[0],ymin:e[1],zmin:e[2],xmax:l[0],ymax:l[1],zmax:l[2],spatialReference:h})}if(r.box&&k(r.box,12)){const t=r.box,a=g(t[0],t[1],t[2]),o=g(t[3],t[4],t[5]),s=g(t[6],t[7],t[8]),i=g(t[9],t[10],t[11]),e=[];for(let x=0;x<8;++x)e.push(E());if(m(e[0],a,o),m(e[0],e[0],s),m(e[0],e[0],i),u(e[1],a,o),m(e[1],e[1],s),m(e[1],e[1],i),m(e[2],a,o),u(e[2],e[2],s),m(e[2],e[2],i),u(e[3],a,o),u(e[3],e[3],s),m(e[3],e[3],i),m(e[4],a,o),m(e[4],e[4],s),u(e[4],e[4],i),u(e[5],a,o),m(e[5],e[5],s),u(e[5],e[5],i),m(e[6],a,o),u(e[6],e[6],s),u(e[6],e[6],i),u(e[7],a,o),u(e[7],e[7],s),u(e[7],e[7],i),c&&k(c,16)){const x=c;for(let $=0;$<8;++$)W(e[$],e[$],x)}const l=g(-Number.MAX_VALUE,-Number.MAX_VALUE,-Number.MAX_VALUE),d=g(Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE);for(let x=0;x<8;++x)S||G(e[x],N,0,e[x],I.WGS84,0),Y(d,d,e[x]),Z(l,l,e[x]);return new b({xmin:d[0],ymin:d[1],zmin:d[2],xmax:l[0],ymax:l[1],zmax:l[2],spatialReference:h})}return new b(-180,-90,180,90,h)}export{oe as E,ie as R,se as _};
