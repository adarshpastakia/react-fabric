import{p as g,P as _}from"./Percent.js";import{T as c,d as m,L as f,n as x,e as o,s as p}from"./Label.js";import{r as R}from"./Animation.js";class u extends c{constructor(){super(...arguments),Object.defineProperty(this,"_display",{enumerable:!0,configurable:!0,writable:!0,value:this._root._renderer.makeRadialText("",this.textStyle)})}_afterNew(){super._afterNew()}_beforeChanged(){super._beforeChanged(),this._display.clear(),this.isDirty("textType")&&(this._display.textType=this.get("textType"),this.markDirtyBounds()),this.isDirty("radius")&&(this._display.radius=this.get("radius"),this.markDirtyBounds()),this.isDirty("startAngle")&&(this._display.startAngle=(this.get("startAngle",0)+90)*m,this.markDirtyBounds()),this.isDirty("inside")&&(this._display.inside=this.get("inside"),this.markDirtyBounds()),this.isDirty("orientation")&&(this._display.orientation=this.get("orientation"),this.markDirtyBounds()),this.isDirty("kerning")&&(this._display.kerning=this.get("kerning"),this.markDirtyBounds())}}Object.defineProperty(u,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialText"});Object.defineProperty(u,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:c.classNames.concat([u.className])});class y extends f{constructor(){super(...arguments),Object.defineProperty(this,"_flipped",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_afterNew(){this._textKeys.push("textType","kerning"),super._afterNew()}_makeText(){this._text=this.children.push(u.new(this._root,{}))}baseRadius(){const t=this.getPrivate("radius",0),a=this.getPrivate("innerRadius",0),i=this.get("baseRadius",0);return a+R(i,t-a)}radius(){const t=this.get("inside",!1);return this.baseRadius()+this.get("radius",0)*(t?-1:1)}_updateChildren(){if(super._updateChildren(),this.isDirty("baseRadius")||this.isPrivateDirty("radius")||this.isPrivateDirty("innerRadius")||this.isDirty("labelAngle")||this.isDirty("radius")||this.isDirty("inside")||this.isDirty("orientation")||this.isDirty("textType")){const t=this.get("textType","adjusted"),a=this.get("inside",!1),i=this.get("orientation");let e=x(this.get("labelAngle",0));this._text.set("startAngle",this.get("labelAngle",0)),this._text.set("inside",a);const r=p(e),n=o(e);let s=this.baseRadius(),l=this.radius();if(this._display.angle=0,t=="circular")this.setAll({paddingTop:0,paddingBottom:0,paddingLeft:0,paddingRight:0}),this.setRaw("x",void 0),this.setRaw("y",void 0),this._text.set("orientation",i),this._text.set("radius",l);else{s==0&&(e=0,l=0);let d=l*n,h=l*r;t=="radial"?(this.setRaw("x",d),this.setRaw("y",h),e<90||e>270||i!="auto"?(this._display.angle=e,this._flipped=!1):(this._display.angle=e+180,this._flipped=!0),this._dirty.rotation=!1):t=="adjusted"?(this.setRaw("centerX",g),this.setRaw("centerY",g),this.setRaw("x",d),this.setRaw("y",h)):t=="regular"&&(this.setRaw("x",d),this.setRaw("y",h))}this.markDirtyPosition(),this.markDirtyBounds()}}_updatePosition(){const t=this.get("textType","regular"),a=this.get("inside",!1);let i=0,e=0,r=this.get("labelAngle",0),n=this.localBounds(),s=n.right-n.left,l=n.bottom-n.top;if(t=="radial"){if(this._flipped){let d=this.get("centerX");d instanceof _&&(s=s*(1-d.value*2)),i=s*o(r),e=s*p(r)}}else!a&&t=="adjusted"&&(i=s/2*o(r),e=l/2*p(r));this.setRaw("dx",i),this.setRaw("dy",e),super._updatePosition()}get text(){return this._text}}Object.defineProperty(y,"className",{enumerable:!0,configurable:!0,writable:!0,value:"RadialLabel"});Object.defineProperty(y,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:f.classNames.concat([y.className])});export{y as R,u as a};
