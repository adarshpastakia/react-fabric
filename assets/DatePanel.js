import{_ as q}from"./index.js";import{_ as F,ax as J,r as u,l as j,aL as Q,aN as V,j as l,m as X}from"./iframe-DwvN93Ge.js";import{B as w}from"./Button.js";import{u as Y}from"./Global.js";import{u as Z}from"./useDebounce.js";import{P as m,D as $}from"./Google.js";import{B as ee}from"./BasePanel.js";import{i as E,a as H}from"./zh-CN.js";import{i as ae}from"./getDay.js";var re=["className","max","min","dateDisabled","onChange","showHijriToggle","value","withTime"];function N(s,n){var i=Object.keys(s);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(s);n&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(s,t).enumerable})),i.push.apply(i,r)}return i}function g(s){for(var n=1;n<arguments.length;n++){var i=arguments[n]!=null?arguments[n]:{};n%2?N(Object(i),!0).forEach(function(r){q(s,r,i[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(i)):N(Object(i)).forEach(function(r){Object.defineProperty(s,r,Object.getOwnPropertyDescriptor(i,r))})}return s}var me=function(n){var i=n.className,r=n.max,t=n.min,d=n.dateDisabled,P=n.onChange,A=n.showHijriToggle,T=n.value,M=n.withTime,B=F(n,re),R=J("date"),h=R.t,z=Y(),f=z.currentCalendar,_=u.useState(f==="hijri"),x=j(_,2),D=x[0],C=x[1],G=u.useState(!0),O=j(G,2),I=O[0],K=O[1],y=Z(P,[P]);u.useEffect(function(){C(f==="hijri")},[f]);var L=u.useReducer(function(e,a){if(a.type==="reset")if(Q(a.date))e.selected=void 0,e.pageDate=new Date,e.hour=0,e.minute=0;else{var p=new Date(a.date);e.selected=p,e.pageDate=p,e.hour=p.getHours(),e.minute=p.getMinutes()}if(a.type==="changeDate"&&(a.date.setHours(e.hour),a.date.setMinutes(e.minute),e.selected=a.date,e.pageDate=a.date),a.type==="changeTime"){var b,v;(b=e.selected)===null||b===void 0||b.setHours(a.hour),(v=e.selected)===null||v===void 0||v.setMinutes(a.minute),e.hour=a.hour,e.minute=a.minute}return a.type==="changePage"&&(e.page=a.page),a.type==="changePageDate"&&(e.pageDate=a.date,a.pageChange&&(e.page=Math.max(e.page-1,0))),(a.type==="changeDate"||a.type==="changeTime")&&(t&&e.selected&&E(e.selected,new Date(t))&&(e.selected=new Date(t),e.hour=e.selected.getHours(),e.minute=e.selected.getMinutes()),r&&e.selected&&H(e.selected,new Date(r))&&(e.selected=new Date(r),e.hour=e.selected.getHours(),e.minute=e.selected.getMinutes()),e.selected&&(y==null||y(e.selected.toISOString()))),g({},e)},{page:m.DATE,pageDate:new Date,hour:0,minute:0}),S=j(L,2),c=S[0],o=S[1];u.useEffect(function(){var e=!0;t&&e&&(e=H(new Date,t)),r&&e&&(e=E(new Date,r)),K(e)},[t,r]),u.useEffect(function(){o({type:"reset",date:T})},[T]);var U=u.useCallback(function(e){return c.page===m.DATE&&V(d)?!!d.find(function(a){return ae(new Date(a),e)}):$.isDisabled(e,c.page,t,r)},[c.page,t,r,d]),W=u.useCallback(function(e){var a=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;o({type:"changePageDate",pageChange:a,date:e})},[]),k=u.useCallback(function(e){o({type:"changeDate",date:e})},[]);return l.jsxs("div",g(g({className:X("block overflow-hidden bg-base rounded-capped",i)},B),{},{children:[l.jsx(ee,g(g({},c),{},{max:r,min:t,withTime:M,isHijri:D,selectDate:k,isDateDisabled:U,changeTime:function(a){return o(g({type:"changeTime"},a))},changePage:function(a){return o({type:"changePage",page:a})},changePageDate:W})),l.jsxs("div",{className:"border-t flex flex-nowrap justify-between px-2",children:[l.jsx("span",{children:A&&l.jsx(w,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){C(!D)},children:h(D?"label.gregorian":"label.hijri")})}),c.page===m.DATE&&I&&l.jsx(w,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return k(new Date)},children:h("label.today")}),c.page!==m.DATE&&l.jsx(w,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return o({type:"changePage",page:m.DATE})},children:h("core:action.cancel")})]})]}))};export{me as D};
