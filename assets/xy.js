import{X as $e,C as Se,V as le,a as Ve,L as Z}from"./xyChart.js";import{A as wt,d as yt,f as It,g as Tt,h as Mt,e as Nt,B as Ot,b as kt,G as At,c as Ft,i as Xt}from"./xyChart.js";import{S as Re}from"./Scrollbar.js";import{G as qe,f as ae,m as He,q as Ke,E as Ge,h as ne}from"./Label.js";import{m as W}from"./Animation.js";import{a as re,g as Te,b as C,d as Je,e as Me,f as S,r as y,D as Q,h as he}from"./Tick.js";import{i as j,e as F,n as Ne,z as Qe,g as z,B as et,E as tt,x as Oe,b as it}from"./Disposer.js";import{c as B,b as st,a as oe}from"./Theme.js";import{R as Ee}from"./RadialLabel.js";import{E as ze}from"./EditableLabel.js";import{R as Be}from"./Button3.js";import{a as at}from"./Percent.js";import"./ColorSet.js";import"./DefaultTheme.js";function ke(l,e,t){l._context.bezierCurveTo(l._x1+l._k*(l._x2-l._x0),l._y1+l._k*(l._y2-l._y0),l._x2+l._k*(l._x1-e),l._y2+l._k*(l._y1-t),l._x2,l._y2)}function We(l,e){this._context=l,this._k=(1-e)/6}We.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x0=this._x1=this._x2=this._y0=this._y1=this._y2=NaN,this._point=0},lineEnd:function(){switch(this._point){case 2:this._context.lineTo(this._x2,this._y2);break;case 3:ke(this,this._x1,this._y1);break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line},point:function(l,e){switch(l=+l,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(l,e):this._context.moveTo(l,e);break;case 1:this._point=2,this._x1=l,this._y1=e;break;case 2:this._point=3;default:ke(this,l,e);break}this._x0=this._x1,this._x1=this._x2,this._x2=l,this._y0=this._y1,this._y1=this._y2,this._y2=e}};const Ae=function l(e){function t(i){return new We(i,e)}return t.tension=function(i){return l(+i)},t}(0);function Ze(l,e){this._context=l,this._t=e}Ze.prototype={areaStart:function(){this._line=0},areaEnd:function(){this._line=NaN},lineStart:function(){this._x=this._y=NaN,this._point=0},lineEnd:function(){0<this._t&&this._t<1&&this._point===2&&this._context.lineTo(this._x,this._y),(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line>=0&&(this._t=1-this._t,this._line=1-this._line)},point:function(l,e){switch(l=+l,e=+e,this._point){case 0:this._point=1,this._line?this._context.lineTo(l,e):this._context.moveTo(l,e);break;case 1:this._point=2;default:{if(this._t<=0)this._context.lineTo(this._x,e),this._context.lineTo(l,e);else{var t=this._x*(1-this._t)+l*this._t;this._context.lineTo(t,this._y),this._context.lineTo(t,e)}break}}this._x=l,this._y=e}};function nt(l){return new Ze(l,1)}class me extends Re{constructor(){super(...arguments),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push($e.new(this._root,{themeTags:["chart"],interactive:!1,interactiveChildren:!1,panX:!1,panY:!1,wheelX:"none",wheelY:"none"}))}),Object.defineProperty(this,"overlay",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(qe.new(this._root,{themeTags:["overlay"],interactive:!1}))})}_afterNew(){this._addOrientationClass(),this._settings.themeTags=W(this._settings.themeTags,["scrollbar","xy","chart",this._settings.orientation]);const e=this.children;e.moveValue(this.thumb),e.moveValue(this.startGrip),e.moveValue(this.endGrip),this.thumb.set("opacity",0),this.thumb.states.create("hover",{opacity:.2});const t=this.chart.plotContainer;t.set("interactive",!1),t.remove("background"),t.children.removeValue(this.chart.zoomOutButton),super._afterNew()}_updateThumb(){super._updateThumb(),this.overlay.set("draw",e=>{const t=this.startGrip,i=this.endGrip;let s=t.x(),n=t.y(),a=i.x(),r=i.y();const o=this.height(),u=this.width();s>a&&([s,a]=[a,s]),n>r&&([n,r]=[r,n]),this.get("orientation")==="horizontal"?(e.moveTo(0,0),e.lineTo(s,0),e.lineTo(s,o),e.lineTo(0,o),e.lineTo(0,0),e.moveTo(a,0),e.lineTo(u,0),e.lineTo(u,o),e.lineTo(a,o),e.lineTo(a,0)):(e.moveTo(0,0),e.lineTo(0,n),e.lineTo(u,n),e.lineTo(u,0),e.lineTo(0,0),e.moveTo(0,r),e.lineTo(0,o),e.lineTo(u,o),e.lineTo(u,r),e.lineTo(0,r))})}}Object.defineProperty(me,"className",{enumerable:!0,configurable:!0,writable:!0,value:"XYChartScrollbar"});Object.defineProperty(me,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Re.classNames.concat([me.className])});class fe extends Se{constructor(){super(...arguments),Object.defineProperty(this,"_frequency",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_itemMap",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=W(this._settings.themeTags,["axis"]),this.fields.push("category"),super._afterNew()}_prepareAxisItems(){this.setPrivateRaw("baseInterval",this.get("baseInterval"));const e=this.get("renderer"),t=this.dataItems.length;let i=this.startIndex();i>0&&i--;let s=this.endIndex();s<t&&s++;let n=e.axisLength()/Math.max(e.get("minGridDistance"),1/Number.MAX_SAFE_INTEGER),a=Math.min(t,Math.ceil((s-i)/n));i=Math.floor(i/a)*a,this._frequency=a;for(let w=0;w<t;w++)this._toggleDataItem(this.dataItems[w],!1);let r=Number(this.dataItems[i].get("category")),o=Number(this.dataItems[s-1].get("category")),u=o-r;s-i<n&&(u=o-r-((o-r)/this.baseDuration()-(s-i))*this.baseDuration());let c=re(0,u,n,this.get("gridIntervals"));const h=Te(c.timeUnit),m=this.getPrivate("baseInterval");C(c)<this.baseDuration()&&(c=Object.assign({},m));const _=this.get("dateFormats");let p=-1/0,b=-1/0,g=-1/0,f,v=[],D=!1;for(let w=i;w<s;w++){let I=this.dataItems[w],T=I.get("index"),N=!1,d=Number(I.get("category")),P=new Date(d),O=Je(P,c.timeUnit);f=_[c.timeUnit];let k=!1;c.timeUnit!="year"&&c.timeUnit!="week"&&h&&this.get("markUnitChange")&&j(p)&&Me(d,p,h,this._root.utc)&&(f=this.get("periodChangeDateFormats")[c.timeUnit],T-a*.5<b&&v.pop(),v.push({format:f,dataItem:I}),D=!0,k=!0,b=T,g=O);let M=!1;c.timeUnit==="day"||c.timeUnit==="week"?T-b>=a&&(M=!0):O%c.count===0&&O!=g&&(M=!0),!k&&M&&(T-a*.7<b&&D&&(N=!0),N||(v.push({format:f,dataItem:I}),b=T,g=O),D=!1),p=d}if(v.length>0){let w=v[0].dataItem.get("index",0);F(v,I=>{const T=I.dataItem,N=I.format;this._createAssets(T,[]),this._toggleDataItem(T,!0);let d=Number(T.get("category")),P=new Date(d);const O=T.get("label");O&&O.set("text",this._root.dateFormatter.format(P,N)),w++,this._prepareDataItem(T,w,a)})}}baseDuration(){return C(this.getPrivate("baseInterval"))}getTooltipText(e,t){let i=this.dataItems[this.axisPositionToIndex(e)];if(i){let s=this.get("dateFormats")[this.getPrivate("baseInterval").timeUnit];return this._root.dateFormatter.format(new Date(i.get("category",0)),this.get("tooltipDateFormat",s))}}_updateTooltipText(e,t){e.label.set("text",this.getTooltipText(t))}}Object.defineProperty(fe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CategoryDateAxis"});Object.defineProperty(fe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Se.classNames.concat([fe.className])});class ee extends le{constructor(){super(...arguments),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_seriesDataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_groupingCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_intervalDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_baseDuration",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_intervalMax",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"_intervalMin",{enumerable:!0,configurable:!0,writable:!0,value:{}})}_afterNew(){this._settings.themeTags=W(this._settings.themeTags,["axis"]),super._afterNew(),this._setBaseInterval(this.get("baseInterval")),this.on("baseInterval",()=>{this._setBaseInterval(this.get("baseInterval"))})}_setBaseInterval(e){this.setPrivateRaw("baseInterval",e),this._baseDuration=C(e)}_fixZoomFactor(){const e=this.get("maxZoomFactor");e!=null&&e!=1/0?this.setPrivateRaw("maxZoomFactor",e):this.setPrivateRaw("maxZoomFactor",Math.round((this.getPrivate("max",0)-this.getPrivate("min",0))/this.baseMainDuration()))}_groupData(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(j(e)&&j(t)){this._fixZoomFactor();const i=this.getPrivate("groupInterval");if(i?this._setBaseInterval(i):this._setBaseInterval(this.get("baseInterval")),this.isDirty("groupInterval")){let s=this.get("groupInterval");s&&(this.setRaw("groupIntervals",[s]),this._handleRangeChange())}if(this.isDirty("groupData")&&!this._dataGrouped){if(this.get("groupData"))F(this.series,s=>{this._groupSeriesData(s)}),this._handleRangeChange();else{let s=this.get("baseInterval"),n=s.timeUnit+s.count;F(this.series,a=>{a.setDataSet(n),a.resetGrouping()}),this._setBaseInterval(s),this.setPrivateRaw("groupInterval",void 0),this.markDirtyExtremes()}this._dataGrouped=!0}}}_groupSeriesData(e){if(this.get("groupData")&&!e.get("groupDataDisabled")){this._dataGrouped=!0,this._seriesDataGrouped=!0;let t=[],i=this.baseMainDuration(),s=this.get("groupIntervals");F(s,_=>{C(_)>i&&t.push(_)}),e._dataSets={};const n=this.getPrivate("name")+this.get("renderer").getPrivate("letter");let a;const r=e.get("baseAxis");e.get("xAxis")===r?a=e._valueYFields:e.get("yAxis")===r&&(a=e._valueXFields);let o=e._mainDataItems,u=this.get("baseInterval"),c=u.timeUnit+u.count;e._dataSets[c]=o;const h=e.get("groupDataCallback");let m=e.get("groupDataWithOriginals",!1);h&&(m=!0),F(t,_=>{let p=-1/0,b=_.timeUnit+_.count;e._dataSets[b]=[];let g,f={},v={},D={},w={};F(a,P=>{f[P]=0,v[P]=0,D[P]=e.get(P+"Grouped"),w[P]=P+"Working"});let I=S(_.timeUnit),T=o[0],N;T&&(N=o[0].get(n));let d;F(o,P=>{let O=P.get(n),k=y(O,_.timeUnit,_.count,this._root,N),M;p<k-I/24?(M=Ne(P.dataContext),g=new Q(e,M,e._makeDataItem(M)),g.setRaw(n,k),e._dataSets[b].push(g),F(a,x=>{let U=P.get(x);j(U)?(g.setRaw(x,U),g.setRaw(w[x],U),v[x]=1,f[x]=U):(f[x]=0,v[x]=0)}),m&&g.set("originals",[P]),h&&d&&h(d,_),d=g):(F(a,x=>{let U=D[x],L=P.get(x);if(L!=null){let Y=g.get(x);switch(U){case"close":g.setRaw(x,L);break;case"sum":g.setRaw(x,Y+L);break;case"open":break;case"low":L<Y&&g.setRaw(x,L);break;case"high":L>Y&&g.setRaw(x,L);break;case"average":v[x]++,f[x]+=L;let X=f[x]/v[x];g.setRaw(x,X);break;case"extreme":Math.abs(L)>Math.abs(Y)&&g.setRaw(x,L);break}g.setRaw(w[x],g.get(x));let V=Ne(P.dataContext);V[n]=k,g.dataContext=V}}),m&&g.get("originals").push(P)),p=k}),h&&d&&h(d,_)}),e._dataSetId&&e.setDataSet(e._dataSetId),this.markDirtySize(),this._seriesAdded&&this._root.events.once("frameended",()=>{this.markDirtySize()})}}_clearDirty(){super._clearDirty(),this._groupingCalculated=!1,this._dataGrouped=!1}getGroupInterval(e){let t=this.get("baseInterval"),i=re(0,e,this.get("groupCount",1/0),this.get("groupIntervals"));return C(i)<C(t)&&(i=Object.assign({},t)),i}getIntervalMax(e){return this._intervalMax[e.timeUnit+e.count]}getIntervalMin(e){return this._intervalMin[e.timeUnit+e.count]}_handleRangeChange(){super._handleRangeChange();let e=Math.round(this.getPrivate("selectionMin")),t=Math.round(this.getPrivate("selectionMax"));if(j(e)&&j(t)){if(this.get("endLocation")==0&&(t+=1),this.get("groupData")&&!this._groupingCalculated){this._groupingCalculated=!0;let i=this.get("groupInterval"),s=this.getPrivate("groupInterval"),n=t-e+(this.get("startLocation",0)+(1-this.get("endLocation",1))*this.baseDuration());if(s){let a=C(s);n=Math.ceil(n/a)*a}if(i||(i=this.getGroupInterval(n)),i&&(!s||s.timeUnit!==i.timeUnit||s.count!==i.count||this._seriesDataGrouped)){this._seriesDataGrouped=!1,this.setPrivateRaw("groupInterval",i),this._setBaseInterval(i);let a=i.timeUnit+i.count;F(this.series,r=>{r.get("baseAxis")===this&&r.setDataSet(a)}),this.markDirtyExtremes(),this._root.events.once("frameended",()=>{this._root.events.once("frameended",()=>{const r="groupintervalchanged";this.events.isEnabled(r)&&this.events.dispatch(r,{type:r,target:this})})})}}F(this.series,i=>{if(i.get("baseAxis")===this){let s=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),a=Qe(i.dataItems,b=>B(b.get(s),e)).index;a>0&&(a-=1),t+=this.baseDuration()*(1-this.get("endLocation",1));let o=z(i.dataItems,b=>B(b.get(s),t)).index,u=o;u>1&&u--;const c=i.dataItems[a],h=i.dataItems[u];let m,_;c&&(_=c.get(s)),h&&(m=h.get(s));let p=!1;m!=null&&_!=null&&(m<e||_>t)&&(p=!0),i.setPrivate("outOfSelection",p),i.setPrivate("startIndex",a),i.setPrivate("adjustedStartIndex",i._adjustStartIndex(a)),i.setPrivate("endIndex",o),this.root.events.once("frameended",()=>{i._markDirtyPrivateKey("adjustedStartIndex")})}})}}_adjustMinMax(e,t,i,s){return{min:e,max:t,step:(t-e)/i}}intervalDuration(){return this._intervalDuration}_saveMinMax(e,t){let i=this.getPrivate("groupInterval");i||(i=this.get("baseInterval"));let s=i.timeUnit+i.count;this._intervalMin[s]=e,this._intervalMax[s]=t}_getM(e){return e=="day"||e=="month"||e=="year"?1.05:1.01}_getMinorInterval(e){var t;let i,s=e.count,n=e.timeUnit;return s>1&&(s==10||s==15?s=5:s==12?s=2:s==6?s=1:s==30?s=10:s<10&&(s=1),i={timeUnit:n,count:s}),n=="week"&&(((t=this.getPrivate("baseInterval"))===null||t===void 0?void 0:t.timeUnit)!="week"?i={timeUnit:"day",count:1}:i={timeUnit:"week",count:1}),n=="year"&&s==1&&this.getPrivate("selectionMax",0)-this.getPrivate("selectionMin",0)<4*366*24*60*60*1e3&&(i={timeUnit:"month",count:1}),i}_prepareAxisItems(){const e=this.getPrivate("min"),t=this.getPrivate("max");if(j(e)&&j(t)){const i=this._root,s=Math.round(this.getPrivate("selectionMin")),n=Math.round(this.getPrivate("selectionMax")),a=this.get("renderer"),r=this.getPrivate("baseInterval");let o=s,u=0;const c=this.get("gridIntervals");let h=re(0,n-s,a.gridCount(),c);C(h)<this.baseDuration()&&(h=Object.assign({},r));const m=C(h);this._intervalDuration=m;const _=Te(h.timeUnit),p=i.utc,b=i.timezone;o=y(s-m,h.timeUnit,h.count,i,e);let g=o-m,f;const v=this.get("dateFormats");this.setPrivateRaw("gridInterval",h);const D=a.get("minorLabelsEnabled"),w=a.get("minorGridEnabled",D);let I,T=0;w&&(I=this._getMinorInterval(h),T=C(I));let N=0;for(;o<n+m;){let d;this.dataItems.length<u+1?(d=new Q(this,void 0,{}),this._dataItems.push(d),this.processDataItem(d)):d=this.dataItems[u],this._createAssets(d,[]),this._toggleDataItem(d,!0),d.setRaw("value",o),d.setRaw("labelEndValue",void 0);let P=o+S(h.timeUnit,h.count*this._getM(h.timeUnit));P=y(P,h.timeUnit,1,i),d.setRaw("endValue",P);let O=new Date(o);f=v[h.timeUnit],_&&this.get("markUnitChange")&&j(g)&&h.timeUnit!="year"&&Me(o,g,_,p,b)&&(f=this.get("periodChangeDateFormats")[h.timeUnit]);const k=d.get("label");k&&k.set("text",i.dateFormatter.format(O,f));let M=h.count;if(h.timeUnit=="week"?k==null||k.set("location",this.get("weekLabelLocation",0)):k==null||k.set("location",a.labels.template.get("location")),w){M=1;let x=h.timeUnit;x=="week"&&this.get("skipFirstMinor")&&(x="day");let U=o+S(x,this._getM(x));U=y(U,x,1,i),d.setRaw("labelEndValue",U)}if(this._prepareDataItem(d,M),g=o,o=P,I){const x=I.timeUnit,U=I.count,L=this._getM(x);this.get("skipFirstMinor")||(g-=T*L);let Y=y(g+T*L,x,U,i,g),V,X=this.get("minorDateFormats",this.get("dateFormats"));for(;Y<o-.01*T;){let A;this.minorDataItems.length<N+1?(A=new Q(this,void 0,{}),this.minorDataItems.push(A),this.processDataItem(A)):A=this.minorDataItems[N],this._createAssets(A,["minor"],!0),this._toggleDataItem(A,!0),A.setRaw("value",Y);let q=Y+S(x,U*L);q=y(q,x,1,i),A.setRaw("endValue",q);let H=new Date(Y);f=X[x];const K=A.get("label");if(K&&(D?K.set("text",i.dateFormatter.format(H,f)):K.setPrivate("visible",!1)),this._prepareDataItem(A,1),Y==V)break;if(!A.get("isRange")){const R=this.get("fillRule");R&&R(A)}V=Y,Y=q,N++}}if(o==g)break;u++}for(let d=u;d<this.dataItems.length;d++)this._toggleDataItem(this.dataItems[d],!1);for(let d=N;d<this.minorDataItems.length;d++)this._toggleDataItem(this.minorDataItems[d],!1);F(this.series,d=>{d.inited&&d._markDirtyAxes()})}this._updateGhost()}_updateFinals(e,t){this.setPrivateRaw("selectionMinFinal",this.positionToValue(e)),this.setPrivateRaw("selectionMaxFinal",this.positionToValue(t))}_getDelta(){this._deltaMinMax=this.baseDuration()/2}_fixMin(e){const t=this.getPrivate("baseInterval"),i=t.timeUnit;let s=y(e,i,t.count,this._root),n=s+S(i,t.count*this._getM(i));return n=y(n,i,1,this._root),s+(n-s)*this.get("startLocation",0)}_fixMax(e){const t=this.getPrivate("baseInterval"),i=t.timeUnit;let s=y(e,i,t.count,this._root),n=s+S(i,t.count*this._getM(i));return n=y(n,i,1,this._root),s+(n-s)*this.get("endLocation",1)}_updateDates(e,t){}_handleSeriesRemoved(){this.setPrivate("baseInterval",this.get("baseInterval")),this.setPrivate("min",void 0),this.setPrivate("minFinal",void 0)}baseDuration(){return this._baseDuration}baseMainDuration(){return C(this.get("baseInterval"))}processSeriesDataItem(e,t){const i=this.getPrivate("baseInterval");e.open||(e.open={}),e.close||(e.close={}),F(t,s=>{let n=e.get(s);if(j(n)){let a=e.open[s],r=e.close[s];if(!(n>=a&&n<=r)){const o=i.timeUnit,u=i.count;a=y(n,o,u,this._root),r=a+S(o,u*this._getM(o)),r=y(r,o,1,this._root),e.open[s]=a,e.close[s]=r}this._updateDates(a,e.component)}})}_handleSizeDirty(){}getDataItemPositionX(e,t,i,s,n){let a,r,o;return n?o=e.get(t):(e.open&&e.close?(a=e.open[t],r=e.close[t]):(a=e.get(t),r=a),o=a+(r-a)*i,o=this._baseValue+(o-this._baseValue)*s),this.valueToPosition(o)}getDataItemCoordinateX(e,t,i,s){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionX(e,t,i,s))}getDataItemPositionY(e,t,i,s,n){let a,r,o;return n?o=e.get(t):(e.open&&e.close?(a=e.open[t],r=e.close[t]):(a=e.get(t),r=a),o=a+(r-a)*i,o=this._baseValue+(o-this._baseValue)*s),this.valueToPosition(o)}getDataItemCoordinateY(e,t,i,s){return this._settings.renderer.positionToCoordinate(this.getDataItemPositionY(e,t,i,s))}roundAxisPosition(e,t){let i=this.positionToValue(e);i=i-(t-.5)*this.baseDuration();let s=this.getPrivate("baseInterval");if(!et(i)){const n=this._root.locale.firstDayOfWeek,a=s.timeUnit,r=this._root.utc,o=this._root.timezone,u=s.count;i=y(i,a,u,this._root,this.getPrivate("min",0));let c=he(s,new Date(i),n,r,o);return o&&(i=y(i+this.baseDuration()*.05,a,u,this._root,this.getPrivate("min",0)),c=he(s,new Date(i+c*t),n,r,o)),this.valueToPosition(i+c*t)}return NaN}getTooltipText(e,t){if(this.getPrivate("min")!=null){let i=this.get("tooltipDateFormats")[this.getPrivate("baseInterval").timeUnit],s=this.positionToValue(e);if(j(s)){let n=new Date(s),a=this.getPrivate("baseInterval"),r=he(a,n,this._root.locale.firstDayOfWeek,this._root.utc,this._root.timezone);return t!==!1&&(n=new Date(s+this.get("tooltipIntervalOffset",-this.get("tooltipLocation",.5))*r)),this._root.dateFormatter.format(n,this.get("tooltipDateFormat",i))}}return""}getSeriesItem(e,t,i,s){let n=this.getPrivate("name")+this.get("renderer").getPrivate("letter"),a=this.positionToValue(t);i==null&&(i=.5),a=a-(i-.5)*this.baseDuration();const r=z(e.dataItems,o=>{let u=0;return o.open&&(u=o.open[n]),B(u,a)});if(s||e.get("snapTooltip")){let o=e.dataItems[r.index-1],u=e.dataItems[r.index];if(o&&u&&o.open&&u.close){let c=o.open[n],h=u.close[n];if(Math.abs(a-c)>Math.abs(a-h))return u}if(o)return o;if(u)return u}else{const o=e.dataItems[r.index-1];if(o&&o.open&&o.close){let u=o.open[n],c=o.close[n];if(a>=u&&a<=c)return o}}}shouldGap(e,t,i,s){const n=e.get(s);return t.get(s)-n>this.baseDuration()*i}zoomToDates(e,t,i){this.zoomToValues(e.getTime(),t.getTime(),i)}zoomToValues(e,t,i){const s=this.getPrivate("minFinal",this.getPrivate("min",0)),n=this.getPrivate("maxFinal",this.getPrivate("max",0));if(this.getPrivate("min")!=null&&this.getPrivate("max")!=null)if(this.get("groupData")){const a=this.getGroupInterval(t-e),r=this.get("baseInterval");let o=this.getIntervalMin(r),u=this.getIntervalMax(r)-1;u=y(u,a.timeUnit,a.count,this.root),u+=this._getM(a.timeUnit)*C(a),u=y(u,a.timeUnit,a.count,this.root);let c=y(o,a.timeUnit,a.count,this.root),h=y(u,a.timeUnit,a.count,this.root),m=(e-c)/(h-c),_=(t-c)/(h-c);this.zoom(m,_,i)}else this.zoom((e-s)/(n-s),(t-s)/(n-s),i)}positionToDate(e){return new Date(this.positionToValue(e))}dateToPosition(e){return this.valueToPosition(e.getTime())}getCellWidthPosition(){let e=this.getPrivate("selectionMax",this.getPrivate("max")),t=this.getPrivate("selectionMin",this.getPrivate("min"));return j(e)&&j(t)?this._intervalDuration/(e-t):.05}nextPosition(e){e==null&&(e=1);let t=this.get("tooltipLocation",.5)*this.baseDuration();this.get("renderer").getPrivate("letter")=="Y"&&(e*=-1);let i=this.positionToValue(this.getPrivate("tooltipPosition",0));const s=this.getPrivate("baseInterval");let n=this._nextTime(i,e,s),a=this.getPrivate("selectionMin",0),r=this.getPrivate("selectionMax",0),o=y(a,s.timeUnit,s.count,this._root),u=y(r,s.timeUnit,s.count,this._root);return n+=t,n=ae(n,o+t,u-t),this.toGlobalPosition(this.valueToPosition(n))}_nextTime(e,t,i){return y(e+t*this.baseDuration(),i.timeUnit,i.count,this._root)}}Object.defineProperty(ee,"className",{enumerable:!0,configurable:!0,writable:!0,value:"DateAxis"});Object.defineProperty(ee,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:le.classNames.concat([ee.className])});class _e extends ee{constructor(){super(...arguments),Object.defineProperty(this,"_frequency",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"_m",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_dates",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_customDates",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_afterNew(){this.valueFields.push("date"),super._afterNew()}_getDates(){return this._customDates?this._customDates:this._dates}_updateDates(e,t){if(!t.get("ignoreMinMax")){const i=this._getDates(),s=z(i,n=>B(n,e));s.found||tt(i,s.index,e)}}_updateAllDates(){if(!this._customDates){const e=this._dates;e.length=0,F(this.series,o=>{let u="valueX";o.get("yAxis")==this&&(u="valueY"),F(o.dataItems,c=>{let h=c.get(u);j(h)&&c.open&&this._updateDates(c.open[u],o)})});const t=this.get("extraMax",0),i=this.get("extraMin",0);let s=e.length;const n=this.getPrivate("baseInterval"),a=n.count,r=n.timeUnit;if(t>0){const o=s*t;let u=e[s-1];if(j(u))for(let c=s-1;c<s+o;c++)u+=S(r,a*this._getM(r)),u=y(u,r,a,this._root),e.push(u)}if(i>0){const o=s*i;let u=e[0];if(j(u))for(let c=0;c<o;c++)u-=S(r,a),u=y(u,r,a,this._root),e.unshift(u)}}}valueToPosition(e){const t=this._getDates(),i=this.get("startLocation",0),s=this.get("endLocation",1),n=t.length-i-(1-s),a=z(t,o=>B(o,e));let r=a.index;if(a.found)return(r-i)/n;{r>0&&(r-=1);let o=t[r];const u=t[r+1];if(u){let h=u;Math.abs(h-e)<Math.abs(o-e)&&(o=h,r++)}let c=e-o;return(r-i)/n+c/this.baseDuration()/n}}valueToIndex(e){const t=this._getDates(),i=z(t,n=>B(n,e));let s=i.index;return i.found||s>0&&(s-=1),s}positionToValue(e){const t=this.get("startLocation",0),i=this.get("endLocation",1),s=this._getDates();let n=Math.round(s.length-t-(1-i)),a=e*n,r=Math.floor(a);return r<0&&(r=0),r>n-1&&(r=n-1),s[r]+(a-r+t)*this.baseDuration()}_fixZoomFactor(){this.setPrivateRaw("maxZoomFactor",this._getDates().length-this.get("startLocation",0)-(1-this.get("endLocation",1)))}zoomToDates(e,t,i){const s=this._getDates(),n=s.length;let a=z(s,u=>B(u,e.getTime())),r=s[Math.min(a.index,n-1)];a=z(s,u=>B(u,t.getTime()));let o=s[a.index];a.index>=n&&(o=s[n-1]+this.baseDuration()),this.zoomToValues(r,o,i)}zoomToValues(e,t,i){const s=this.getPrivate("min",0),n=this.getPrivate("max",0);e=ae(e,s,n),t=ae(t,s,n),this.zoom(this.valueToPosition(e),this.valueToPosition(t),i)}_prepareAxisItems(){let e=this.getPrivate("selectionMin",0),t=this.getPrivate("selectionMax",0);if(j(e)&&j(t)){this._seriesValuesDirty&&(this._seriesValuesDirty=!1,this._updateAllDates());const i=this._root,s=i.utc,n=i.timezone,a=this._getDates(),r=this.get("renderer"),o=a.length,u=this.baseDuration();let c=this.valueToIndex(e);c>0&&c--;let h=this.valueToIndex(t);h<o-1&&h++;let m=r.axisLength()/Math.max(r.get("minGridDistance"),1/Number.MAX_SAFE_INTEGER),_=Math.min(o,Math.ceil((h-c)/m));_=Math.max(1,_),c=Math.floor(c/_)*_,this._frequency=_,F(this.dataItems,M=>{this._toggleDataItem(M,!1)}),F(this.minorDataItems,M=>{this._toggleDataItem(M,!1)});let p=t-e-((t-e)/u-(h-c))*u,b=re(0,p,m,this.get("gridIntervals"));const g=this.getPrivate("baseInterval");let f=C(b);f<u&&(b=Object.assign({},g),f=C(b)),this._intervalDuration=f;const v=b.timeUnit,D=this.get("dateFormats");let w=Date.now();a[0]&&(w=a[0]);let I=y(this.getPrivate("selectionMin",0),v,b.count,i,w);const T=r.get("minorLabelsEnabled"),N=r.get("minorGridEnabled",T);let d,P=0,O;N&&(d=this._getMinorInterval(b),P=C(d));let k=this._getIndexes(I,this.getPrivate("selectionMax",I)+f,b,this.getPrivate("min",I));if(k.length>0){let M=0;this._m=0;let x=I-f*10;const U=Te(v);if(d){let Y=a[k[0]];this._addMinorGrid(Y-f,Y,P,d)}let L=r.axisLength()/r.gridCount()*.5;F(k,Y=>{var V;let X;this.dataItems.length<M+1?(X=new Q(this,void 0,{}),this._dataItems.push(X),this.processDataItem(X)):X=this.dataItems[M];let A=a[Y],q=new Date(A),H=A;M<k.length-1?H=a[k[M+1]]:H+=f,X.setRaw("value",A),X.setRaw("endValue",H),X.setRaw("index",M),X.setRaw("labelEndValue",void 0);let K=D[v];U&&this.get("markUnitChange")&&j(x)&&v!="year"&&Me(A,x,U,s,n)&&(K=this.get("periodChangeDateFormats")[v]),this._createAssets(X,[]);const R=X.get("label");R&&R.set("text",i.dateFormatter.format(q,K)),this._toggleDataItem(X,!0);let ue=b.count;if(v=="week"&&X.setRaw("labelEndValue",A),N){let G=b.timeUnit;if(G=="week"&&(G="day"),ue>1||b.timeUnit=="week"){let E=y(A,G,1,i)+S(G,this._getM(G)),se=this.valueToIndex(E);if(E=a[se],E==A){let J=a[se+1];J?E=J:E+=P}X.setRaw("labelEndValue",E)}ue=1}if(this._prepareDataItem(X,ue),R&&O&&r.getPrivate("letter")=="X"){let G=O.get("label");if(G){let E=R.x(),se=G.x();if(E-se<L){let J=this._pickWorse(O,X,b);J&&((V=J.get("label"))===null||V===void 0||V.setPrivate("visible",!1))}}}d&&this._addMinorGrid(A,H,P,d),M++,R&&R.getPrivate("visible")&&(O=X),x=A})}F(this.series,M=>{M.inited&&M._markDirtyAxes()})}this._updateGhost()}_pickWorse(e,t,i){const s=i.timeUnit,n=e.get("value",0),a=t.get("value",0);return s=="hour"&&new Date(n).getDate()!=new Date(a).getDate()?e:t}_addMinorGrid(e,t,i,s){const n=this.get("minorDateFormats",this.get("dateFormats")),a=s.timeUnit;let r=e+S(a,this._getM(a));r=y(r,a,1,this._root);let o=t-i*.5,u=this._getIndexes(r,o,s,r);const c=this._getDates();F(u,h=>{let m;this.minorDataItems.length<this._m+1?(m=new Q(this,void 0,{}),this.minorDataItems.push(m),this.processDataItem(m)):m=this.minorDataItems[this._m],r=c[h],m.setRaw("value",r),m.setRaw("endValue",r+i),m.setRaw("index",h),this._createAssets(m,["minor"],!0);const _=m.get("label");if(_)if(this.get("renderer").get("minorLabelsEnabled")){let p=new Date(r),b=n[a];_.set("text",this._root.dateFormatter.format(p,b))}else _.setPrivate("visible",!1);this._toggleDataItem(m,!0),this._prepareDataItem(m,1),this._m++})}_getIndexes(e,t,i,s){const n=[],a=i.timeUnit,r=i.count,o=this._getM(a),u=this.getPrivate("baseInterval"),c=this._root,h=this._getDates();let m=r-1,_=-1/0,p=S(a,o),b=S(a,r*o),g=e;for(a=="day"&&(e=s);e<=t;){e=y(e,a,r,c);let f=this.valueToIndex(e),v=h[f];if(a=="day"&&u.timeUnit=="day")this._hasDate(e)&&m++,m==r&&(e>=g-b*2&&Oe(n,f),m=0),e+=p,e=y(e,a,1,c);else{if(v<e){for(let D=f,w=h.length;D<w;D++)if(v=h[D],v>=e){f=D;break}}Oe(n,f),e+=b,e=y(e,a,r,c)}if(e==_&&(e+=b+p,e=y(e,a,r,c)),e==_)break;_=e}return n}_hasDate(e){return z(this._getDates(),i=>st(i,e)).found}_nextTime(e,t,i){let s=ae(this.valueToIndex(e)+t,0,this._dates.length-1);return this._dates[s]}}Object.defineProperty(_e,"className",{enumerable:!0,configurable:!0,writable:!0,value:"GaplessDateAxis"});Object.defineProperty(_e,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ee.classNames.concat([_e.className])});class be extends le{constructor(){super(...arguments),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_groupingCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_intervalDuration",{enumerable:!0,configurable:!0,writable:!0,value:1})}_afterNew(){this._settings.themeTags=W(this._settings.themeTags,["axis"]),super._afterNew()}_adjustMinMax(e,t,i,s){let n;const a=this.getDurationFormatter(),r=this.get("baseUnit");if(this.setRaw("maxPrecision",0),r=="millisecond"||r=="second"||r=="minute"||r=="hour"){i<=1&&(i=1),i=Math.round(i);let o=t-e;o===0&&(o=Math.abs(t));let u=o/i,c=[60,30,20,15,10,2,1],h=1;r=="hour"&&(c=[24,12,6,4,2,1]);for(let f of c)if(o/f>i){h=f;break}let m=Math.ceil((t-e)/h/i),_=Math.log(Math.abs(m))*Math.LOG10E,p=Math.pow(10,Math.floor(_))/10,b=m/p;m=He(c,b)*p,u=h*m,e=Math.floor(e/u)*u,t=Math.ceil(t/u)*u,n={min:e,max:t,step:u}}else n=super._adjustMinMax(e,t,i,s);return this.setPrivateRaw("durationFormat",a.getFormat(n.step,n.max,r)),n}_formatText(e){return this.getDurationFormatter().format(e,this.getPrivate("durationFormat"),this.get("baseUnit"))}getTooltipText(e,t){const i=this.getDurationFormatter(),s=this.get("extraTooltipPrecision",0),n=this.getPrivate("stepDecimalPlaces",0)+s,a=Ke(this.positionToValue(e),n);return i.format(a,this.getPrivate("durationFormat"),this.get("baseUnit"))}}Object.defineProperty(be,"className",{enumerable:!0,configurable:!0,writable:!0,value:"DurationAxis"});Object.defineProperty(be,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:le.classNames.concat([be.className])});class de extends Ge{constructor(){super(...arguments),Object.defineProperty(this,"axis",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}_beforeChanged(){super._beforeChanged();const e=this.get("sprite");if(this.isDirty("sprite")&&e&&(e.setAll({position:"absolute",role:"figure"}),this._disposers.push(e)),this.isDirty("location")){const t=e.dataItem;this.axis&&e&&t&&this.axis._prepareDataItem(t)}}_dispose(){const e=this.axis;e&&it(e._bullets,(t,i)=>{i.uid==this.uid&&delete e._bullets[t]}),super._dispose()}}Object.defineProperty(de,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisBullet"});Object.defineProperty(de,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ge.classNames.concat([de.className])});class pe extends Ee{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(pe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"AxisLabelRadial"});Object.defineProperty(pe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ee.classNames.concat([pe.className])});class ve extends ze{constructor(){super(...arguments),Object.defineProperty(this,"_tickPoints",{enumerable:!0,configurable:!0,writable:!0,value:[]})}}Object.defineProperty(ve,"className",{enumerable:!0,configurable:!0,writable:!0,value:"EditableAxisLabel"});Object.defineProperty(ve,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:ze.classNames.concat([ve.className])});class $ extends Be{_beforeChanged(){super._beforeChanged(),(this.isDirty("lowX0")||this.isDirty("lowY0")||this.isDirty("lowX1")||this.isDirty("lowY1")||this.isDirty("highX0")||this.isDirty("highX1")||this.isDirty("highY0")||this.isDirty("highY1"))&&(this._clear=!0)}_draw(){super._draw();const e=this._display;e.moveTo(this.get("lowX0",0),this.get("lowY0",0)),e.lineTo(this.get("lowX1",0),this.get("lowY1",0)),e.moveTo(this.get("highX0",0),this.get("highY0",0)),e.lineTo(this.get("highX1",0),this.get("highY1",0))}}Object.defineProperty($,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Candlestick"});Object.defineProperty($,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Be.classNames.concat([$.className])});class te extends Ve{constructor(){super(...arguments),Object.defineProperty(this,"columns",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new ne(oe.new({themeTags:["autocolor"]}),()=>$._new(this._root,{themeTags:W(this.columns.template.get("themeTags",[]),["candlestick","series","column"])},[this.columns.template])))})}makeColumn(e,t){const i=t.make();return this.get("turboMode")?i.virtualParent=this.chart:this.mainContainer.children.push(i),i._setDataItem(e),t.push(i),i}_updateGraphics(e,t,i){super._updateGraphics(e,t,i);const s=this.getRaw("xAxis"),n=this.getRaw("yAxis");let a=this.get("vcy",1),r=this.get("vcx",1),o,u,c,h,m,_,p,b,g=this.get("locationX",e.get("locationX",.5)),f=this.get("locationY",e.get("locationY",.5)),v=this.get("openLocationX",e.get("openLocationX",g)),D=this.get("openLocationY",e.get("openLocationY",f)),w;if(i==0){let I=n.getDataItemPositionY(e,this._yOpenField,1,a),T=n.getDataItemPositionY(e,this._yField,1,a);h=n.getDataItemPositionY(e,this._yLowField,1,a),b=n.getDataItemPositionY(e,this._yHighField,1,a),p=Math.max(I,T),c=Math.min(I,T);let N=this._aLocationX0+v-.5,d=this._aLocationX1+g-.5;o=s.getDataItemPositionX(e,this._xField,N+(d-N)/2,r),u=o,m=o,_=o,w="vertical"}else{let I=s.getDataItemPositionX(e,this._xOpenField,1,r),T=s.getDataItemPositionX(e,this._xField,1,r);u=s.getDataItemPositionX(e,this._xLowField,1,r),_=s.getDataItemPositionX(e,this._xHighField,1,r),m=Math.max(I,T),o=Math.min(I,T);let N=this._aLocationY0+D-.5,d=this._aLocationY1+f-.5;c=n.getDataItemPositionY(e,this._yField,N+(d-N)/2,a),h=c,p=c,b=c,w="horizontal"}this._updateCandleGraphics(e,o,u,c,h,m,_,p,b,w)}_updateCandleGraphics(e,t,i,s,n,a,r,o,u,c){let h=e.get("graphics");if(h){let m=this.getPoint(t,s),_=this.getPoint(i,n),p=this.getPoint(a,o),b=this.getPoint(r,u);if(this.get("turboMode")){const g=this.allColumnsData[this.allColumnsData.length-1];g.lowX0=m.x,g.lowY0=m.y,g.lowX1=_.x,g.lowY1=_.y,g.highX0=p.x,g.highY0=p.y,g.highX1=b.x,g.highY1=b.y}else{let g=h.x(),f=h.y();h.set("lowX0",m.x-g),h.set("lowY0",m.y-f),h.set("lowX1",_.x-g),h.set("lowY1",_.y-f),h.set("highX0",p.x-g),h.set("highY0",p.y-f),h.set("highX1",b.x-g),h.set("highY1",b.y-f),h.set("orientation",c);let v=e.get("rangeGraphics");v&&F(v,D=>{D.set("lowX0",m.x-g),D.set("lowY0",m.y-f),D.set("lowX1",_.x-g),D.set("lowY1",_.y-f),D.set("highX0",p.x-g),D.set("highY0",p.y-f),D.set("highX1",b.x-g),D.set("highY1",b.y-f),D.set("orientation",c)})}}}_afterColumnsDraw(){this.get("turboMode")&&this.allColumns.set("draw",e=>{e.clear(),F(this.allColumnsData,t=>{e.beginPath();const i=t.width,s=t.height,n=t.x,a=t.y,r=t.stroke,o=t.fill,u=t.strokeWidth,c=t.strokeOpacity,h=t.fillOpacity,m=t.lowX0,_=t.lowY0,p=t.lowX1,b=t.lowY1,g=t.highX0,f=t.highY0,v=t.highX1,D=t.highY1;e.beginFill(o,h),e.beginPath(),e.lineStyle(u,r,c),e.drawRect(n,a,i,s),e.moveTo(m,_),e.lineTo(p,b),e.moveTo(g,f),e.lineTo(v,D),e.endStroke(),e.endFill()})})}_processAxisRange(e){super._processAxisRange(e),e.columns=new ne(oe.new({}),()=>$._new(this._root,{themeTags:W(e.columns.template.get("themeTags",[]),["candlestick","series","column"])},[this.columns.template,e.columns.template]))}}Object.defineProperty(te,"className",{enumerable:!0,configurable:!0,writable:!0,value:"CandlestickSeries"});Object.defineProperty(te,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Ve.classNames.concat([te.className])});class ie extends ${_draw(){const e=this._display;e.moveTo(this.get("lowX1",0),this.get("lowY1",0)),e.lineTo(this.get("highX1",0),this.get("highY1",0));let t=this.width(),i=this.height();if(this.get("orientation")=="vertical"){let s=i,n=0;e.moveTo(0,s),e.lineTo(t/2,s),e.moveTo(t/2,n),e.lineTo(t,n)}else{let s=0,n=t;e.moveTo(s,0),e.lineTo(s,i/2),e.moveTo(n,i/2),e.lineTo(n,i)}}}Object.defineProperty(ie,"className",{enumerable:!0,configurable:!0,writable:!0,value:"OHLC"});Object.defineProperty(ie,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:$.classNames.concat([ie.className])});class xe extends te{constructor(){super(...arguments),Object.defineProperty(this,"columns",{enumerable:!0,configurable:!0,writable:!0,value:this.addDisposer(new ne(oe.new({themeTags:["autocolor"]}),()=>ie._new(this._root,{themeTags:W(this.columns.template.get("themeTags",[]),["ohlc","series","column"])},[this.columns.template])))})}makeColumn(e,t){const i=this.mainContainer.children.push(t.make());return i._setDataItem(e),t.push(i),i}_processAxisRange(e){super._processAxisRange(e),e.columns=new ne(oe.new({}),()=>ie._new(this._root,{themeTags:W(e.columns.template.get("themeTags",[]),["ohlc","series","column"])},[this.columns.template,e.columns.template]))}}Object.defineProperty(xe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"OHLCSeries"});Object.defineProperty(xe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:te.classNames.concat([xe.className])});class rt{constructor(e,t){Object.defineProperty(this,"_line",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_point",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_x1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_t0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tension",{enumerable:!0,configurable:!0,writable:!0,value:0}),this._context=e,this._tension=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0}lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ce(this,this._t0,je(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,t){[e,t]=[t,e];let i=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(t,e):this._context.moveTo(t,e);break;case 1:this._point=2;break;case 2:this._point=3,ce(this,je(this,i=Xe(this,e,t)),i);break;default:ce(this,this._t0,i=Xe(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}}function De(l){function e(t){return new rt(t,l)}return e.tension=function(t){return De(+t)},e}function Fe(l){return l<0?-1:1}function Xe(l,e,t){let i=l._x1-l._x0,s=e-l._x1,n=(l._y1-l._y0)/(i||s<0&&-0),a=(t-l._y1)/(s||i<0&&-0),r=(n*s+a*i)/(i+s);return(Fe(n)+Fe(a))*Math.min(Math.abs(n),Math.abs(a),.5*Math.abs(r))||0}function je(l,e){let t=l._x1-l._x0;return t?(3*(l._y1-l._y0)/t-e)/2:e}function ce(l,e,t){let i=l._x0,s=l._y0,n=l._x1,a=l._y1,r=(n-i)/1.5*(1-l._tension);l._context.bezierCurveTo(s+r*e,i+r,a-r*t,n-r,a,n)}class Pe extends Z{_afterNew(){this._setDefault("curveFactory",De(this.get("tension",.5))),super._afterNew()}_updateChildren(){this.isDirty("tension")&&(this.set("curveFactory",De(this.get("tension",.5))),this._valuesDirty=!0),super._updateChildren()}}Object.defineProperty(Pe,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SmoothedYLineSeries"});Object.defineProperty(Pe,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([Pe.className])});class ot{constructor(e,t){Object.defineProperty(this,"_line",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_point",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_context",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_x0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_x1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y1",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_t0",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_tension",{enumerable:!0,configurable:!0,writable:!0,value:0}),this._context=e,this._tension=t}areaStart(){this._line=0}areaEnd(){this._line=NaN}lineStart(){this._x0=this._x1=this._y0=this._y1=this._t0=NaN,this._point=0}lineEnd(){switch(this._point){case 2:this._context.lineTo(this._x1,this._y1);break;case 3:ge(this,this._t0,Ce(this,this._t0));break}(this._line||this._line!==0&&this._point===1)&&this._context.closePath(),this._line=1-this._line}point(e,t){let i=NaN;if(e=+e,t=+t,!(e===this._x1&&t===this._y1)){switch(this._point){case 0:this._point=1,this._line?this._context.lineTo(e,t):this._context.moveTo(e,t);break;case 1:this._point=2;break;case 2:this._point=3,ge(this,Ce(this,i=Le(this,e,t)),i);break;default:ge(this,this._t0,i=Le(this,e,t));break}this._x0=this._x1,this._x1=e,this._y0=this._y1,this._y1=t,this._t0=i}}}function Ye(l){function e(t){return new ot(t,l)}return e}function Ue(l){return l<0?-1:1}function Le(l,e,t){let i=l._x1-l._x0,s=e-l._x1,n=(l._y1-l._y0)/(i||s<0&&-0),a=(t-l._y1)/(s||i<0&&-0),r=(n*s+a*i)/(i+s);return(Ue(n)+Ue(a))*Math.min(Math.abs(n),Math.abs(a),.5*Math.abs(r))||0}function Ce(l,e){let t=l._x1-l._x0;return t?(3*(l._y1-l._y0)/t-e)/2:e}function ge(l,e,t){let i=l._x0,s=l._y0,n=l._x1,a=l._y1,r=(n-i)/1.5*(1-l._tension);l._context.bezierCurveTo(i+r,s+r*e,n-r,a-r*t,n,a)}class we extends Z{_afterNew(){this._setDefault("curveFactory",Ye(this.get("tension",.5))),super._afterNew()}_updateChildren(){this.isDirty("tension")&&(this.set("curveFactory",Ye(this.get("tension",.5))),this._valuesDirty=!0),super._updateChildren()}}Object.defineProperty(we,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SmoothedXLineSeries"});Object.defineProperty(we,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([we.className])});class ye extends Z{_afterNew(){this._setDefault("curveFactory",Ae.tension(this.get("tension",.5))),super._afterNew()}_updateChildren(){this.isDirty("tension")&&(this.set("curveFactory",Ae.tension(this.get("tension",.5))),this._valuesDirty=!0),super._updateChildren()}}Object.defineProperty(ye,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SmoothedXYLineSeries"});Object.defineProperty(ye,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([ye.className])});class Ie extends Z{_afterNew(){this._setDefault("curveFactory",nt),super._afterNew()}_getPoints(e,t){let i=t.points,s=this.get("stepWidth",at).value/2,n=e.get("locationX",t.locationX),a=e.get("locationY",t.locationY),r=n,o=a;t.baseAxis===t.xAxis?(n-=s,r+=s):t.baseAxis===t.yAxis&&(a-=s,o+=s);let u=t.xAxis.getDataItemPositionX(e,t.xField,n,t.vcx),c=t.yAxis.getDataItemPositionY(e,t.yField,a,t.vcy),h=t.xAxis.getDataItemPositionX(e,t.xField,r,t.vcx),m=t.yAxis.getDataItemPositionY(e,t.yField,o,t.vcy);if(this._shouldInclude(u)){const _=this.getPoint(u,c),p=[_.x,_.y],b=this.getPoint(h,m),g=[b.x,b.y];if(t.fillVisible){let f=u,v=c,D=h,w=m;if(t.baseAxis===t.xAxis?(v=t.basePosY,w=t.basePosY):t.baseAxis===t.yAxis&&(f=t.basePosX,D=t.basePosX),t.getOpen){let N=e.get(t.xOpenField),d=e.get(t.yOpenField);if(N!=null&&d!=null)if(n=e.get("openLocationX",t.openLocationX),a=e.get("openLocationY",t.openLocationY),r=n,o=a,t.baseAxis===t.xAxis?(n-=s,r+=s):t.baseAxis===t.yAxis&&(a-=s,o+=s),t.stacked){let P=e.get("stackToItemX"),O=e.get("stackToItemY");P?(f=t.xAxis.getDataItemPositionX(P,t.xField,n,P.component.get("vcx")),D=t.xAxis.getDataItemPositionX(P,t.xField,r,P.component.get("vcx"))):t.yAxis===t.baseAxis?(f=t.basePosX,D=t.basePosX):t.baseAxis===t.yAxis&&(f=t.xAxis.getDataItemPositionX(e,t.xOpenField,n,t.vcx),D=t.xAxis.getDataItemPositionX(e,t.xOpenField,r,t.vcx)),O?(v=t.yAxis.getDataItemPositionY(O,t.yField,a,O.component.get("vcy")),w=t.yAxis.getDataItemPositionY(O,t.yField,o,O.component.get("vcy"))):t.xAxis===t.baseAxis?(v=t.basePosY,w=t.basePosY):t.baseAxis===t.yAxis&&(v=t.yAxis.getDataItemPositionY(e,t.yOpenField,a,t.vcy),w=t.yAxis.getDataItemPositionY(e,t.yOpenField,o,t.vcy))}else f=t.xAxis.getDataItemPositionX(e,t.xOpenField,n,t.vcx),v=t.yAxis.getDataItemPositionY(e,t.yOpenField,a,t.vcy),D=t.xAxis.getDataItemPositionX(e,t.xOpenField,r,t.vcx),w=t.yAxis.getDataItemPositionY(e,t.yOpenField,o,t.vcy)}let I=this.getPoint(f,v),T=this.getPoint(D,w);p[2]=I.x,p[3]=I.y,g[2]=T.x,g[3]=T.y}i.push(p),i.push(g),e.set("point",{x:p[0]+(g[0]-p[0])/2,y:p[1]+(g[1]-p[1])/2})}this.get("noRisers")&&(t.points=[],t.segments.push(i))}}Object.defineProperty(Ie,"className",{enumerable:!0,configurable:!0,writable:!0,value:"StepLineSeries"});Object.defineProperty(Ie,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:Z.classNames.concat([Ie.className])});export{wt as Axis,de as AxisBullet,yt as AxisLabel,pe as AxisLabelRadial,It as AxisRenderer,Tt as AxisRendererX,Mt as AxisRendererY,Nt as AxisTick,Ot as BaseColumnSeries,$ as Candlestick,te as CandlestickSeries,Se as CategoryAxis,fe as CategoryDateAxis,Ve as ColumnSeries,ee as DateAxis,kt as DefaultTheme,be as DurationAxis,ve as EditableAxisLabel,_e as GaplessDateAxis,At as Grid,Z as LineSeries,ie as OHLC,xe as OHLCSeries,we as SmoothedXLineSeries,ye as SmoothedXYLineSeries,Pe as SmoothedYLineSeries,Ie as StepLineSeries,le as ValueAxis,$e as XYChart,me as XYChartScrollbar,Ft as XYCursor,Xt as XYSeries};
