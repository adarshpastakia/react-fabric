import{c as M,a as S}from"./devEnvironmentUtils.js";import{M as U,ay as y,b as p,cz as w,cA as F,cB as $,cC as v,cD as E,cE as x,cF as N,cG as D,cH as z,cI as B,cJ as C}from"./ShadowCastClear.glsl.js";import{e as G}from"./webStyleAcceptedFormats.js";import"./iframe-qDaPDssc.js";import"./index.js";import"./Viewport.js";import"./debounce.js";import"./index2.js";import"./Section.js";import"./ErrorBoundary.js";import"./createClass.js";import"./Global.js";import"./useIsDark.js";function et(e,t,l){const a=e.name;return a==null?Promise.reject(new p("symbolstyleutils:style-symbol-reference-name-missing","Missing name in style symbol reference")):e.styleName==="Esri2DPointSymbolsStyle"?R(a,t,l):z(e,t,l).then(o=>J(o,a,t,B,l))}function H(e,t){return t.items.find(l=>l.name===e)}async function J(e,t,l,a,o){var h,g;const n=(l==null?void 0:l.portal)!=null?l.portal:U.getDefault(),s={portal:n,url:y(e.baseUrl)},m=H(t,e.data);if(!m)throw new p("symbolstyleutils:symbol-name-not-found",`The symbol name '${t}' could not be found`,{symbolName:t});const u=(o==null?void 0:o.acceptedFormats)??G,b=a(m,u);if(!b)throw new p("symbolstyleutils:symbol-reference-no-accepted-format",`The symbol name '${t}' does not have an accepted format (one of ${u})`,{symbolName:t});const{url:I,format:O}=b;let i=w(I,s),c=((h=m.thumbnail)==null?void 0:h.href)??null;const f=(g=m.thumbnail)==null?void 0:g.imageData;M()&&(i=S(i)??"",c=S(c));const P={portal:n,url:y(F(i)),origin:"portal-item"};return $(i,o).then(d=>{const T=O==="cim"?v(d.data):d.data,r=E(T,P);if(r&&x(r)){if(c){const A=w(c,s);r.thumbnail=new N({url:A})}else f&&(r.thumbnail=new N({url:`data:image/png;base64,${f}`}));e.styleUrl?r.styleOrigin=new D({portal:l.portal,styleUrl:e.styleUrl,name:t}):e.styleName&&(r.styleOrigin=new D({portal:l.portal,styleName:e.styleName,name:t}))}return r})}function R(e,t,l){const a=C.replaceAll(/\{SymbolName\}/gi,e),o=t.portal!=null?t.portal:U.getDefault();return $(a,l).then(n=>{const s=v(n.data);return E(s,{portal:o,url:y(F(a)),origin:"portal-item"})})}export{J as fetchSymbolFromStyle,H as getStyleItemFromStyle,et as resolveWebStyleSymbol};
