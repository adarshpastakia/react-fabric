import{_ as B,r as u,w as U,bc as ce,j as o,m as E,Q as _,n as G,bd as Y,F as ue,l as V,be as de,x as me,I as fe,B as pe,z as ve,y as be,J as ge,L as xe,K as he,bf as je,N as ye,bg as Oe,bh as Ie,O as ke,bi as Pe,bj as we,U as Ce,W as Ne,X as Re}from"./iframe-DpfJK_wQ.js";import{H as Fe}from"./index.js";import{c as $e}from"./cloneElement.js";import{n as Ee}from"./nodeCheck.js";import{g as Se,b as Me,a as Te,H as De}from"./Button.js";import{I as q,T as Ke,a as Le}from"./Tooltip.js";var He=["as","label","color","className","icon","appendLabel","altIcon","id","active","disabled","onClick","badge","hotKey","tabIndex","minimal","data-open","ref"],We=["children"];function J(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(h){return Object.getOwnPropertyDescriptor(s,h).enumerable})),n.push.apply(n,t)}return n}function x(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?J(Object(n),!0).forEach(function(t){G(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):J(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var Q=function(e){var n=e.as,t=e.label,h=e.color,S=h===void 0?"primary":h,L=e.className,j=e.icon,k=e.appendLabel,y=e.altIcon,M=e.id,O=e.active,T=e.disabled,P=e.onClick,m=e.badge,g=e.hotKey,D=e.tabIndex,w=D===void 0?-1:D,i=e.minimal,C=e["data-open"],N=e.ref,R=B(e,He),c=u.useRef(null),v=U(),b=u.useMemo(function(){return Se(m)},[m]);u.useEffect(function(){var l;w===0&&((l=c.current)===null||l===void 0||l.focus())},[w]);var a=u.useMemo(function(){var l,d=j;return i&&!d&&(d=ce(t)),o.jsx(q,x({className:E("fabric-menuIcon",i&&"minimal")},Le((l=d)!==null&&l!==void 0?l:"")))},[j,i,t]),$=u.useCallback(function(l){var d=l.children,I=B(l,We);return i?o.jsx(Ke,x(x({content:t,placement:"right",disabled:C},I),{},{children:d})):o.jsx(u.Fragment,{children:d})},[i,t,C]),H=u.useMemo(function(){return o.jsxs("div",{className:"flex flex-nowrap text-start items-center",children:[a,!i&&o.jsx("label",{className:"flex-1 pe-4 py-[0.375em] truncate",children:t}),k&&o.jsx("span",{className:E("font-bold whitespace-nowrap text-center leading-none mx-1",i&&"absolute inset-x-0 bottom-0 overflow-clip",i?"text-[0.5rem]":"text-[0.625rem]",O?"text-white/50":"text-tint-600/50"),children:k}),m&&o.jsx(Me,x(x({},b),{},{placement:i?"end":"",className:E("me-1",b.className)})),g&&o.jsx(Te,{keyCombo:g}),!i&&y&&o.jsx(q,{className:"text-muted px-1",icon:y,rtlFlip:!0})]})},[a,i,k,t,m,b,g,O]),F=n??"button";return o.jsx($,x(x({},R),{},{children:o.jsxs(F,x(x({ref:_(N,c),"data-dropdown-dismiss":!0,"data-color":S,className:E("fabric-menuItem cursor-pointer",L,O&&"active",i&&"minimal",T&&"disabled","rounded relative max-w-[50vw] my-0.5"),"data-active":O,"data-open":C,disabled:T,"data-id":M,tabIndex:w,onClick:function(d){(P==null?void 0:P(d))!==!1&&(v==null||v.events.emit("click"))}},i?{}:R),{},{children:[g&&o.jsx(De,{keyCombo:g,handler:function(){var d,I;return(d=c.current)===null||d===void 0||(I=d.click)===null||I===void 0?void 0:I.call(d)}}),H]}))}))},Ae=["children","minimal","menuClassName","onClick","trigger","ref"];function X(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(h){return Object.getOwnPropertyDescriptor(s,h).enumerable})),n.push.apply(n,t)}return n}function p(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?X(Object(n),!0).forEach(function(t){G(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var z=function s(e){var n,t,h=e.children,S=e.minimal,L=e.menuClassName,j=e.onClick,k=e.trigger,y=k===void 0?"hover":k,M=e.ref,O=B(e,Ae),T=u.useState(!1),P=V(T,2),m=P[0],g=P[1],D=u.useState(null),w=V(D,2),i=w[0],C=w[1],N=u.useRef([]),R=u.useRef([]),c=U(),v=de(),b=Y(),a=b!==null,$=me({nodeId:v,open:!a||m,onOpenChange:function(f,K,A){a&&g(f),A==="outside-press"&&y==="click"&&(c==null||c.events.emit("close"))},placement:a?"right-start":"bottom-start",middleware:[pe({mainAxis:a?0:4,alignmentAxis:a?-4:0}),ve(),be()],whileElementsMounted:fe}),H=$.floatingStyles,F=$.refs,l=$.context,d=ge(l,{enabled:y==="hover",delay:{open:75},handleClose:xe({blockPointerEvents:!0})}),I=he(l,{event:"mousedown",toggle:y==="click"||!a,ignoreMouse:y==="hover"&&!a}),Z=je(l,{role:"menu"}),ee=ye(l,{bubbles:!0}),te=Oe(l,{listRef:N,activeIndex:i,nested:a,onNavigate:C}),ne=Ie(l,{listRef:R,onMatch:m?C:void 0,activeIndex:i}),W=ke([I,d,Z,ee,te,ne]),ae=W.getReferenceProps,re=W.getFloatingProps,oe=W.getItemProps;u.useEffect(function(){if(!c||!b)return;function r(){g(!1)}function f(K){K.nodeId!==v&&K.parentId===b&&g(!1)}return c.events.on("click",r),c.events.on("close",r),c.events.on("menuopen",f),function(){c.events.off("click",r),c.events.off("close",r),c.events.off("menuopen",f)}},[c,v,b]),u.useEffect(function(){m&&c&&c.events.emit("menuopen",{parentId:b,nodeId:v})},[c,m,v,b]);var se=u.useCallback(function(r){var f=r.target;f.dataset.id&&(j==null||j(f.dataset.id))},[j]),ie=a?Ce:u.Fragment,le=a?{root:(n=(t=F.domReference.current)===null||t===void 0?void 0:t.closest(".theme-base"))!==null&&n!==void 0?n:void 0}:{};return u.useEffect(function(){setTimeout(function(){var r;return(r=F.floating.current)===null||r===void 0||(r=r.querySelector('[data-active="true"]'))===null||r===void 0?void 0:r.scrollIntoView({block:"nearest"})},100)},[m]),u.useEffect(function(){(!a||m)&&i&&setTimeout(function(){var r;(r=N.current[i])===null||r===void 0||r.scrollIntoView({block:"nearest"})},100)},[m,i]),o.jsxs(Pe,{id:v,children:[a&&o.jsx(Q,p(p({},ae(p(p({},O),{},{id:void 0,"data-dropdown-dismiss":!1,onClick:function(f){return f.stopPropagation(),!1}}))),{},{"data-open":m,minimal:S,altIcon:"icon-[mdi--menu-right]",ref:_(F.setReference,M)})),o.jsx(we,{elementsRef:N,labelsRef:R,children:(!a||m)&&o.jsxs(ie,p(p({},le),{},{children:[a&&o.jsx(Ne,{}),o.jsx(Fe,{children:o.jsx(Re,{context:l,modal:!a,initialFocus:a?-1:0,returnFocus:!a,children:o.jsx("div",p(p({className:E(L,"flex flex-col bg-base p-1 menu-list",a&&"outline shadow-lg rounded-capped max-h-96 overflow-auto scroll-thin z-(--z-popover)"),autoFocus:!0,ref:_(a?F.setFloating:M)},re({onClick:a?void 0:se})),{},{style:a?H:O.style,children:$e(h,function(r,f){return R.current[f]=r.props.label,u.cloneElement(r,Ee(r,Q,ze,s)?p({minimal:!a&&S,"data-focus":i===f,ref:function(A){return N.current[f]=A}},oe({onClick:r.props.onClick,tabIndex:i===f?0:-1})):{})})}))})})]}))})]})},ze=function(e){var n=Y(),t=U();return t?o.jsx(z,p(p({},e),{},{className:"",menuClassName:e.className})):n===null?o.jsx(ue,{children:o.jsx(z,p(p({},e),{},{className:"",menuClassName:e.className}))}):o.jsx(z,p({},e))};export{ze as M,Q as a};
