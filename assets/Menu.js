import{_ as X,C as ce,H as ue}from"./index.js";import{_ as z,r as u,v as U,be as de,j as o,m as E,O as B,bf as Y,F as me,l as V,bg as fe,w as pe,G as ve,z as be,y as ge,x as he,I as xe,K as je,J as ye,bh as Oe,L as Ie,bi as ke,bj as Ce,N as Pe,bk as we,bl as Ne,Q as Re,U as Fe,W as $e}from"./iframe-DwvN93Ge.js";import{c as Ee}from"./cloneElement.js";import{n as Se}from"./nodeCheck.js";import{g as Me,b as Te,a as De,H as Ke}from"./Button.js";import{I as q,T as Le,a as He}from"./Tooltip.js";var We=["as","label","color","className","icon","appendLabel","altIcon","id","active","disabled","onClick","badge","hotKey","tabIndex","minimal","data-open","ref"],Ae=["children"];function G(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(x){return Object.getOwnPropertyDescriptor(s,x).enumerable})),n.push.apply(n,t)}return n}function h(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?G(Object(n),!0).forEach(function(t){X(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):G(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var J=function(e){var n=e.as,t=e.label,x=e.color,S=x===void 0?"primary":x,L=e.className,j=e.icon,k=e.appendLabel,y=e.altIcon,M=e.id,O=e.active,T=e.disabled,C=e.onClick,m=e.badge,g=e.hotKey,D=e.tabIndex,P=D===void 0?-1:D,i=e.minimal,w=e["data-open"],N=e.ref,R=z(e,We),c=u.useRef(null),v=U(),b=u.useMemo(function(){return Me(m)},[m]);u.useEffect(function(){var l;P===0&&((l=c.current)===null||l===void 0||l.focus())},[P]);var a=u.useMemo(function(){var l,d=j;return i&&!d&&(d=de(t)),o.jsx(q,h({className:E("fabric-menuIcon",i&&"minimal")},He((l=d)!==null&&l!==void 0?l:"")))},[j,i,t]),$=u.useCallback(function(l){var d=l.children,I=z(l,Ae);return i?o.jsx(Le,h(h({content:t,placement:"right",disabled:w},I),{},{children:d})):o.jsx(u.Fragment,{children:d})},[i,t,w]),H=u.useMemo(function(){return o.jsxs("div",{className:"flex flex-nowrap text-start items-center",children:[a,!i&&o.jsx("label",{className:"flex-1 pe-4 py-[0.375em] truncate",children:t}),k&&o.jsx("span",{className:E("font-bold whitespace-nowrap text-center leading-none mx-1",i&&"absolute inset-x-0 bottom-0 overflow-clip",i?"text-[0.5rem]":"text-[0.625rem]",O?"text-white/50":"text-tint-600/50"),children:k}),m&&o.jsx(Te,h(h({},b),{},{placement:i?"end":"",className:E("me-1",b.className)})),g&&o.jsx(De,{keyCombo:g}),!i&&y&&o.jsx(q,{className:"text-muted px-1",icon:y,rtlFlip:!0})]})},[a,i,k,t,m,b,g,O]),F=n??"button";return o.jsx($,h(h({},R),{},{children:o.jsxs(F,h(h({ref:B(N,c),"data-dropdown-dismiss":!0,"data-color":S,className:E("fabric-menuItem cursor-pointer",L,O&&"active",i&&"minimal",T&&"disabled","rounded relative max-w-[50vw] my-0.5"),"data-active":O,"data-open":w,disabled:T,"data-id":M,tabIndex:P,onClick:function(d){(C==null?void 0:C(d))!==!1&&(v==null||v.events.emit("click"))}},i?{}:R),{},{children:[g&&o.jsx(Ke,{keyCombo:g,handler:function(){var d,I;return(d=c.current)===null||d===void 0||(I=d.click)===null||I===void 0?void 0:I.call(d)}}),H]}))}))},_e=["children","minimal","menuClassName","onClick","trigger","ref"];function Q(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(x){return Object.getOwnPropertyDescriptor(s,x).enumerable})),n.push.apply(n,t)}return n}function p(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Q(Object(n),!0).forEach(function(t){X(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Q(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var _=function s(e){var n,t,x=e.children,S=e.minimal,L=e.menuClassName,j=e.onClick,k=e.trigger,y=k===void 0?"hover":k,M=e.ref,O=z(e,_e),T=u.useState(!1),C=V(T,2),m=C[0],g=C[1],D=u.useState(null),P=V(D,2),i=P[0],w=P[1],N=u.useRef([]),R=u.useRef([]),c=U(),v=fe(),b=Y(),a=b!==null,$=pe({nodeId:v,open:!a||m,onOpenChange:function(f,K,A){a&&g(f),A==="outside-press"&&y==="click"&&(c==null||c.events.emit("close"))},placement:a?"right-start":"bottom-start",middleware:[be({mainAxis:a?0:4,alignmentAxis:a?-4:0}),ge(),he()],whileElementsMounted:ve}),H=$.floatingStyles,F=$.refs,l=$.context,d=xe(l,{enabled:y==="hover",delay:{open:75},handleClose:je({blockPointerEvents:!0})}),I=ye(l,{event:"mousedown",toggle:y==="click"||!a,ignoreMouse:y==="hover"&&!a}),Z=Oe(l,{role:"menu"}),ee=Ie(l,{bubbles:!0}),te=ke(l,{listRef:N,activeIndex:i,nested:a,onNavigate:w}),ne=Ce(l,{listRef:R,onMatch:m?w:void 0,activeIndex:i}),W=Pe([I,d,Z,ee,te,ne]),ae=W.getReferenceProps,re=W.getFloatingProps,oe=W.getItemProps;u.useEffect(function(){if(!c||!b)return;function r(){g(!1)}function f(K){K.nodeId!==v&&K.parentId===b&&g(!1)}return c.events.on("click",r),c.events.on("close",r),c.events.on("menuopen",f),function(){c.events.off("click",r),c.events.off("close",r),c.events.off("menuopen",f)}},[c,v,b]),u.useEffect(function(){m&&c&&c.events.emit("menuopen",{parentId:b,nodeId:v})},[c,m,v,b]);var se=u.useCallback(function(r){var f=r.target;f.dataset.id&&(j==null||j(f.dataset.id))},[j]),ie=a?Re:u.Fragment,le=a?{root:(n=(t=F.domReference.current)===null||t===void 0?void 0:t.closest(".theme-base"))!==null&&n!==void 0?n:void 0}:{};return u.useEffect(function(){setTimeout(function(){var r;return(r=F.floating.current)===null||r===void 0||(r=r.querySelector('[data-active="true"]'))===null||r===void 0?void 0:r.scrollIntoView({block:"nearest"})},100)},[m]),u.useEffect(function(){(!a||m)&&i&&setTimeout(function(){var r;(r=N.current[i])===null||r===void 0||r.scrollIntoView({block:"nearest"})},100)},[m,i]),o.jsxs(we,{id:v,children:[a&&o.jsx(J,p(p({},ae(p(p({},O),{},{id:void 0,"data-dropdown-dismiss":!1,onClick:function(f){return f.stopPropagation(),!1}}))),{},{"data-open":m,minimal:S,altIcon:ce.chevronRight,ref:B(F.setReference,M)})),o.jsx(Ne,{elementsRef:N,labelsRef:R,children:(!a||m)&&o.jsxs(ie,p(p({},le),{},{children:[a&&o.jsx(Fe,{}),o.jsx(ue,{children:o.jsx($e,{context:l,modal:!a,initialFocus:a?-1:0,returnFocus:!a,children:o.jsx("div",p(p({className:E(L,"flex flex-col bg-base p-1 menu-list",a&&"outline shadow-lg rounded-capped max-h-96 overflow-auto scroll-thin z-(--z-popover)"),autoFocus:!0,ref:B(a?F.setFloating:M)},re({onClick:a?void 0:se})),{},{style:a?H:O.style,children:Ee(x,function(r,f){return R.current[f]=r.props.label,u.cloneElement(r,Se(r,J,ze,s)?p({minimal:!a&&S,"data-focus":i===f,ref:function(A){return N.current[f]=A}},oe({onClick:r.props.onClick,tabIndex:i===f?0:-1})):{})})}))})})]}))})]})},ze=function(e){var n=Y(),t=U();return t?o.jsx(_,p(p({},e),{},{className:"",menuClassName:e.className})):n===null?o.jsx(me,{children:o.jsx(_,p(p({},e),{},{className:"",menuClassName:e.className}))}):o.jsx(_,p({},e))};export{ze as M,J as a};
