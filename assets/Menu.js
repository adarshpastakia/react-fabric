import{_ as ee,C as ce,H as ue}from"./index2.js";import{_ as V,r as l,v as J,bo as de,j as o,m as T,O as G,bp as te,F as me,l as Q,bq as fe,w as pe,G as ve,z as be,y as ge,x as xe,I as he,K as je,J as ye,br as Oe,L as Ie,bs as Ce,bt as ke,N as we,bu as Pe,bv as Ne,Q as Fe,U as Re,W as $e}from"./iframe-Ctw5u0Cj.js";import{c as Ee}from"./cloneElement.js";import{n as Se}from"./nodeCheck.js";import{g as Me,b as Te,a as De,H as Ke}from"./Button.js";import{I as _,T as Le}from"./Tooltip.js";var He=["as","label","color","className","icon","iconBg","iconColor","appendLabel","rtlFlip","altIcon","id","active","disabled","onClick","badge","hotKey","tabIndex","minimal","data-open","ref"],Be=["children"];function X(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(x){return Object.getOwnPropertyDescriptor(s,x).enumerable})),n.push.apply(n,t)}return n}function y(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?X(Object(n),!0).forEach(function(t){ee(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):X(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var Y=function(e){var n=e.as,t=e.label,x=e.color,D=x===void 0?"primary":x,B=e.className,O=e.icon,R=e.iconBg,I=e.iconColor,N=e.appendLabel,$=e.rtlFlip,K=e.altIcon,L=e.id,d=e.active,F=e.disabled,E=e.onClick,C=e.badge,v=e.hotKey,S=e.tabIndex,h=S===void 0?-1:S,c=e.minimal,i=e["data-open"],j=e.ref,b=V(e,He),a=l.useRef(null),k=J(),M=l.useMemo(function(){return Me(C)},[C]);l.useEffect(function(){var m;h===0&&((m=a.current)===null||m===void 0||m.focus())},[h]);var w=l.useMemo(function(){var m,u=O;return c&&!u&&(u=de(t)),o.jsx(_,{className:T("fabric-menuIcon",c&&"minimal"),icon:(m=u)!==null&&m!==void 0?m:"",bg:R,color:I,rtlFlip:$})},[O,R,I,$,c,t]),g=l.useCallback(function(m){var u=m.children,P=V(m,Be);return c?o.jsx(Le,y(y({content:t,placement:"right",disabled:i},P),{},{children:u})):o.jsx(l.Fragment,{children:u})},[c,t,i]),W=l.useMemo(function(){return o.jsxs("div",{className:"flex flex-nowrap text-start items-center",children:[w,!c&&o.jsx("label",{className:"flex-1 pe-4 py-[0.375em] truncate",children:t}),N&&o.jsx("span",{className:T("font-bold whitespace-nowrap text-center leading-none mx-1",c&&"absolute inset-x-0 bottom-0 overflow-clip",c?"text-[0.5rem]":"text-[0.625rem]",d?"text-white/50":"text-tint-600/50"),children:N}),C&&o.jsx(Te,y(y({},M),{},{placement:c?"end":"",className:T("me-1",M.className)})),v&&o.jsx(De,{keyCombo:v}),!c&&K&&o.jsx(_,{className:"text-muted px-1",icon:K,rtlFlip:!0})]})},[w,c,N,t,C,M,v,d]),A=n??"button";return o.jsx(g,y(y({},b),{},{children:o.jsxs(A,y(y({ref:G(j,a),"data-dropdown-dismiss":!0,"data-color":D,className:T("fabric-menuItem cursor-pointer",B,d&&"active",c&&"minimal",F&&"disabled","rounded relative max-w-[50vw] my-0.5"),"data-active":d,"data-open":i,disabled:F,"data-id":L,tabIndex:h,onClick:function(u){(E==null?void 0:E(u))!==!1&&(k==null||k.events.emit("click"))}},c?{}:b),{},{children:[v&&o.jsx(Ke,{keyCombo:v,handler:function(){var u,P;return(u=a.current)===null||u===void 0||(P=u.click)===null||P===void 0?void 0:P.call(u)}}),W]}))}))},We=["children","minimal","menuClassName","onClick","trigger","ref"];function Z(s,e){var n=Object.keys(s);if(Object.getOwnPropertySymbols){var t=Object.getOwnPropertySymbols(s);e&&(t=t.filter(function(x){return Object.getOwnPropertyDescriptor(s,x).enumerable})),n.push.apply(n,t)}return n}function p(s){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Z(Object(n),!0).forEach(function(t){ee(s,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(s,Object.getOwnPropertyDescriptors(n)):Z(Object(n)).forEach(function(t){Object.defineProperty(s,t,Object.getOwnPropertyDescriptor(n,t))})}return s}var U=function s(e){var n,t,x=e.children,D=e.minimal,B=e.menuClassName,O=e.onClick,R=e.trigger,I=R===void 0?"hover":R,N=e.ref,$=V(e,We),K=l.useState(!1),L=Q(K,2),d=L[0],F=L[1],E=l.useState(null),C=Q(E,2),v=C[0],S=C[1],h=l.useRef([]),c=l.useRef([]),i=J(),j=fe(),b=te(),a=b!==null,k=pe({nodeId:j,open:!a||d,onOpenChange:function(f,H,q){a&&F(f),q==="outside-press"&&I==="click"&&(i==null||i.events.emit("close"))},placement:a?"right-start":"bottom-start",middleware:[be({mainAxis:a?0:4,alignmentAxis:a?-4:0}),ge(),xe()],whileElementsMounted:ve}),M=k.floatingStyles,w=k.refs,g=k.context,W=he(g,{enabled:I==="hover",delay:{open:75},handleClose:je({blockPointerEvents:!0})}),A=ye(g,{event:"mousedown",toggle:I==="click"||!a,ignoreMouse:I==="hover"&&!a}),m=Oe(g,{role:"menu"}),u=Ie(g,{bubbles:!0}),P=Ce(g,{listRef:h,activeIndex:v,nested:a,onNavigate:S}),ne=ke(g,{listRef:c,onMatch:d?S:void 0,activeIndex:v}),z=we([A,W,m,u,P,ne]),ae=z.getReferenceProps,re=z.getFloatingProps,oe=z.getItemProps;l.useEffect(function(){if(!i||!b)return;function r(){F(!1)}function f(H){H.nodeId!==j&&H.parentId===b&&F(!1)}return i.events.on("click",r),i.events.on("close",r),i.events.on("menuopen",f),function(){i.events.off("click",r),i.events.off("close",r),i.events.off("menuopen",f)}},[i,j,b]),l.useEffect(function(){d&&i&&i.events.emit("menuopen",{parentId:b,nodeId:j})},[i,d,j,b]);var se=l.useCallback(function(r){var f=r.target;f.dataset.id&&(O==null||O(f.dataset.id))},[O]),ie=a?Fe:l.Fragment,le=a?{root:(n=(t=w.domReference.current)===null||t===void 0?void 0:t.closest(".theme-base"))!==null&&n!==void 0?n:void 0}:{};return l.useEffect(function(){setTimeout(function(){var r;return(r=w.floating.current)===null||r===void 0||(r=r.querySelector('[data-active="true"]'))===null||r===void 0?void 0:r.scrollIntoView({block:"nearest"})},100)},[d]),l.useEffect(function(){(!a||d)&&v&&setTimeout(function(){var r;(r=h.current[v])===null||r===void 0||r.scrollIntoView({block:"nearest"})},100)},[d,v]),o.jsxs(Pe,{id:j,children:[a&&o.jsx(Y,p(p({},ae(p(p({},$),{},{id:void 0,"data-dropdown-dismiss":!1,onClick:function(f){return f.stopPropagation(),!1}}))),{},{"data-open":d,minimal:D,altIcon:ce.chevronRight,ref:G(w.setReference,N)})),o.jsx(Ne,{elementsRef:h,labelsRef:c,children:(!a||d)&&o.jsxs(ie,p(p({},le),{},{children:[a&&o.jsx(Re,{}),o.jsx(ue,{children:o.jsx($e,{context:g,modal:!a,initialFocus:a?-1:0,returnFocus:!a,children:o.jsx("div",p(p({className:T(B,"flex flex-col bg-base p-1 menu-list",a&&"outline shadow-lg rounded-capped max-h-96 overflow-auto scroll-thin z-(--z-popover)"),autoFocus:!0,ref:G(a?w.setFloating:N)},re({onClick:a?void 0:se})),{},{style:a?M:$.style,children:Ee(x,function(r,f){return c.current[f]=r.props.label,l.cloneElement(r,Se(r,Y,Ae,s)?p({minimal:!a&&D,"data-focus":v===f,ref:function(q){return h.current[f]=q}},oe({onClick:r.props.onClick,tabIndex:v===f?0:-1})):{})})}))})})]}))})]})},Ae=function(e){var n=te(),t=J();return t?o.jsx(U,p(p({},e),{},{className:"",menuClassName:e.className})):n===null?o.jsx(me,{children:o.jsx(U,p(p({},e),{},{className:"",menuClassName:e.className}))}):o.jsx(U,p({},e))};export{Ae as M,Y as a};
