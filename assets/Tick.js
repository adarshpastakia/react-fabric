import{_ as $,l as ae,C as Z,I as le}from"./Animation.js";import{k as X,S as ne,C as x,L as z,G as J,l as oe}from"./Label.js";import{e as w,k as ue,y as he,i as O,s as K}from"./Disposer.js";import{a as M,P as fe}from"./Percent.js";class ce extends X{constructor(){super(...arguments),Object.defineProperty(this,"processor",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}incrementRef(){}decrementRef(){}_onPush(e){this.processor&&this.processor.processRow(e),super._onPush(e)}_onInsertIndex(e,t){this.processor&&this.processor.processRow(t),super._onInsertIndex(e,t)}_onSetIndex(e,t,s){this.processor&&this.processor.processRow(s),super._onSetIndex(e,t,s)}}class xe{constructor(e){Object.defineProperty(this,"processor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this._value=e}incrementRef(){}decrementRef(){}}class k extends ne{constructor(e,t,s){super(s),Object.defineProperty(this,"component",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dataContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"open",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"close",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.dataContext=t,this.component=e,this._settings.visible=!0,this._checkDirty()}markDirty(){this.component.markDirtyValues(this)}_startAnimation(){this.component._root._addAnimation(this)}_animationTime(){return this.component._root.animationTime}_dispose(){this.component&&this.component.disposeDataItem(this),super._dispose()}show(e){this.setRaw("visible",!0),this.component&&this.component.showDataItem(this,e)}hide(e){this.setRaw("visible",!1),this.component&&this.component.hideDataItem(this,e)}isHidden(){return!this.get("visible")}}class F extends x{constructor(){super(...arguments),Object.defineProperty(this,"_data",{enumerable:!0,configurable:!0,writable:!0,value:new ce}),Object.defineProperty(this,"_dataItems",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"_mainDataItems",{enumerable:!0,configurable:!0,writable:!0,value:this._dataItems}),Object.defineProperty(this,"valueFields",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"fields",{enumerable:!0,configurable:!0,writable:!0,value:["id"]}),Object.defineProperty(this,"_valueFields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valueFieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fields",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_fieldsF",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_valuesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataChanged",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataGrouped",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"inited",{enumerable:!0,configurable:!0,writable:!0,value:!1})}set data(e){e.incrementRef(),this._data.decrementRef(),this._data=e}get data(){return this._data}_dispose(){super._dispose(),this._data.decrementRef()}_onDataClear(){}_afterNew(){super._afterNew(),this._data.incrementRef(),this._updateFields(),this._disposers.push(this.data.events.onAll(e=>{const t=this._mainDataItems;if(this.markDirtyValues(),this._markDirtyGroup(),this._dataChanged=!0,e.type==="clear")w(t,s=>{s.dispose()}),t.length=0,this._onDataClear();else if(e.type==="push"){const s=new k(this,e.newValue,this._makeDataItem(e.newValue));t.push(s),this.processDataItem(s)}else if(e.type==="setIndex"){const s=t[e.index],a=this._makeDataItem(e.newValue);s.bullets&&s.bullets.length==0&&(s.bullets=void 0),ue(a).forEach(r=>{s.animate({key:r,to:a[r],duration:this.get("interpolationDuration",0),easing:this.get("interpolationEasing")})}),s.dataContext=e.newValue}else if(e.type==="insertIndex"){const s=new k(this,e.newValue,this._makeDataItem(e.newValue));t.splice(e.index,0,s),this.processDataItem(s)}else if(e.type==="removeIndex")t[e.index].dispose(),t.splice(e.index,1);else if(e.type==="moveIndex"){const s=t[e.oldIndex];t.splice(e.oldIndex,1),t.splice(e.newIndex,0,s)}else throw new Error("Unknown IStreamEvent type");this._afterDataChange()}))}_updateFields(){this.valueFields&&(this._valueFields=[],this._valueFieldsF={},w(this.valueFields,e=>{this.get(e+"Field")&&(this._valueFields.push(e),this._valueFieldsF[e]={fieldKey:e+"Field",workingKey:e+"Working"})})),this.fields&&(this._fields=[],this._fieldsF={},w(this.fields,e=>{this.get(e+"Field")&&(this._fields.push(e),this._fieldsF[e]=e+"Field")}))}get dataItems(){return this._dataItems}processDataItem(e){}_makeDataItem(e){const t={};return this._valueFields&&w(this._valueFields,s=>{const a=this.get(this._valueFieldsF[s].fieldKey);t[s]=e[a],t[this._valueFieldsF[s].workingKey]=t[s]}),this._fields&&w(this._fields,s=>{const a=this.get(this._fieldsF[s]);t[s]=e[a]}),t}makeDataItem(e,t){let s=new k(this,t,e);return this.processDataItem(s),s}pushDataItem(e,t){const s=this.makeDataItem(e,t);return this._mainDataItems.push(s),s}disposeDataItem(e){}showDataItem(e,t){return $(this,void 0,void 0,function*(){e.set("visible",!0)})}hideDataItem(e,t){return $(this,void 0,void 0,function*(){e.set("visible",!1)})}_clearDirty(){super._clearDirty(),this._valuesDirty=!1}_afterDataChange(){}_afterChanged(){if(super._afterChanged(),this._dataChanged){const e="datavalidated";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this}),this._dataChanged=!1}if(this._valuesDirty){const e="valueschanged";this.events.isEnabled(e)&&this.events.dispatch(e,{type:e,target:this})}this.inited=!0}markDirtyValues(e){this.markDirty(),this._valuesDirty=!0}_markDirtyGroup(){this._dataGrouped=!1}markDirtySize(){this._sizeDirty=!0,this.markDirty()}getDataItemById(e){return he(this.dataItems,t=>t.get("id")==e)}}Object.defineProperty(F,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Component"});Object.defineProperty(F,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:x.classNames.concat([F.className])});function Q(i){return new Promise((e,t)=>{setTimeout(e,i)})}let L={millisecond:1,second:1e3,minute:6e4,hour:36e5,day:864e5,week:6048e5,month:365.242/12*864e5,year:31536e6};function W(i){switch(i){case"year":return;case"month":return"year";case"week":return"month";case"day":return"month";case"hour":return"day";case"minute":return"hour";case"second":return"minute";case"millisecond":return"second"}}function D(i,e){return e==null&&(e=1),L[i]*e}function ee(i){return i?L[i.timeUnit]*i.count:0}function de(i,e,t,s,a){const r=i.timeUnit,n=i.count;if(r=="hour"||r=="minute"||r=="second"||r=="millisecond")return L[i.timeUnit]*i.count;{const o=S(new Date(e.getTime()),r,n,t,s,void 0,a).getTime();let h=o+n*D(r)*1.05;return h=S(new Date(h),r,1,t,s,void 0,a).getTime(),h-o}}function te(){return new Date}function me(){return te().getTime()}function pe(i){return new Date(i.getTime())}function se(i,e,t,s,a){if(e-i>D(t,1.2))return!0;let r=new Date(i),n=new Date(e);a&&(r=a.convertLocal(r),n=a.convertLocal(n));let o=0,h=0;!s&&t!="millisecond"&&(o=r.getTimezoneOffset(),r.setUTCMinutes(r.getUTCMinutes()-o),h=n.getTimezoneOffset(),n.setUTCMinutes(n.getUTCMinutes()-h));let u=!1;switch(t){case"year":r.getUTCFullYear()!=n.getUTCFullYear()&&(u=!0);break;case"month":(r.getUTCFullYear()!=n.getUTCFullYear()||r.getUTCMonth()!=n.getUTCMonth())&&(u=!0);break;case"day":(r.getUTCMonth()!=n.getUTCMonth()||r.getUTCDate()!=n.getUTCDate())&&(u=!0);break;case"hour":r.getUTCHours()!=n.getUTCHours()&&(u=!0);break;case"minute":r.getUTCMinutes()!=n.getUTCMinutes()&&(u=!0);break;case"second":r.getUTCSeconds()!=n.getUTCSeconds()&&(u=!0);break;case"millisecond":r.getTime()!=n.getTime()&&(u=!0);break}if(u)return u;let f=W(t);return f?se(i,e,f,s,a):!1}function be(i,e,t,s,a){let r=0;switch(!s&&e!="millisecond"&&(r=i.getTimezoneOffset(),a&&(r-=a.offsetUTC(i)),i.setUTCMinutes(i.getUTCMinutes()-r)),e){case"day":let n=i.getUTCDate();i.setUTCDate(n+t);break;case"second":let o=i.getUTCSeconds();i.setUTCSeconds(o+t);break;case"millisecond":let h=i.getUTCMilliseconds();i.setUTCMilliseconds(h+t);break;case"hour":let u=i.getUTCHours();i.setUTCHours(u+t);break;case"minute":let f=i.getUTCMinutes();i.setUTCMinutes(f+t);break;case"year":let p=i.getUTCFullYear();i.setUTCFullYear(p+t);break;case"month":const c=i.getUTCDate(),g=new Date(i.getUTCFullYear(),i.getUTCMonth(),0).getUTCDate();let l=i.getUTCMonth();c>g?i.setUTCMonth(l+t,g):i.setUTCMonth(l+t);break;case"week":let b=i.getUTCDate();i.setUTCDate(b+t*7);break}if(!s&&e!="millisecond"&&(i.setUTCMinutes(i.getUTCMinutes()+r),e=="day"||e=="week"||e=="month"||e=="year")){let n=i.getTimezoneOffset();if(a&&(n+=a.offsetUTC(i)),n!=r){let o=n-r;i.setUTCMinutes(i.getUTCMinutes()+o),i.getTimezoneOffset()!=n&&i.setUTCMinutes(i.getUTCMinutes()-o)}}return i}function ge(i,e,t,s,a){let r;return a!=null&&(r=new Date(a)),S(new Date(i),e,t,s.locale.firstDayOfWeek,s.utc,r,s.timezone).getTime()}function S(i,e,t,s,a,r,n){if(!n||a){let o=0;switch(!a&&e!="millisecond"&&(o=i.getTimezoneOffset(),i.setUTCMinutes(i.getUTCMinutes()-o)),e){case"day":let h=i.getUTCDate();if(t>1){if(r){r=S(r,"day",1);let _=i.getTime()-r.getTime(),I=Math.floor(_/D("day")/t),v=D("day",I*t);i.setTime(r.getTime()+v-o*D("minute"))}}else i.setUTCDate(h);i.setUTCHours(0,0,0,0);break;case"second":let u=i.getUTCSeconds();t>1&&(u=Math.floor(u/t)*t),i.setUTCSeconds(u,0);break;case"millisecond":if(t==1)return i;let f=i.getUTCMilliseconds();f=Math.floor(f/t)*t,i.setUTCMilliseconds(f);break;case"hour":let p=i.getUTCHours();t>1&&(p=Math.floor(p/t)*t),i.setUTCHours(p,0,0,0);break;case"minute":let c=i.getUTCMinutes();t>1&&(c=Math.floor(c/t)*t),i.setUTCMinutes(c,0,0);break;case"month":let g=i.getUTCMonth();t>1&&(t==2||t==3||t==4||t==6)&&(g=Math.floor(g/t)*t),i.setUTCMonth(g,1),i.setUTCHours(0,0,0,0);break;case"year":let l=i.getUTCFullYear();t>1&&(l=Math.floor(l/t)*t),i.setUTCFullYear(l,0,1),i.setUTCHours(0,0,0,0);break;case"week":if(t>1&&r){r=S(r,"week",1);let _=i.getTime()-r.getTime(),I=Math.floor(_/D("week")/t),v=D("week",I*t);i.setTime(r.getTime()+v-o*D("minute"))}let b=i.getUTCDate(),C=i.getUTCDay();O(s)||(s=1),C>=s?b=b-C+s:b=b-(7+C)+s,i.setUTCDate(b),i.setUTCHours(0,0,0,0);break}if(!a&&e!="millisecond"&&(i.setUTCMinutes(i.getUTCMinutes()+o),e=="day"||e=="week"||e=="month"||e=="year")){let h=i.getTimezoneOffset();if(h!=o){let u=h-o;i.setUTCMinutes(i.getUTCMinutes()+u)}}return i}else{if(isNaN(i.getTime()))return i;let o=i.getTime(),h=n.offsetUTC(i),u=i.getTimezoneOffset(),f=n.parseDate(i),p=f.year,c=f.month,g=f.day,l=f.hour,b=f.minute,C=f.second,_=f.millisecond,I=f.weekday,v=h-u;switch(e){case"day":if(t>1&&r){r=S(r,"day",1,s,a,void 0,n);let y=i.getTime()-r.getTime(),T=Math.floor(y/D("day")/t),d=D("day",T*t);i.setTime(r.getTime()+d),f=n.parseDate(i),p=f.year,c=f.month,g=f.day}l=0,b=v,C=0,_=0;break;case"second":b+=v,t>1&&(C=Math.floor(C/t)*t),_=0;break;case"millisecond":b+=v,t>1&&(_=Math.floor(_/t)*t);break;case"hour":t>1&&(l=Math.floor(l/t)*t),b=v,C=0,_=0;break;case"minute":t>1&&(b=Math.floor(b/t)*t),b+=v,C=0,_=0;break;case"month":t>1&&(c=Math.floor(c/t)*t),g=1,l=0,b=v,C=0,_=0;break;case"year":t>1&&(p=Math.floor(p/t)*t),c=0,g=1,l=0,b=v,C=0,_=0;break;case"week":O(s)||(s=1),I>=s?g=g-I+s:g=g-(7+I)+s,l=0,b=v,C=0,_=0;break}i=new Date(p,c,g,l,b,C,_);const P=i.getTime();let m=36e5;e=="hour"&&(m=36e5*t),P+m<=o&&(e=="hour"||e=="minute"||e=="second"||e=="millisecond")&&(i=new Date(P+m));let N=i.getTimezoneOffset(),j=n.offsetUTC(i)-N;return j!=v&&i.setTime(i.getTime()+(j-v)*6e4),i}}function ie(i,e,t,s){let a=s[i],r=ee(a),n=s.length-1;if(i>=n)return Object.assign({},s[n]);let o=Math.ceil(e/r);return e<r&&i>0?Object.assign({},s[i-1]):o<=t?Object.assign({},s[i]):i+1<s.length?ie(i+1,e,t,s):Object.assign({},s[i])}function _e(i,e){switch(e){case"day":return i.getDate();case"second":return i.getSeconds();case"millisecond":return i.getMilliseconds();case"hour":return i.getHours();case"minute":return i.getMinutes();case"month":return i.getMonth();case"year":return i.getFullYear();case"week":return ae(i)}}const Me=Object.freeze(Object.defineProperty({__proto__:null,add:be,checkChange:se,chooseInterval:ie,copy:pe,getDateIntervalDuration:de,getDuration:D,getIntervalDuration:ee,getNextUnit:W,getTime:me,getUnitValue:_e,now:te,roun:ge,round:S,sleep:Q,timeUnitDurations:L},Symbol.toStringTag,{value:"Module"}));class A extends F{constructor(){super(...arguments),Object.defineProperty(this,"_aggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_selectionAggregatesCalculated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_dataProcessed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"_psi",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_pei",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_baseSeriesDirty",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"chart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"bullets",{enumerable:!0,configurable:!0,writable:!0,value:new X}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:x.new(this._root,{width:M,height:M,position:"absolute"})})}_afterNew(){this.valueFields.push("value","customValue"),super._afterNew(),this.setPrivate("customData",{}),this._disposers.push(this.bullets.events.onAll(e=>{if(e.type==="clear")this._handleBullets(this.dataItems);else if(e.type==="push")this._handleBullets(this.dataItems);else if(e.type==="setIndex")this._handleBullets(this.dataItems);else if(e.type==="insertIndex")this._handleBullets(this.dataItems);else if(e.type==="removeIndex")this._handleBullets(this.dataItems);else if(e.type==="moveIndex")this._handleBullets(this.dataItems);else throw new Error("Unknown IListEvent type")}))}_dispose(){this.bulletsContainer.dispose(),super._dispose()}startIndex(){let e=this.dataItems.length;return Math.min(this.getPrivate("startIndex",0),e)}endIndex(){let e=this.dataItems.length;return Math.max(0,Math.min(this.getPrivate("endIndex",e),e))}_handleBullets(e){w(e,t=>{const s=t.bullets;s&&(w(s,a=>{a.dispose()}),t.bullets=void 0)}),this.markDirtyValues()}_makeBullets(e){this._shouldMakeBullet(e)&&(e.bullets=[],this.bullets.each(t=>{this._makeBullet(e,t)}))}_shouldMakeBullet(e){return!0}_makeBullet(e,t,s){const a=t(this._root,this,e);return a&&(a._index=s,this._makeBulletReal(e,a)),a}_makeBulletReal(e,t){let s=t.get("sprite");s&&(s._setDataItem(e),s.setRaw("position","absolute"),this.bulletsContainer.children.push(s)),t.series=this,e.bullets.push(t)}addBullet(e,t){e.bullets||(e.bullets=[]),t&&this._makeBulletReal(e,t)}_clearDirty(){super._clearDirty(),this._aggregatesCalculated=!1,this._baseSeriesDirty=!1,this._selectionAggregatesCalculated=!1}_prepareChildren(){super._prepareChildren();let e=this.startIndex(),t=this.endIndex();if(this.isDirty("name")&&this.updateLegendValue(),this.isDirty("heatRules")&&(this._valuesDirty=!0),this.isPrivateDirty("baseValueSeries")){const a=this.getPrivate("baseValueSeries");a&&this._disposers.push(a.onPrivate("startIndex",()=>{this._baseSeriesDirty=!0,this.markDirtyValues()}))}if(this.get("calculateAggregates")&&(this._valuesDirty&&!this._dataProcessed&&(this._aggregatesCalculated||(this._calculateAggregates(0,this.dataItems.length),this._aggregatesCalculated=!0,e!=0&&(this._psi=void 0))),(this._psi!=e||this._pei!=t||this.isPrivateDirty("adjustedStartIndex"))&&!this._selectionAggregatesCalculated&&(e===0&&t===this.dataItems.length&&this._aggregatesCalculated||this._calculateAggregates(e,t),this._selectionAggregatesCalculated=!0)),this.isDirty("tooltip")){let a=this.get("tooltip");a&&(a.hide(0),a.set("tooltipTarget",this))}if(this.isDirty("fill")||this.isDirty("stroke")){let a;const r=this.get("legendDataItem");if(r&&(a=r.get("markerRectangle"),a&&this.isVisible())){if(this.isDirty("stroke")){let n=this.get("stroke");a.set("stroke",n)}if(this.isDirty("fill")){let n=this.get("fill");a.set("fill",n)}}this.updateLegendMarker(void 0)}if(this.bullets.length>0){let a=this.startIndex(),r=this.endIndex();r<this.dataItems.length&&r++;for(let n=a;n<r;n++){let o=this.dataItems[n];o.bullets||this._makeBullets(o)}}}_handleRemoved(){}_adjustStartIndex(e){return e}_calculateAggregates(e,t){let s=this._valueFields;if(!s)throw new Error("No value fields are set for the series.");const a={},r={},n={},o={},h={},u={},f={},p={},c={};w(s,l=>{a[l]=0,r[l]=0,n[l]=0});const g=this.dataItems.length;w(s,l=>{let b=l+"Change",C=l+"ChangePercent",_=l+"ChangePrevious",I=l+"ChangePreviousPercent",v=l+"ChangeSelection",P=l+"ChangeSelectionPercent",m="valueY";(l=="valueX"||l=="openValueX"||l=="lowValueX"||l=="highValueX")&&(m="valueX");const N=this.getPrivate("baseValueSeries"),B=this.getPrivate("adjustedStartIndex",e),j=(y,T)=>{if(y){let d=y.get(T);d!=null&&(y.setRaw(_,d-c[m]),y.setRaw(I,(d-c[m])/c[m]*100),y.setRaw(v,d-u[m]),y.setRaw(P,(d-u[m])/u[m]*100),c[T]=d)}};for(let y=B;y<t;y++){const T=this.dataItems[y];if(T){let d=T.get(l);d!=null&&(n[l]++,a[l]+=d,r[l]+=Math.abs(d),p[l]=a[l]/n[l],(o[l]>d||o[l]==null)&&(o[l]=d),(h[l]<d||h[l]==null)&&(h[l]=d),f[l]=d,u[l]==null&&(u[l]=d,c[l]=d,N&&(u[m]=N._getBase(m))),e===0&&(T.setRaw(b,d-u[m]),T.setRaw(C,(d-u[m])/u[m]*100)),j(T,l))}}t<g&&j(this.dataItems[t],l),t+1<g&&j(this.dataItems[t+1],l),e>0&&e--,delete c[l];for(let y=e;y<B;y++){const T=this.dataItems[y];if(T){let d=T.get(l);c[l]==null&&(c[l]=d),d!=null&&(T.setRaw(_,d-c[m]),T.setRaw(I,(d-c[m])/c[m]*100),T.setRaw(v,d-u[m]),T.setRaw(P,(d-u[m])/u[m]*100),c[l]=d)}}}),w(s,l=>{this.setPrivate(l+"AverageSelection",p[l]),this.setPrivate(l+"CountSelection",n[l]),this.setPrivate(l+"SumSelection",a[l]),this.setPrivate(l+"AbsoluteSumSelection",r[l]),this.setPrivate(l+"LowSelection",o[l]),this.setPrivate(l+"HighSelection",h[l]),this.setPrivate(l+"OpenSelection",u[l]),this.setPrivate(l+"CloseSelection",f[l])}),e===0&&t===g&&w(s,l=>{this.setPrivate(l+"Average",p[l]),this.setPrivate(l+"Count",n[l]),this.setPrivate(l+"Sum",a[l]),this.setPrivate(l+"AbsoluteSum",r[l]),this.setPrivate(l+"Low",o[l]),this.setPrivate(l+"High",h[l]),this.setPrivate(l+"Open",u[l]),this.setPrivate(l+"Close",f[l])})}_updateChildren(){super._updateChildren(),this._psi=this.startIndex(),this._pei=this.endIndex(),this.isDirty("visible")&&this.bulletsContainer.set("visible",this.get("visible"));const e=this.get("heatRules");if(this._valuesDirty&&e&&e.length>0&&w(e,t=>{const s=t.minValue||this.getPrivate(t.dataField+"Low")||0,a=t.maxValue||this.getPrivate(t.dataField+"High")||0;w(t.target._entities,r=>{const n=r.dataItem.get(t.dataField);if(!O(n)){t.neutral&&r.set(t.key,t.neutral);const o=r.states;if(o){const h=o.lookup("default");h&&t.neutral&&h.set(t.key,t.neutral)}if(!t.customFunction)return}if(t.customFunction)t.customFunction.call(this,r,s,a,n);else{let o;t.logarithmic?o=(Math.log(n)*Math.LOG10E-Math.log(s)*Math.LOG10E)/(Math.log(a)*Math.LOG10E-Math.log(s)*Math.LOG10E):o=(n-s)/(a-s),O(n)&&(!O(o)||Math.abs(o)==1/0)&&(o=.5);let h;O(t.min)?h=t.min+(t.max-t.min)*o:t.min instanceof Z?h=Z.interpolate(o,t.min,t.max):t.min instanceof fe&&(h=le(o,t.min,t.max)),r.set(t.key,h);const u=r.states;if(u){const f=u.lookup("default");f&&f.set(t.key,h)}}})}),this.get("visible")){let t=this.dataItems.length,s=this.startIndex(),a=this.endIndex();a<t&&a++,s>0&&s--;for(let r=0;r<s;r++)this._hideBullets(this.dataItems[r]);for(let r=s;r<a;r++)this._positionBullets(this.dataItems[r]);for(let r=a;r<t;r++)this._hideBullets(this.dataItems[r])}}_positionBullets(e){e.bullets&&w(e.bullets,t=>{this._positionBullet(t);const s=t.get("sprite");t.get("dynamic")&&(s&&(s._markDirtyKey("fill"),s.markDirtySize()),s instanceof x&&s.walkChildren(a=>{a._markDirtyKey("fill"),a.markDirtySize(),a instanceof z&&a.text.markDirtyText()})),s instanceof z&&s.get("populateText")&&s.text.markDirtyText()})}_hideBullets(e){e.bullets&&w(e.bullets,t=>{let s=t.get("sprite");s&&s.setPrivate("visible",!1)})}_positionBullet(e){}_placeBulletsContainer(e){e.bulletsContainer.children.moveValue(this.bulletsContainer)}_removeBulletsContainer(){const e=this.bulletsContainer;e.parent&&e.parent.children.removeValue(e)}disposeDataItem(e){const t=e.bullets;t&&(w(t,s=>{s.dispose()}),e.bullets=void 0)}_getItemReaderLabel(){return""}showDataItem(e,t){const s=Object.create(null,{showDataItem:{get:()=>super.showDataItem}});return $(this,void 0,void 0,function*(){const a=[s.showDataItem.call(this,e,t)],r=e.bullets;r&&w(r,n=>{const o=n.get("sprite");o&&a.push(o.show(t))}),yield Promise.all(a)})}hideDataItem(e,t){const s=Object.create(null,{hideDataItem:{get:()=>super.hideDataItem}});return $(this,void 0,void 0,function*(){const a=[s.hideDataItem.call(this,e,t)],r=e.bullets;r&&w(r,n=>{const o=n.get("sprite");o&&a.push(o.hide(t))}),yield Promise.all(a)})}_sequencedShowHide(e,t){return $(this,void 0,void 0,function*(){if(this.get("sequencedInterpolation"))if(O(t)||(t=this.get("interpolationDuration",0)),t>0){const s=this.startIndex(),a=this.endIndex();yield Promise.all(K(this.dataItems,(r,n)=>$(this,void 0,void 0,function*(){let o=t||0;(n<s-10||n>a+10)&&(o=0);let h=this.get("sequencedDelay",0)+o/(a-s);yield Q(h*(n-s)),e?yield this.showDataItem(r,o):yield this.hideDataItem(r,o)})))}else yield Promise.all(K(this.dataItems,s=>e?this.showDataItem(s,0):this.hideDataItem(s,0)))})}updateLegendValue(e){if(e){const t=e.get("legendDataItem");if(t){const s=t.get("valueLabel");if(s){const r=s.text;let n="";s._setDataItem(e),n=this.get("legendValueText",r.get("text","")),s.set("text",n),r.markDirtyText()}const a=t.get("label");if(a){const r=a.text;let n="";a._setDataItem(e),n=this.get("legendLabelText",r.get("text","")),a.set("text",n),r.markDirtyText()}}}}updateLegendMarker(e){}_onHide(){super._onHide();const e=this.getTooltip();e&&e.hide()}hoverDataItem(e){}unhoverDataItem(e){}_getBase(e){const t=this.dataItems[this.startIndex()];return t?t.get(e):0}}Object.defineProperty(A,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Series"});Object.defineProperty(A,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:F.classNames.concat([A.className])});function q(i,e){for(let t=0,s=e.length;t<s;t++){const a=e[t];if(a.length>0){let r=a[0];if(r.length>0){let n=r[0];i.moveTo(n.x,n.y);for(let o=0,h=a.length;o<h;o++)ve(i,a[o])}}}}function ve(i,e){for(let t=0,s=e.length;t<s;t++){const a=e[t];i.lineTo(a.x,a.y)}}class V extends J{_beforeChanged(){super._beforeChanged(),(this.isDirty("points")||this.isDirty("segments")||this._sizeDirty||this.isPrivateDirty("width")||this.isPrivateDirty("height"))&&(this._clear=!0)}_changed(){if(super._changed(),this._clear){const e=this.get("points"),t=this.get("segments");if(e&&e.length>0){let s=e[0];this._display.moveTo(s.x,s.y),q(this._display,[[e]])}else if(t)q(this._display,t);else if(!this.get("draw")){let s=this.width(),a=this.height();this._display.moveTo(0,0),this._display.lineTo(s,a)}}}}Object.defineProperty(V,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Line"});Object.defineProperty(V,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:J.classNames.concat([V.className])});function Ue(i){return function(){return i}}const E=Math.PI,H=2*E,U=1e-6,we=H-U;function re(i){this._+=i[0];for(let e=1,t=i.length;e<t;++e)this._+=arguments[e]+i[e]}function Ce(i){let e=Math.floor(i);if(!(e>=0))throw new Error(`invalid digits: ${i}`);if(e>15)return re;const t=10**e;return function(s){this._+=s[0];for(let a=1,r=s.length;a<r;++a)this._+=Math.round(arguments[a]*t)/t+s[a]}}class Te{constructor(e){this._x0=this._y0=this._x1=this._y1=null,this._="",this._append=e==null?re:Ce(e)}moveTo(e,t){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}`}closePath(){this._x1!==null&&(this._x1=this._x0,this._y1=this._y0,this._append`Z`)}lineTo(e,t){this._append`L${this._x1=+e},${this._y1=+t}`}quadraticCurveTo(e,t,s,a){this._append`Q${+e},${+t},${this._x1=+s},${this._y1=+a}`}bezierCurveTo(e,t,s,a,r,n){this._append`C${+e},${+t},${+s},${+a},${this._x1=+r},${this._y1=+n}`}arcTo(e,t,s,a,r){if(e=+e,t=+t,s=+s,a=+a,r=+r,r<0)throw new Error(`negative radius: ${r}`);let n=this._x1,o=this._y1,h=s-e,u=a-t,f=n-e,p=o-t,c=f*f+p*p;if(this._x1===null)this._append`M${this._x1=e},${this._y1=t}`;else if(c>U)if(!(Math.abs(p*h-u*f)>U)||!r)this._append`L${this._x1=e},${this._y1=t}`;else{let g=s-n,l=a-o,b=h*h+u*u,C=g*g+l*l,_=Math.sqrt(b),I=Math.sqrt(c),v=r*Math.tan((E-Math.acos((b+c-C)/(2*_*I)))/2),P=v/I,m=v/_;Math.abs(P-1)>U&&this._append`L${e+P*f},${t+P*p}`,this._append`A${r},${r},0,0,${+(p*g>f*l)},${this._x1=e+m*h},${this._y1=t+m*u}`}}arc(e,t,s,a,r,n){if(e=+e,t=+t,s=+s,n=!!n,s<0)throw new Error(`negative radius: ${s}`);let o=s*Math.cos(a),h=s*Math.sin(a),u=e+o,f=t+h,p=1^n,c=n?a-r:r-a;this._x1===null?this._append`M${u},${f}`:(Math.abs(this._x1-u)>U||Math.abs(this._y1-f)>U)&&this._append`L${u},${f}`,s&&(c<0&&(c=c%H+H),c>we?this._append`A${s},${s},0,1,${p},${e-o},${t-h}A${s},${s},0,1,${p},${this._x1=u},${this._y1=f}`:c>U&&this._append`A${s},${s},0,${+(c>=E)},${p},${this._x1=e+s*Math.cos(r)},${this._y1=t+s*Math.sin(r)}`)}rect(e,t,s,a){this._append`M${this._x0=this._x1=+e},${this._y0=this._y1=+t}h${s=+s}v${+a}h${-s}Z`}toString(){return this._}}function Oe(i){let e=3;return i.digits=function(t){if(!arguments.length)return e;if(t==null)e=null;else{const s=Math.floor(t);if(!(s>=0))throw new RangeError(`invalid digits: ${t}`);e=s}return i},()=>new Te(e)}class R extends x{constructor(){super(...arguments),Object.defineProperty(this,"chartContainer",{enumerable:!0,configurable:!0,writable:!0,value:this.children.push(x.new(this._root,{width:M,height:M,interactiveChildren:!1}))}),Object.defineProperty(this,"bulletsContainer",{enumerable:!0,configurable:!0,writable:!0,value:x.new(this._root,{interactiveChildren:!1,isMeasured:!1,position:"absolute",width:M,height:M})})}}Object.defineProperty(R,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Chart"});Object.defineProperty(R,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:x.classNames.concat([R.className])});class G extends R{constructor(){super(...arguments),Object.defineProperty(this,"seriesContainer",{enumerable:!0,configurable:!0,writable:!0,value:x.new(this._root,{width:M,height:M,isMeasured:!1})}),Object.defineProperty(this,"series",{enumerable:!0,configurable:!0,writable:!0,value:new oe})}_afterNew(){super._afterNew(),this._disposers.push(this.series);const e=this.seriesContainer.children;this._disposers.push(this.series.events.onAll(t=>{if(t.type==="clear"){w(t.oldValues,r=>{this._removeSeries(r)});const s=this.get("colors");s&&s.reset();const a=this.get("patterns");a&&a.reset()}else if(t.type==="push")e.moveValue(t.newValue),this._processSeries(t.newValue);else if(t.type==="setIndex")e.setIndex(t.index,t.newValue),this._processSeries(t.newValue);else if(t.type==="insertIndex")e.insertIndex(t.index,t.newValue),this._processSeries(t.newValue);else if(t.type==="removeIndex")this._removeSeries(t.oldValue);else if(t.type==="moveIndex")e.moveValue(t.value,t.newIndex),this._processSeries(t.value);else if(t.type==="swap"){const s=t.a,a=t.b,r=this.series.indexOf(s),n=this.series.indexOf(a);e.moveValue(s,n),e.moveValue(a,r),this.series.each(o=>{this._processSeries(o),o.markDirtyValues()})}else throw new Error("Unknown IListEvent type")}))}_processSeries(e){e.chart=this,e._placeBulletsContainer(this)}_removeSeries(e){e._handleRemoved(),e.isDisposed()||(this.seriesContainer.children.removeValue(e),e._removeBulletsContainer())}}Object.defineProperty(G,"className",{enumerable:!0,configurable:!0,writable:!0,value:"SerialChart"});Object.defineProperty(G,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:R.classNames.concat([G.className])});class Y extends V{}Object.defineProperty(Y,"className",{enumerable:!0,configurable:!0,writable:!0,value:"Tick"});Object.defineProperty(Y,"classNames",{enumerable:!0,configurable:!0,writable:!0,value:V.classNames.concat([Y.className])});export{F as C,k as D,xe as J,V as L,A as S,Y as T,ie as a,ee as b,Ue as c,_e as d,se as e,D as f,W as g,de as h,Me as i,R as j,G as k,ce as l,S as m,ge as r,Oe as w};
