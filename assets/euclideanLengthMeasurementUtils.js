const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./SelfSnappingEngine.js","./ShadowCastClear.glsl.js","./iframe-qDaPDssc.js","./iframe-9zG0Ao4u.css","./index.js","./Viewport.js","./debounce.js","./index2.js","./Section.js","./ErrorBoundary.js","./createClass.js","./Global.js","./useIsDark.js","./ShadowCastClear-BxU8WlBI.css","./angularMeasurementUtils.js","./geometry2dUtils.js","./geodeticLengthOperator.js","./geodeticCurveType.js","./GridSnappingEngine.js","./gridUtils.js","./FeatureSnappingEngine.js","./floorFilterUtils.js"])))=>i.map(i=>d[i]);
import{b8 as Ae}from"./iframe-qDaPDssc.js";import{x$ as Tn,fb as Pe,BV as Dt,BW as qt,bC as ce,Ag as Pn,gH as ee,D as kt,b8 as Ee,E as l,F as d,V as le,b6 as Nt,O as ae,l as En,hQ as Ln,bj as Ye,bo as Ot,BX as bt,kK as Mn,gp as et,BY as Rn,fn as zn,eM as Cn,BZ as Dn,sM as qn,bJ as f,f4 as kn,nV as ue,fA as J,fB as Y,fE as Nn,fC as Se,fi as E,go as P,h9 as x,bI as K,fV as Le,B_ as tt,hl as B,Ab as On,fF as De,fc as qe,fG as Me,gE as ke,gC as z,B$ as nt,C0 as jt,fe as at,zs as Ht,na as oe,ww as xe,vF as jn,ld as Vt,g6 as Hn,zt as Vn,gL as $,ml as In,xR as An,bx as Zn,C1 as Fn,qd as Wn,zu as It,gD as At,nP as Zt,hP as Bn,C2 as Gn,mn as Un,nb as Jn,C3 as Kn,C4 as Xn,zb as Qn,sQ as Yn,C5 as es,fW as ts,C6 as ns,C7 as wt,hE as st,hA as ot,hB as ut,C8 as ss,bK as is,p4 as rs,vB as as,o_ as Ft,p0 as os,mI as us,gr as cs,lo as Wt,C as Bt,T as he,vf as R,lq as ls,b3 as hs,ev as ds,f7 as ps,bk as fs,ar as Ze,eB as St,eA as gs,eo as ys,m$ as vs,m_ as _s,n0 as $s,I as ms,mS as bs,C9 as ws,Ae as Gt,e_ as Fe,Af as Ss}from"./ShadowCastClear.glsl.js";import{g as xs}from"./geometry2dUtils.js";import{m as Ts,l as Ut}from"./geodeticLengthOperator.js";function Jt(t,e,n){return L(t,e,n)}function L(t=0,e=0,n=0){return Pe(t,e,n)}function Ui(t){return t}function Ji(t){return t}function X(t,e,n){return Pe(t,e,n)}function te(t){const[e,n,s]=t;return t.length>3?[e,n,s,t[3]]:[e,n,s]}function We(t){return t[3]=1|((t.length>3?t[3]:void 0)??0),t}function Ki(t){return!!(1&((t.length>3?t[3]:void 0)??0))}function xt(t,e,{coordinateHelper:n,elevationInfo:s},i){return t?re(n.vectorToDehydratedPoint(t,Ps),e,s,i):null}function re(t,e,n,s=L()){return s[0]=t.x,s[1]=t.y,s[2]=t.z??0,e==null||(e.type==="2d"?s[2]=0:s[2]=Tn(e,t,n,ee)??0),s}function Xi(t,e,n){return n?(qt(n,t[0],t[1],t[2],e),n):ce(t[0],t[1],t[2],e)}function Tt(t,e,{z:n,m:s},i,r){const{spatialReference:a,elevationInfo:o}=i;let u;n==null&&s==null?u=void 0:e==null||e.type==="2d"?u=n??void 0:u=Dt(e,t,a,ee,o)??0;const[c,h]=t;return r?qt(r,c,h,u,a):r=ce(c,h,u,a),s!=null&&(r.m=s,r.hasM=!0),r}function Qi(t,e,n,s,i=L()){const[r,a]=t;return i[0]=r,i[1]=a,t.length>3&&(i[3]=t[3]??0),(n==null?void 0:n.type)!=="3d"?(i[2]=e.value,i):(i[2]=Pn(n,r,a,e.value,s,e.elevationInfo,ee)??0,i)}const Ps=ce(0,0,0,null);let q=class extends kt{constructor(){super(...arguments),this.enabled=!0}};l([d({type:Boolean})],q.prototype,"enabled",void 0),q=l([le("esri.views.interactive.snapping.Settings.DefaultSnappingAlgorithm")],q);let _=class extends kt{constructor(e){super(e),this.lineSnapper=new q,this.parallelLineSnapper=new q,this.rightAngleSnapper=new q,this.rightAngleTriangleSnapper=new q,this.shortLineThreshold=15,this.distance=5,this.pointThreshold=1e-6,this.intersectionParallelLineThreshold=1e-6,this.parallelLineThreshold=1e-6,this.verticalLineThresholdMeters=.3,this.touchSensitivityMultiplier=1.5,this.pointOnLineThreshold=1e-6,this.orange=new Ee([255,127,0]),this.orangeTransparent=new Ee([255,127,0,.5]),this.lineHintWidthReference=3,this.lineHintWidthTarget=3,this.lineHintFadedExtensions=.3,this.parallelLineHintWidth=2,this.parallelLineHintLength=24,this.parallelLineHintOffset=1.5,this.rightAngleHintSize=24,this.rightAngleHintOutlineSize=1.5,this.satisfiesConstraintScreenThreshold=1}};l([d({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_.prototype,"lineSnapper",void 0),l([d({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_.prototype,"parallelLineSnapper",void 0),l([d({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_.prototype,"rightAngleSnapper",void 0),l([d({type:q,constructOnly:!0,nonNullable:!0,json:{write:!0}})],_.prototype,"rightAngleTriangleSnapper",void 0),l([d({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],_.prototype,"shortLineThreshold",void 0),l([d({type:Number,nonNullable:!0,range:{min:-1,max:50,step:1},json:{write:!0}})],_.prototype,"distance",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_.prototype,"pointThreshold",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_.prototype,"intersectionParallelLineThreshold",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_.prototype,"parallelLineThreshold",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],_.prototype,"verticalLineThresholdMeters",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_.prototype,"touchSensitivityMultiplier",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:1e-5},json:{write:!0}})],_.prototype,"pointOnLineThreshold",void 0),l([d({type:Ee,nonNullable:!0})],_.prototype,"orange",void 0),l([d({type:Ee,nonNullable:!0})],_.prototype,"orangeTransparent",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_.prototype,"lineHintWidthReference",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_.prototype,"lineHintWidthTarget",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:1},json:{write:!0}})],_.prototype,"lineHintFadedExtensions",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:10},json:{write:!0}})],_.prototype,"parallelLineHintWidth",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:50},json:{write:!0}})],_.prototype,"parallelLineHintLength",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],_.prototype,"parallelLineHintOffset",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:46},json:{write:!0}})],_.prototype,"rightAngleHintSize",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:6},json:{write:!0}})],_.prototype,"rightAngleHintOutlineSize",void 0),l([d({type:Number,nonNullable:!0,range:{min:0,max:5},json:{write:!0}})],_.prototype,"satisfiesConstraintScreenThreshold",void 0),_=l([le("esri.views.interactive.snapping.Settings.Defaults")],_);const Re=new _;let W=class extends Nt{constructor(e){super(e),this.layer=null,this.enabled=!0,this.updating=!1,this.availability=1,this.sublayerSources=new ae}};l([d({constructOnly:!0})],W.prototype,"layer",void 0),l([d()],W.prototype,"enabled",void 0),l([d()],W.prototype,"updating",void 0),l([d()],W.prototype,"availability",void 0),l([d()],W.prototype,"sublayerSources",void 0),W=l([le("esri.views.interactive.snapping.FeatureSnappingLayerSource")],W);let S=class extends Nt{constructor(t){super(t),this.enabled=!1,this.enabledToggled=!1,this.forceDisabled=!1,this.selfEnabled=!0,this.featureEnabled=!0,this.gridEnabled=!1,this.attributeRulesEnabled=!1,this.featureSources=new ae,this.distance=Re.distance,this.touchSensitivityMultiplier=Re.touchSensitivityMultiplier}get effectiveEnabled(){return!this.forceDisabled&&(this.enabledToggled?!this.enabled:this.enabled)}get effectiveGridEnabled(){return this.effectiveEnabled&&this.gridEnabled}get effectiveSelfEnabled(){return this.effectiveEnabled&&this.selfEnabled}get effectiveFeatureEnabled(){return this.effectiveEnabled&&this.featureEnabled}get _effectiveFeatureSources(){var o;const t=this.featureSources;t.some(Pt)&&En.getLogger(this).warnOnce("Do not configure SubtypeGroupLayer sources in SnappingOptions.featureSources directly. Create a FeatureSnappingLayerSource for each SubtypeSublayer.");const e=t.filter(Ls),n=((o=this._get("_effectiveFeatureSources"))==null?void 0:o.filter(Pt))??new ae;for(const u of e){const c=n.find(h=>h.layer===u.layer.parent);if(c)c.sublayerSources.includes(u)||c.sublayerSources.add(u);else if(u.layer.parent){const h=new W({layer:u.layer.parent});h.sublayerSources.add(u),n.add(h)}}for(const u of n){const c=u.sublayerSources.filter(h=>!e.includes(h));u.sublayerSources.removeMany(c)}n.removeMany(n.filter(u=>u.sublayerSources.length===0));const s=t.filter(Es),i=this._get("_effectiveFeatureSources")??new ae,{added:r,removed:a}=Ln(i.toArray(),[...s,...n]);return i.removeMany(a),i.addMany(r),i}};function Pt(t){return t.layer.type==="subtype-group"}function Es(t){return t.layer.type!=="subtype-group"}function Ls(t){return t.layer.type==="subtype-sublayer"}l([d()],S.prototype,"enabled",void 0),l([d()],S.prototype,"enabledToggled",void 0),l([d()],S.prototype,"forceDisabled",void 0),l([d()],S.prototype,"selfEnabled",void 0),l([d()],S.prototype,"featureEnabled",void 0),l([d()],S.prototype,"gridEnabled",void 0),l([d()],S.prototype,"attributeRulesEnabled",void 0),l([d({type:ae.ofType(W)})],S.prototype,"featureSources",void 0),l([d()],S.prototype,"distance",void 0),l([d()],S.prototype,"touchSensitivityMultiplier",void 0),l([d({readOnly:!0})],S.prototype,"effectiveEnabled",null),l([d({readOnly:!0})],S.prototype,"effectiveGridEnabled",null),l([d({readOnly:!0})],S.prototype,"effectiveSelfEnabled",null),l([d({readOnly:!0})],S.prototype,"effectiveFeatureEnabled",null),l([d({readOnly:!0})],S.prototype,"_effectiveFeatureSources",null),S=l([le("esri.views.interactive.snapping.SnappingOptions")],S);const tr=Symbol("grid-placement-graphic");function Kt(t,e){const n=t.x-e.x,s=t.y-e.y;return n*n+s*s}function nr(t,e){return Math.sqrt(Kt(t,e))}function Ms(t,e){e.sort((n,s)=>et(n.targetPoint,t)-et(s.targetPoint,t))}function sr({parameters:{point:t,distance:e,returnEdge:n,vertexMode:s,coordinateHelper:{spatialReference:i},filter:r},mode:a,returnZ:o,filter:u}){const c=(u==null?void 0:u.clone())??new zn({where:"1=1"});return c.returnZ=o??a==="3d",r&&(c.geometry=r.geometry,c.distance=r.distance,c.spatialRelationship=r.spatialRelationship,c.where=Cn(c.where,r.where),c.timeExtent=Dn(c.timeExtent,r.timeExtent),c.objectIds=Rs(c.objectIds,r.objectIds)),{point:ce(t[0],t[1],t[2],i.toJSON()),mode:a,distance:e,returnEdge:n,vertexMode:s,query:c.toJSON()}}function Rs(t,e){return t||e?e?t?Array.from(qn(new Set(t),new Set(e))):e:t:null}function ir(t,e,n){return{left:xt(t.leftVertex.pos,e,n),right:xt(t.rightVertex.pos,e,n)}}const Et=Symbol("snapping-toggle");function rr(t,e=()=>{}){const n=Ye(()=>({view:t.view,snappingOptions:t.snappingOptions}),({view:s,snappingOptions:i})=>{if(t.removeHandles(Et),!s||!i)return;const r=Mn.TOOL,a=[s.on("key-down",o=>{o.key!==bt.toggle||o.repeat||(i.enabledToggled=!0,e())},r),s.on("key-up",o=>{o.key===bt.toggle&&(i.enabledToggled=!1,e())},r),s.on("pointer-move",o=>{const u=o.native.ctrlKey;i.enabledToggled!==u&&(i.enabledToggled=u,e())},r)];t.addHandles(a,Et)},Ot);t.addHandles(n)}function ar(t){var e;return Rn(t)&&"utilityNetworks"in t&&!!((e=t.utilityNetworks)!=null&&e.length)}function or(t){return(t==null?void 0:t.type)==="line"}function ct({start:t,end:e,type:n},s,i){const r=[],a=J(de,e,t),o=J(Ne,t,s),u=Me(a),c=2*De(a,o),h=c*c-4*u*(Me(o)-i*i);if(h===0){const p=-c/(2*u);(n===0||p>=0)&&r.push(Se(Y(),t,a,p))}else if(h>0){const p=Math.sqrt(h),y=(-c+p)/(2*u);(n===0||y>=0)&&r.push(Se(Y(),t,a,y));const g=(-c-p)/(2*u);(n===0||g>=0)&&r.push(Se(Y(),t,a,g))}return r}function Xt(t,e){const n=t.start,s=t.end,i=J(de,s,n),r=K(je,-i[1],i[0],0),a=e.start,o=e.end,u=E(ht,o,a),c=P(u,r),h=K(an,n[0],n[1],0),p=E(on,h,a),y=P(p,r),g=ue();if(Math.abs(c)<g)return[];const w=x(un,a,u,y/c);if(e.type===0){const T=E(it,w,a);if(P(T,u)<-g)return[]}if(t.type===1){const T=On(Ne,w,n);if(De(T,i)<-g)return[]}return[B(w)]}function zs(t,e){return Ds(ze(dt,e[2],t),e)}function Qt(t,e){return sn(ze(dt,0,t),ze(Os,0,e)).map(([s,i])=>xe(s,i))}function Yt(t,e,n){return tn(t,ze(dt,t[2],e),n)}function en(t,e,n,s=f()){const i=J(de,t,e),r=Nn(i);return Se(s,e,i,r===0?1:n/r),s[2]=t[2],s}function tn(t,{start:e,end:n,type:s},i=f()){const r=E(Oe,t,e),a=E(je,n,e),o=P(r,a)/P(a,a);return x(i,e,a,s===0?Math.max(o,0):o)}const Cs=(()=>{const t=f(),e=f(),n=f();return({start:s,end:i},{center:r,radius:a,normal:o,slicePlane:u})=>{const c=ke(r,o,Ns);if(v(nt(c,s),0)&&v(nt(c,i),0)){jt(o,t,e);const p=(w,T)=>(qe(n,T,r),Vt(w,P(n,t),P(n,e)),w),y=xs({start:p(de,s),end:p(Ne,i)},Hn,a),g=[];for(const[w,T]of y){const M=at(f(),r);x(M,M,t,w),x(M,M,e,T),u&&!U(u,M)||g.push(M)}return g}const h=f();return Ht(c,s,i,h)?!v(oe(h,r),a)||u&&!U(u,h)?[]:[h]:[]}})();function nn({start:t,end:e,type:n},s,i){const r=[],a=qe(Oe,e,t),o=J(Ne,t,s),u=Me(a),c=2*De(a,o),h=c*c-4*u*(Me(o)-i*i);if(h===0){const p=-c/(2*u);(n===1||p>=0)&&r.push(x(f(),t,a,p))}else if(h>0){const p=Math.sqrt(h),y=(-c+p)/(2*u);(n===1||y>=0)&&r.push(x(f(),t,a,y));const g=(-c-p)/(2*u);(n===1||g>=0)&&r.push(x(f(),t,a,g))}return r}function sn(t,e){const n=t.start,s=t.end,i=e.start,r=e.end,a=E(Oe,s,n),o=E(je,r,i),u=E(ht,i,n),c=Le(an,a,o);if(!v(P(u,c),0))return[];const h=tt(c);if(v(h,0))return[];const p=Le(on,u,o),y=P(p,c)/h,g=x(un,n,a,y);if(t.type===0){const w=E(it,g,n);if(P(a,w)<-ue())return[]}if(e.type===0){const w=E(it,g,i);if(P(o,w)<-ue())return[]}return[B(g)]}function Ds({start:t,end:e,type:n},s){const i=E(Oe,s,t),r=E(je,e,t),a=Le(ht,r,i),o=tt(a)/tt(r),u=ue();if(o<u)switch(n){case 1:return[B(s)];case 0:return P(r,i)<-u?[]:[B(s)]}return[]}function lt(t,e,n,s){const[i,r]=t,[a,o]=n,u=a-i,c=o-r,h=u*u+c*c,p=Math.sqrt(h);if(p>e+s)return[];if(p<Math.abs(e-s))return[];if(v(p,0)&&v(e,s))return[];const y=(e*e-s*s+h)/(2*p),g=Math.sqrt(e*e-y*y),w=g*c/p,T=g*u/p,[M,Q]=jn(de,t,n,y/p);return v(w,T)?[xe(M,Q)]:[xe(M+w,Q-T),xe(M-w,Q+T)]}function ze(t,e,{start:n,end:s,type:i}){return K(t.start,n[0],n[1],e),K(t.end,s[0],s[1],e),t.type=ks[i],t}function rn(t,e){return v(t[2],e[2])}function v(t,e){return kn(Math.abs(t-e),0,ue())}function qs(t,e){return e.filter(n=>U(t,n))}function U(t,e){return Vn(t,e)}const ks={0:1,1:0},de=Y(),Ne=Y(),Oe=f(),je=f(),ht=f(),an=f(),on=f(),un=f(),it=f(),Ns=z(),dt={start:f(),end:f(),type:1},Os={start:f(),end:f(),type:1};class C{intersect(e){return I(this,e)}closestPoints(e){return[this.closestTo(e)]}}class ne extends C{constructor(e){super(),this.point=e}equals(e){return this===e||D(e)&&$(this.point,e.point)}closestTo(){return te(this.point)}}class pt extends C{constructor(e,n,s){super(),this.start=e,this.end=n,this.lineLike={start:e,end:n,type:s}}equals(e){return this===e||N(e)&&this.lineLike.type===e.lineLike.type&&$(this.start,e.start)&&$(this.end,e.end)}closestTo(e){const n=L();return tn(e,this.lineLike,n),n}}class ft extends pt{constructor(e,n){super(e,n,1)}}class js extends pt{constructor(e,n){super(e,n,0)}}class cn extends C{constructor(e){super(),this.constraints=e}equals(e){return this===e||rt(e)&&Bn(this.constraints,e.constraints,(n,s)=>n.equals(s))}closestTo(e){let n,s=1/0;for(const i of this.constraints){const r=i.closestTo(e),a=et(e,r);a<s&&(s=a,n=r)}return te(n??e)}closestPoints(e){return this.constraints.flatMap(n=>n===this?[]:n.closestPoints(e))}}class ln extends C{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||j(e)&&this.center[0]===e.center[0]&&this.center[1]===e.center[1]&&this.radius===e.radius}closestTo(e){const n=L();return en(e,this.center,this.radius,n),n}}class gt extends C{constructor(e,n){super(),this.center=e,this.radius=n}equals(e){return this===e||Z(e)&&$(this.center,e.center)&&this.radius===e.radius}closestTo(e){const n=L();return en(e,this.center,this.radius,n),n[2]=this.center[2],n}asCircle(){return new yt(te(this.center),this.radius,X(0,0,1))}}class yt extends C{constructor(e,n,s,i=void 0){super(),this.center=e,this.radius=n,this.normal=s,this.slicePlane=i}equals(e){return this===e||G(e)&&$(this.center,e.center)&&$(this.normal,e.normal)&&this.radius===e.radius}closestTo(e){const{center:n,radius:s}=this;It(this.getPlane(Hs),e,Be);const i=E(Be,Be,n),r=Un(i);if(v(r,0))return te(e);const a=s/Math.sqrt(r),o=L();x(o,n,i,a);const{slicePlane:u}=this;if(u&&!U(u,o)){const c=_t(u,this);return(c==null?void 0:c.closestTo(e))??te(e)}return o}getPlane(e=z()){return ke(this.center,this.normal,e)}}const Be=f(),Hs=z();class Vs extends C{constructor(e){super(),this.z=e}equals(e){return this===e||A(e)&&this.z===e.z}closestTo(e){return X(e[0],e[1],this.z)}getPlane(e=z()){return K(Lt,0,0,this.z),ke(Lt,Gn,e)}}const Lt=f();class vt extends C{constructor(e,n,s){super(),this.start=e,this.end=n,this.planeLike={start:e,end:n,type:s}}equals(e){return this===e||O(e)&&this.planeLike.type===e.planeLike.type&&$(this.start,e.start)&&$(this.end,e.end)}closestTo(e){const n=L();return Yt(e,this.planeLike,n),n}closestEndTo(e){const{start:n,end:s}=this.planeLike;return Math.sign(De(J(Is,s,n),J(As,e,n)))>0?this.end:this.start}getPlane(e=z()){const n=at(Mt,this.end);return n[2]+=1,In(this.start,this.end,n,e)}getSlicePlane(e=z()){const{start:n,end:s,type:i}=this.planeLike;if(i===0)return;const r=K(Mt,n[0],n[1],0),a=K(Rt,s[0],s[1],0),o=qe(Rt,a,r);return ke(r,o,e),e}}const Is=Y(),As=Y(),Mt=f(),Rt=f();class ur extends vt{constructor(e,n){super(e,n,1)}}class hn extends vt{constructor(e,n){super(e,n,0)}}class Zs extends C{constructor(e,n){super(),this.sphere=Jn(e,n),this._center=B(e)}equals(e){return this===e||F(e)&&Kn(this.sphere,e.sphere)}closestTo(e){const n=L();return Xn(this.sphere,e,n),n}get center(){return this._center}get radius(){return this.sphere[3]}}class dn extends C{constructor(e,n,s){super(),this.start=e,this.end=n,this.getZ=s,this.planeLike={start:e,end:n,type:0}}equals(e){return this===e||Ce(e)&&$(this.start,e.start)&&$(this.end,e.end)&&this.getZ===e.getZ}closestTo(e){return Js(this,e)}addIfOnTheGround(e,n){for(const s of n){const i=this.getZ(s[0],s[1])??0;v(s[2],i)&&(s[2]=i,e.push(s))}}}class Fs extends C{constructor(e,n,s){super(),this._x=e,this._y=n,this._z=s}equals(e){return this===e||hi(e)&&this._x===e._x&&this._y===e._y&&this._z===e._z}closestTo([e,n,s]){return Jt(this._x??e,this._y??n,this._z??s)}}class Ws extends C{constructor(e,n,s,i,r){super(),this._origin=e,this._spatialReference=n,this._distanceMeters=s,this._z=i,this._directionDegrees=r}equals(e){return this===e||li(e)&&wt(this._origin,e._origin)&&this._spatialReference===e._spatialReference&&this._distanceMeters===e._distanceMeters&&this._z===e._z&&this._directionDegrees===e._directionDegrees}closestTo([e,n,s]){return Vt(ie,e,n),wt(ie,this._origin)||this._applyDirectionAndDistance(ie),Jt(ie[0],ie[1],this._z??s)}_applyDirectionAndDistance(e){if(this._directionDegrees!=null&&this._distanceMeters!=null)st(e,this._origin,this._directionDegrees,this._distanceMeters,this._spatialReference);else if(this._directionDegrees!=null)Gs(e,this._origin,this._directionDegrees,e,this._spatialReference);else if(this._distanceMeters!=null){const{azimuth:n}=ot(Bs,this._origin,e,this._spatialReference);st(e,this._origin,n??0,this._distanceMeters,this._spatialReference)}}}const ie=[0,0],Bs=new ut;function Gs(t,e,n,s,i){let{azimuth:r,distance:a}=ot(Us,e,s,i);r??(r=0);let o=a*Math.cos((r-n)*ss);o=Math.max(0,o),st(t,e,n,o,i)}const Us=new ut;function Js(t,e){const n=L();return Yt(e,t.planeLike,n),n[2]=t.getZ(n[0],n[1])??fn,n}function I(t,e){if(rt(t)){const n=[];for(const s of t.constraints){const i=s.intersect(e);i&&n.push(i)}return $t(n)}if(rt(e))return I(e,t);if(Ce(t))return zt(t,e);if(Ce(e))return zt(e,t);if(D(t)){const{point:n}=t;if(D(e))return $(n,e.point)?t:void 0;const s=e.closestTo(n);return An(s,n)?t:void 0}if(N(t)){if(D(e))return I(e,t);if(N(e))return k(sn(t.lineLike,e.lineLike));if(A(e))return Ks(t,e);if(O(e))return k(Xt(e.planeLike,t.lineLike));if(j(e))return k(nn(t.lineLike,e.center,e.radius));if(G(e))return k(Cs(t.lineLike,e));if(Z(e))return Xs(t,e);if(F(e))return Qs(t,e)}else if(A(t)){if(D(e)||N(e))return I(e,t);if(A(e))return Ys(t,e);if(O(e))return ei(t,e);if(j(e))return ti(t,e);if(G(e))return si(t,e);if(Z(e))return ni(t,e);if(F(e))return ii(t,e)}else if(O(t)){if(D(e)||N(e)||A(e))return I(e,t);if(O(e))return Ge(Qt(t.planeLike,e.planeLike));if(j(e))return Ge(ct(t.planeLike,e.center,e.radius));if(G(e))return ai(t,e);if(Z(e))return ri(t,e);if(F(e))return oi(t,e)}else if(j(t)){if(D(e)||N(e)||A(e)||O(e))return I(e,t);if(j(e))return Ge(lt(t.center,t.radius,e.center,e.radius));if(G(e))return void 0;if(Z(e))return ui(t,e);if(F(e))return void 0}else if(G(t)){if(D(e)||N(e)||A(e)||O(e)||j(e))return I(e,t);if(G(e))return void 0;if(Z(e))return e.asCircle(),void 0;if(F(e))return void 0}else if(Z(t)){if(D(e)||N(e)||A(e)||O(e)||j(e)||G(e))return I(e,t);if(Z(e))return ci(e,t);if(F(e))return void 0}else if(F(t)){if(D(e)||N(e)||A(e)||O(e)||j(e)||Z(e))return I(e,t);if(F(e))return void 0}}const Ks=(()=>{const t=z();return(e,n)=>{const{start:s,end:i}=e;if(rn(s,i)&&v(s[2],n.z))return e;const r=L();return Ht(n.getPlane(t),s,i,r)?new ne(r):void 0}})();function Xs({lineLike:t},{center:e,radius:n}){const s=e[2];return k(nn(t,e,n).filter(i=>v(i[2],s)))}function Qs({lineLike:t},{sphere:e}){return k(Fn(e,t.start,t.end))}const _t=(()=>{const t=Yn(),e=f(),n=f();return(s,i,r)=>{const{normal:a,center:o,radius:u}=i;jt(a,e,n);const c=At(s),h=u*P(c,e),p=u*P(c,n);Qn(t,o[0],o[1],o[2],1);const y=es(s,t),g=Math.hypot(h,p),w=v(g,0);if(v(nt(s,o),0)){if(w)return i;if(v(u,0))return!r||U(r,o)?new ne(te(o)):void 0;Le(e,c,a),ts(e,e);const Ie=new Array,ye=B(o);x(ye,ye,e,u),r&&!U(r,ye)||Ie.push(ye);const ve=B(o);return x(ve,ve,e,-u),r&&!U(r,ve)||Ie.push(ve),k(Ie)}if(w)return;const T=-y/g;if(Math.abs(T)>1||v(T,1))return;const M=Math.atan(h/p),Q=ns(T)-M,mt=Math.PI-Q,pe=new Array,fe=f();x(fe,o,e,u*Math.cos(Q)),x(fe,fe,n,u*Math.sin(Q)),pe.push(fe);const ge=f();return x(ge,o,e,u*Math.cos(mt)),x(ge,ge,n,u*Math.sin(mt)),pe.push(ge),k(r?qs(r,pe):pe)}})();function Ys(t,e){return v(t.z,e.z)?t:void 0}function ei({z:t},{planeLike:e}){const[n,s]=e.start,[i,r]=e.end,a=X(n,s,t),o=X(i,r,t);return e.type===0?new ft(a,o):new js(a,o)}function ti(t,e){const[n,s]=e.center;return new gt(X(n,s,t.z),e.radius)}function ni(t,e){return v(e.center[2],t.z)?e:void 0}const si=(()=>{const t=z();return(e,n)=>_t(e.getPlane(t),n,n.slicePlane)})();function ii(t,{center:e,radius:n}){const s=Math.abs(e[2]-t.z);if(s>n&&!v(s,n))return;const i=X(e[0],e[1],t.z),r=Math.sqrt(n**2-s**2);return v(r,0)?void 0:new gt(i,r)}const ri=(()=>{const t=z();return(e,{center:n,radius:s})=>{const i=ct(e.planeLike,n,s),r=n[2];e.getSlicePlane(t);const a=new Array;for(const[o,u]of i){const c=[o,u,r];U(t,c)&&a.push(c)}return k(a)}})(),ai=(()=>{const t=z(),e=z();return(n,s)=>_t(n.getPlane(t),s,n.getSlicePlane(e))})(),oi=(()=>{const t=z();return(e,{center:n,radius:s})=>{const i=e.getPlane(t),r=Wn(i,n),a=Math.abs(r);if(a>s&&!v(a,s))return;const o=Math.sqrt(s**2-r**2);if(v(o,0)){const h=L();return It(i,n,h),new ne(h)}const u=L(),c=B(At(i));return x(u,n,c,r),new yt(u,o,c,e.getSlicePlane())}})();function ui(t,e){const n=Zt(t.center,e.center);return v(n,0)&&v(t.radius,e.radius)?e:pn(lt(t.center,t.radius,e.center,e.radius),e.center[2])}function ci(t,e){if(!rn(t.center,e.center))return;const n=Zt(t.center,e.center);return v(n,0)&&v(t.radius,e.radius)?t:pn(lt(t.center,t.radius,e.center,e.radius),t.center[2])}function zt(t,e){const{planeLike:n,getZ:s}=t,i=new Array;if(D(e))t.addIfOnTheGround(i,zs(n,e.point));else if(N(e))t.addIfOnTheGround(i,Xt(n,e.lineLike));else if(j(e))for(const[r,a]of ct(n,e.center,e.radius)){const o=s(r,a);o!=null&&i.push(Pe(r,a,o))}else if(O(e)||Ce(e))for(const[r,a]of Qt(n,e.planeLike)){const o=s(r,a)??fn;i.push(Pe(r,a,o))}return k(i)}function Ge(t){return $t(t.map(([e,n])=>{const s=X(e,n,0),i=X(e,n,1);return new ft(s,i)}))}function k(t){return $t(t.map(e=>e?new ne(e):void 0))}function pn(t,e){return k(t.map(([n,s])=>[n,s,e]))}function $t(t){if(t.length!==0)return t.length===1?t[0]??void 0:new cn(t.filter(Zn))}function rt(t){return t instanceof cn}function D(t){return t instanceof ne}function N(t){return t instanceof pt}function A(t){return t instanceof Vs}function O(t){return t instanceof vt}function j(t){return t instanceof ln}function Z(t){return t instanceof gt}function G(t){return t instanceof yt}function F(t){return t instanceof Zs}function Ce(t){return t instanceof dn}function li(t){return t instanceof Ws}function hi(t){return t instanceof Fs}const fn=0;let se=class{constructor(e,n,s,i){this.targetPoint=e,this.constraint=n,this.isDraped=s,this.domain=i}},gn=class extends se{constructor({targetPoint:e,objectId:n,constraint:s,isDraped:i}){super(e,s,i,1),this.objectId=n}},He=class{constructor(e,n){this.isDraped=e,this.domain=n}},H=class yn extends He{constructor(e,n,s,i,r=3,a=!0,o=!0){super(i,r),this.type=e,this.lineStart=n,this.lineEnd=s,this.fadeLeft=a,this.fadeRight=o}equals(e){return e instanceof yn&&this.type===e.type&&$(this.lineStart,e.lineStart)&&$(this.lineEnd,e.lineEnd)&&this.fadeLeft===e.fadeLeft&&this.fadeRight===e.fadeRight}get length(){return oe(this.lineStart,this.lineEnd)}};class di extends gn{constructor(e){super({...e,isDraped:!0,constraint:new dn(e.edgeStart,e.edgeEnd,e.getGroundElevation)})}get hints(){return[new H(1,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}}let pi=class extends gn{constructor(e){super({...e,constraint:new ft(e.edgeStart,e.edgeEnd)})}get hints(){return[new H(1,this.constraint.start,this.constraint.end,this.isDraped,this.domain)]}},fi=class vn extends He{constructor(e,n,s=3){super(n,s),this.intersectionPoint=e}equals(e){return e instanceof vn&&$(this.intersectionPoint,e.intersectionPoint)}},Te=class extends se{constructor(e,n,s,i){super(e,new ne(e),i,3),this.first=n,this.second=s}get hints(){return this.first.targetPoint=this.targetPoint,this.second.targetPoint=this.targetPoint,[...this.first.hints,...this.second.hints,new fi(this.targetPoint,this.isDraped,this.domain)]}},gi=class extends se{constructor({lineStart:e,lineEnd:n,targetPoint:s,isDraped:i}){super(s,new hn(e,n),i,2),this._referenceLineHint=new H(2,e,n,i,this.domain)}get hints(){return[this._referenceLineHint,new H(0,this._lineEndClosestToTarget(),this.targetPoint,this.isDraped,this.domain)]}_lineEndClosestToTarget(){return this.constraint.closestEndTo(this.targetPoint)}},yi=class _n extends He{constructor(e,n,s,i=3){super(s,i),this.lineStart=e,this.lineEnd=n}equals(e){return e instanceof _n&&$(this.lineStart,e.lineStart)&&$(this.lineEnd,e.lineEnd)}},vi=class extends se{constructor({referenceLine:e,lineStart:n,targetPoint:s,isDraped:i}){const r=B(n),{left:a,right:o}=e;qe(r,is(r,r,o),a),super(s,new hn(n,r),i,2),this._referenceLines=[{edge:e,fadeLeft:!0,fadeRight:!0}]}get hints(){return[new H(0,this.constraint.start,this.targetPoint,this.isDraped,this.domain),new yi(this.constraint.start,this.targetPoint,this.isDraped,this.domain),...this._referenceLines.map(e=>new H(1,e.edge.left,e.edge.right,this.isDraped,this.domain,e.fadeLeft,e.fadeRight))]}addReferenceLine(e){const n={edge:e,fadeLeft:!0,fadeRight:!0};this._referenceLines.forEach(s=>{$(e.right,s.edge.left)&&(s.fadeLeft=!1,n.fadeRight=!1),$(e.right,s.edge.right)&&(s.fadeRight=!1,n.fadeRight=!1),$(e.left,s.edge.right)&&(s.fadeRight=!1,n.fadeLeft=!1),$(e.left,s.edge.left)&&(s.fadeLeft=!1,n.fadeLeft=!1)}),this._referenceLines.push(n)}},$n=class mn extends He{constructor(e,n,s,i,r=3){super(i,r),this.previousVertex=e,this.centerVertex=n,this.nextVertex=s}equals(e){return e instanceof mn&&$(this.previousVertex,e.previousVertex)&&$(this.centerVertex,e.centerVertex)&&$(this.nextVertex,e.nextVertex)}},_i=class extends se{constructor({targetPoint:e,constraint:n,previousVertex:s,otherVertex:i,otherVertexType:r,isDraped:a,selfSnappingType:o,objectId:u,domain:c}){super(e,n,a,c??2),this.previousVertex=s,this.otherVertex=i,this.otherVertexType=r,this.selfSnappingType=o??0,this.objectId=u??null}get hints(){const e=this.previousVertex,n=this.otherVertexType===1?this.otherVertex:this.targetPoint,s=this.otherVertexType===1?this.targetPoint:this.otherVertex;return[new H(0,n,s,this.isDraped,this.domain),new H(1,e,n,this.isDraped,this.domain),new $n(this.previousVertex,n,s,this.isDraped,this.domain)]}},$i=class extends se{constructor({targetPoint:e,point1:n,point2:s,isDraped:i}){super(e,new ln(rs(f(),n,s,.5),.5*as(n,s)),i,2),this._p1=n,this._p2=s}get hints(){return[new H(1,this.targetPoint,this._p1,this.isDraped,this.domain),new H(1,this.targetPoint,this._p2,this.isDraped,this.domain),new $n(this._p1,this.targetPoint,this._p2,this.isDraped,this.domain)]}};function _r(t,e,n,s){const i=n.projectToRenderScreen(t,wi),r=n.projectToRenderScreen(e,Si);return i==null||r==null?null:(J(s,r,i),os(s,s),s)}function mi(t,e,n,s,i=f()){const r=at(bi,t);return r[2]=Dt(s,r,e,n)||0,s.renderCoordsHelper.toRenderCoords(r,e,i),i}const bi=f(),wi=Ft(),Si=Ft();function xi(t,e,n,s){return s.type==="2d"?(_e.x=t[0],_e.y=t[1],_e.spatialReference=e,s.toScreen(_e)):(mi(t,e,n,s,Ct),s.state.camera.projectToScreen(Ct,Ue),us(Ue[0],Ue[1]))}const _e=ce(0,0,0,null),Ct=f(),Ue=cs();function $r(t){return Wt(t)||Bt(t)}function bn(t,e,n,...s){return Wt(t)?e.apply(void 0,s):t.isWebMercator?n.apply(void 0,s):null}const mr=1e5;function Ti(t){const{spatialReference:e}=t;return bn(e,zi,Ci,t)}function Pi(t,e){if(!he(t.spatialReference,e.spatialReference))return null;const{spatialReference:n}=t;return $e[0]=t.x,$e[1]=t.y,$e[2]=t.hasZ?t.z:0,me[0]=e.x,me[1]=e.y,me[2]=e.hasZ?e.z:0,wn($e,me,n)}function wn(t,e,n){return bn(n,Mi,Ri,t,e,n)}const Ei={geodesicLength:Ti,geodesicDistanceBetweenPoints:Pi,geodesicDistance:wn};async function Li(){return await Ts(),Ei}function Mi(t,e,n){return R(ot(qi,t,e,n).distance,"meters")}function Ri(t,e,n){return R(Ut(Di(t,e,n),{unit:"meters"}),"meters")}function zi(t){return R(ls([t],"meters")[0],"meters")}function Ci(t){return R(Ut(t,{unit:"meters"}),"meters")}function Di(t,e,n){return new hs({spatialReference:n,paths:[[[...t],[...e]]]})}const qi=new ut,$e=f(),me=f();let V=class extends ds{constructor(t){super(t),this.options=new S,this._engineCache=new Map,this._loadTask=null,this._engines=[],this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=0}initialize(){this.addHandles([Ye(()=>{const{distance:t,touchSensitivityMultiplier:e,effectiveSelfEnabled:n,effectiveFeatureEnabled:s,effectiveGridEnabled:i}=this.options;return{selfEnabled:n,featureEnabled:s,gridEnabled:this.view.type==="2d"&&i,viewReady:this.view.ready,viewSpatialReference:this.view.spatialReference,distance:t,touchSensitivityMultiplier:e}},(t,e)=>{var n;e&&(this.doneSnapping(),this.emit("changed")),(n=this._loadTask)==null||n.abort(),this._loadTask=ps(s=>this._updateEngines(t,e,s))},Ot),Ye(()=>this.options,t=>{for(const e of this._engines)e.options=t},fs)])}destroy(){var t;(t=this._loadTask)==null||t.abort(),this._destroyEngines()}get updating(){var t;return this._engines.some(e=>e.updating)||!((t=this._loadTask)!=null&&t.finished)}_destroyEngines(){this._engineCache.forEach(t=>t.destroy()),this._engineCache.clear(),this._engines=[]}async _updateEngines(t,e,n){var r;if(!t.viewReady)return void this._destroyEngines();(e==null?void 0:e.viewSpatialReference)!==t.viewSpatialReference&&this._destroyEngines();const s=this._engineCache,i=await Promise.allSettled([t.featureEnabled&&!s.has("feature")?this._createFeatureSnappingEngine(n):void 0,t.selfEnabled&&!s.has("self")?this._createSelfSnappingEngine(n):void 0,t.gridEnabled&&!s.has("grid")?this._createGridSnappingEngine(n):void 0]);if(n.aborted)for(const a of i)a.status==="fulfilled"&&((r=a.value)==null||r.engine.destroy());else{for(const a of i)a.status==="fulfilled"&&a.value&&s.set(a.value.type,a.value.engine);this._engines=Array.from(s.values())}}async _createSelfSnappingEngine(t){const[{SelfSnappingEngine:e},n]=await Promise.all([Ae(()=>import("./SelfSnappingEngine.js"),__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17]),import.meta.url),Li()]);return Ze(t),{type:"self",engine:new e({view:this.view,options:this.options,geodesicLengthMeasurementUtils:n})}}async _createGridSnappingEngine(t){const{view:e}=this;if(e.type!=="2d")return;const{GridSnappingEngine:n}=await Ae(()=>import("./GridSnappingEngine.js"),__vite__mapDeps([18,1,2,3,4,5,6,7,8,9,10,11,12,13,19,15,16,17]),import.meta.url);return Ze(t),{type:"grid",engine:new n({view:e,options:this.options})}}async _createFeatureSnappingEngine(t){const{FeatureSnappingEngine:e}=await Ae(()=>import("./FeatureSnappingEngine.js"),__vite__mapDeps([20,2,3,1,4,5,6,7,8,9,10,11,12,13,21,15,16,17]),import.meta.url);Ze(t);const{view:n,options:s}=this,{spatialReference:i}=n;return{type:"feature",engine:new e({view:n,options:s,spatialReference:i})}}get _squaredMouseProximityThreshold(){return this.options.distance*this.options.distance}get _squaredTouchProximityThreshold(){const{distance:t,touchSensitivityMultiplier:e}=this.options,n=t*e;return n*n}snap(t){return Oi(t)?this._snapMultiPoint(t):this._snapSinglePoint(t)}update(t){const{point:e,context:n}=t;this._removeVisualization();const s=this._currentMainCandidate;if(s==null)return e;const i=this._selectUpdateInput(t);if(i==null)return e;const{spatialReference:r}=n,a=St(i,r);if(a==null)return e;const{view:o}=this,{elevationInfo:u,visualizer:c}=n,h=[],p=re(a,o,u),y=s.constraint.closestTo(p);if(!this._arePointsWithinScreenThreshold(p,y,n)||!Ke(s,n.drawConstraints))return this._resetSnappingState(),e;s.targetPoint=We(y),h.push(...s.hints);for(const g of this._currentOtherActiveCandidates)Ke(g,n.drawConstraints)&&(g.targetPoint=We(y),h.push(...g.hints));return c!=null&&this.addHandles(c.draw(h,{spatialReference:r,elevationInfo:ji(n),view:o,selfSnappingZ:n.selfSnappingZ}),Je),Tt(y,o,e,n)}doneSnapping(){this._removeVisualization(),this._resetSnappingState()}_selectUpdateInput({point:t,scenePoint:e}){switch(this._currentSnappedType){case 0:return t;case 1:return e}}_resetSnappingState(){this._currentMainCandidate=null,this._currentOtherActiveCandidates=[],this._currentSnappedType=0}_removeVisualization(){this.removeHandles(Je)}async _snapSinglePoint({point:t,context:e,signal:n}){const{view:s}=this,{elevationInfo:i}=e,r=re(t,s,i),a=await this._fetchCandidates(r,3,e,n);return this._createSnapResult(r,0,a,s,t,e,n)}async _snapMultiPoint({point:t,scenePoint:e,context:n,signal:s}){const{view:i}=this,{coordinateHelper:r,elevationInfo:a,spatialReference:o}=n;await gs(e.spatialReference,o);const u=St(e,o),c=re(u,i,a),h=await this._fetchCandidates(c,1,n,s);if(h.length>0){const g=await this._fetchCandidates(c,2,n,s);return this._createSnapResult(c,1,[...h,...g],i,u,n,s)}const p=re(t,i,a),y=await this._fetchCandidates(p,2,n,s);return this._createSnapResult(p,0,y,i,{z:r.hasZ()&&t.hasZ?t.z??0:void 0,m:r.hasM()&&t.hasM?t.m??0:void 0},n,s)}async _fetchCandidates(t,e,n,s){return(await Promise.all(this._engines.map(i=>i.fetchCandidates(t,e,n,s)))).flat()}_createSnapResult(t,e,n,s,i,r,a){return{get valid(){return!ys(a)},apply:()=>{const{spatialReference:o}=r,{snappedPoint:u,hints:c}=this._processCandidates(t,e,n,r);return this._removeVisualization(),r.visualizer!=null&&this.addHandles(r.visualizer.draw(c,{spatialReference:o,elevationInfo:ee,view:s,selfSnappingZ:r.selfSnappingZ}),Je),Tt(u,s,i,r)}}}_processCandidates(t,e,n,s){if(n.length<1)return this.doneSnapping(),{snappedPoint:t,hints:[]};this._currentSnappedType!==e&&this._resetSnappingState(),Ms(t,n);const i=this._currentMainCandidate;if(i!=null){const r=Ni(i,n);if(r>=0){if(!(n[r]instanceof Te))return this._intersectWithOtherCandidates(r,n,t,e,s);if(this._arePointsWithinScreenThreshold(t,i.targetPoint,s))return this._updateSnappingCandidate(i,e,n,s)}}return this._intersectWithOtherCandidates(0,n,t,e,s)}_intersectWithOtherCandidates(t,e,n,s,i){const{coordinateHelper:r}=i,a=e[t],o=[];for(let u=0;u<e.length;++u){if(u===t)continue;const c=e[u],h=a.constraint.intersect(c.constraint);if(h)for(const p of h.closestPoints(a.targetPoint))o.push([new Te(We(p),a,c,c.isDraped),this._squaredScreenDistance(n,p,r)])}return o.length>0&&(o.sort((u,c)=>u[1]-c[1]),o[0][1]<this._squaredPointProximityThreshold(i.pointer))?this._updateSnappingCandidate(o[0][0],s,e,i):Ke(a,i.drawConstraints)?this._updateSnappingCandidate(a,s,e,i):{snappedPoint:n,hints:[]}}_updateSnappingCandidate(t,e,n,s){this.doneSnapping(),this._currentMainCandidate=t,this._currentSnappedType=e;const i=this._currentMainCandidate.targetPoint,r=[];r.push(...t.hints);for(const a of n){if(t instanceof Te){if(a.constraint.equals(t.first.constraint)||a.constraint.equals(t.second.constraint))continue}else if(a.constraint.equals(t.constraint))continue;const o=a.constraint.closestTo(i);this._squaredScreenDistance(o,i,s.coordinateHelper)<ki()&&(a.targetPoint=i,this._currentOtherActiveCandidates.push(a),r.push(...a.hints))}return{snappedPoint:i,hints:r}}_squaredPointProximityThreshold(t){return t==="touch"?this._squaredTouchProximityThreshold:this._squaredMouseProximityThreshold}_arePointsWithinScreenThreshold(t,e,n){return this._squaredScreenDistance(t,e,n.coordinateHelper)<this._squaredPointProximityThreshold(n.pointer)}_squaredScreenDistance(t,e,n){return Kt(this._toScreen(t,n),this._toScreen(e,n))}_toScreen(t,e){return xi(t,e.spatialReference,ee,this.view)}get test(){}};l([d({constructOnly:!0})],V.prototype,"view",void 0),l([d()],V.prototype,"options",void 0),l([d({readOnly:!0})],V.prototype,"updating",null),l([d()],V.prototype,"_loadTask",void 0),l([d()],V.prototype,"_engines",void 0),l([d()],V.prototype,"_squaredMouseProximityThreshold",null),l([d()],V.prototype,"_squaredTouchProximityThreshold",null),V=l([le("esri.views.interactive.snapping.SnappingManager")],V);const Je="visualization-handle";function ki(){return Re.satisfiesConstraintScreenThreshold*Re.satisfiesConstraintScreenThreshold}function Ke(t,e){return!e||e.direction==null&&e.distance==null||!(t instanceof di||t instanceof pi||t instanceof gi||t instanceof vi||t instanceof $i)&&(!(t instanceof _i)||e.direction==null&&t.selfSnappingType===1)}function Ni(t,e){return t instanceof Te?Xe(e,t.first)>=0&&Xe(e,t.second)>=0?0:-1:Xe(e,t)}function Xe(t,e){let n=-1;for(let s=0;s<t.length;++s)if(e.constraint.equals(t[s].constraint)){n=s;break}return n}function Oi(t){return t.scenePoint!=null}function ji({coordinateHelper:t,elevationInfo:e}){return t.hasZ()?ee:e}function Sn(t){return $s(t)?ms(t)||Bt(t)||bs(t)||ws(t)?vs:t:_s(t)}function br(t){return Hi(t)}function Hi(t,e){const{hasZ:n,spatialReference:s}=t,i=Sn(s);let r=0;const a=Gt(i);if(a==null)return null;const o=xn;for(const u of t.paths){if(u.length<2)continue;const c=u.length-1;for(let h=0;h<c;++h){const p=u[h];m[0]=p[0],m[1]=p[1],m[2]=n?p[2]:0;const y=u[h+1];b[0]=y[0],b[1]=y[1],b[2]=n?y[2]:0;const g=o(m,b,s);if(g==null)return null;r+=g.value}}return R(r,a)}function wr(t,e){const{spatialReference:n}=t;return he(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,b[0]=e.x,b[1]=e.y,b[2]=e.hasZ?e.z:0,Ii(m,b,n)):null}function Sr(t,e){const{spatialReference:n}=t;return he(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,b[0]=e.x,b[1]=e.y,b[2]=e.hasZ?e.z:0,Ai(m,b,n)):null}function xr(t,e){const{spatialReference:n}=t;return he(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,b[0]=e.x,b[1]=e.y,b[2]=e.hasZ?e.z:0,xn(m,b,n)):null}function Tr(t,e){const{spatialReference:n}=t;return he(n,e.spatialReference)?(m[0]=t.x,m[1]=t.y,m[2]=t.hasZ?t.z:0,b[0]=e.x,b[1]=e.y,b[2]=e.hasZ?e.z:0,Zi(m,b,n)):null}function Pr(t){return t!=null?Vi(t.hasZ?t.z:0,t.spatialReference):null}function Vi(t,e){const n=Ss(e);return n!=null?R(t??0,n):null}function Ii(t,e,n){const s=Ve(t,e,n);return s!=null?{direct:R(s.direct,s.unit),horizontal:R(s.horizontal,s.unit),vertical:R(s.vertical,s.unit)}:null}function Ai(t,e,n){const s=Ve(t,e,n,0);return s!=null?R(s.direct,s.unit):null}function xn(t,e,n){const s=Ve(t,e,n,1);return s!=null?R(s.horizontal,s.unit):null}function Zi(t,e,n){const s=Ve(t,e,n,2);return s!=null?R(s.verticalSigned,s.unit):null}function Ve(t,e,n,s){const i=Sn(n),r=Gt(i);if(r==null)return null;const a=e[2]-t[2];if(s===2)return{verticalSigned:a,unit:r};if(!Fe(t,n,Qe,i)||!Fe(e,n,be,i))return null;if(s===0)return{direct:oe(be,Qe),unit:r};if(K(we,t[0],t[1],e[2]),!Fe(we,n,we,i))return null;const o=oe(we,be);return s===1?{horizontal:o,unit:r}:{direct:oe(be,Qe),horizontal:o,vertical:Math.abs(a),unit:r}}const m=f(),b=f(),Qe=f(),be=f(),we=f();export{re as $,yi as A,$n as B,ar as C,xt as D,_i as E,ur as F,xi as G,nr as H,_r as I,Xi as J,Qi as K,Ki as L,mi as M,Ui as N,Pr as O,$r as P,Kt as Q,or as R,ir as S,tn as T,vi as U,$i as V,rr as W,Sr as X,mr as Y,xn as Z,Ai as _,br as a,Tt as a0,Fs as a1,ln as a2,$t as a3,Vs as a4,Ws as a5,Vi as a6,D as a7,Tr as a8,Zi as a9,wr as aa,gi as b,Ji as c,tr as d,We as e,L as f,Li as g,di as h,W as i,pi as j,X as k,Jt as l,xr as m,Te as n,gn as o,Re as p,V as q,ne as r,He as s,sr as t,S as u,Sn as v,bn as w,fi as x,Ms as y,H as z};
