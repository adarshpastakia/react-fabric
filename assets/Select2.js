import{t as cr,bR as dr,_ as ve,r as c,s as tr,j as d,m as X,l as ne,bS as pr,bT as $e,aA as ar,bl as Fe,bx as Se,bQ as Ae,bk as z,aO as ke,aQ as he,G as vr}from"./iframe-6XIGnDH8.js";import{n as fr}from"./nodeCheck.js";import{_ as ue,C as He}from"./index2.js";import{T as gr,I as Re}from"./Tooltip.js";import{g as mr,b as hr,B as De}from"./Button.js";import{D as yr}from"./DropdownTool.js";import{a as br,u as Or,o as jr,F as Pr,_ as xr,D as Dr,Y as wr,b as Cr,B as qe,T as Ve,C as Sr}from"./BasePanel.js";import{u as Me}from"./useDebounce.js";import{C as kr}from"./Content.js";import{S as Er}from"./Section.js";import{P as J,D as ee}from"./Google.js";import{e as Ee}from"./endOfDay.js";import{e as Tr,a as Be,d as Nr,i as Ir}from"./zh-CN.js";import{u as Fr}from"./Global.js";import{i as Ye}from"./getDay.js";import{c as Rr}from"./cloneElement.js";import{F as Mr,I as or}from"./InputWrapper.js";import{u as $r}from"./eventHandlers.js";import{a as Ar,s as Hr,f as qr,o as Vr,b as Br,c as Yr,d as Kr,e as Qr,g as zr,F as Ur,h as Gr}from"./floating-ui.react.js";import{E as Lr}from"./EmptyContent.js";import{m as Wr,c as Jr}from"./isEqual.js";import{d as Ke,g as Xr}from"./dedupe.js";function Qe(t,e,n){const r=cr(t,n==null?void 0:n.in);return isNaN(+r)?dr(t,NaN):(r.setFullYear(e),r)}var Zr=["ref","as","id","className","label","icon","iconBg","iconColor","rtlFlip","badge","disabled","onClose","active","onClick","tabFlex","color","actions","tooltip","activeClassName"];function ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function je(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ze(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ze(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var _r=function(e){var n=e.ref,r=e.as,l=e.id,f=e.className,O=e.label,g=e.icon,w=e.iconBg,P=e.iconColor,H=e.rtlFlip,C=e.badge,m=e.disabled,A=e.onClose,b=e.active,h=e.onClick,y=e.tabFlex,S=e.color,p=e.actions,i=e.tooltip,j=e.activeClassName,D=ve(e,Zr),N=c.useMemo(function(){return mr(C)},[C]),I=c.useMemo(function(){return!O},[O]),x=c.useMemo(function(){return tr(i)?{content:i}:i??{}},[i]),F=r??"button",k=i?gr:c.Fragment;return d.jsx(k,je(je({},x),{},{children:d.jsxs(F,je(je({"data-id":l,disabled:m,"data-color":S,"data-inner-clickable":!0,className:X("fabric-tabButton",f,b&&"active pointer-events-none",b&&j,m&&"text-tint-500 pointer-events-none",y?"flex-1":"flex-initial max-w-36",I?"min-w-6 rounded":"min-w-18 rounded-capped","flex items-center justify-center px-1 overflow-hidden cursor-pointer"),onClick:function(){return!b&&(h==null?void 0:h(l))},ref:n},D),{},{children:[g&&d.jsx(Re,{icon:g,bg:w,color:P,rtlFlip:H,className:"flex-content p-2"}),!I&&d.jsx("label",{className:"flex-initial truncate text-center px-1 py-1",children:O}),C&&d.jsx(hr,je(je({},N),{},{placement:I?"end":"",className:X("me-1",N.className)})),p&&b&&d.jsx(yr,{className:"bg-tint-50/20 me-1 z-5",children:p}),A&&d.jsx("span",{role:"none",className:X("cursor-pointer me-1 opacity-65 hover:opacity-90 pointer-events-auto"),onClick:function(G){A==null||A(),G.stopPropagation()},children:"Ã—"})]}))}))},qn=function(e){var n=e.children,r=e.headerClassName,l=e.orientation,f=l===void 0?"top":l,O=e.activeTab,g=e.activeClassName,w=e.justify,P=e.variant,H=e.tabFlex,C=e.append,m=e.prepend,A=e.gap,b=e.onBeforeChange,h=e.onChange,y=c.useState(),S=ne(y,2),p=S[0],i=S[1],j=c.useMemo(function(){return c.Children.toArray(n).reduce(function(k,M){return fr(M,_r)?k[0].push(M):k[1].push(M),k},[[],[]])},[n]),D=ne(j,2),N=D[0],I=D[1];c.useEffect(function(){i(O)},[O]);var x=c.useMemo(function(){var k;return(k=N.find(function(M){return M.props.id===p}))===null||k===void 0?void 0:k.props.children},[N,p]),F=c.useCallback(function(k){Promise.resolve(b==null?void 0:b(k,p)).then(function(M){M!==!1&&(i(k),h==null||h(k))})},[b,h,p]);return d.jsxs("div",{className:X("fabric-tabPanel","area-content grid bg-base overflow-hidden"),"data-orientation":f,"data-variant":P??"default",children:[d.jsxs("div",{className:X("fabric-tabHeader",r,w&&"justify-".concat(w),["start","end"].includes(f)&&"flex-col","flex flex-nowrap overflow-hidden items-center"),children:[m,d.jsx("div",{className:X("fabric-tabList",w&&"justify-".concat(w),["start","end"].includes(f)&&"flex-col",["bottom","end"].includes(f)?"self-start":"self-end","flex flex-1 flex-nowrap overflow-auto scroll-thin"),style:{gap:A},children:N.map(function(k){var M,G;return c.cloneElement(k,{tabFlex:(M=k.props.tabFlex)!==null&&M!==void 0?M:H,activeClassName:(G=k.props.activeClassName)!==null&&G!==void 0?G:g,onClick:F,active:k.props.id===p})})}),C]}),I,x]})},en=["name","children"],rn=["ref","onChange"];function Ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Pe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ue(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Vn=function(e){var n=e.name,r=e.children,l=ve(e,en);if(!n)throw Error("Form Controller missing `name` prop");return d.jsx(br,{name:n,render:function(O){var g,w=O.field,P=w.ref,H=w.onChange,C=ve(w,rn),m=O.fieldState.error,A=O.formState.isSubmitting;return c.isValidElement(r)?c.cloneElement(c.Children.only(r),Pe(Pe(Pe({},C),l),{},{ref:function(h){h&&P(h);try{var y;r.props.ref&&"current"in r.props.ref&&(r.props.ref.current=h),(y=r.props.ref)!==null&&y!==void 0&&y.prototype&&r.props.ref(h)}catch{}},checked:!!C.value,readOnly:A||r.props.readOnly,invalid:!!(m!=null&&m.message)||r.props.invalid,error:(g=m==null?void 0:m.message)!==null&&g!==void 0?g:r.props.error,onChange:function(h){var y,S;H(h),(y=(S=r.props).onChange)===null||y===void 0||y.call(S,h)}})):r(Pe(Pe(Pe({},C),l),{},{ref:function(h){h&&P(h)},readOnly:A,invalid:!!(m!=null&&m.message),checked:!!C.value,error:m==null?void 0:m.message,onChange:function(h){H(h)}}))}})},nn=["formRef","schema","children","defaultValues","onSubmit","onChange"];function Ge(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ge(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var tn=function(){},Bn=function(e){var n=e.formRef,r=e.schema,l=e.children,f=e.defaultValues,O=f===void 0?pr:f,g=e.onSubmit,w=g===void 0?tn:g,P=e.onChange,H=ve(e,nn),C=c.useRef(null),m=Or({shouldFocusError:!0,resolver:r&&jr(r),defaultValues:O}),A=c.useTransition(),b=ne(A,2),h=b[1],y=Me(P,[P],300);c.useEffect(function(){var i=m.watch(function(j){h(function(){return y==null?void 0:y(j)})});return function(){return i.unsubscribe()}},[m.watch,y]);var S=c.useCallback(function(){var i,j=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.reset(j),m.clearErrors(),(i=C.current)===null||i===void 0||(i=i.querySelector("[auto-focus], input, textarea"))===null||i===void 0||i.focus()},[O]);c.useImperativeHandle(n,function(){return{state:m.formState,reset:function(){return S(O)},clear:function(){return S()},submit:function(){return m.handleSubmit(w)},validate:function(){var i=xr($e.mark(function D(){return $e.wrap(function(I){for(;;)switch(I.prev=I.next){case 0:return I.next=2,m.trigger();case 2:return I.abrupt("return",I.sent);case 3:case"end":return I.stop()}},D)}));function j(){return i.apply(this,arguments)}return j}(),getValues:function(){return m.getValues()},setValues:function(j){return setTimeout(function(){return m.reset(j)},50)},setValue:function(j,D){return setTimeout(function(){return m.setValue(j,D,{shouldDirty:!1,shouldTouch:!1})},50)}}},[w,m,m.formState,O]);var p=c.useCallback(function(i,j){var D=j.target;setTimeout(function(){var N;return(N=D.querySelector("input[aria-invalid='true'],textarea[aria-invalid='true']"))===null||N===void 0?void 0:N.focus()},10)},[]);return d.jsx(Pr,Ce(Ce({},m),{},{children:d.jsxs("form",Ce(Ce({ref:C,onReset:function(){return S(O)},onSubmit:function(j){j.stopPropagation(),m.handleSubmit(w,p)(j)},"data-loading":m.formState.isSubmitting,className:"contents",autoComplete:"off"},H),{},{children:[l,d.jsx("input",{type:"submit",className:"absolute invisible"})]}))}))};function Le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function an(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Le(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var on=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],l=z(r);n.forEach(function(g){return l.push({label:g.label,hijri:g.hijri,icon:g.icon,start:Qe(ee.parseDate(g.start),e),end:Qe(ee.parseDate(g.end),e)})}),l.push({label:"superdate:event.newYear",start:Se(new Date("".concat(e-1,"-12-31"))),end:Ee(new Date("".concat(e,"-01-01")))}),l.push({label:"superdate:event.christmas",start:Se(new Date("".concat(e,"-12-24"))),end:Ee(new Date("".concat(e,"-12-26")))});var f=ee.startOfYear(new Date("".concat(e-1,"-12-31")),!0);f=ee.addMonths(f,8,!0),f.getFullYear()!==e&&(f=ee.addYears(f,f.getFullYear()>e?-1:1,!0));var O=ee.endOfMonth(f,!0);return l.push({label:"superdate:event.ramadan",start:Se(f),end:Ee(O)}),l.sort(function(g,w){return g.start.getTime()<w.start.getTime()?-1:1})},Yn=function(e){var n=e.isHijri,r=e.onChange,l=e.events,f=l===void 0?Fe:l,O=e.recurringEvents,g=O===void 0?Fe:O,w=ar(),P=w.t,H=c.useState({}),C=ne(H,2),m=C[0],A=C[1],b=c.useReducer(function(p,i){var j=!1;if(i.type==="init"&&(p.pageDate=new Date,j=!0),i.type==="changePage"&&(p.page=Math.max(i.page,J.MONTH)),i.type==="changePageDate"&&(j=!0,p.pageDate=i.date,i.changePage&&(p.page=Math.max(p.page-1,J.MONTH))),j){var D,N=p.pageDate.getFullYear();p.events=on(N,g??[],(D=m[N])!==null&&D!==void 0?D:[])}return an({},p)},{pageDate:new Date,page:J.MONTH,events:[]}),h=ne(b,2),y=h[0],S=h[1];return c.useEffect(function(){S({type:"init"})},[]),c.useEffect(function(){var p={};f.forEach(function(i){var j=Se(new Date(i.start)),D=Ee(new Date(i.end));p[j.getFullYear()]||(p[j.getFullYear()]=[]),p[j.getFullYear()].push(i),j.getFullYear()!==D.getFullYear()&&(p[D.getFullYear()]||(p[D.getFullYear()]=[]),p[D.getFullYear()].push(i))}),A(p)},[f]),d.jsxs(Er,{children:[d.jsx(Dr,{page:y.page,pageDate:y.pageDate,changePage:function(i){return S({type:"changePage",page:i})},changePageDate:function(i){return S({type:"changePageDate",date:i,changePage:!1})}}),y.page===J.MONTH&&d.jsx(kr,{className:"p-2 max-h-48",children:y.events.map(function(p){return d.jsxs("div",{role:"none","data-dropdown-dismiss":"true",onClick:function(){r==null||r("".concat(p.start.toISOString(),"|").concat(p.end.toISOString()),[p.start.toISOString(),p.end.toISOString()])},className:"text-sm my-1 py-1 px-2 flex flex-nowrap items-center cursor-pointer rounded hover:bg-primary-50",children:[d.jsx("div",{className:"flex-1 truncate",children:P(p.label,{defaultValue:p.label})}),d.jsxs("div",{className:"text-muted text-xs",children:[ee.format(p.start,Tr(p.start,p.end)?"dd":"dd/MMM",Ae.language,n),d.jsx("span",{children:" - "}),ee.format(p.end,"dd/MMM",Ae.language,n)]})]},p.label)})}),y.page===J.YEAR&&d.jsx(wr,{isHijri:n,page:y.page,pageDate:y.pageDate,changePageDate:function(i){return S({type:"changePageDate",date:i})}}),y.page===J.DECADE&&d.jsx(Cr,{isHijri:n,page:y.page,pageDate:y.pageDate,changePageDate:function(i){return S({type:"changePageDate",date:i})}})]})},ln=["className","max","min","dateDisabled","onChange","showHijriToggle","value","withTime","showApply"];function We(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?We(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Kn=function(e){var n=e.className,r=e.max,l=e.min,f=e.dateDisabled,O=e.onChange,g=e.showHijriToggle,w=e.value,P=e.withTime,H=e.showApply,C=H===void 0?!1:H,m=ve(e,ln),A=ar("date"),b=A.t,h=Fr(),y=h.currentCalendar,S=c.useState(y==="hijri"),p=ne(S,2),i=p[0],j=p[1],D=Me(O,[O]);c.useEffect(function(){j(y==="hijri")},[y]);var N=c.useReducer(function(a,u){if(u.type==="reset")if(ke(u.date))a.hilight=void 0,a.selected=void 0,a.start.pageDate=new Date,a.start.hour=0,a.start.minute=0,a.end.pageDate=ee.addMonths(new Date,1),a.end.hour=0,a.end.minute=0;else{var _=ne(u.date,2),ye=_[0],Z=_[1],s=new Date(ye),ie=new Date(Z);a.hilight=void 0,a.selected=[s,ie],a.start.pageDate=s,a.start.hour=s.getHours(),a.start.minute=s.getMinutes(),a.end.pageDate=ie,a.end.hour=ie.getHours(),a.end.minute=ie.getMinutes()}if(u.type==="changeDate")if(!a.hilight)a.hilight=[u.date,u.date],a.start.pageDate=u.date,a.end.pageDate=ee.addMonths(u.date,1,i);else{var se=Be(a.hilight[0],u.date),fe=se?u.date:a.hilight[0],be=se?a.hilight[0]:u.date;a.selected=[fe,be],a.hilight=void 0,a.start.pageDate=fe,a.end.pageDate=be}if(u.type==="changeHilight")if(a.hilight&&u.date){var le=ne(a.hilight,1),Oe=le[0];a.hilight=[Oe,u.date]}else a.hilight=void 0;if(u.type==="changeTime"){if(u.range==="start"&&(a.start.hour=u.hour,a.start.minute=u.minute,a.selected)){var o,v;(o=a.selected[0])===null||o===void 0||o.setHours(u.hour),(v=a.selected[0])===null||v===void 0||v.setMinutes(u.minute)}if(u.range==="end"&&(a.end.hour=u.hour,a.end.minute=u.minute,a.selected)){var R,K;(R=a.selected[1])===null||R===void 0||R.setHours(u.hour),(K=a.selected[1])===null||K===void 0||K.setMinutes(u.minute)}}return u.type==="changePage"&&(a[u.range].page=u.page),u.type==="changePageDate"&&(a[u.range].pageDate=u.date,u.pageChange&&(a[u.range].page=Math.max(a[u.range].page-1,0),u.range==="start"&&a.start.page===J.DATE&&(a.end.pageDate=Nr(u.date,1)))),(u.type==="changeDate"||u.type==="changeTime")&&(l&&a.selected&&Ir(a.selected[0],new Date(l))&&(a.selected[0]=new Date(l),a.start.hour=a.selected[0].getHours(),a.start.minute=a.selected[0].getMinutes()),r&&a.selected&&Be(a.selected[1],new Date(r))&&(a.selected[1]=new Date(r),a.end.hour=a.selected[1].getHours(),a.end.minute=a.selected[1].getMinutes()),!C&&a.selected&&!a.hilight&&(D==null||D([a.selected[0].toISOString(),a.selected[1].toISOString()]))),de({},a)},{start:{page:J.DATE,pageDate:new Date,hour:0,minute:0},end:{page:J.DATE,pageDate:ee.addMonths(new Date,1,i),hour:0,minute:0}}),I=ne(N,2),x=I[0],F=I[1];c.useEffect(function(){F({type:"reset",date:w})},[w]);var k=c.useCallback(function(a){return x.start.page===J.DATE&&he(f)?!!f.find(function(u){return Ye(new Date(u),a)}):ee.isDisabled(a,x.start.page,l,r)},[x.start.page,l,r,f]),M=c.useCallback(function(a){return x.end.page===J.DATE&&he(f)?!!f.find(function(u){return Ye(new Date(u),a)}):ee.isDisabled(a,x.end.page,l,r)},[x.end.page,l,r,f]),G=c.useCallback(function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;F({type:"changePageDate",pageChange:u,range:"start",date:a})},[]),q=c.useCallback(function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;F({type:"changePageDate",pageChange:u,range:"end",date:a})},[]),V=c.useCallback(function(a){F({type:"changeDate",date:a})},[]);return d.jsxs("div",de(de({className:X("block overflow-hidden bg-base rounded-capped",n)},m),{},{children:[d.jsxs("div",{className:"flex flex-nowrap",children:[d.jsx(qe,de(de({},x.start),{},{max:r,min:l,hideNext:!0,withTime:P,isHijri:i,hilight:x.hilight,selected:x.selected,selectDate:V,isDateDisabled:k,changeTime:function(u){return F(de({type:"changeTime",range:"start"},u))},changePage:function(u){return F({type:"changePage",range:"start",page:u})},mouseOver:function(u){return F({type:"changeHilight",date:u})},changePageDate:G})),d.jsx("div",{className:"border-s border-s-dimmed"}),d.jsx(qe,de(de({},x.end),{},{max:r,min:l,hidePrevious:!0,withTime:P,isHijri:i,hilight:x.hilight,selected:x.selected,selectDate:V,isDateDisabled:M,changeTime:function(u){return F(de({type:"changeTime",range:"end"},u))},changePage:function(u){return F({type:"changePage",range:"end",page:u})},mouseOver:function(u){return F({type:"changeHilight",date:u})},changePageDate:q}))]}),d.jsxs("div",{className:"border-t flex flex-nowrap justify-between px-2",children:[d.jsx("span",{children:g&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){j(!i)},children:b(i?"label.gregorian":"label.hijri")})}),x.start.page!==J.DATE&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return F({type:"changePage",range:"start",page:J.DATE})},children:b("core:action.cancel")}),x.end.page!==J.DATE&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return F({type:"changePage",range:"end",page:J.DATE})},children:b("core:action.cancel")}),x.hilight&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return F({type:"changeHilight"})},children:b("core:action.cancel")}),!x.hilight&&C&&d.jsx(De,{size:"sm",variant:"solid",color:"primary",disabled:!x.selected,"data-dropdown-dismiss":"true",className:"my-1",onClick:function(){var u,_;return D==null?void 0:D([(u=x.selected)===null||u===void 0?void 0:u[0].toISOString(),(_=x.selected)===null||_===void 0?void 0:_[1].toISOString()])},children:b("core:action.apply")})]})]}))},un=["children","vertical","noOutline","plain"];function Je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Xe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Je(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Qn=function(e){var n=e.children,r=e.vertical,l=e.noOutline,f=e.plain,O=ve(e,un);return d.jsx(Mr,Xe(Xe({},O),{},{children:d.jsx("div",{className:X("fabric-fieldGroup",!f&&!l&&"outline",!f&&"bg-base",f&&"flex-wrap","flex-1 rounded",!r&&"flex"),"data-vertical":!!r,children:Rr(n,function(g){return c.cloneElement(g,{"data-inner":!0})})})}))},sn=["ref","value","invalid","readOnly","disabled","required","placeholder","defaultValue","autoFocus","name","min","max","step","onBlur","onFocus","onChange","onEnterPressed"];function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function _e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ze(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var zn=function(e){var n=e.ref,r=e.value,l=e.invalid,f=e.readOnly,O=e.disabled,g=e.required,w=e.placeholder,P=e.defaultValue,H=e.autoFocus,C=e.name,m=e.min,A=e.max,b=e.step,h=e.onBlur,y=e.onFocus,S=e.onChange,p=e.onEnterPressed,i=ve(e,sn),j=c.useState(""),D=ne(j,2),N=D[0],I=D[1],x=c.useDeferredValue(r??P),F=$r(p);c.useEffect(function(){I(x??"")},[x]);var k=c.useCallback(function(M){var G,q=(G=M==null?void 0:M.target.valueAsNumber)!==null&&G!==void 0?G:P;I(q??""),S==null||S(q??null)},[S,P]);return d.jsx(or,_e(_e({showClear:!!N&&!O&&!f,onClear:k,invalid:l,readOnly:f,disabled:O,required:g},i),{},{children:d.jsx("input",{className:"appearance-none bg-transparent py-1 px-2 flex-1 border-none outline-none ring-0 peer","aria-invalid":l,"aria-disabled":O,"aria-readonly":f,placeholder:w,disabled:O,readOnly:f,"data-testid":C,name:C,type:"number",size:1,min:m,max:A,step:b,ref:n,autoComplete:"off",autoFocus:H,value:N,onBlur:h,onFocus:y,onChange:k,onKeyDown:F})}))},cn=["ref","style","items","active","className","itemRef","empty","valueProperty","labelProperty","itemProps","children"];function er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function xe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?er(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var dn=function(e){var n=e.ref,r=e.style,l=e.items,f=e.active,O=e.className,g=e.itemRef,w=e.empty;e.valueProperty;var P=e.labelProperty,H=P===void 0?"label":P,C=e.itemProps,m=e.children,A=ve(e,cn);return d.jsxs("div",xe(xe({ref:n,className:X("bg-base select-none overflow-x-hidden overflow-y-auto",O),style:r},A),{},{children:[l.length===0&&(w??d.jsx(Lr,{message:d.jsx(Ve,{i18nKey:"form:select.emptyList"})})),l.map(function(b,h){var y,S;return b.___group___?d.jsx("p",{className:"px-2 py-1 text-muted text-xs sticky -top-px z-2 bg-base border-t",children:b.label},h):b.___create___?d.jsx("div",xe(xe({role:"none",tabIndex:f===h?0:-1,ref:function(i){return g(h,i)},"data-active":f===h?!0:void 0,className:X("block text-start truncate px-2 py-1 leading-normal cursor-pointer select-none","data-[active]:bg-primary-200 data-[selected]:bg-primary-600 data-[selected]:text-white data-[active]:data-[selected]:underline")},C(b)),{},{children:d.jsx(Ve,{i18nKey:"form:select.createOption",values:{query:(y=b.value)!==null&&y!==void 0?y:b},components:[d.jsx("strong",{children:"query"},"t0")]})}),h):d.jsx("div",xe(xe({role:"none",tabIndex:f===h?0:-1,ref:function(i){return g(h,i)},"data-active":f===h?!0:void 0,className:X("block text-start truncate px-2 py-1 leading-normal cursor-pointer","data-[active]:bg-primary-200 data-[selected]:bg-primary-600 data-[selected]:text-white data-[active]:data-[selected]:underline")},C(b)),{},{children:m(b,(S=b[H])!==null&&S!==void 0?S:b)}),h)})]}))},pn=function(e){return e},vn=function(e,n){var r,l,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return he(e)?e.map(function(O){var g;return(g=O[f])!==null&&g!==void 0?g:O}):(r=(l=e==null?void 0:e[f])!==null&&l!==void 0?l:e)!==null&&r!==void 0?r:n};function rr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function U(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rr(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rr(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var fn=function(e){var n=e.options,r=n===void 0?Fe:n,l=e.value,f=e.defaultOpen,O=f===void 0?!1:f,g=e.autoComplete,w=e.multiple,P=w===void 0?!1:w,H=e.allowCreate,C=H===void 0?!1:H,m=e.groupProperty,A=m===void 0?"":m,b=e.valueProperty,h=b===void 0?"id":b,y=e.labelProperty,S=y===void 0?"label":y,p=e.sortProperty,i=e.createOption,j=i===void 0?pn:i,D=e.matcher,N=e.onQuery,I=e.onChange,x=e.onSelect,F=c.useMemo(function(){return P?[]:""},[P]),k=c.useDeferredValue(l??F),M=c.useRef([]),G=c.useRef(null),q=c.useRef([]),V=c.useRef([]),a=c.useCallback(function(o,v){var R,K;return(R=D==null?void 0:D(o,v))!==null&&R!==void 0?R:Wr((K=o[S])!==null&&K!==void 0?K:o,v)},[D]),u=c.useCallback(function(o){setTimeout(function(){x==null||x(o??F),I==null||I(vn(o,F,h))},50)},[F,x,I]),_=c.useReducer(function(o,v){if(v.type==="open"){var R=o.items.indexOf(o.multiple?o.value[0]:o.value);return U(U({},o),{},{open:!0,activeIndex:R>-1?R:null})}if(v.type==="close")return U(U({},o),{},{activeIndex:null,open:!1});if(v.type==="active"&&o.open)return g&&v.index!==null&&(o.query=o.items[v.index]),U(U({},o),{},{activeIndex:v.index});if(v.type==="setValue")return U(U({},o),{},{value:v.value,selectedIndex:o.items.indexOf(o.multiple?v.value[0]:v.value)});if(v.type==="changeValue"){var K,B=U(U({},o),{},{value:o.emptyValue,activeIndex:null,selectedIndex:g?o.multiple?(K=v.value)===null||K===void 0?void 0:K.length:0:o.items.indexOf(v.value)});if(v.value!==void 0)if(P){var Q=[];tr(v.value)?Q.push.apply(Q,z(v.value.split(/,\s?/))):Q.push(v.value),B.value=z(o.value),Q.forEach(function(ae){var ce,ge;B.value=(ce=(ge=B.value).includes)!==null&&ce!==void 0&&ce.call(ge,ae)?B.value.filter(function(me){return me!==ae}):[].concat(z(B.value),[ae])})}else B.value=v.value;return o.multiple||(B.open=!1),u(B.value),B}if(v.type==="removeItem"){var re=o.value;if(o.multiple){var L;re=z(re),re.splice((L=v.index)!==null&&L!==void 0?L:-1,1)}else re="";return u(re),U(U({},o),{},{value:re})}if(v.type==="startQuery")return U(U({},o),{},{loading:!0,query:v.query});if(v.type==="options"){var W=U(U({},o),{},{loading:!1,query:v.query}),te=z(v.options);g&&v.query!==void 0&&(te=Ke([v.query].concat(z(te)))),p&&(te=te.sort(Jr("asc",p)));var Te=Xr(te,A,"");if(v.open&&(W.open=!0),W.items=[],C&&v.query&&W.items.push({___create___:!0,value:v.query}),Object.entries(Te).forEach(function(ae){var ce,ge=ne(ae,2),me=ge[0],Ne=ge[1];me&&W.items.push({___group___:!0,label:me}),(ce=W.items).push.apply(ce,z(Ne))}),v.setActive){var we=W.items.findIndex(function(ae){return!ae.___group___});W.activeIndex=we>=0?we:null}else W.activeIndex=null;return q.current=W.items,W}return o},{multiple:P,emptyValue:F,open:O,loading:!1,activeIndex:null,selectedIndex:null,value:F,query:void 0,items:[]}),ye=ne(_,2),Z=ye[0],s=ye[1];c.useEffect(function(){if(!P){var o,v=(C||g)&&k?j(k):void 0,R=r.find(function(B){var Q;return((Q=B[h])!==null&&Q!==void 0?Q:B)===k});V.current=r,!R&&v&&(V.current=[v].concat(z(r??[]))),s({type:"options",options:V.current}),s({type:"setValue",value:(o=R??v)!==null&&o!==void 0?o:k})}if(P){V.current=[];var K=(he(k)?k:[]).map(function(B){var Q,re=(C||g)&&B?j(B):void 0,L=r.find(function(W){var te;return((te=W[h])!==null&&te!==void 0?te:W)===B});return!L&&re&&V.current.push(re),(Q=L??re)!==null&&Q!==void 0?Q:B});V.current=[].concat(z(V.current),z(r??[])),s({type:"options",options:V.current}),s({type:"setValue",value:K})}},[k,r,P,C,g,j]);var ie=Me(function(o){Promise.resolve(N==null?void 0:N(o)).then(function(v){var R=z(v);g&&R.push.apply(R,z(V.current.filter(function(K){return a==null?void 0:a(K,o)}))),s({type:"options",query:o,options:R,open:!0,setActive:!0})})},[N],300),se=c.useCallback(function(o){if(!o)s({type:"options",query:"",options:V.current});else{if(N)return s({type:"startQuery",query:o}),ie(o);s({type:"options",query:o,open:!0,setActive:!0,options:V.current.filter(function(v){return a==null?void 0:a(v,o)})})}},[a,N]),fe=c.useCallback(function(o){var v=o;if(g&&P&&o&&(v=o.split(/,\s?/)),s({type:"changeValue",value:o!=null&&o.___create___?o.value:o}),o!=null&&o.___create___){var R=[o.value];P&&(R=o.value.split(/,\s?/)),V.current=[].concat(z(V.current),z(R.map(j)))}g&&(V.current=Ke([].concat(z(he(v)?v:[v]),z(V.current)))),s({type:"options",options:V.current})},[]),be=c.useCallback(function(o){s({type:"removeItem",index:o})},[]),le=c.useCallback(function(o){s({type:o?"open":"close"}),s({type:"options",query:void 0,options:V.current})},[]),Oe=c.useCallback(function(o){s({type:"active",index:o})},[]);return{state:Z,listRef:M,focusableRef:G,listContentRef:q,handleChange:fe,handleRemove:be,handleQuery:se,macthOption:a,setActiveIndex:Oe,setOpen:le,setItemRef:function(v,R){M.current[v]=R}}},gn=["ref","name","value","invalid","readOnly","disabled","required","placeholder","autoFocus","error","options","defaultOpen","hideHandle","groupProperty","labelProperty","valueProperty","sortProperty","multiple","searchable","allowCreate","emptyDisplay","createOption","matcher","renderer","onQuery","onChange","onSelect","onEnterPressed"];function nr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function pe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nr(Object(n),!0).forEach(function(r){ue(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Un=function(e){var n,r,l=e.ref,f=e.name,O=e.value,g=e.invalid,w=e.readOnly,P=e.disabled,H=e.required,C=e.placeholder,m=e.autoFocus,A=e.error,b=e.options,h=e.defaultOpen,y=e.hideHandle,S=e.groupProperty,p=e.labelProperty,i=p===void 0?"label":p,j=e.valueProperty,D=j===void 0?"id":j,N=e.sortProperty,I=e.multiple,x=e.searchable,F=e.allowCreate,k=e.emptyDisplay,M=e.createOption,G=e.matcher,q=e.renderer,V=e.onQuery,a=e.onChange,u=e.onSelect,_=e.onEnterPressed,ye=ve(e,gn),Z=fn({value:O,options:b,multiple:I,defaultOpen:h,groupProperty:S,labelProperty:i,valueProperty:D,sortProperty:N,allowCreate:F,createOption:M,matcher:G,onChange:a,onSelect:u,onQuery:V}),s=Z.state,ie=Z.listRef,se=Z.listContentRef,fe=Z.setOpen,be=Z.macthOption,le=Z.handleChange,Oe=Z.handleRemove,o=Z.handleQuery,v=Z.setItemRef,R=Z.setActiveIndex,K=c.useId(),B=Ar({open:s.open,onOpenChange:function($,E,Y){!$&&(ie.current=[]),fe($)},strategy:"fixed",placement:"bottom",whileElementsMounted:vr,middleware:[Hr({padding:8}),qr(),Vr(2)]}),Q=B.context,re=B.floatingStyles,L=B.refs,W=Br(Q,{}),te=Yr(Q,{}),Te=Kr(Q,{listRef:ie,activeIndex:s.activeIndex,selectedIndex:s.selectedIndex,loop:!0,virtual:!0,focusItemOnOpen:!1,onNavigate:R}),we=Qr(Q,{listRef:se,activeIndex:s.activeIndex,selectedIndex:s.selectedIndex,findMatch:function($,E){return $.find(function(Y){return be(Y,E)})},onMatch:function($){s.open&&R($),!x&&!I&&!s.open&&le(se.current[$])}}),ae=zr([te,x?void 0:W,Te,we]),ce=ae.getReferenceProps,ge=ae.getFloatingProps,me=ae.getItemProps,Ne=c.useMemo(function(){var T=ce();return pe(pe({},T),{},{onBlur:function(E){var Y;if((Y=E.relatedTarget)!==null&&Y!==void 0&&Y.closest('[data-select-dropdown="'.concat(K,'"]'))){var oe;(oe=L.domReference.current)===null||oe===void 0||(oe=oe.querySelector("input"))===null||oe===void 0||oe.focus();return}o(""),fe(!1)},onKeyDown:function(E){if(E.key==="Enter"){if(s.activeIndex!==null)return le(se.current[s.activeIndex]),E.preventDefault(),E.stopPropagation(),!1;if(s.query)return o(""),E.preventDefault(),E.stopPropagation(),!1;_==null||_(E)}else E.key==="Tab"&&s.activeIndex!==null?le(se.current[s.activeIndex]):E.key==="Backspace"?!s.query&&Oe():(!x||["ArrowUp","ArrowDown"].includes(E.key))&&(["ArrowUp","ArrowDown"].includes(E.key)&&s.activeIndex===null&&R(s.selectedIndex),setTimeout(function(){var Y;(Y=T.onKeyDown)===null||Y===void 0||Y.call(T,E)},50))}})},[ce,_,o,L,s.query,s.activeIndex]),ir=c.useMemo(function(){return ge({"data-select-dropdown":K})},[ge]),lr=c.useCallback(function(T){var $,E,Y=he(s.value)?($=s.value)===null||$===void 0||(E=$.includes)===null||E===void 0?void 0:E.call($,T):s.value===T;return me({"data-selected":Y?!0:void 0,onClick:function(){le(T)}})},[me,le,s.value]),ur=c.useMemo(function(){if(he(s.value))return s.value.map(function(E,Y){var oe,Ie;return d.jsx(Sr,{onRemove:function(){return Oe(Y)},children:(oe=(Ie=q==null?void 0:q(E))!==null&&Ie!==void 0?Ie:E[i])!==null&&oe!==void 0?oe:E},Y)});if(!ke(s.value)&&!s.query){var T,$;return d.jsx("span",{className:"self-center pointer-events-none select-none",children:(T=($=q==null?void 0:q(s.value))!==null&&$!==void 0?$:s.value[i])!==null&&T!==void 0?T:s.value})}},[s.value,s.query,C,q]),sr=c.useCallback(function(){var T;fe(!0),(T=L.domReference.current)===null||T===void 0||(T=T.querySelector("input"))===null||T===void 0||T.focus()},[]);return c.useLayoutEffect(function(){s.open&&setTimeout(function(){var T;s.selectedIndex&&((T=ie.current[s.selectedIndex])===null||T===void 0||T.scrollIntoView({block:"center"}))},100)},[s.open]),d.jsxs(or,pe(pe({showClear:!ke(s.value),onClear:le,invalid:g,readOnly:w,disabled:P,required:H,error:A,wrapperRef:L.setReference,className:s.open?"!z-[99]":""},ye),{},{children:[d.jsxs("div",pe(pe({role:"none","data-select-display":"true",className:X("group flex-1 py-1 px-2 truncate text-start flex gap-1 relative min-h-5 justify-start",I?"flex-wrap":"flex-nowrap overflow-hidden")},Ne),{},{onMouseUp:function($){var E;return(E=$.currentTarget.querySelector("input"))===null||E===void 0?void 0:E.focus()},children:[ur,d.jsx("input",{readOnly:!x||w,disabled:P,value:(n=s.query)!==null&&n!==void 0?n:"","aria-invalid":g,"data-testid":f,name:f,size:1,ref:l,autoFocus:m,className:X("appearance-none bg-transparent outline-none border-none ring-0 flex-1 peer",P&&"cursor-not-allowed pointer-events-none",I&&"min-w-24"),placeholder:ke(s.value)?C:"",onChange:function($){return o($.target.value)}})]})),!s.loading&&!y&&d.jsx(Re,{className:X("flex-content p-2 z-0 order-9 text-muted cursor-pointer self-stretch flex items-center h-auto",s.open&&"-scale-y-100 pointer-events-none",P&&"pointer-events-none"),onClick:function(){return!P&&sr()},icon:He.chevronDown}),s.loading&&d.jsx(Re,{animate:"spin",className:X("flex-content p-2 z-0 order-9 text-muted pointer-events-none"),icon:He.spinner}),s.open&&!s.loading&&d.jsx(Ur,{children:d.jsx(Gr,{context:Q,initialFocus:-1,visuallyHiddenDismiss:!0,children:d.jsx(dn,pe(pe({ref:L.setFloating,className:"outline shadow-lg max-h-[40vh] z-(--z-popover)",style:pe({width:(r=L.reference.current)===null||r===void 0?void 0:r.getBoundingClientRect().width},re)},ir),{},{items:s.items,active:s.activeIndex,valueProperty:D,labelProperty:i,itemRef:v,itemProps:lr,empty:k,children:function($,E){var Y;return(Y=q==null?void 0:q($))!==null&&Y!==void 0?Y:E}}))})})]}))};export{Vn as C,Yn as E,Qn as F,zn as N,dn as O,Kn as R,Un as S,qn as T,Bn as a,_r as b,fn as u};
