import{t as fr,bH as gr,_ as de,r as c,s as lr,j as d,m as W,l as ne,bI as mr,bJ as Me,ax as ur,bb as He,br as Te,bG as Be,ba as Q,aL as Re,aN as Pe,w as hr,x as yr,y as br,z as Or,G as Pr,J as jr,L as xr,bi as Dr,bj as wr,N as Cr,Q as Sr,W as kr}from"./iframe-qDaPDssc.js";import{n as Er}from"./nodeCheck.js";import{_ as ie,C as Ye}from"./index.js";import{T as Nr,I as qe,a as Ir}from"./Tooltip.js";import{g as Tr,b as Rr,B as Ee}from"./Button.js";import{D as Fr}from"./DropdownTool.js";import{a as Mr,u as $r,o as Ar,F as Hr,_ as sr,D as qr,Y as Vr,b as Br,B as Ke,T as ze,C as Yr}from"./BasePanel.js";import{u as Ve}from"./useDebounce.js";import{C as Kr}from"./Content.js";import{S as zr}from"./Section.js";import{P as Z,D as ee}from"./Google.js";import{e as Fe}from"./endOfDay.js";import{e as Qr,a as Qe,d as Ur,i as Lr}from"./zh-CN.js";import{u as Gr}from"./Global.js";import{i as Ue}from"./getDay.js";import{c as Wr}from"./cloneElement.js";import{F as Jr,I as cr}from"./InputWrapper.js";import{u as Xr}from"./eventHandlers.js";import{E as Zr}from"./EmptyContent.js";import{m as _r,c as en}from"./isEqual.js";import{d as Le,g as rn}from"./dedupe.js";function Ge(t,e,n){const r=fr(t,n==null?void 0:n.in);return isNaN(+r)?gr(t,NaN):(r.setFullYear(e),r)}var nn=["ref","as","id","className","label","icon","badge","disabled","onClose","active","onClick","tabFlex","color","actions","tooltip","activeClassName"];function We(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Oe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?We(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var tn=function(e){var n=e.ref,r=e.as,l=e.id,p=e.className,O=e.label,P=e.icon,x=e.badge,N=e.disabled,k=e.onClose,j=e.active,m=e.onClick,A=e.tabFlex,R=e.color,b=e.actions,v=e.tooltip,w=e.activeClassName,g=de(e,nn),u=c.useMemo(function(){return Tr(x)},[x]),h=c.useMemo(function(){return!O},[O]),D=c.useMemo(function(){return lr(v)?{content:v}:v??{}},[v]),F=r??"button",q=v?Nr:c.Fragment;return d.jsx(q,Oe(Oe({},D),{},{children:d.jsxs(F,Oe(Oe({"data-id":l,disabled:N,"data-color":R,"data-inner-clickable":!0,className:W("fabric-tabButton",p,j&&"active pointer-events-none",j&&w,N&&"text-tint-500 pointer-events-none",A?"flex-1":"flex-initial max-w-36",h?"min-w-6 rounded":"rounded-capped","flex items-center justify-center overflow-hidden cursor-pointer"),onClick:function(){return!j&&(m==null?void 0:m(l))},ref:n},g),{},{children:[P&&d.jsx(qe,Oe({className:"flex-content p-2"},Ir(P))),!h&&d.jsx("label",{className:"flex-initial truncate text-center px-1 py-1",children:O}),x&&d.jsx(Rr,Oe(Oe({},u),{},{placement:h?"end":"",className:W("me-1",u.className)})),b&&j&&d.jsx(Fr,{className:"bg-tint-50/20 me-1 z-5",children:b}),k&&d.jsx("span",{role:"none",className:W("cursor-pointer me-1 opacity-65 hover:opacity-90 pointer-events-auto"),onClick:function(I){k==null||k(),I.stopPropagation()},children:"Ã—"})]}))}))},Bn=function(e){var n=e.children,r=e.headerClassName,l=e.orientation,p=l===void 0?"top":l,O=e.activeTab,P=e.activeClassName,x=e.justify,N=e.variant,k=e.tabFlex,j=e.append,m=e.prepend,A=e.tabRotate,R=e.gap,b=e.onBeforeChange,v=e.onChange,w=c.useState(),g=ne(w,2),u=g[0],h=g[1],D=c.useMemo(function(){return c.Children.toArray(n).reduce(function(C,T){return Er(T,tn)?C[0].push(T):C[1].push(T),C},[[],[]])},[n]),F=ne(D,2),q=F[0],y=F[1];c.useEffect(function(){h(O)},[O]);var I=c.useMemo(function(){var C;return(C=q.find(function(T){return T.props.id===u}))===null||C===void 0?void 0:C.props.children},[q,u]),U=c.useCallback(function(C){Promise.resolve(b==null?void 0:b(C,u)).then(function(T){T!==!1&&(h(C),v==null||v(C))})},[b,v,u]);return d.jsxs("div",{className:W("fabric-tabPanel","area-content grid bg-base overflow-hidden"),"data-orientation":p,"data-variant":N??"default",children:[d.jsxs("div",{className:W("fabric-tabHeader",r,A&&"tab-rotate",x&&"justify-".concat(x),["start","end"].includes(p)&&"flex-col","flex flex-nowrap overflow-hidden items-center"),children:[m,d.jsx("div",{className:W("fabric-tabList",x&&"justify-".concat(x),["start","end"].includes(p)&&"flex-col",["bottom","end"].includes(p)?"self-start":"self-end","flex flex-1 flex-nowrap overflow-auto scroll-thin"),style:{gap:R},children:q.map(function(C){var T,B;return c.cloneElement(C,{tabFlex:(T=C.props.tabFlex)!==null&&T!==void 0?T:k,activeClassName:(B=C.props.activeClassName)!==null&&B!==void 0?B:P,onClick:U,active:C.props.id===u})})}),j]}),y,I]})},an=["name","children"],on=["ref","onChange"];function Je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Je(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Yn=function(e){var n=e.name,r=e.children,l=de(e,an);if(!n)throw Error("Form Controller missing `name` prop");return d.jsx(Mr,{name:n,render:function(O){var P,x=O.field,N=x.ref,k=x.onChange,j=de(x,on),m=O.fieldState.error,A=O.formState.isSubmitting;return c.isValidElement(r)?c.cloneElement(c.Children.only(r),Ce(Ce(Ce({},j),l),{},{ref:function(b){b&&N(b);try{var v;r.props.ref&&"current"in r.props.ref&&(r.props.ref.current=b),(v=r.props.ref)!==null&&v!==void 0&&v.prototype&&r.props.ref(b)}catch{}},checked:!!j.value,readOnly:A||r.props.readOnly,invalid:!!(m!=null&&m.message)||r.props.invalid,error:(P=m==null?void 0:m.message)!==null&&P!==void 0?P:r.props.error,onChange:function(b){var v,w;k(b),(v=(w=r.props).onChange)===null||v===void 0||v.call(w,b)}})):r(Ce(Ce(Ce({},j),l),{},{ref:function(b){b&&N(b)},readOnly:A,invalid:!!(m!=null&&m.message),checked:!!j.value,error:m==null?void 0:m.message,onChange:function(b){k(b)}}))}})},ln=["formRef","schema","children","defaultValues","onSubmit","onChange"];function Xe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Ie(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Xe(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Xe(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var un=function(){},Kn=function(e){var n=e.formRef,r=e.schema,l=e.children,p=e.defaultValues,O=p===void 0?mr:p,P=e.onSubmit,x=P===void 0?un:P,N=e.onChange,k=de(e,ln),j=c.useRef(null),m=$r({shouldFocusError:!0,resolver:r&&Ar(r),defaultValues:O}),A=c.useTransition(),R=ne(A,2),b=R[1],v=Ve(N,[N],300);c.useEffect(function(){var u=m.watch(function(h){b(function(){return v==null?void 0:v(h)})});return function(){return u.unsubscribe()}},[m.watch,v]);var w=c.useCallback(function(){var u,h=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.reset(h),m.clearErrors(),(u=j.current)===null||u===void 0||(u=u.querySelector("[auto-focus], input, textarea"))===null||u===void 0||u.focus()},[O]);c.useImperativeHandle(n,function(){return{state:m.formState,reset:function(){return w(O)},clear:function(){return w()},submit:function(){return m.handleSubmit(x)},validate:function(){var u=sr(Me.mark(function D(F){return Me.wrap(function(y){for(;;)switch(y.prev=y.next){case 0:return y.next=2,m.trigger(F);case 2:return y.abrupt("return",y.sent);case 3:case"end":return y.stop()}},D)}));function h(D){return u.apply(this,arguments)}return h}(),getValues:function(){return m.getValues()},setValues:function(h){return setTimeout(function(){return m.reset(h)},50)},setValue:function(h,D){return setTimeout(function(){return m.setValue(h,D,{shouldDirty:!1,shouldTouch:!1})},50)}}},[x,m,m.formState,O]);var g=c.useCallback(function(u,h){var D=h.target;setTimeout(function(){var F;return(F=D.querySelector("input[aria-invalid='true'],textarea[aria-invalid='true']"))===null||F===void 0?void 0:F.focus()},10)},[]);return d.jsx(Hr,Ie(Ie({},m),{},{children:d.jsxs("form",Ie(Ie({ref:j,onReset:function(){return w(O)},onSubmit:function(h){h.stopPropagation(),m.handleSubmit(x,g)(h)},"data-loading":m.formState.isSubmitting,className:"contents",autoComplete:"off"},k),{},{children:[l,d.jsx("input",{type:"submit",className:"absolute invisible"})]}))}))};function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function sn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ze(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var cn=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],l=Q(r);n.forEach(function(P){return l.push({label:P.label,hijri:P.hijri,icon:P.icon,start:Ge(ee.parseDate(P.start),e),end:Ge(ee.parseDate(P.end),e)})}),l.push({label:"superdate:event.newYear",start:Te(new Date("".concat(e-1,"-12-31"))),end:Fe(new Date("".concat(e,"-01-01")))}),l.push({label:"superdate:event.christmas",start:Te(new Date("".concat(e,"-12-24"))),end:Fe(new Date("".concat(e,"-12-26")))});var p=ee.startOfYear(new Date("".concat(e-1,"-12-31")),!0);p=ee.addMonths(p,8,!0),p.getFullYear()!==e&&(p=ee.addYears(p,p.getFullYear()>e?-1:1,!0));var O=ee.endOfMonth(p,!0);return l.push({label:"superdate:event.ramadan",start:Te(p),end:Fe(O)}),l.sort(function(P,x){return P.start.getTime()<x.start.getTime()?-1:1})},zn=function(e){var n=e.isHijri,r=e.onChange,l=e.events,p=l===void 0?He:l,O=e.recurringEvents,P=O===void 0?He:O,x=ur(),N=x.t,k=c.useState({}),j=ne(k,2),m=j[0],A=j[1],R=c.useReducer(function(g,u){var h=!1;if(u.type==="init"&&(g.pageDate=new Date,h=!0),u.type==="changePage"&&(g.page=Math.max(u.page,Z.MONTH)),u.type==="changePageDate"&&(h=!0,g.pageDate=u.date,u.changePage&&(g.page=Math.max(g.page-1,Z.MONTH))),h){var D,F=g.pageDate.getFullYear();g.events=cn(F,P??[],(D=m[F])!==null&&D!==void 0?D:[])}return sn({},g)},{pageDate:new Date,page:Z.MONTH,events:[]}),b=ne(R,2),v=b[0],w=b[1];return c.useEffect(function(){w({type:"init"})},[]),c.useEffect(function(){var g={};p.forEach(function(u){var h=Te(new Date(u.start)),D=Fe(new Date(u.end));g[h.getFullYear()]||(g[h.getFullYear()]=[]),g[h.getFullYear()].push(u),h.getFullYear()!==D.getFullYear()&&(g[D.getFullYear()]||(g[D.getFullYear()]=[]),g[D.getFullYear()].push(u))}),A(g)},[p]),d.jsxs(zr,{children:[d.jsx(qr,{page:v.page,pageDate:v.pageDate,changePage:function(u){return w({type:"changePage",page:u})},changePageDate:function(u){return w({type:"changePageDate",date:u,changePage:!1})}}),v.page===Z.MONTH&&d.jsx(Kr,{className:"p-2 max-h-48",children:v.events.map(function(g){return d.jsxs("div",{role:"none","data-dropdown-dismiss":"true",onClick:function(){r==null||r("".concat(g.start.toISOString(),"|").concat(g.end.toISOString()),[g.start.toISOString(),g.end.toISOString()])},className:"text-sm my-1 py-1 px-2 flex flex-nowrap items-center cursor-pointer rounded hover:bg-primary-50",children:[d.jsx("div",{className:"flex-1 truncate",children:N(g.label,{defaultValue:g.label})}),d.jsxs("div",{className:"text-muted text-xs",children:[ee.format(g.start,Qr(g.start,g.end)?"dd":"dd/MMM",Be.language,n),d.jsx("span",{children:" - "}),ee.format(g.end,"dd/MMM",Be.language,n)]})]},g.label)})}),v.page===Z.YEAR&&d.jsx(Vr,{isHijri:n,page:v.page,pageDate:v.pageDate,changePageDate:function(u){return w({type:"changePageDate",date:u})}}),v.page===Z.DECADE&&d.jsx(Br,{isHijri:n,page:v.page,pageDate:v.pageDate,changePageDate:function(u){return w({type:"changePageDate",date:u})}})]})},dn=["className","max","min","dateDisabled","onChange","showHijriToggle","value","withTime","showApply"];function _e(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function se(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?_e(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):_e(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Qn=function(e){var n=e.className,r=e.max,l=e.min,p=e.dateDisabled,O=e.onChange,P=e.showHijriToggle,x=e.value,N=e.withTime,k=e.showApply,j=k===void 0?!1:k,m=de(e,dn),A=ur("date"),R=A.t,b=Gr(),v=b.currentCalendar,w=c.useState(v==="hijri"),g=ne(w,2),u=g[0],h=g[1],D=Ve(O,[O]);c.useEffect(function(){h(v==="hijri")},[v]);var F=c.useReducer(function(a,i){if(i.type==="reset")if(Re(i.date))a.hilight=void 0,a.selected=void 0,a.start.pageDate=new Date,a.start.hour=0,a.start.minute=0,a.end.pageDate=ee.addMonths(new Date,1),a.end.hour=0,a.end.minute=0;else{var Y=ne(i.date,2),xe=Y[0],pe=Y[1],oe=new Date(xe),K=new Date(pe);a.hilight=void 0,a.selected=[oe,K],a.start.pageDate=oe,a.start.hour=oe.getHours(),a.start.minute=oe.getMinutes(),a.end.pageDate=K,a.end.hour=K.getHours(),a.end.minute=K.getMinutes()}if(i.type==="changeDate")if(!a.hilight)a.hilight=[i.date,i.date],a.start.pageDate=i.date,a.end.pageDate=ee.addMonths(i.date,1,u);else{var s=Qe(a.hilight[0],i.date),ve=s?i.date:a.hilight[0],le=s?a.hilight[0]:i.date;a.selected=[ve,le],a.hilight=void 0,a.start.pageDate=ve,a.end.pageDate=le}if(i.type==="changeHilight")if(a.hilight&&i.date){var he=ne(a.hilight,1),ke=he[0];a.hilight=[ke,i.date]}else a.hilight=void 0;if(i.type==="changeTime"){if(i.range==="start"&&(a.start.hour=i.hour,a.start.minute=i.minute,a.selected)){var re,fe;(re=a.selected[0])===null||re===void 0||re.setHours(i.hour),(fe=a.selected[0])===null||fe===void 0||fe.setMinutes(i.minute)}if(i.range==="end"&&(a.end.hour=i.hour,a.end.minute=i.minute,a.selected)){var o,f;(o=a.selected[1])===null||o===void 0||o.setHours(i.hour),(f=a.selected[1])===null||f===void 0||f.setMinutes(i.minute)}}return i.type==="changePage"&&(a[i.range].page=i.page),i.type==="changePageDate"&&(a[i.range].pageDate=i.date,i.pageChange&&(a[i.range].page=Math.max(a[i.range].page-1,0),i.range==="start"&&a.start.page===Z.DATE&&(a.end.pageDate=Ur(i.date,1)))),(i.type==="changeDate"||i.type==="changeTime")&&(l&&a.selected&&Lr(a.selected[0],new Date(l))&&(a.selected[0]=new Date(l),a.start.hour=a.selected[0].getHours(),a.start.minute=a.selected[0].getMinutes()),r&&a.selected&&Qe(a.selected[1],new Date(r))&&(a.selected[1]=new Date(r),a.end.hour=a.selected[1].getHours(),a.end.minute=a.selected[1].getMinutes()),!j&&a.selected&&!a.hilight&&(D==null||D([a.selected[0].toISOString(),a.selected[1].toISOString()]))),se({},a)},{start:{page:Z.DATE,pageDate:new Date,hour:0,minute:0},end:{page:Z.DATE,pageDate:ee.addMonths(new Date,1,u),hour:0,minute:0}}),q=ne(F,2),y=q[0],I=q[1];c.useEffect(function(){I({type:"reset",date:x})},[x]);var U=c.useCallback(function(a){return y.start.page===Z.DATE&&Pe(p)?!!p.find(function(i){return Ue(new Date(i),a)}):ee.isDisabled(a,y.start.page,l,r)},[y.start.page,l,r,p]),C=c.useCallback(function(a){return y.end.page===Z.DATE&&Pe(p)?!!p.find(function(i){return Ue(new Date(i),a)}):ee.isDisabled(a,y.end.page,l,r)},[y.end.page,l,r,p]),T=c.useCallback(function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;I({type:"changePageDate",pageChange:i,range:"start",date:a})},[]),B=c.useCallback(function(a){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;I({type:"changePageDate",pageChange:i,range:"end",date:a})},[]),je=c.useCallback(function(a){I({type:"changeDate",date:a})},[]);return d.jsxs("div",se(se({className:W("block overflow-hidden bg-base rounded-capped",n)},m),{},{children:[d.jsxs("div",{className:"flex flex-nowrap",children:[d.jsx(Ke,se(se({},y.start),{},{max:r,min:l,hideNext:!0,withTime:N,isHijri:u,hilight:y.hilight,selected:y.selected,selectDate:je,isDateDisabled:U,changeTime:function(i){return I(se({type:"changeTime",range:"start"},i))},changePage:function(i){return I({type:"changePage",range:"start",page:i})},mouseOver:function(i){return I({type:"changeHilight",date:i})},changePageDate:T})),d.jsx("div",{className:"border-s border-s-dimmed"}),d.jsx(Ke,se(se({},y.end),{},{max:r,min:l,hidePrevious:!0,withTime:N,isHijri:u,hilight:y.hilight,selected:y.selected,selectDate:je,isDateDisabled:C,changeTime:function(i){return I(se({type:"changeTime",range:"end"},i))},changePage:function(i){return I({type:"changePage",range:"end",page:i})},mouseOver:function(i){return I({type:"changeHilight",date:i})},changePageDate:B}))]}),d.jsxs("div",{className:"border-t flex flex-nowrap justify-between px-2",children:[d.jsx("span",{children:P&&d.jsx(Ee,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){h(!u)},children:R(u?"label.gregorian":"label.hijri")})}),y.start.page!==Z.DATE&&d.jsx(Ee,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return I({type:"changePage",range:"start",page:Z.DATE})},children:R("core:action.cancel")}),y.end.page!==Z.DATE&&d.jsx(Ee,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return I({type:"changePage",range:"end",page:Z.DATE})},children:R("core:action.cancel")}),y.hilight&&d.jsx(Ee,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return I({type:"changeHilight"})},children:R("core:action.cancel")}),!y.hilight&&j&&d.jsx(Ee,{size:"sm",variant:"solid",color:"primary",disabled:!y.selected,"data-dropdown-dismiss":"true",className:"my-1",onClick:function(){var i,Y;return D==null?void 0:D([(i=y.selected)===null||i===void 0?void 0:i[0].toISOString(),(Y=y.selected)===null||Y===void 0?void 0:Y[1].toISOString()])},children:R("core:action.apply")})]})]}))},pn=["children","vertical","noOutline","plain"];function er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function rr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?er(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Un=function(e){var n=e.children,r=e.vertical,l=e.noOutline,p=e.plain,O=de(e,pn);return d.jsx(Jr,rr(rr({},O),{},{children:d.jsx("div",{className:W("fabric-fieldGroup",!p&&!l&&"outline",!p&&"bg-base",p&&"flex-wrap","flex-1 rounded",!r&&"flex"),"data-vertical":!!r,children:Wr(n,function(P){return c.cloneElement(P,{"data-inner":!0})})})}))},vn=["ref","value","invalid","readOnly","disabled","required","placeholder","defaultValue","autoFocus","name","min","max","step","onBlur","onFocus","onChange","onEnterPressed"];function nr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function tr(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nr(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Ln=function(e){var n=e.ref,r=e.value,l=e.invalid,p=e.readOnly,O=e.disabled,P=e.required,x=e.placeholder,N=e.defaultValue,k=e.autoFocus,j=e.name,m=e.min,A=e.max,R=e.step,b=e.onBlur,v=e.onFocus,w=e.onChange,g=e.onEnterPressed,u=de(e,vn),h=c.useState(""),D=ne(h,2),F=D[0],q=D[1],y=c.useDeferredValue(r??N),I=Xr(g);c.useEffect(function(){q(y??"")},[y]);var U=c.useCallback(function(C){var T,B=(T=C==null?void 0:C.target.valueAsNumber)!==null&&T!==void 0?T:N;q(B??""),w==null||w(B??null)},[w,N]);return d.jsx(cr,tr(tr({showClear:!!F&&!O&&!p,onClear:U,invalid:l,readOnly:p,disabled:O,required:P},u),{},{children:d.jsx("input",{className:"appearance-none bg-transparent py-1 px-2 flex-1 border-none outline-none ring-0 peer","aria-invalid":l,"aria-disabled":O,"aria-readonly":p,placeholder:x,disabled:O,readOnly:p,"data-testid":j,name:j,type:"number",size:1,min:m,max:A,step:R,ref:n,autoComplete:"off",autoFocus:k,value:F,onBlur:b,onFocus:v,onChange:U,onKeyDown:I})}))},fn=["ref","style","items","active","className","itemRef","empty","info","valueProperty","labelProperty","itemProps","children"];function ar(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Se(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ar(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ar(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var gn=function(e){var n=e.ref,r=e.style,l=e.items,p=e.active,O=e.className,P=e.itemRef,x=e.empty,N=e.info;e.valueProperty;var k=e.labelProperty,j=k===void 0?"label":k,m=e.itemProps,A=e.children,R=de(e,fn);return d.jsxs("div",Se(Se({ref:n,className:W("bg-base select-none flex flex-col",O),style:r},R),{},{children:[d.jsxs("div",{className:W("overflow-x-hidden overflow-y-auto flex-1"),children:[l.length===0&&(x??d.jsx(Zr,{message:d.jsx(ze,{i18nKey:"form:select.emptyList"})})),l.map(function(b,v){var w,g;return b.___group___?d.jsx("p",{className:"px-2 py-1 text-muted text-xs sticky -top-px z-2 bg-base border-t",children:b.label},v):b.___create___?d.jsx("div",Se(Se({role:"none",tabIndex:p===v?0:-1,ref:function(h){return P(v,h)},"data-active":p===v?!0:void 0,className:W("block text-start truncate px-2 py-1 leading-normal cursor-pointer select-none","data-active:bg-primary-200 data-selected:bg-primary-600 data-selected:text-white data-active:data-selected:underline")},m(b)),{},{children:d.jsx(ze,{i18nKey:"form:select.createOption",values:{query:(w=b.value)!==null&&w!==void 0?w:b},components:[d.jsx("strong",{children:"query"},"t0")]})}),v):d.jsx("div",Se(Se({role:"none",tabIndex:p===v?0:-1,ref:function(h){return P(v,h)},"data-active":p===v?!0:void 0,className:W("block text-start truncate px-2 py-1 leading-normal cursor-pointer","data-active:bg-primary-200 data-selected:bg-primary-600 data-selected:text-white data-active:data-selected:underline")},m(b)),{},{children:A(b,(g=b[j])!==null&&g!==void 0?g:b)}),v)})]}),N&&d.jsx("div",{className:"px-2 py-1 text-sm bg-dimmed text-muted",children:N})]}))},mn=function(e){return e},hn=function(e,n){var r,l,p=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return Pe(e)?e.map(function(O){var P;return(P=O[p])!==null&&P!==void 0?P:O}):(r=(l=e==null?void 0:e[p])!==null&&l!==void 0?l:e)!==null&&r!==void 0?r:n};function ir(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function G(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?ir(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):ir(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var yn=function(e){var n=e.options,r=n===void 0?He:n,l=e.value,p=e.autoComplete,O=e.alwaysOpen,P=O===void 0?!1:O,x=e.defaultOpen,N=x===void 0?!1:x,k=e.multiple,j=k===void 0?!1:k,m=e.allowCreate,A=m===void 0?!1:m,R=e.groupProperty,b=R===void 0?"":R,v=e.valueProperty,w=v===void 0?"id":v,g=e.labelProperty,u=g===void 0?"label":g,h=e.sortProperty,D=e.createOption,F=D===void 0?mn:D,q=e.matcher,y=e.onQuery,I=e.onChange,U=e.onSelect,C=c.useMemo(function(){return j?[]:""},[j]),T=c.useDeferredValue(l??C),B=c.useRef([]),je=c.useRef(null),a=c.useRef([]),i=c.useRef([]),Y=c.useCallback(function(o,f){var $,_;return($=q==null?void 0:q(o,f))!==null&&$!==void 0?$:_r((_=o[u])!==null&&_!==void 0?_:o,f)},[q]),xe=c.useCallback(function(o){setTimeout(function(){U==null||U(o??C),I==null||I(hn(o,C,w))},50)},[C,U,I]),pe=c.useReducer(function(o,f){if(f.type==="open"){var $=o.items.indexOf(o.multiple?o.value[0]:o.value);return G(G({},o),{},{open:!0,activeIndex:$>-1?$:null})}if(f.type==="close")return G(G({},o),{},{activeIndex:null,activeItem:null,open:!1});if(f.type==="active"&&o.open){var _;return p&&f.index!==null&&(o.query=o.items[f.index]),G(G({},o),{},{activeIndex:f.index,activeItem:o.items[(_=f.index)!==null&&_!==void 0?_:-1]})}if(f.type==="setValue")return G(G({},o),{},{value:f.value,selectedIndex:o.items.indexOf(o.multiple?f.value[0]:f.value)});if(f.type==="changeValue"){var J,H=G(G({},o),{},{value:o.emptyValue,activeIndex:null,activeItem:null,selectedIndex:p?o.multiple?(J=f.value)===null||J===void 0?void 0:J.length:0:o.items.indexOf(f.value)});if(f.value!==void 0)if(j){var te=[];lr(f.value)?te.push.apply(te,Q(f.value.split(/,\s?/))):te.push(f.value),H.value=Q(o.value),te.forEach(function(ae){var ue,me;H.value=(ue=(me=H.value).includes)!==null&&ue!==void 0&&ue.call(me,ae)?H.value.filter(function(we){return we!==ae}):[].concat(Q(H.value),[ae])})}else H.value=f.value;return o.multiple||(H.open=P),xe(H.value),H}if(f.type==="removeItem"){var V=o.value;if(o.multiple){var ge;V=Q(V),V.splice((ge=f.index)!==null&&ge!==void 0?ge:-1,1)}else V="";return xe(V),G(G({},o),{},{value:V})}if(f.type==="startQuery")return G(G({},o),{},{loading:!0,query:f.query});if(f.type==="options"){var L=G(G({},o),{},{loading:!1,query:f.query}),ye=Q(f.options);p&&f.query!==void 0&&(ye=Le([f.query].concat(Q(ye)))),h&&(ye=ye.sort(en("asc",h)));var $e=rn(ye,b,"");if(f.open&&(L.open=!0),L.items=[],A&&f.query&&L.items.push({___create___:!0,value:f.query}),Object.entries($e).forEach(function(ae){var ue,me=ne(ae,2),we=me[0],Ae=me[1];we&&L.items.push({___group___:!0,label:we}),(ue=L.items).push.apply(ue,Q(Ae))}),f.setActive){var De=L.items.findIndex(function(ae){return!ae.___group___});L.activeIndex=De>=0?De:null}else L.activeIndex=null;return a.current=L.items,L}return o},{multiple:j,emptyValue:C,open:P||N,loading:!1,activeIndex:null,activeItem:null,selectedIndex:null,value:C,query:void 0,items:[]}),oe=ne(pe,2),K=oe[0],s=oe[1];c.useEffect(function(){if(!j){var o,f=(A||p)&&T?F(T):void 0,$=r.find(function(J){var H;return((H=J[w])!==null&&H!==void 0?H:J)===T});i.current=r,!$&&f&&(i.current=[f].concat(Q(r??[]))),s({type:"options",options:i.current}),s({type:"setValue",value:(o=$??f)!==null&&o!==void 0?o:T})}if(j){i.current=[];var _=(Pe(T)?T:[]).map(function(J){var H,te=(A||p)&&J?F(J):void 0,V=r.find(function(ge){var L;return((L=ge[w])!==null&&L!==void 0?L:ge)===J});return!V&&te&&i.current.push(te),(H=V??te)!==null&&H!==void 0?H:J});i.current=[].concat(Q(i.current),Q(r??[])),s({type:"options",options:i.current}),s({type:"setValue",value:_})}},[T,r,j,A,p,F]);var ve=Ve(function(o){Promise.resolve(y==null?void 0:y(o)).then(function(f){var $=Q(f);p&&$.push.apply($,Q(i.current.filter(function(_){return Y==null?void 0:Y(_,o)}))),s({type:"options",query:o,options:$,open:!0,setActive:!0})})},[y],300),le=c.useCallback(function(o){if(!o)s({type:"options",query:"",options:i.current});else{if(y)return s({type:"startQuery",query:o}),ve(o);s({type:"options",query:o,open:!0,setActive:!0,options:i.current.filter(function(f){return Y==null?void 0:Y(f,o)})})}},[Y,y]),he=c.useCallback(function(o){var f=o;if(p&&j&&o&&(f=o.split(/,\s?/)),s({type:"changeValue",value:o!=null&&o.___create___?o.value:o}),o!=null&&o.___create___){var $=[o.value];j&&($=o.value.split(/,\s?/)),i.current=[].concat(Q(i.current),Q($.map(F)))}p&&(i.current=Le([].concat(Q(Pe(f)?f:[f]),Q(i.current)))),s({type:"options",options:i.current})},[]),ke=c.useCallback(function(o){s({type:"removeItem",index:o})},[]),re=c.useCallback(function(o){s({type:o?"open":"close"}),s({type:"options",query:void 0,options:i.current})},[]),fe=c.useCallback(function(o){o&&o>-1&&s({type:"active",index:o})},[]);return{state:K,listRef:B,focusableRef:je,listContentRef:a,handleChange:he,handleRemove:ke,handleQuery:le,macthOption:Y,setActiveIndex:fe,setOpen:re,setItemRef:function(f,$){B.current[f]=$}}},bn=["ref","name","value","invalid","readOnly","disabled","required","placeholder","autoFocus","error","options","defaultOpen","hideHandle","groupProperty","labelProperty","valueProperty","sortProperty","infoProperty","multiple","searchable","allowCreate","emptyDisplay","createOption","matcher","renderer","onQuery","onChange","onSelect","onEnterPressed"];function or(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?or(Object(n),!0).forEach(function(r){ie(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):or(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Gn=function(e){var n,r,l,p=e.ref,O=e.name,P=e.value,x=e.invalid,N=e.readOnly,k=e.disabled,j=e.required,m=e.placeholder,A=e.autoFocus,R=e.error,b=e.options,v=e.defaultOpen,w=e.hideHandle,g=e.groupProperty,u=e.labelProperty,h=u===void 0?"label":u,D=e.valueProperty,F=D===void 0?"id":D,q=e.sortProperty,y=e.infoProperty,I=e.multiple,U=e.searchable,C=e.allowCreate,T=e.emptyDisplay,B=e.createOption,je=e.matcher,a=e.renderer,i=e.onQuery,Y=e.onChange,xe=e.onSelect,pe=e.onEnterPressed,oe=de(e,bn),K=yn({value:P,options:b,multiple:I,defaultOpen:v,groupProperty:g,labelProperty:h,valueProperty:F,sortProperty:q,allowCreate:C,createOption:B,matcher:je,onChange:Y,onSelect:xe,onQuery:i}),s=K.state,ve=K.listRef,le=K.listContentRef,he=K.setOpen,ke=K.macthOption,re=K.handleChange,fe=K.handleRemove,o=K.handleQuery,f=K.setItemRef,$=K.setActiveIndex,_=c.useId(),J=hr({open:s.open,onOpenChange:function(M,S,z){!M&&(ve.current=[]),he(M)},strategy:"fixed",placement:"bottom",whileElementsMounted:Pr,middleware:[yr({padding:8}),br(),Or(2)]}),H=J.context,te=J.floatingStyles,V=J.refs,ge=jr(H,{}),L=xr(H,{}),ye=Dr(H,{listRef:ve,activeIndex:s.activeIndex,selectedIndex:s.selectedIndex,loop:!0,virtual:!0,focusItemOnOpen:!1,onNavigate:$}),$e=wr(H,{listRef:le,activeIndex:s.activeIndex,selectedIndex:s.selectedIndex,findMatch:function(M,S){return M.find(function(z){return ke(z,S)})},onMatch:function(M){s.open&&$(M),!U&&!I&&!s.open&&re(le.current[M])}}),De=Cr([L,U?void 0:ge,ye,$e]),ae=De.getReferenceProps,ue=De.getFloatingProps,me=De.getItemProps,we=c.useMemo(function(){var E=ae();return ce(ce({},E),{},{onBlur:function(S){var z;if((z=S.relatedTarget)!==null&&z!==void 0&&z.closest('[data-select-dropdown="'.concat(_,'"]'))){var X;(X=V.domReference.current)===null||X===void 0||(X=X.querySelector("input"))===null||X===void 0||X.focus();return}o(""),he(!1)},onKeyDown:function(S){if(S.key==="Enter"){if(s.activeIndex!==null)return re(le.current[s.activeIndex]),S.preventDefault(),S.stopPropagation(),!1;if(s.query)return o(""),S.preventDefault(),S.stopPropagation(),!1;pe==null||pe(S)}else S.key==="Tab"&&s.activeIndex!==null?re(le.current[s.activeIndex]):S.key==="Backspace"?!s.query&&fe():(!U||["ArrowUp","ArrowDown"].includes(S.key))&&(["ArrowUp","ArrowDown"].includes(S.key)&&s.activeIndex===null&&$(s.selectedIndex),setTimeout(function(){var z;(z=E.onKeyDown)===null||z===void 0||z.call(E,S)},50))}})},[ae,pe,o,V,s.query,s.activeIndex]),Ae=c.useMemo(function(){return ue({"data-select-dropdown":_})},[ue]),dr=c.useCallback(function(E){var M,S,z=Pe(s.value)?(M=s.value)===null||M===void 0||(S=M.includes)===null||S===void 0?void 0:S.call(M,E):s.value===E;return me({"data-selected":z?!0:void 0,onClick:function(){re(E)}})},[me,re,s.value]),pr=c.useMemo(function(){if(Pe(s.value))return s.value.map(function(S,z){var X,Ne;return d.jsx(Yr,{onRemove:function(){return fe(z)},children:(X=(Ne=a==null?void 0:a(S))!==null&&Ne!==void 0?Ne:S[h])!==null&&X!==void 0?X:S},z)});if(!Re(s.value)&&!s.query){var E,M;return d.jsx("span",{className:"self-center pointer-events-none select-none",children:(E=(M=a==null?void 0:a(s.value))!==null&&M!==void 0?M:s.value[h])!==null&&E!==void 0?E:s.value})}},[s.value,s.query,m,a]),vr=c.useCallback(function(){var E;he(!0),(E=V.domReference.current)===null||E===void 0||(E=E.querySelector("input"))===null||E===void 0||E.focus()},[]);return c.useLayoutEffect(function(){s.open&&setTimeout(function(){var E;s.selectedIndex&&((E=ve.current[s.selectedIndex])===null||E===void 0||E.scrollIntoView({block:"center"}))},100)},[s.open]),d.jsxs(cr,ce(ce({showClear:!Re(s.value),onClear:re,invalid:x,readOnly:N,disabled:k,required:j,error:R,wrapperRef:V.setReference,className:s.open?"z-99!":""},oe),{},{children:[d.jsxs("div",ce(ce({role:"none","data-select-display":"true",className:W("group flex-1 py-1 px-2 truncate text-start flex gap-1 relative min-h-5 justify-start",I?"flex-wrap":"flex-nowrap overflow-hidden")},we),{},{onMouseUp:function(M){var S;return(S=M.currentTarget.querySelector("input"))===null||S===void 0?void 0:S.focus()},children:[pr,d.jsx("input",{readOnly:!U||N,disabled:k,value:(n=s.query)!==null&&n!==void 0?n:"","aria-invalid":x,"data-testid":O,name:O,size:1,ref:p,autoFocus:A,className:W("appearance-none bg-transparent outline-none border-none ring-0 flex-1 peer",k&&"cursor-not-allowed pointer-events-none",I&&"min-w-24"),placeholder:Re(s.value)?m:"",onChange:function(M){return o(M.target.value)}})]})),!s.loading&&!w&&d.jsx(qe,{className:W("flex-content p-2 z-0 order-9 text-muted cursor-pointer self-stretch flex items-center h-auto",s.open&&"-scale-y-100 pointer-events-none",k&&"pointer-events-none"),onClick:function(){return!k&&vr()},icon:Ye.chevronDown}),s.loading&&d.jsx(qe,{animate:"spin",className:W("flex-content p-2 z-0 order-9 text-muted pointer-events-none"),icon:Ye.spinner}),s.open&&!s.loading&&d.jsx(Sr,{children:d.jsx(kr,{context:H,initialFocus:-1,visuallyHiddenDismiss:!0,children:d.jsx(gn,ce(ce({ref:V.setFloating,className:"outline shadow-lg max-h-[40vh] z-(--z-popover)",style:ce({width:(r=V.reference.current)===null||r===void 0?void 0:r.getBoundingClientRect().width},te)},Ae),{},{items:s.items,active:s.activeIndex,valueProperty:F,labelProperty:h,itemRef:f,itemProps:dr,empty:T,info:(l=s.activeItem)===null||l===void 0?void 0:l[y??"info"],children:function(){var E=sr(Me.mark(function M(S,z){var X;return Me.wrap(function(be){for(;;)switch(be.prev=be.next){case 0:return be.next=2,(X=a==null?void 0:a(S))!==null&&X!==void 0?X:z;case 2:return be.abrupt("return",be.sent);case 3:case"end":return be.stop()}},M)}));return function(M,S){return E.apply(this,arguments)}}()}))})})]}))};export{Yn as C,zn as E,Un as F,Ln as N,gn as O,Qn as R,Gn as S,Bn as T,Kn as a,tn as b,yn as u};
