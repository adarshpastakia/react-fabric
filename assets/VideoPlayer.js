import{l as se,aN as $t,_ as ot,r as m,bk as he,j as a,m as X,aS as oe,bP as _t,ca as at,bm as Ht}from"./iframe-BTaJxP5y.js";import{_ as ie,a as Ge,C as N}from"./index2.js";import{S as _e}from"./Section.js";import{A as He,B as V,H as O,c as Bt}from"./Button.js";import{g as Ft,u as Ut,I as ue}from"./Tooltip.js";import{u as Xt}from"./useResizeObserver.js";import{F as fe,H as Yt}from"./HeadFoot.js";import{D as Le}from"./Divider.js";import{T as Zt}from"./Text.js";import"./ColorPicker.js";import"./Google.js";import{I as Gt}from"./InputWrapper.js";import{d as Kt}from"./debounce.js";import{c as Jt}from"./isEqual.js";import{T as lt}from"./ThemeProvider.js";import{E as ut}from"./ErrorBoundary.js";import{u as Qt}from"./useResize.js";import{D as Re,a as Pe}from"./Dropdown.js";import{P as Ke}from"./Panel.js";import{C as Je}from"./Content.js";import{T as dt}from"./Textarea.js";var en=function(e){var t=e;return $t(e)?[0,0,0,0]:(typeof e=="string"&&(t=e.split(",")),Array.isArray(t)&&(t=t.map(function(n){return parseInt(n,10)})),t)},Ve=function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:"0,0,0,0",t=en(e),n=se(t,4),r=n[0],s=n[1],i=n[2],o=n[3];return i=r<0?i+r:i,o=s<0?o+s:o,r=r>0?r:0,s=s>0?s:0,[r,s,i,o]},tn=["active","children","className","onPanelChange","onBack"];function Qe(d,e){var t=Object.keys(d);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(d);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(d,r).enumerable})),t.push.apply(t,n)}return t}function et(d){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?Qe(Object(t),!0).forEach(function(n){ie(d,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(t)):Qe(Object(t)).forEach(function(n){Object.defineProperty(d,n,Object.getOwnPropertyDescriptor(t,n))})}return d}var nn=function(e){e.active;var t=e.children,n=e.className,r=e.onPanelChange,s=e.onBack,i=ot(e,tn),o=m.useRef(null),l=m.useState([]),p=se(l,2),c=p[0],v=p[1],y=m.useTransition(),g=se(y,2),u=g[1],h=m.useMemo(function(){return new Map(m.Children.toArray(t).map(function(L){var C;return L.props&&[(C=L.props.panelId)!==null&&C!==void 0?C:"root",L]}))},[t]);m.useEffect(function(){u(function(){var L,C;r==null||r((L=c[0])!==null&&L!==void 0?L:"root"),(C=o.current)===null||C===void 0||C.dispatchEvent(new Event("updatePopper",{bubbles:!0}))})},[r,c]);var f=m.useCallback(function(){var L;(s==null?void 0:s(c[0],(L=c[1])!==null&&L!==void 0?L:"root"))!==!1&&v(c.slice(1))},[c,s]),b=m.useMemo(function(){var L;return(L=h.get(c[0]))!==null&&L!==void 0?L:h.values().next().value},[c,h]),k=m.useCallback(function(L){var C,T=(C=L.target)===null||C===void 0||(C=C.dataset)===null||C===void 0?void 0:C.panel;return T?(T==="back"?f():T==="root"?(s==null?void 0:s(c[0],"root"))!==!1&&v([]):h.has(T)&&v([T].concat(he(c))),L.stopPropagation(),L.preventDefault(),!1):!0},[f,c,h,s]);return a.jsx("div",et(et({},i),{},{role:"none",ref:o,className:n,onClickCapture:k,children:b&&m.cloneElement(b,{onBack:c.length>0?f:void 0})}))},rn={"":"1rem",sm:"0.875rem",md:"1.125rem",lg:"1.5rem",xl:"2rem"},sn=function(e){var t=e.value,n=t===void 0?0:t,r=e.size,s=r===void 0?"sm":r,i=e.color,o=i===void 0?"primary-500":i,l=Ge(function(){return Math.min(Math.max(n,0),1)},[n],"ProgressCirle value"),p=Ge(function(){var c=Math.PI*2*44;return c*(1-l)},[l],"ProgressCirle dashOffset");return a.jsxs("div",{className:X("inline-block w-[4em] h-[4em] text-lg relative"),"aria-hidden":"true",style:{fontSize:rn[s],color:Ft(o)},children:[a.jsxs("svg",{viewBox:"0 0 100 100",className:X("absolute inset-0 w-full h-full stroke-dimmed"),children:[a.jsx("circle",{cx:"50",cy:"50",r:"44",strokeWidth:"12",strokeOpacity:"0.25",fillOpacity:"0"}),a.jsx("circle",{cx:"50",cy:"50",r:"44",stroke:"currentColor",strokeWidth:"12",fillOpacity:"0",style:{transform:"rotate(-90deg)",transformOrigin:"center",strokeDasharray:Math.PI*2*44,strokeDashoffset:p,transition:"stroke-dashoffset 0.5s"}})]}),a.jsx("span",{className:"flex w-full h-full items-center justify-center select-none font-bold text-[0.625em]",children:oe.percent(l)})]})},ze=function(e){var t=e.getBoundingClientRect();return{top:Math.ceil(t.top),left:Math.ceil(t.left),right:Math.ceil(t.right),width:Math.ceil(t.width),bottom:Math.ceil(t.bottom),height:Math.ceil(t.height)}},Ne=function(e){return he(e).map(Number).sort(function(t,n){return t-n})},Ae={getPercentageForValue:function(e,t,n){return Math.max(0,Math.min(100,(e-t)/(n-t)*100))},getValueForClientX:function(e,t,n,r,s){var i=t.left,o=t.right,l=t.width,p=(s?o-e:e-i)/l,c=(r-n)*p;return c+n},getValueForClientY:function(e,t,n,r){var s=t.height,i=t.bottom,o=(i-e)/s,l=(r-n)*o;return l+n}},on=function(e){var t=m.useRef(e);return t.current=e,m.useCallback(function(){return t.current},[])},an=function(e){var t,n=(t=e.tickSize)!==null&&t!==void 0?t:10,r=e.values,s=e.min,i=e.max,o=e.vertical,l=e.ticks,p="steps"in e?e.steps:void 0,c=e.onChange,v=e.onDrag,y=e.onDragStart,g=e.onDragEnd,u="stepSize"in e?e.stepSize:1,h=m.useState(),f=se(h,2),b=f[0],k=f[1],L=m.useState(),C=se(L,2),T=C[0],P=C[1],j=m.useState(),S=se(j,2),z=S[0],w=S[1],M=Ut(),$=m.useMemo(function(){return o?"bottom":M?"right":"left"},[o,M]),F=m.useMemo(function(){return o?"marginBottom":M?"marginRight":"marginLeft"},[o,M]),x=on({activeHandleIndex:b,segmentStart:T,onChange:c,onDrag:v,onDragStart:y,onDragEnd:g,values:r,tempValues:z}),W=m.useRef(null),A=m.useRef(null),B=m.useCallback(function(E){var D=ze(W.current);return Ae.getValueForClientX(E,D,s,i,M)},[i,s,M]),K=m.useCallback(function(E){var D=ze(W.current);return Ae.getValueForClientY(E,D,s,i)},[i,s]),ee=m.useCallback(function(E,D){if(p){var I=p.indexOf(E),R=I+D;return R>=0&&R<p.length?p[R]:E}else{var U=E+u*D;return U>=s&&U<=i?U:E}},[i,s,u,p]),te=m.useCallback(function(E){var D=s,I=i;if(p)p.forEach(function(R){R<=E&&R>D&&(D=R),R>=E&&R<I&&(I=R)});else{for(;D<E&&D+u<E;)D+=u;I=Math.min(D+u,i)}return E-D<I-E?+D.toFixed(3):+I.toFixed(3)},[i,s,u,p]),de=m.useCallback(function(E){var D=x(),I=D.activeHandleIndex,R=D.onDrag,U=E.type==="touchmove"?E.changedTouches[0].clientX:E.clientX,_=E.type==="touchmove"?E.changedTouches[0].clientY:E.clientY,ne=o?K(_):B(U),Y=te(ne),Q=[].concat(he(r.slice(0,I)),[Y],he(r.slice(+I+1)));R==null||R(Q),w(Q)},[x,B,K,te,r,o]),pe=m.useCallback(function(E){var D=x(),I=se(D.segmentStart,2),R=I[0],U=I[1],_=D.tempValues,ne=D.onDrag,Y=ze(A.current),Q=Y.left,we=Y.bottom,me=E.type==="touchmove"?E.changedTouches[0].clientX:E.clientX,je=E.type==="touchmove"?E.changedTouches[0].clientY:E.clientY,xe=B(o?we+(je-U):Q+(me-R)),le=te(xe)-_[0];+_[1]+le>i&&(le=0);var ge=[+_[0]+le,+_[1]+le];(_[0]!==ge[0]||_[1]!==ge[1])&&(ne==null||ne(ge),w(ge),P([me,je]))},[x,B,K,te,r,o,i]),be=m.useCallback(function(E,D){var I=x(),R=I.values,U=I.onChange;if(["ArrowLeft","ArrowUp","ArrowRight","ArrowDown"].includes(E.key)){k(D);var _=["ArrowLeft","ArrowDown"].includes(E.key)?-1:1,ne=+ee(R[D],_).toFixed(3),Y=[].concat(he(R.slice(0,D)),[ne],he(R.slice(D+1))),Q=Ne(Y);U==null||U(Q),E.stopPropagation(),E.preventDefault()}},[x,ee]),ae=m.useCallback(function(E,D){var I=x(),R=I.onDragStart,U=I.values;if(D===-1){var _=E.type==="touchmove"?E.nativeEvent.changedTouches[0].clientX:E.nativeEvent.clientX,ne=E.type==="touchmove"?E.nativeEvent.changedTouches[0].clientY:E.nativeEvent.clientY;w(U),P([_,ne])}else k(D);var Y=function Q(we){var me=x(),je=me.tempValues,xe=me.onChange,le=me.onDragEnd;document.removeEventListener("mousemove",D===-1?pe:de),document.removeEventListener("touchmove",D===-1?pe:de),document.removeEventListener("mouseup",Q,{capture:!0}),document.removeEventListener("touchend",Q,{capture:!0});var ge=Ne(je||U);le==null||le(),xe==null||xe(ge),k(void 0),P(void 0),w(void 0)};R==null||R(),document.addEventListener("mousemove",D===-1?pe:de),document.addEventListener("touchmove",D===-1?pe:de),document.addEventListener("mouseup",Y,{capture:!0}),document.addEventListener("touchend",Y,{capture:!0})},[x,de]),J=m.useCallback(function(E){return Ae.getPercentageForValue(E,s,i)},[i,s]),q=m.useCallback(function(E){var D=x(),I=D.onChange,R=D.values,U=E.type==="touchmove"?E.changedTouches[0].clientX:E.clientX,_=E.type==="touchmove"?E.changedTouches[0].clientY:E.clientY,ne=o?K(_):B(U),Y=te(ne),Q=[Y];if(R.length===2)if(R[0]>Y)Q=[Y,R[1]];else if(R[1]<Y)Q=[R[0],Y];else{var we=(R[1]-R[0])/2;R[0]+we>=Y&&(Q=[Y,R[1]]),R[1]-we<=Y&&(Q=[R[0],Y])}I(Q)},[x,B,K,o]);m.useEffect(function(){var E;(E=W.current)===null||E===void 0||E.addEventListener("mousedown",q)},[q]);var Z=m.useMemo(function(){var E=l??p;if(!E){E=[s];for(var D=n-n%u;E[E.length-1]<i-D;)E.push(E[E.length-1]+D);E.push(i)}return E.map(function(I,R){return{key:R,value:I,percentage:J(I),styles:ie(ie({},$,"".concat(J(I),"%")),F,"-0.125rem")}})},[l,J,i,s,p,n,$,F]),re=m.useMemo(function(){var E=Ne(z??r);return[].concat(he(E),[i]).map(function(D,I){var R=I===E.length-1;return{key:I,value:D,active:R,props:R?{ref:A,onMouseDownCapture:function(_){_.stopPropagation(),_.persist(),ae(_,-1)},onTouchStartCapture:function(_){_.stopPropagation(),_.persist(),ae(_,-1)}}:{},styles:function(){var U=J(E[I-1]?E[I-1]:s),_=J(D)-U;return ie(ie({},$,"".concat(U,"%")),o?"height":"width","".concat(_,"%"))}()}})},[J,i,s,z,r,$,F]),ce=m.useMemo(function(){return(z??r).map(function(E,D){return{key:D,value:E,percentage:J(E),active:D===b,props:{role:"slider","aria-valuemin":s,"aria-valuemax":i,"aria-valuenow":E,onKeyDown:function(R){R.stopPropagation(),R.persist(),be(R,D)},onMouseDownCapture:function(R){R.stopPropagation(),R.persist(),ae(R,D)},onTouchStartCapture:function(R){R.stopPropagation(),R.persist(),ae(R,D)}},styles:ie(ie({},$,"".concat(J(E),"%")),F,"-0.375rem"),valueStyles:ie({},$,"".concat(J(E),"%"))}})},[b,J,be,ae,s,i,z,r,$,F]);return{trackElRef:W,activeHandleIndex:b,ticks:Z,segments:re,handles:ce}},ln=["error","name","value","step","min","max","height","color","vertical","showLabels","showValue","minLabel","maxLabel","ranges","useInfinity","format","invalid","autoFocus","disabled","readOnly","onBlur","onChange","onEnterPressed","onFocus","onSlide"];function tt(d,e){var t=Object.keys(d);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(d);e&&(n=n.filter(function(r){return Object.getOwnPropertyDescriptor(d,r).enumerable})),t.push.apply(t,n)}return t}function Ee(d){for(var e=1;e<arguments.length;e++){var t=arguments[e]!=null?arguments[e]:{};e%2?tt(Object(t),!0).forEach(function(n){ie(d,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(d,Object.getOwnPropertyDescriptors(t)):tt(Object(t)).forEach(function(n){Object.defineProperty(d,n,Object.getOwnPropertyDescriptor(t,n))})}return d}var un=function(e){var t=e.error;e.name;var n=e.value,r=e.step,s=r===void 0?1:r,i=e.min,o=i===void 0?0:i,l=e.max,p=l===void 0?100:l,c=e.height,v=c===void 0?192:c,y=e.color,g=e.vertical,u=e.showLabels,h=e.showValue,f=e.minLabel,b=e.maxLabel,k=e.ranges,L=e.useInfinity,C=e.format,T=e.invalid;e.autoFocus;var P=e.disabled,j=e.readOnly;e.onBlur;var S=e.onChange;e.onEnterPressed,e.onFocus;var z=e.onSlide,w=ot(e,ln),M=m.useState(0),$=se(M,2),F=$[0],x=$[1],W=m.useState(!1),A=se(W,2),B=A[0],K=A[1],ee=m.useDeferredValue(n),te=m.useMemo(function(){var q;return(q=k==null?void 0:k[0])!==null&&q!==void 0?q:o},[o,k]),de=m.useMemo(function(){var q;return(q=k==null?void 0:k.slice(-1)[0])!==null&&q!==void 0?q:p},[p,k]);m.useEffect(function(){x(L&&ee===1/0?p:ee??o)},[ee,o,p,L]),m.useEffect(function(){K(!!h)},[h]);var pe=m.useCallback(function(q){var Z=L&&q===p?1/0:q;x(Z??0),S==null||S(Z??null)},[S,p,L]),be=m.useMemo(function(){return a.jsx("span",{className:"text-sm text-dimmed px-2.5 py-px whitespace-nowrap overflow-hidden text-center",children:f??oe.number(o,C)})},[f,o,C]),ae=m.useMemo(function(){return a.jsx("span",{className:"text-sm text-dimmed px-2.5 py-px whitespace-nowrap overflow-hidden text-center",children:b??(L?"∞":oe.number(p,C))})},[b,p,C,L]),J=an({values:[F],min:te,max:de,stepSize:s,steps:k,vertical:g,tickSize:Math.max((p-o)/10,s),onDrag:function(Z){return z==null?void 0:z(Z[0])},onDragStart:function(){return K(!0)},onDragEnd:function(){return K(!!h)},onChange:function(Z){return pe(Z[0])}});return a.jsx(Gt,Ee(Ee({},w),{},{noOutline:!0,error:t,invalid:T,isDisabled:P,isReadOnly:j,canClear:!!F,children:a.jsxs("div",{className:X("flex-1 order-3 flex items-center select-none relative z-0",g&&"flex-col w-8",T?"text-danger-500":"text-primary-600"),"data-vertical":!!g,style:T?void 0:{color:y},children:[u&&(g?ae:be),a.jsxs("div",{ref:J.trackElRef,className:X("flex-1 relative flex items-center",g?"my-2 w-8":"mx-2 h-8"),style:{height:g?v:void 0},children:[J.ticks.map(function(q){q.value;var Z=q.key,re=q.styles;return a.jsx("div",{className:X("absolute inline-block h-1 w-1 rounded-sm bg-invert opacity-30 leading-[0] z-1",g&&"left-1/2 -ml-0.5"),style:re},Z)}),J.segments.map(function(q){var Z=q.key,re=q.styles,ce=q.active;return a.jsx("div",{className:X("absolute",ce?"bg-current z-1 opacity-90":"bg-invert opacity-5 z-0",g?"-bottom-1 left-1/2 -translate-x-1/2":"top-1/2 -translate-y-1/2",!g&&(ce?"h-1":"h-0.5"),g&&(ce?"w-1":"w-0.5")),style:re},Z)}),J.handles.map(function(q){var Z=q.key,re=q.value,ce=q.props,E=q.styles,D=q.percentage,I=q.valueStyles;return a.jsxs(m.Fragment,{children:[a.jsx("button",Ee(Ee({type:"button",className:X("bg-current cursor-pointer appearance-none h-3 w-3 rounded-full z-3 absolute","focus:ring-2 focus:ring-offset-2",g&&"left-1/2 -ml-1.5")},ce),{},{style:E})),B&&a.jsx("div",{className:X("bg-invert text-invert py-px px-2 text-xs absolute rounded z-[5] whitespace-nowrap","before:absolute before:h-1.5 before:w-1.5 before:z-[-1] before:bg-invert before:top-1/2 before:-translate-y-1/2 before:rotate-45",g?"end-0 ltr:translate-x-full rtl:-translate-x-full translate-y-2":"top-1/2 -translate-y-1/2",!g&&(D>50?"-ms-3 ltr:-translate-x-full rtl:translate-x-full ltr:before:translate-x-[0.125rem] rtl:before:-translate-x-[0.125rem] before:end-0":"ms-3 ltr:before:-translate-x-[0.125rem] rtl:before:translate-x-[0.125rem] before:start-0")),"data-align":D>50?"start":"end",style:I,children:re===1/0||L&&re===p?b??"∞":oe.number(re,C)})]},Z)})]}),u&&(g?be:ae)]})}))};const ct=({box:d,label:e,index:t,ratio:n,maxWidth:r,maxHeight:s,onChange:i,onRemove:o,color:l="var(--color-marigold)"})=>{const p=m.useMemo(()=>{const[u,h,f,b]=Ve(d);return{left:u*n,top:h*n,width:f*n,height:b*n}},[d,n]),[c,v]=m.useReducer((u,h)=>{if(h.type==="dragstart"&&(u.dragging=!0,u.mode=h.mode,u.pos={...h.defaultPos},u.startPos={...h.defaultPos},u.startPoint=h.startPoint),h.type==="dragend"&&(u.dragging=!1),h.type==="move"){const f=h.point[0]-u.startPoint[0],b=h.point[1]-u.startPoint[1];u.pos.top=u.startPos.top+b,u.pos.left=u.startPos.left+f}if(h.type==="x"||h.type==="xh"||h.type==="xy"){const f=h.point[0]-u.startPoint[0];u.pos.left=u.startPos.left+f,u.pos.left>=0&&(u.pos.width=u.startPos.width-f)}if(h.type==="y"||h.type==="xy"||h.type==="yw"){const f=h.point[1]-u.startPoint[1];u.pos.top=u.startPos.top+f,u.pos.top&&(u.pos.height=u.startPos.height-f)}if(h.type==="w"||h.type==="yw"||h.type==="wh"){const f=h.point[0]-u.startPoint[0];u.pos.width=u.startPos.width+f}if(h.type==="h"||h.type==="xh"||h.type==="wh"){const f=h.point[1]-u.startPoint[1];u.pos.height=u.startPos.height+f}return u.pos.top=Math.max(u.pos.top,0),u.pos.left=Math.max(u.pos.left,0),u.pos.width=Math.max(u.pos.width,16),u.pos.height=Math.max(u.pos.height,16),u.pos.top+u.pos.height>s&&(u.pos.height=s-u.pos.top),u.pos.left+u.pos.width>r&&(u.pos.width=r-u.pos.left),{...u}},{dragging:!1}),y=m.useMemo(()=>c.dragging?c.pos:p,[c.dragging,c.pos,p]),g=m.useCallback((u,h)=>{h.stopPropagation(),h.preventDefault(),v({type:"dragstart",mode:u,defaultPos:p,startPoint:[h.clientX,h.clientY]})},[p]);return m.useEffect(()=>{const u=b=>{v({type:c.mode,point:[b.clientX,b.clientY]})},h=b=>{v({type:"dragend"});const{top:k,left:L,width:C,height:T}=c.pos;i==null||i([L,k,C,T])},f=b=>{b.code==="Escape"&&v({type:"dragend",cancelled:!0})};return c.dragging&&document.addEventListener("mousemove",u),c.dragging&&document.addEventListener("mouseup",h),c.dragging&&document.addEventListener("keydown",f),()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",h),document.removeEventListener("keydown",f)}},[c.dragging,c.mode,i]),a.jsxs("div",{role:"none",className:X("outline-2 -outline-offset-1 outline-current absolute group cursor-move hover:z-10","before:absolute before:inset-0 before:bg-current",c.dragging?"before:opacity-30":"before:opacity-10"),style:{...y,color:l},onMouseDown:u=>g("move",u),children:[a.jsx("button",{className:"bg-danger text-white cursor-pointer leading-none p-0.5 text-sm opacity-0 group-hover:opacity-60 hover:opacity-90 absolute top-0 right-0",onMouseDown:u=>[u.stopPropagation(),o()],children:a.jsx(ue,{icon:N.trash})}),a.jsx("div",{className:"absolute left-0 bottom-full max-w-full truncate select-none pointer-events-none text-xs bg-current font-medium leading-tight px-0.5",style:{color:l},children:a.jsx("span",{className:"mix-blend-luminosity",style:{filter:"invert(1) grayscale(1) brightness(1.3) contrast(9000)"},children:e??t})}),a.jsx("div",{role:"none",onMouseDown:u=>g("y",u),className:"absolute top-0 inset-x-0 h-2 cursor-ns-resize"}),a.jsx("div",{role:"none",onMouseDown:u=>g("h",u),className:"absolute bottom-0 inset-x-0 h-2 cursor-ns-resize"}),a.jsx("div",{role:"none",onMouseDown:u=>g("x",u),className:"absolute left-0 inset-y-0 w-2 cursor-ew-resize"}),a.jsx("div",{role:"none",onMouseDown:u=>g("w",u),className:"absolute right-0 inset-y-0 w-2 cursor-ew-resize"}),a.jsx("div",{role:"none",onMouseDown:u=>g("xy",u),className:"absolute top-0 left-0 size-2 cursor-nwse-resize border-t-2 border-l-2 border-black/90"}),a.jsx("div",{role:"none",onMouseDown:u=>g("xh",u),className:"absolute bottom-0 left-0 size-2 cursor-nesw-resize border-b-2 border-l-2 border-black/90"}),a.jsx("div",{role:"none",onMouseDown:u=>g("yw",u),className:"absolute top-0 right-0 size-2 cursor-nesw-resize border-t-2 border-r-2 border-black/90"}),a.jsx("div",{role:"none",onMouseDown:u=>g("wh",u),className:"absolute bottom-0 right-0 size-2 cursor-nwse-resize border-b-2 border-r-2 border-black/90"})]})};ct.__docgenInfo={description:"",methods:[],displayName:"Annotation",props:{box:{required:!0,tsType:{name:"union",raw:"string | [number, number, number, number]",elements:[{name:"string"},{name:"tuple",raw:"[number, number, number, number]",elements:[{name:"number"},{name:"number"},{name:"number"},{name:"number"}]}]},description:""},label:{required:!1,tsType:{name:"string"},description:""},color:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"var(--color-marigold)"',computed:!1}},data:{required:!1,tsType:{name:"T"},description:""},index:{required:!0,tsType:{name:"number"},description:""},ratio:{required:!0,tsType:{name:"number"},description:""},maxWidth:{required:!0,tsType:{name:"number"},description:""},maxHeight:{required:!0,tsType:{name:"number"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(box: [number, number, number, number]) => void",signature:{arguments:[{type:{name:"tuple",raw:"[number, number, number, number]",elements:[{name:"number"},{name:"number"},{name:"number"},{name:"number"}]},name:"box"}],return:{name:"void"}}},description:""},onRemove:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const dn=({maxHeight:d,maxWidth:e,offset:t,onAdd:n})=>{const[r,s]=m.useReducer((o,l)=>{if(l.type==="dragstart"&&(o.dragging=!0,console.log(t,l.startPoint),o.pos={left:l.startPoint[0]-t[0],top:l.startPoint[1]-t[1],height:1,width:1},o.startPoint=l.startPoint),l.type==="dragend"&&(o.dragging=!1),l.type==="drag"){const p=l.point[0]-o.startPoint[0],c=l.point[1]-o.startPoint[1];p>0?o.pos.width=p:(o.pos.left=l.point[0]-t[0],o.pos.width=Math.abs(p)),p>0?o.pos.height=c:(o.pos.top=l.point[1]-t[1],o.pos.height=Math.abs(c))}return o.pos.top=Math.max(o.pos.top,0),o.pos.left=Math.max(o.pos.left,0),o.pos.width=Math.max(o.pos.width,1),o.pos.height=Math.max(o.pos.height,1),o.pos.top+o.pos.height>d&&(o.pos.height=d-o.pos.top),o.pos.left+o.pos.width>e&&(o.pos.width=e-o.pos.left),{...o}},{dragging:!1}),i=m.useCallback(o=>{o.stopPropagation(),o.preventDefault(),s({type:"dragstart",startPoint:[o.clientX,o.clientY]})},[]);return m.useEffect(()=>{const o=c=>{s({type:"drag",point:[c.clientX,c.clientY]})},l=c=>{s({type:"dragend"});const{top:v,left:y,width:g,height:u}=r.pos;n==null||n([y,v,Math.max(g,16),Math.max(u,16)])},p=c=>{c.code==="Escape"&&s({type:"dragend",cancelled:!0})};return r.dragging&&document.addEventListener("mousemove",o),r.dragging&&document.addEventListener("mouseup",l),r.dragging&&document.addEventListener("keydown",p),()=>{document.removeEventListener("mousemove",o),document.removeEventListener("mouseup",l),document.removeEventListener("keydown",p)}},[r.dragging]),{startDragging:i,addPlaceholder:r.dragging&&a.jsx("div",{className:X("outline-2 -outline-offset-1 outline-dashed outline-current absolute group cursor-move hover:z-10","before:absolute before:inset-0 before:bg-current",r.dragging?"before:opacity-30":"before:opacity-10"),style:{...r.pos,color:"var(--color-marigold)"}})}},cn=m.createContext({}),ht=({src:d,annotations:e,onChange:t,onError:n,onLoad:r,onAdd:s})=>{const i=Xt(()=>{l({type:"resize"})}),[o,l]=m.useReducer((h,f)=>{var b,k,L,C;if(f.type==="loading"&&(h.isLoading=!0,h.isLoaded=!1,h.isErrored=!1),f.type==="loaded"&&(h.isLoading=!1,h.isLoaded=!0,i.current&&(h.pos={top:i.current.offsetTop,left:i.current.offsetLeft,width:i.current.offsetWidth,height:i.current.offsetHeight},h.offset=[((b=i.current.parentElement)==null?void 0:b.offsetLeft)??0,((k=i.current.parentElement)==null?void 0:k.offsetTop)??0],h.ratio=i.current.offsetWidth/i.current.naturalWidth)),f.type==="errored"&&(h.isLoading=!1,h.isLoaded=!1,h.isErrored=!0),f.type==="resize"&&i.current&&(h.pos={top:i.current.offsetTop,left:i.current.offsetLeft,width:i.current.offsetWidth,height:i.current.offsetHeight},h.offset=[((L=i.current.parentElement)==null?void 0:L.offsetLeft)??0,((C=i.current.parentElement)==null?void 0:C.offsetTop)??0],h.ratio=i.current.offsetWidth/i.current.naturalWidth),f.type==="change"&&(h.annotations=f.annotations),f.type==="add"&&(h.annotations.push({box:f.box,label:f.label}),setTimeout(()=>{t==null||t(h.annotations)},10)),f.type==="update"){const T=h.annotations[f.index],[P,j,S,z]=f.box;T.box=[P/h.ratio,j/h.ratio,S/h.ratio,z/h.ratio],h.annotations.splice(f.index,1,{...T}),setTimeout(()=>{t==null||t(h.annotations)},10)}return f.type==="remove"&&(h.annotations.splice(f.index,1),setTimeout(()=>{t==null||t(h.annotations)},10)),{...h}},{isLoaded:!1,isLoading:!1,isErrored:!1,pos:{top:0,left:0,width:0,height:0},offset:[0,0],ratio:0}),{addPlaceholder:p,startDragging:c}=dn({maxHeight:o.pos.height,maxWidth:o.pos.width,offset:o.offset,async onAdd(h){const f=await Promise.resolve(s==null?void 0:s());l({type:"add",box:h,label:f})}});m.useEffect(()=>{l({type:"loading",src:d})},[d]),m.useEffect(()=>{l({type:"change",annotations:e})},[e]);const v=m.useCallback(()=>{l({type:"loaded"}),r==null||r()},[r]),y=m.useCallback(()=>{l({type:"errored"}),n==null||n()},[n]),g=m.useCallback((h,f)=>{l({type:"update",index:h,box:f})},[]),u=m.useCallback(h=>{l({type:"remove",index:h})},[]);return a.jsxs(cn.Provider,{value:{...o,handleLoad:v},children:[a.jsxs("div",{className:"relative",children:[d&&a.jsx("img",{src:d,alt:"annotate",ref:i,className:"max-w-full",onLoad:v,onError:y}),a.jsxs("div",{role:"none",style:o.pos,className:"absolute cursor-crosshair",onMouseDown:c,children:[o.isLoaded&&o.annotations.map((h,f)=>a.jsx(ct,{...h,index:f,ratio:o.ratio,maxWidth:o.pos.width,maxHeight:o.pos.height,onRemove:()=>u(f),onChange:b=>g(f,b)},f)),p]})]}),o.isErrored&&a.jsx(ue,{icon:N.mediaImageBroken}),o.isLoading&&a.jsx(He,{})]})};ht.__docgenInfo={description:"",methods:[],displayName:"AnnotatorProvider",props:{src:{required:!0,tsType:{name:"string"},description:"image source"},annotations:{required:!0,tsType:{name:"Array",elements:[{name:"AnnotationItem",elements:[{name:"T"}],raw:"AnnotationItem<T>"}],raw:"Array<AnnotationItem<T>>"},description:"image annotations"},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"image load handler"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"image load error"},onAdd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => string | undefined | Promise<string | undefined>",signature:{arguments:[],return:{name:"union",raw:"string | undefined | Promise<string | undefined>",elements:[{name:"string"},{name:"undefined"},{name:"Promise",elements:[{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}],raw:"Promise<string | undefined>"}]}}},description:"annotation added"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(annotations: Array<AnnotationItem<T>>) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"AnnotationItem",elements:[{name:"T"}],raw:"AnnotationItem<T>"}],raw:"Array<AnnotationItem<T>>"},name:"annotations"}],return:{name:"void"}}},description:"annotations changed"}}};const hn=d=>a.jsx(_e,{dir:"ltr",children:a.jsx("div",{className:"area-content grid place-items-center overflow-auto p-2",children:a.jsx(ht,{...d})})});hn.__docgenInfo={description:`Annotator component provides a user interface for annotating images.
It allows users to draw shapes, add text, and highlight areas on the image.
It is designed to be used within a section of the application,
providing a grid layout for the content area.

@param {AnnotatorProps<T>} props - The properties for the Annotator component.
@returns {JSX.Element} The rendered Annotator component.

@example
\`\`\`jsx
<Annotator
  imageUrl="https://example.com/image.jpg"
  annotations={[]}
  onSave={(annotations) => console.log(annotations)}
  onCancel={() => console.log("Cancelled")}
/>
\`\`\`

@see {@link https://adarshpastakia.github.io/react-fabric/?path=/story/media-annotator--annotator} for more details on the properties.`,methods:[],displayName:"Annotator",props:{src:{required:!0,tsType:{name:"string"},description:"image source"},annotations:{required:!0,tsType:{name:"Array",elements:[{name:"AnnotationItem",elements:[{name:"T"}],raw:"AnnotationItem<T>"}],raw:"Array<AnnotationItem<T>>"},description:"image annotations"},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"image load handler"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"image load error"},onAdd:{required:!1,tsType:{name:"signature",type:"function",raw:"() => string | undefined | Promise<string | undefined>",signature:{arguments:[],return:{name:"union",raw:"string | undefined | Promise<string | undefined>",elements:[{name:"string"},{name:"undefined"},{name:"Promise",elements:[{name:"union",raw:"string | undefined",elements:[{name:"string"},{name:"undefined"}]}],raw:"Promise<string | undefined>"}]}}},description:"annotation added"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(annotations: Array<AnnotationItem<T>>) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"AnnotationItem",elements:[{name:"T"}],raw:"AnnotationItem<T>"}],raw:"Array<AnnotationItem<T>>"},name:"annotations"}],return:{name:"void"}}},description:"annotations changed"}}};const pt=m.createContext({}),Be=()=>m.useContext(pt),H=[32,64,128,256,512,1e3,2e3,4e3,6e3,8e3,12e3,16e3],$e=m.memo(({index:d,value:e,label:t,onChange:n,color:r="#0d9488",forChannel:s=!1})=>a.jsx("div",{style:{width:"2.5rem"},"data-negative":e===0?"zero":e<0,"data-for-channel":s,dir:d==="left"?"rtl":"ltr",children:a.jsx(un,{vertical:!0,step:1,height:128,value:e,showLabels:!0,color:e<0?"#e11d48":r,"data-channel":s,maxLabel:`${!s&&e>0?"+":""}${~~e}`,minLabel:t,min:s?0:-40,max:s?100:40,onChange:i=>n(d,i)})}));$e.displayName="Audio.EQSlider";const Fe=m.memo(()=>{const{wavesurfer:d,state:e}=Be(),t=m.useRef(null),n=m.useRef(null),[r,s]=m.useState([]),[i,o]=m.useState(),l=m.useCallback(()=>{if(d){const g=[{f:H[0],name:"32",type:"lowshelf"},{f:H[1],name:"64",type:"peaking"},{f:H[2],name:"128",type:"peaking"},{f:H[3],name:"256",type:"peaking"},{f:H[4],name:"512",type:"peaking"},{f:H[5],name:"1k",type:"peaking"},{f:H[6],name:"2k",type:"peaking"},{f:H[7],name:"4k",type:"peaking"},{f:H[8],name:"6k",type:"peaking"},{f:H[9],name:"8k",type:"peaking"},{f:H[10],name:"12k",type:"highshelf"},{f:H[11],name:"16k",type:"highshelf"}];t.current||(t.current=new AudioContext,n.current=t.current.createMediaElementSource(d.instance.getMediaElement()));const u=t.current,h=n.current;if(u&&h){const f=g.map(function(T){const P=u.createBiquadFilter();return P.type=T.type,P.gain.value=0,P.Q.value=1,P.frequency.value=T.f,P}),b=[],k=[],L=d.instance.decodedData.numberOfChannels;if(L>1){const T=u.createChannelSplitter(L),P=u.createChannelMerger(L);b.push(T);for(let j=0;j<L;j++){const S=u.createGain();T.connect(S,j),S.gain.value=1,S.connect(P,0,j),b.push(S),k.push(S)}o(k),b.push(P)}[...f,...b].reduce((T,P)=>(T.connect(P),P),h).connect(u.destination),s(f)}}},[d]);m.useEffect(()=>{d&&d.instance.on("ready",l)},[d,l]),m.useLayoutEffect(()=>{document.addEventListener("mousedown",()=>{var g;(g=t.current)==null||g.resume()},{capture:!0}),document.addEventListener("keydown",()=>{var g;(g=t.current)==null||g.resume()},{capture:!0})},[]);const p=m.useCallback((g,u)=>{const h=[...r];h[g].gain.value=~~u,s([...h])},[r]),c=m.useCallback(()=>{s(r.map(g=>(g.gain.value=0,g)))},[r]),v=m.useCallback(g=>{const u=g==="speech";s(r.map(h=>(h.frequency.value===H[0]&&(h.gain.value=u?-40:0),h.frequency.value===H[1]&&(h.gain.value=u?-30:10),h.frequency.value===H[2]&&(h.gain.value=u?-20:30),h.frequency.value===H[3]&&(h.gain.value=u?0:10),h.frequency.value===H[4]&&(h.gain.value=u?20:-20),h.frequency.value===H[5]&&(h.gain.value=u?20:-40),h.frequency.value===H[6]&&(h.gain.value=u?20:-40),h.frequency.value===H[7]&&(h.gain.value=u?20:-20),h.frequency.value===H[8]&&(h.gain.value=u?0:10),h.frequency.value===H[9]&&(h.gain.value=u?-20:30),h.frequency.value===H[10]&&(h.gain.value=u?-30:10),h.frequency.value===H[11]&&(h.gain.value=u?-40:0),h)))},[r]),y=m.useCallback((g,u)=>{if(i!=null){const h=i[g];h.gain.value=u/100,o([...i])}},[i]);return e.showEqs?a.jsxs("div",{className:"flex flex-row h-[192px] justify-center overflow-x-auto",children:[i!=null&&a.jsxs(m.Fragment,{children:[i.map((g,u)=>{var h,f,b,k,L,C;return a.jsx($e,{forChannel:!0,index:u,label:a.jsx(ue,{size:"1.25rem",onClick:()=>y(u,g.gain.value>0?0:100),icon:N.mediaChannel,color:(b=(f=(h=d==null?void 0:d.instance.options.splitChannels)==null?void 0:h[u])==null?void 0:f.waveColor)==null?void 0:b.toString()}),value:g.gain.value*100,onChange:y,color:(C=(L=(k=d==null?void 0:d.instance.options.splitChannels)==null?void 0:k[u])==null?void 0:L.waveColor)==null?void 0:C.toString()},u)}),a.jsx(Le,{vertical:!0})]}),r.map((g,u)=>a.jsx($e,{index:u,label:g.name,value:g.gain.value,onChange:p},u)),a.jsx(Le,{vertical:!0}),a.jsxs("div",{style:{width:196},className:"self-center",children:[a.jsx(Zt,{className:"text-muted text-sm text-center",children:"Presets"}),a.jsx(V,{fullWidth:!0,onClick:()=>v("speech"),children:"Speech"}),a.jsx(V,{fullWidth:!0,onClick:()=>v("back"),children:"Background Noise"}),a.jsx(V,{fullWidth:!0,onClick:c,color:"danger",children:"Reset"})]})]}):null});Fe.displayName="Audio.Equalizers";Fe.__docgenInfo={description:"",methods:[],displayName:"Audio.Equalizers"};const mt=()=>{const[d,e]=m.useState(0),{wavesurfer:t}=Be();return m.useEffect(()=>(t==null||t.instance.on("loading",e),()=>{t==null||t.instance.un("loading",e)}),[t]),a.jsx("div",{className:"absolute inset-0 grid place-content-center",children:a.jsx(sn,{value:d})})};mt.__docgenInfo={description:"",methods:[],displayName:"Loading"};const ke=({max:d,min:e=0,icon:t,value:n,textIcon:r,disabled:s,onClick:i,onChange:o})=>{const l=m.useRef(null),p=c=>{l.current&&(l.current.valueAsNumber=Math.max(e,Math.min(d,l.current.valueAsNumber+(c<0?-.01:.01))),o(l.current.valueAsNumber))};return a.jsxs(Re,{placement:"top",dropdownEvent:"hover",plainDropdown:!0,dropdownClassName:"bg-tint-50/50 backdrop-blur h-28 w-8 relative !rounded-none overflow-visible",children:[a.jsx(V,{variant:"link","aria-label":"slider",disabled:s,className:X(r&&"fabric-btnTextIcon"),icon:t,onClick:i,onWheel:c=>(p(c.deltaY),c.stopPropagation(),!1)}),a.jsx("input",{type:"range",dir:"ltr",min:e,max:d,step:.01,value:n,ref:l,onChange:()=>{var c;return o(((c=l.current)==null?void 0:c.valueAsNumber)??0)},onWheel:c=>(p(c.deltaY),c.stopPropagation(),!1),className:X("fabric-media-slider","w-24 absolute -bottom-2 left-4 origin-left -rotate-90")})]})};ke.__docgenInfo={description:"",methods:[],displayName:"MiniSlider",props:{textIcon:{required:!1,tsType:{name:"boolean"},description:""},min:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}},max:{required:!0,tsType:{name:"number"},description:""},icon:{required:!0,tsType:{name:"string"},description:""},value:{required:!0,tsType:{name:"number"},description:""},disabled:{required:!1,tsType:{name:"boolean"},description:""},onClick:{required:!0,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(value: number) => void",signature:{arguments:[{type:{name:"number"},name:"value"}],return:{name:"void"}}},description:""}}};const Ue=({duration:d,time:e,onChange:t,children:n})=>a.jsxs(a.Fragment,{children:[a.jsxs("div",{className:"flex-1 relative flex",children:[a.jsx("input",{type:"range",className:X("fabric-media-slider","fabric-media-timeSlider"),min:0,max:Math.max(d,e),step:.01,value:e,onChange:r=>t(r.currentTarget.valueAsNumber??0)}),n]}),a.jsx("span",{className:"text-dimmed text-xs px-1",children:`${oe.duration(e,!0)}/${oe.duration(d,!0)}`})]});Ue.__docgenInfo={description:"",methods:[],displayName:"TimeSlider",props:{duration:{required:!0,tsType:{name:"number"},description:""},time:{required:!0,tsType:{name:"number"},description:""},onChange:{required:!0,tsType:{name:"signature",type:"function",raw:"(time: number) => void",signature:{arguments:[{type:{name:"number"},name:"time"}],return:{name:"void"}}},description:""}}};const gt=()=>{const{audioRef:d,state:e,toggleEqs:t}=Be(),n=m.useMemo(()=>e.volume===0?N.mediaVolume0:e.volume<=.4?N.mediaVolume1:e.volume<=.7?N.mediaVolume2:N.mediaVolume3,[e.volume]),r=m.useMemo(()=>({togglePlay:async()=>{var s,i,o;return(s=d.current)!=null&&s.paused?await((i=d.current)==null?void 0:i.play()):(o=d.current)==null?void 0:o.pause()},mute:()=>d.current&&(d.current.volume=d.current.volume===0?.5:0),volumeUp:()=>d.current&&d.current.volume<1&&(d.current.volume=Math.min(1,d.current.volume+.1)),volumeDown:()=>d.current&&d.current.volume>0&&(d.current.volume=Math.max(0,d.current.volume-.1)),jumpDown:()=>d.current&&d.current.currentTime>0&&(d.current.currentTime-=1),jumpUp:()=>d.current&&(d.current.currentTime+=1),seekDown:()=>d.current&&d.current.currentTime>0&&(d.current.currentTime-=.165),seekUp:()=>d.current&&(d.current.currentTime+=.165),speedDown:()=>d.current&&d.current.playbackRate>0&&(d.current.playbackRate-=.5),speedUp:()=>d.current&&d.current.playbackRate<5&&(d.current.playbackRate+=.5),toggleEqs:()=>t()}),[]);return a.jsxs(fe,{flex:!0,className:"select-none bg-tint-50",children:[e.isLoaded&&a.jsxs(m.Fragment,{children:[a.jsx(O,{global:!0,keyCombo:"space",handler:r.togglePlay}),a.jsx(O,{global:!0,keyCombo:"0",handler:r.mute}),a.jsx(O,{global:!0,keyCombo:"q",handler:r.toggleEqs}),a.jsx(O,{global:!0,keyCombo:",",handler:r.jumpDown}),a.jsx(O,{global:!0,keyCombo:".",handler:r.jumpUp}),a.jsx(O,{global:!0,keyCombo:"-",handler:r.volumeDown}),a.jsx(O,{global:!0,keyCombo:"=",handler:r.volumeUp}),a.jsx(O,{global:!0,keyCombo:"shift+{",handler:r.speedDown}),a.jsx(O,{global:!0,keyCombo:"shift+}",handler:r.speedUp}),a.jsx(O,{global:!0,keyCombo:"shift+<",handler:r.seekDown}),a.jsx(O,{global:!0,keyCombo:"shift+>",handler:r.seekUp})]}),a.jsx(V,{variant:"link","aria-label":"togglePlay",onClick:r.togglePlay,icon:e.isPlaying?N.mediaPause:N.mediaPlay}),a.jsx(ke,{icon:n,value:e.volume,disabled:!e.isLoaded,max:1,onClick:()=>{const s=e.volume===1?0:e.volume>=.5?1:.5;d.current&&(d.current.volume=s)},onChange:s=>d.current&&(d.current.volume=s)}),a.jsx(ke,{icon:`${e.speed.toFixed(1)}x`,value:e.speed,disabled:!e.isLoaded,max:5,min:.1,textIcon:!0,onClick:()=>{const s=e.speed>=2?.5:e.speed>=1.5?2:e.speed>=1?1.5:e.volume>=.5?1:.5;d.current&&(d.current.playbackRate=s)},onChange:s=>d.current&&(d.current.playbackRate=s)}),a.jsx(Ue,{time:e.time,duration:e.duration,onChange:s=>d.current&&(d.current.currentTime=s)}),a.jsx(V,{"aria-label":"eqs",variant:e.showEqs?"solid":"link",onClick:t,disabled:!e.isLoaded,icon:N.mediaEqs})]})};gt.__docgenInfo={description:"",methods:[],displayName:"Tools"};function G(d,e,t,n){return new(t||(t=Promise))(function(r,s){function i(p){try{l(n.next(p))}catch(c){s(c)}}function o(p){try{l(n.throw(p))}catch(c){s(c)}}function l(p){var c;p.done?r(p.value):(c=p.value,c instanceof t?c:new t(function(v){v(c)})).then(i,o)}l((n=n.apply(d,e||[])).next())})}let Te=class{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),n==null?void 0:n.once){const r=()=>{this.un(e,r),this.un(e,t)};return this.on(e,r),r}return()=>this.un(e,t)}un(e,t){var n;(n=this.listeners[e])===null||n===void 0||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(n=>n(...t))}};const Se={decode:function(d,e){return G(this,void 0,void 0,function*(){const t=new AudioContext({sampleRate:e});return t.decodeAudioData(d).finally(()=>t.close())})},createBuffer:function(d,e){return typeof d[0]=="number"&&(d=[d]),function(t){const n=t[0];if(n.some(r=>r>1||r<-1)){const r=n.length;let s=0;for(let i=0;i<r;i++){const o=Math.abs(n[i]);o>s&&(s=o)}for(const i of t)for(let o=0;o<r;o++)i[o]/=s}}(d),{duration:e,length:d[0].length,sampleRate:d[0].length/e,numberOfChannels:d.length,getChannelData:t=>d==null?void 0:d[t],copyFromChannel:AudioBuffer.prototype.copyFromChannel,copyToChannel:AudioBuffer.prototype.copyToChannel}}};function ft(d,e){const t=e.xmlns?document.createElementNS(e.xmlns,d):document.createElement(d);for(const[n,r]of Object.entries(e))if(n==="children")for(const[s,i]of Object.entries(e))typeof i=="string"?t.appendChild(document.createTextNode(i)):t.appendChild(ft(s,i));else n==="style"?Object.assign(t.style,r):n==="textContent"?t.textContent=r:t.setAttribute(n,r.toString());return t}function nt(d,e,t){const n=ft(d,e||{});return t==null||t.appendChild(n),n}var pn=Object.freeze({__proto__:null,createElement:nt,default:nt});const mn={fetchBlob:function(d,e,t){return G(this,void 0,void 0,function*(){const n=yield fetch(d,t);if(n.status>=400)throw new Error(`Failed to fetch ${d}: ${n.status} (${n.statusText})`);return function(r,s){G(this,void 0,void 0,function*(){if(!r.body||!r.headers)return;const i=r.body.getReader(),o=Number(r.headers.get("Content-Length"))||0;let l=0;const p=v=>G(this,void 0,void 0,function*(){l+=(v==null?void 0:v.length)||0;const y=Math.round(l/o*100);s(y)}),c=()=>G(this,void 0,void 0,function*(){let v;try{v=yield i.read()}catch{return}v.done||(p(v.value),yield c())});c()})}(n.clone(),e),n.blob()})}};class gn extends Te{constructor(e){super(),this.isExternalMedia=!1,e.media?(this.media=e.media,this.isExternalMedia=!0):this.media=document.createElement("audio"),e.mediaControls&&(this.media.controls=!0),e.autoplay&&(this.media.autoplay=!0),e.playbackRate!=null&&this.onMediaEvent("canplay",()=>{e.playbackRate!=null&&(this.media.playbackRate=e.playbackRate)},{once:!0})}onMediaEvent(e,t,n){return this.media.addEventListener(e,t,n),()=>this.media.removeEventListener(e,t,n)}getSrc(){return this.media.currentSrc||this.media.src||""}revokeSrc(){const e=this.getSrc();e.startsWith("blob:")&&URL.revokeObjectURL(e)}canPlayType(e){return this.media.canPlayType(e)!==""}setSrc(e,t){const n=this.getSrc();if(e&&n===e)return;this.revokeSrc();const r=t instanceof Blob&&(this.canPlayType(t.type)||!e)?URL.createObjectURL(t):e;n&&(this.media.src="");try{this.media.src=r}catch{this.media.src=e}}destroy(){this.isExternalMedia||(this.media.pause(),this.media.remove(),this.revokeSrc(),this.media.src="",this.media.load())}setMediaElement(e){this.media=e}play(){return G(this,void 0,void 0,function*(){return this.media.play()})}pause(){this.media.pause()}isPlaying(){return!this.media.paused&&!this.media.ended}setTime(e){this.media.currentTime=Math.max(0,Math.min(e,this.getDuration()))}getDuration(){return this.media.duration}getCurrentTime(){return this.media.currentTime}getVolume(){return this.media.volume}setVolume(e){this.media.volume=e}getMuted(){return this.media.muted}setMuted(e){this.media.muted=e}getPlaybackRate(){return this.media.playbackRate}isSeeking(){return this.media.seeking}setPlaybackRate(e,t){t!=null&&(this.media.preservesPitch=t),this.media.playbackRate=e}getMediaElement(){return this.media}setSinkId(e){return this.media.setSinkId(e)}}class ve extends Te{constructor(e,t){super(),this.timeouts=[],this.isScrollable=!1,this.audioData=null,this.resizeObserver=null,this.lastContainerWidth=0,this.isDragging=!1,this.subscriptions=[],this.unsubscribeOnScroll=[],this.subscriptions=[],this.options=e;const n=this.parentFromOptionsContainer(e.container);this.parent=n;const[r,s]=this.initHtml();n.appendChild(r),this.container=r,this.scrollContainer=s.querySelector(".scroll"),this.wrapper=s.querySelector(".wrapper"),this.canvasWrapper=s.querySelector(".canvases"),this.progressWrapper=s.querySelector(".progress"),this.cursor=s.querySelector(".cursor"),t&&s.appendChild(t),this.initEvents()}parentFromOptionsContainer(e){let t;if(typeof e=="string"?t=document.querySelector(e):e instanceof HTMLElement&&(t=e),!t)throw new Error("Container not found");return t}initEvents(){const e=t=>{const n=this.wrapper.getBoundingClientRect(),r=t.clientX-n.left,s=t.clientY-n.top;return[r/n.width,s/n.height]};if(this.wrapper.addEventListener("click",t=>{const[n,r]=e(t);this.emit("click",n,r)}),this.wrapper.addEventListener("dblclick",t=>{const[n,r]=e(t);this.emit("dblclick",n,r)}),this.options.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.scrollContainer.addEventListener("scroll",()=>{const{scrollLeft:t,scrollWidth:n,clientWidth:r}=this.scrollContainer,s=t/n,i=(t+r)/n;this.emit("scroll",s,i,t,t+r)}),typeof ResizeObserver=="function"){const t=this.createDelay(100);this.resizeObserver=new ResizeObserver(()=>{t().then(()=>this.onContainerResize()).catch(()=>{})}),this.resizeObserver.observe(this.scrollContainer)}}onContainerResize(){const e=this.parent.clientWidth;e===this.lastContainerWidth&&this.options.height!=="auto"||(this.lastContainerWidth=e,this.reRender())}initDrag(){this.subscriptions.push(function(e,t,n,r,s=3,i=0,o=100){if(!e)return()=>{};const l=matchMedia("(pointer: coarse)").matches;let p=()=>{};const c=v=>{if(v.button!==i)return;v.preventDefault(),v.stopPropagation();let y=v.clientX,g=v.clientY,u=!1;const h=Date.now(),f=T=>{if(T.preventDefault(),T.stopPropagation(),l&&Date.now()-h<o)return;const P=T.clientX,j=T.clientY,S=P-y,z=j-g;if(u||Math.abs(S)>s||Math.abs(z)>s){const w=e.getBoundingClientRect(),{left:M,top:$}=w;u||(n==null||n(y-M,g-$),u=!0),t(S,z,P-M,j-$),y=P,g=j}},b=T=>{if(u){const P=T.clientX,j=T.clientY,S=e.getBoundingClientRect(),{left:z,top:w}=S;r==null||r(P-z,j-w)}p()},k=T=>{T.relatedTarget&&T.relatedTarget!==document.documentElement||b(T)},L=T=>{u&&(T.stopPropagation(),T.preventDefault())},C=T=>{u&&T.preventDefault()};document.addEventListener("pointermove",f),document.addEventListener("pointerup",b),document.addEventListener("pointerout",k),document.addEventListener("pointercancel",k),document.addEventListener("touchmove",C,{passive:!1}),document.addEventListener("click",L,{capture:!0}),p=()=>{document.removeEventListener("pointermove",f),document.removeEventListener("pointerup",b),document.removeEventListener("pointerout",k),document.removeEventListener("pointercancel",k),document.removeEventListener("touchmove",C),setTimeout(()=>{document.removeEventListener("click",L,{capture:!0})},10)}};return e.addEventListener("pointerdown",c),()=>{p(),e.removeEventListener("pointerdown",c)}}(this.wrapper,(e,t,n)=>{this.emit("drag",Math.max(0,Math.min(1,n/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!0,this.emit("dragstart",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))},e=>{this.isDragging=!1,this.emit("dragend",Math.max(0,Math.min(1,e/this.wrapper.getBoundingClientRect().width)))}))}getHeight(e,t){var n;const r=((n=this.audioData)===null||n===void 0?void 0:n.numberOfChannels)||1;if(e==null)return 128;if(!isNaN(Number(e)))return Number(e);if(e==="auto"){const s=this.parent.clientHeight||128;return t!=null&&t.every(i=>!i.overlay)?s/r:s}return 128}initHtml(){const e=document.createElement("div"),t=e.attachShadow({mode:"open"}),n=this.options.cspNonce&&typeof this.options.cspNonce=="string"?this.options.cspNonce.replace(/"/g,""):"";return t.innerHTML=`
      <style${n?` nonce="${n}"`:""}>
        :host {
          user-select: none;
          min-width: 1px;
        }
        :host audio {
          display: block;
          width: 100%;
        }
        :host .scroll {
          overflow-x: auto;
          overflow-y: hidden;
          width: 100%;
          position: relative;
        }
        :host .noScrollbar {
          scrollbar-color: transparent;
          scrollbar-width: none;
        }
        :host .noScrollbar::-webkit-scrollbar {
          display: none;
          -webkit-appearance: none;
        }
        :host .wrapper {
          position: relative;
          overflow: visible;
          z-index: 2;
        }
        :host .canvases {
          min-height: ${this.getHeight(this.options.height,this.options.splitChannels)}px;
        }
        :host .canvases > div {
          position: relative;
        }
        :host canvas {
          display: block;
          position: absolute;
          top: 0;
          image-rendering: pixelated;
        }
        :host .progress {
          pointer-events: none;
          position: absolute;
          z-index: 2;
          top: 0;
          left: 0;
          width: 0;
          height: 100%;
          overflow: hidden;
        }
        :host .progress > div {
          position: relative;
        }
        :host .cursor {
          pointer-events: none;
          position: absolute;
          z-index: 5;
          top: 0;
          left: 0;
          height: 100%;
          border-radius: 2px;
        }
      </style>

      <div class="scroll" part="scroll">
        <div class="wrapper" part="wrapper">
          <div class="canvases" part="canvases"></div>
          <div class="progress" part="progress"></div>
          <div class="cursor" part="cursor"></div>
        </div>
      </div>
    `,[e,t]}setOptions(e){if(this.options.container!==e.container){const t=this.parentFromOptionsContainer(e.container);t.appendChild(this.container),this.parent=t}e.dragToSeek!==!0&&typeof this.options.dragToSeek!="object"||this.initDrag(),this.options=e,this.reRender()}getWrapper(){return this.wrapper}getWidth(){return this.scrollContainer.clientWidth}getScroll(){return this.scrollContainer.scrollLeft}setScroll(e){this.scrollContainer.scrollLeft=e}setScrollPercentage(e){const{scrollWidth:t}=this.scrollContainer,n=t*e;this.setScroll(n)}destroy(){var e,t;this.subscriptions.forEach(n=>n()),this.container.remove(),(e=this.resizeObserver)===null||e===void 0||e.disconnect(),(t=this.unsubscribeOnScroll)===null||t===void 0||t.forEach(n=>n()),this.unsubscribeOnScroll=[]}createDelay(e=10){let t,n;const r=()=>{t&&clearTimeout(t),n&&n()};return this.timeouts.push(r),()=>new Promise((s,i)=>{r(),n=i,t=setTimeout(()=>{t=void 0,n=void 0,s()},e)})}convertColorValues(e){if(!Array.isArray(e))return e||"";if(e.length<2)return e[0]||"";const t=document.createElement("canvas"),n=t.getContext("2d"),r=t.height*(window.devicePixelRatio||1),s=n.createLinearGradient(0,0,0,r),i=1/(e.length-1);return e.forEach((o,l)=>{const p=l*i;s.addColorStop(p,o)}),s}getPixelRatio(){return Math.max(1,window.devicePixelRatio||1)}renderBarWaveform(e,t,n,r){const s=e[0],i=e[1]||e[0],o=s.length,{width:l,height:p}=n.canvas,c=p/2,v=this.getPixelRatio(),y=t.barWidth?t.barWidth*v:1,g=t.barGap?t.barGap*v:t.barWidth?y/2:0,u=t.barRadius||0,h=l/(y+g)/o,f=u&&"roundRect"in n?"roundRect":"rect";n.beginPath();let b=0,k=0,L=0;for(let C=0;C<=o;C++){const T=Math.round(C*h);if(T>b){const S=Math.round(k*c*r),z=S+Math.round(L*c*r)||1;let w=c-S;t.barAlign==="top"?w=0:t.barAlign==="bottom"&&(w=p-z),n[f](b*(y+g),w,y,z,u),b=T,k=0,L=0}const P=Math.abs(s[C]||0),j=Math.abs(i[C]||0);P>k&&(k=P),j>L&&(L=j)}n.fill(),n.closePath()}renderLineWaveform(e,t,n,r){const s=i=>{const o=e[i]||e[0],l=o.length,{height:p}=n.canvas,c=p/2,v=n.canvas.width/l;n.moveTo(0,c);let y=0,g=0;for(let u=0;u<=l;u++){const h=Math.round(u*v);if(h>y){const b=c+(Math.round(g*c*r)||1)*(i===0?-1:1);n.lineTo(y,b),y=h,g=0}const f=Math.abs(o[u]||0);f>g&&(g=f)}n.lineTo(y,c)};n.beginPath(),s(0),s(1),n.fill(),n.closePath()}renderWaveform(e,t,n){if(n.fillStyle=this.convertColorValues(t.waveColor),t.renderFunction)return void t.renderFunction(e,n);let r=t.barHeight||1;if(t.normalize){const s=Array.from(e[0]).reduce((i,o)=>Math.max(i,Math.abs(o)),0);r=s?1/s:1}t.barWidth||t.barGap||t.barAlign?this.renderBarWaveform(e,t,n,r):this.renderLineWaveform(e,t,n,r)}renderSingleCanvas(e,t,n,r,s,i,o){const l=this.getPixelRatio(),p=document.createElement("canvas");p.width=Math.round(n*l),p.height=Math.round(r*l),p.style.width=`${n}px`,p.style.height=`${r}px`,p.style.left=`${Math.round(s)}px`,i.appendChild(p);const c=p.getContext("2d");if(this.renderWaveform(e,t,c),p.width>0&&p.height>0){const v=p.cloneNode(),y=v.getContext("2d");y.drawImage(p,0,0),y.globalCompositeOperation="source-in",y.fillStyle=this.convertColorValues(t.progressColor),y.fillRect(0,0,p.width,p.height),o.appendChild(v)}}renderMultiCanvas(e,t,n,r,s,i){const o=this.getPixelRatio(),{clientWidth:l}=this.scrollContainer,p=n/o;let c=Math.min(ve.MAX_CANVAS_WIDTH,l,p),v={};if(c===0)return;if(t.barWidth||t.barGap){const f=t.barWidth||.5,b=f+(t.barGap||f/2);c%b!=0&&(c=Math.floor(c/b)*b)}const y=f=>{if(f<0||f>=g||v[f])return;v[f]=!0;const b=f*c,k=Math.min(p-b,c);if(k<=0)return;const L=e.map(C=>{const T=Math.floor(b/p*C.length),P=Math.floor((b+k)/p*C.length);return C.slice(T,P)});this.renderSingleCanvas(L,t,k,r,b,s,i)},g=Math.ceil(p/c);if(!this.isScrollable){for(let f=0;f<g;f++)y(f);return}const u=this.scrollContainer.scrollLeft/p,h=Math.floor(u*g);if(y(h-1),y(h),y(h+1),g>1){const f=this.on("scroll",()=>{const{scrollLeft:b}=this.scrollContainer,k=Math.floor(b/p*g);Object.keys(v).length>ve.MAX_NODES&&(s.innerHTML="",i.innerHTML="",v={}),y(k-1),y(k),y(k+1)});this.unsubscribeOnScroll.push(f)}}renderChannel(e,t,n,r){var{overlay:s}=t,i=function(c,v){var y={};for(var g in c)Object.prototype.hasOwnProperty.call(c,g)&&v.indexOf(g)<0&&(y[g]=c[g]);if(c!=null&&typeof Object.getOwnPropertySymbols=="function"){var u=0;for(g=Object.getOwnPropertySymbols(c);u<g.length;u++)v.indexOf(g[u])<0&&Object.prototype.propertyIsEnumerable.call(c,g[u])&&(y[g[u]]=c[g[u]])}return y}(t,["overlay"]);const o=document.createElement("div"),l=this.getHeight(i.height,i.splitChannels);o.style.height=`${l}px`,s&&r>0&&(o.style.marginTop=`-${l}px`),this.canvasWrapper.style.minHeight=`${l}px`,this.canvasWrapper.appendChild(o);const p=o.cloneNode();this.progressWrapper.appendChild(p),this.renderMultiCanvas(e,i,n,l,o,p)}render(e){return G(this,void 0,void 0,function*(){var t;this.timeouts.forEach(l=>l()),this.timeouts=[],this.canvasWrapper.innerHTML="",this.progressWrapper.innerHTML="",this.options.width!=null&&(this.scrollContainer.style.width=typeof this.options.width=="number"?`${this.options.width}px`:this.options.width);const n=this.getPixelRatio(),r=this.scrollContainer.clientWidth,s=Math.ceil(e.duration*(this.options.minPxPerSec||0));this.isScrollable=s>r;const i=this.options.fillParent&&!this.isScrollable,o=(i?r:s)*n;if(this.wrapper.style.width=i?"100%":`${s}px`,this.scrollContainer.style.overflowX=this.isScrollable?"auto":"hidden",this.scrollContainer.classList.toggle("noScrollbar",!!this.options.hideScrollbar),this.cursor.style.backgroundColor=`${this.options.cursorColor||this.options.progressColor}`,this.cursor.style.width=`${this.options.cursorWidth}px`,this.audioData=e,this.emit("render"),this.options.splitChannels)for(let l=0;l<e.numberOfChannels;l++){const p=Object.assign(Object.assign({},this.options),(t=this.options.splitChannels)===null||t===void 0?void 0:t[l]);this.renderChannel([e.getChannelData(l)],p,o,l)}else{const l=[e.getChannelData(0)];e.numberOfChannels>1&&l.push(e.getChannelData(1)),this.renderChannel(l,this.options,o,0)}Promise.resolve().then(()=>this.emit("rendered"))})}reRender(){if(this.unsubscribeOnScroll.forEach(n=>n()),this.unsubscribeOnScroll=[],!this.audioData)return;const{scrollWidth:e}=this.scrollContainer,{right:t}=this.progressWrapper.getBoundingClientRect();if(this.render(this.audioData),this.isScrollable&&e!==this.scrollContainer.scrollWidth){const{right:n}=this.progressWrapper.getBoundingClientRect();let r=n-t;r*=2,r=r<0?Math.floor(r):Math.ceil(r),r/=2,this.scrollContainer.scrollLeft+=r}}zoom(e){this.options.minPxPerSec=e,this.reRender()}scrollIntoView(e,t=!1){const{scrollLeft:n,scrollWidth:r,clientWidth:s}=this.scrollContainer,i=e*r,o=n,l=n+s,p=s/2;if(this.isDragging)i+30>l?this.scrollContainer.scrollLeft+=30:i-30<o&&(this.scrollContainer.scrollLeft-=30);else{(i<o||i>l)&&(this.scrollContainer.scrollLeft=i-(this.options.autoCenter?p:0));const c=i-n-p;t&&this.options.autoCenter&&c>0&&(this.scrollContainer.scrollLeft+=Math.min(c,10))}{const c=this.scrollContainer.scrollLeft,v=c/r,y=(c+s)/r;this.emit("scroll",v,y,c,c+s)}}renderProgress(e,t){if(isNaN(e))return;const n=100*e;this.canvasWrapper.style.clipPath=`polygon(${n}% 0, 100% 0, 100% 100%, ${n}% 100%)`,this.progressWrapper.style.width=`${n}%`,this.cursor.style.left=`${n}%`,this.cursor.style.transform=`translateX(-${Math.round(n)===100?this.options.cursorWidth:0}px)`,this.isScrollable&&this.options.autoScroll&&this.scrollIntoView(e,t)}exportImage(e,t,n){return G(this,void 0,void 0,function*(){const r=this.canvasWrapper.querySelectorAll("canvas");if(!r.length)throw new Error("No waveform data");if(n==="dataURL"){const s=Array.from(r).map(i=>i.toDataURL(e,t));return Promise.resolve(s)}return Promise.all(Array.from(r).map(s=>new Promise((i,o)=>{s.toBlob(l=>{l?i(l):o(new Error("Could not export image"))},e,t)})))})}}ve.MAX_CANVAS_WIDTH=8e3,ve.MAX_NODES=10;class fn extends Te{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}class Ie extends Te{constructor(e=new AudioContext){super(),this.bufferNode=null,this.playStartTime=0,this.playedDuration=0,this._muted=!1,this._playbackRate=1,this._duration=void 0,this.buffer=null,this.currentSrc="",this.paused=!0,this.crossOrigin=null,this.seeking=!1,this.autoplay=!1,this.addEventListener=this.on,this.removeEventListener=this.un,this.audioContext=e,this.gainNode=this.audioContext.createGain(),this.gainNode.connect(this.audioContext.destination)}load(){return G(this,void 0,void 0,function*(){})}get src(){return this.currentSrc}set src(e){if(this.currentSrc=e,this._duration=void 0,!e)return this.buffer=null,void this.emit("emptied");fetch(e).then(t=>{if(t.status>=400)throw new Error(`Failed to fetch ${e}: ${t.status} (${t.statusText})`);return t.arrayBuffer()}).then(t=>this.currentSrc!==e?null:this.audioContext.decodeAudioData(t)).then(t=>{this.currentSrc===e&&(this.buffer=t,this.emit("loadedmetadata"),this.emit("canplay"),this.autoplay&&this.play())})}_play(){var e;if(!this.paused)return;this.paused=!1,(e=this.bufferNode)===null||e===void 0||e.disconnect(),this.bufferNode=this.audioContext.createBufferSource(),this.buffer&&(this.bufferNode.buffer=this.buffer),this.bufferNode.playbackRate.value=this._playbackRate,this.bufferNode.connect(this.gainNode);let t=this.playedDuration*this._playbackRate;(t>=this.duration||t<0)&&(t=0,this.playedDuration=0),this.bufferNode.start(this.audioContext.currentTime,t),this.playStartTime=this.audioContext.currentTime,this.bufferNode.onended=()=>{this.currentTime>=this.duration&&(this.pause(),this.emit("ended"))}}_pause(){var e;this.paused=!0,(e=this.bufferNode)===null||e===void 0||e.stop(),this.playedDuration+=this.audioContext.currentTime-this.playStartTime}play(){return G(this,void 0,void 0,function*(){this.paused&&(this._play(),this.emit("play"))})}pause(){this.paused||(this._pause(),this.emit("pause"))}stopAt(e){const t=e-this.currentTime,n=this.bufferNode;n==null||n.stop(this.audioContext.currentTime+t),n==null||n.addEventListener("ended",()=>{n===this.bufferNode&&(this.bufferNode=null,this.pause())},{once:!0})}setSinkId(e){return G(this,void 0,void 0,function*(){return this.audioContext.setSinkId(e)})}get playbackRate(){return this._playbackRate}set playbackRate(e){this._playbackRate=e,this.bufferNode&&(this.bufferNode.playbackRate.value=e)}get currentTime(){return(this.paused?this.playedDuration:this.playedDuration+(this.audioContext.currentTime-this.playStartTime))*this._playbackRate}set currentTime(e){const t=!this.paused;t&&this._pause(),this.playedDuration=e/this._playbackRate,t&&this._play(),this.emit("seeking"),this.emit("timeupdate")}get duration(){var e,t;return(e=this._duration)!==null&&e!==void 0?e:((t=this.buffer)===null||t===void 0?void 0:t.duration)||0}set duration(e){this._duration=e}get volume(){return this.gainNode.gain.value}set volume(e){this.gainNode.gain.value=e,this.emit("volumechange")}get muted(){return this._muted}set muted(e){this._muted!==e&&(this._muted=e,this._muted?this.gainNode.disconnect():this.gainNode.connect(this.audioContext.destination))}canPlayType(e){return/^(audio|video)\//.test(e)}getGainNode(){return this.gainNode}getChannelData(){const e=[];if(!this.buffer)return e;const t=this.buffer.numberOfChannels;for(let n=0;n<t;n++)e.push(this.buffer.getChannelData(n));return e}}const Ln={waveColor:"#999",progressColor:"#555",cursorWidth:1,minPxPerSec:0,fillParent:!0,interact:!0,dragToSeek:!1,autoScroll:!0,autoCenter:!0,sampleRate:8e3};class ye extends gn{static create(e){return new ye(e)}constructor(e){const t=e.media||(e.backend==="WebAudio"?new Ie:void 0);super({media:t,mediaControls:e.mediaControls,autoplay:e.autoplay,playbackRate:e.audioRate}),this.plugins=[],this.decodedData=null,this.stopAtPosition=null,this.subscriptions=[],this.mediaSubscriptions=[],this.abortController=null,this.options=Object.assign({},Ln,e),this.timer=new fn;const n=t?void 0:this.getMediaElement();this.renderer=new ve(this.options,n),this.initPlayerEvents(),this.initRendererEvents(),this.initTimerEvents(),this.initPlugins();const r=this.options.url||this.getSrc()||"";Promise.resolve().then(()=>{this.emit("init");const{peaks:s,duration:i}=this.options;(r||s&&i)&&this.load(r,s,i).catch(()=>null)})}updateProgress(e=this.getCurrentTime()){return this.renderer.renderProgress(e/this.getDuration(),this.isPlaying()),e}initTimerEvents(){this.subscriptions.push(this.timer.on("tick",()=>{if(!this.isSeeking()){const e=this.updateProgress();this.emit("timeupdate",e),this.emit("audioprocess",e),this.stopAtPosition!=null&&this.isPlaying()&&e>=this.stopAtPosition&&this.pause()}}))}initPlayerEvents(){this.isPlaying()&&(this.emit("play"),this.timer.start()),this.mediaSubscriptions.push(this.onMediaEvent("timeupdate",()=>{const e=this.updateProgress();this.emit("timeupdate",e)}),this.onMediaEvent("play",()=>{this.emit("play"),this.timer.start()}),this.onMediaEvent("pause",()=>{this.emit("pause"),this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("emptied",()=>{this.timer.stop(),this.stopAtPosition=null}),this.onMediaEvent("ended",()=>{this.emit("timeupdate",this.getDuration()),this.emit("finish"),this.stopAtPosition=null}),this.onMediaEvent("seeking",()=>{this.emit("seeking",this.getCurrentTime())}),this.onMediaEvent("error",()=>{var e;this.emit("error",(e=this.getMediaElement().error)!==null&&e!==void 0?e:new Error("Media error")),this.stopAtPosition=null}))}initRendererEvents(){this.subscriptions.push(this.renderer.on("click",(e,t)=>{this.options.interact&&(this.seekTo(e),this.emit("interaction",e*this.getDuration()),this.emit("click",e,t))}),this.renderer.on("dblclick",(e,t)=>{this.emit("dblclick",e,t)}),this.renderer.on("scroll",(e,t,n,r)=>{const s=this.getDuration();this.emit("scroll",e*s,t*s,n,r)}),this.renderer.on("render",()=>{this.emit("redraw")}),this.renderer.on("rendered",()=>{this.emit("redrawcomplete")}),this.renderer.on("dragstart",e=>{this.emit("dragstart",e)}),this.renderer.on("dragend",e=>{this.emit("dragend",e)}));{let e;this.subscriptions.push(this.renderer.on("drag",t=>{if(!this.options.interact)return;let n;this.renderer.renderProgress(t),clearTimeout(e),this.isPlaying()?n=0:this.options.dragToSeek===!0?n=200:typeof this.options.dragToSeek=="object"&&this.options.dragToSeek!==void 0&&(n=this.options.dragToSeek.debounceTime),e=setTimeout(()=>{this.seekTo(t)},n),this.emit("interaction",t*this.getDuration()),this.emit("drag",t)}))}}initPlugins(){var e;!((e=this.options.plugins)===null||e===void 0)&&e.length&&this.options.plugins.forEach(t=>{this.registerPlugin(t)})}unsubscribePlayerEvents(){this.mediaSubscriptions.forEach(e=>e()),this.mediaSubscriptions=[]}setOptions(e){this.options=Object.assign({},this.options,e),e.duration&&!e.peaks&&(this.decodedData=Se.createBuffer(this.exportPeaks(),e.duration)),e.peaks&&e.duration&&(this.decodedData=Se.createBuffer(e.peaks,e.duration)),this.renderer.setOptions(this.options),e.audioRate&&this.setPlaybackRate(e.audioRate),e.mediaControls!=null&&(this.getMediaElement().controls=e.mediaControls)}registerPlugin(e){return e._init(this),this.plugins.push(e),this.subscriptions.push(e.once("destroy",()=>{this.plugins=this.plugins.filter(t=>t!==e)})),e}getWrapper(){return this.renderer.getWrapper()}getWidth(){return this.renderer.getWidth()}getScroll(){return this.renderer.getScroll()}setScroll(e){return this.renderer.setScroll(e)}setScrollTime(e){const t=e/this.getDuration();this.renderer.setScrollPercentage(t)}getActivePlugins(){return this.plugins}loadAudio(e,t,n,r){return G(this,void 0,void 0,function*(){var s;if(this.emit("load",e),!this.options.media&&this.isPlaying()&&this.pause(),this.decodedData=null,this.stopAtPosition=null,!t&&!n){const o=this.options.fetchParams||{};window.AbortController&&!o.signal&&(this.abortController=new AbortController,o.signal=(s=this.abortController)===null||s===void 0?void 0:s.signal);const l=c=>this.emit("loading",c);t=yield mn.fetchBlob(e,l,o);const p=this.options.blobMimeType;p&&(t=new Blob([t],{type:p}))}this.setSrc(e,t);const i=yield new Promise(o=>{const l=r||this.getDuration();l?o(l):this.mediaSubscriptions.push(this.onMediaEvent("loadedmetadata",()=>o(this.getDuration()),{once:!0}))});if(!e&&!t){const o=this.getMediaElement();o instanceof Ie&&(o.duration=i)}if(n)this.decodedData=Se.createBuffer(n,i||0);else if(t){const o=yield t.arrayBuffer();this.decodedData=yield Se.decode(o,this.options.sampleRate)}this.decodedData&&(this.emit("decode",this.getDuration()),this.renderer.render(this.decodedData)),this.emit("ready",this.getDuration())})}load(e,t,n){return G(this,void 0,void 0,function*(){try{return yield this.loadAudio(e,void 0,t,n)}catch(r){throw this.emit("error",r),r}})}loadBlob(e,t,n){return G(this,void 0,void 0,function*(){try{return yield this.loadAudio("",e,t,n)}catch(r){throw this.emit("error",r),r}})}zoom(e){if(!this.decodedData)throw new Error("No audio loaded");this.renderer.zoom(e),this.emit("zoom",e)}getDecodedData(){return this.decodedData}exportPeaks({channels:e=2,maxLength:t=8e3,precision:n=1e4}={}){if(!this.decodedData)throw new Error("The audio has not been decoded yet");const r=Math.min(e,this.decodedData.numberOfChannels),s=[];for(let i=0;i<r;i++){const o=this.decodedData.getChannelData(i),l=[],p=o.length/t;for(let c=0;c<t;c++){const v=o.slice(Math.floor(c*p),Math.ceil((c+1)*p));let y=0;for(let g=0;g<v.length;g++){const u=v[g];Math.abs(u)>Math.abs(y)&&(y=u)}l.push(Math.round(y*n)/n)}s.push(l)}return s}getDuration(){let e=super.getDuration()||0;return e!==0&&e!==1/0||!this.decodedData||(e=this.decodedData.duration),e}toggleInteraction(e){this.options.interact=e}setTime(e){this.stopAtPosition=null,super.setTime(e),this.updateProgress(e),this.emit("timeupdate",e)}seekTo(e){const t=this.getDuration()*e;this.setTime(t)}play(e,t){const n=Object.create(null,{play:{get:()=>super.play}});return G(this,void 0,void 0,function*(){e!=null&&this.setTime(e);const r=yield n.play.call(this);return t!=null&&(this.media instanceof Ie?this.media.stopAt(t):this.stopAtPosition=t),r})}playPause(){return G(this,void 0,void 0,function*(){return this.isPlaying()?this.pause():this.play()})}stop(){this.pause(),this.setTime(0)}skip(e){this.setTime(this.getCurrentTime()+e)}empty(){this.load("",[[0]],.001)}setMediaElement(e){this.unsubscribePlayerEvents(),super.setMediaElement(e),this.initPlayerEvents()}exportImage(){return G(this,arguments,void 0,function*(e="image/png",t=1,n="dataURL"){return this.renderer.exportImage(e,t,n)})}destroy(){var e;this.emit("destroy"),(e=this.abortController)===null||e===void 0||e.abort(),this.plugins.forEach(t=>t.destroy()),this.subscriptions.forEach(t=>t()),this.unsubscribePlayerEvents(),this.timer.destroy(),this.renderer.destroy(),super.destroy()}}ye.BasePlugin=class extends Te{constructor(d){super(),this.subscriptions=[],this.options=d}onInit(){}_init(d){this.wavesurfer=d,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(d=>d())}},ye.dom=pn;let vn=class{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),n==null?void 0:n.once){const r=()=>{this.un(e,r),this.un(e,t)};return this.on(e,r),r}return()=>this.un(e,t)}un(e,t){var n;(n=this.listeners[e])===null||n===void 0||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(n=>n(...t))}},yn=class extends vn{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}};function Lt(d,e){const t=e.xmlns?document.createElementNS(e.xmlns,d):document.createElement(d);for(const[n,r]of Object.entries(e))if(n==="children")for(const[s,i]of Object.entries(e))typeof i=="string"?t.appendChild(document.createTextNode(i)):t.appendChild(Lt(s,i));else n==="style"?Object.assign(t.style,r):n==="textContent"?t.textContent=r:t.setAttribute(n,r.toString());return t}function rt(d,e,t){const n=Lt(d,e||{});return t==null||t.appendChild(n),n}const bn={lineWidth:1,labelSize:11,formatTimeCallback:d=>`${Math.floor(d/60)}:${`0${Math.floor(d)%60}`.slice(-2)}`};let wn=class vt extends yn{constructor(e){super(e||{}),this.unsubscribe=()=>{},this.onPointerMove=t=>{if(!this.wavesurfer)return;const n=this.wavesurfer.getWrapper().getBoundingClientRect(),{width:r}=n,s=t.clientX-n.left,i=Math.min(1,Math.max(0,s/r)),o=Math.min(r-this.options.lineWidth-1,s);this.wrapper.style.transform=`translateX(${o}px)`,this.wrapper.style.opacity="1";const l=this.wavesurfer.getDuration()||0;this.label.textContent=this.options.formatTimeCallback(l*i);const p=this.label.offsetWidth;this.label.style.transform=o+p>r?`translateX(-${p+this.options.lineWidth}px)`:"",this.emit("hover",i)},this.onPointerLeave=()=>{this.wrapper.style.opacity="0"},this.options=Object.assign({},bn,e),this.wrapper=rt("div",{part:"hover"}),this.label=rt("span",{part:"hover-label"},this.wrapper)}static create(e){return new vt(e)}addUnits(e){return`${e}${typeof e=="number"?"px":""}`}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const e=this.wavesurfer.options,t=this.options.lineColor||e.cursorColor||e.progressColor;Object.assign(this.wrapper.style,{position:"absolute",zIndex:10,left:0,top:0,height:"100%",pointerEvents:"none",borderLeft:`${this.addUnits(this.options.lineWidth)} solid ${t}`,opacity:"0",transition:"opacity .1s ease-in"}),Object.assign(this.label.style,{display:"block",backgroundColor:this.options.labelBackground,color:this.options.labelColor,fontSize:`${this.addUnits(this.options.labelSize)}`,transition:"transform .1s ease-in",padding:"2px 3px"});const n=this.wavesurfer.getWrapper();n.appendChild(this.wrapper),n.addEventListener("pointermove",this.onPointerMove),n.addEventListener("pointerleave",this.onPointerLeave),n.addEventListener("wheel",this.onPointerMove),this.unsubscribe=()=>{n.removeEventListener("pointermove",this.onPointerMove),n.removeEventListener("pointerleave",this.onPointerLeave),n.removeEventListener("wheel",this.onPointerLeave)}}destroy(){super.destroy(),this.unsubscribe(),this.wrapper.remove()}},yt=class{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),n==null?void 0:n.once){const r=()=>{this.un(e,r),this.un(e,t)};return this.on(e,r),r}return()=>this.un(e,t)}un(e,t){var n;(n=this.listeners[e])===null||n===void 0||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(n=>n(...t))}},xn=class extends yt{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}};function Me(d,e,t,n,r=3,s=0,i=100){if(!d)return()=>{};const o=matchMedia("(pointer: coarse)").matches;let l=()=>{};const p=c=>{if(c.button!==s)return;c.preventDefault(),c.stopPropagation();let v=c.clientX,y=c.clientY,g=!1;const u=Date.now(),h=C=>{if(C.preventDefault(),C.stopPropagation(),o&&Date.now()-u<i)return;const T=C.clientX,P=C.clientY,j=T-v,S=P-y;if(g||Math.abs(j)>r||Math.abs(S)>r){const z=d.getBoundingClientRect(),{left:w,top:M}=z;g||(t==null||t(v-w,y-M),g=!0),e(j,S,T-w,P-M),v=T,y=P}},f=C=>{if(g){const T=C.clientX,P=C.clientY,j=d.getBoundingClientRect(),{left:S,top:z}=j;n==null||n(T-S,P-z)}l()},b=C=>{C.relatedTarget&&C.relatedTarget!==document.documentElement||f(C)},k=C=>{g&&(C.stopPropagation(),C.preventDefault())},L=C=>{g&&C.preventDefault()};document.addEventListener("pointermove",h),document.addEventListener("pointerup",f),document.addEventListener("pointerout",b),document.addEventListener("pointercancel",b),document.addEventListener("touchmove",L,{passive:!1}),document.addEventListener("click",k,{capture:!0}),l=()=>{document.removeEventListener("pointermove",h),document.removeEventListener("pointerup",f),document.removeEventListener("pointerout",b),document.removeEventListener("pointercancel",b),document.removeEventListener("touchmove",L),setTimeout(()=>{document.removeEventListener("click",k,{capture:!0})},10)}};return d.addEventListener("pointerdown",p),()=>{l(),d.removeEventListener("pointerdown",p)}}function bt(d,e){const t=e.xmlns?document.createElementNS(e.xmlns,d):document.createElement(d);for(const[n,r]of Object.entries(e))if(n==="children")for(const[s,i]of Object.entries(e))typeof i=="string"?t.appendChild(document.createTextNode(i)):t.appendChild(bt(s,i));else n==="style"?Object.assign(t.style,r):n==="textContent"?t.textContent=r:t.setAttribute(n,r.toString());return t}function Ce(d,e,t){const n=bt(d,e||{});return t==null||t.appendChild(n),n}let it=class extends yt{constructor(e,t,n=0){var r,s,i,o,l,p,c,v,y,g;super(),this.totalDuration=t,this.numberOfChannels=n,this.minLength=0,this.maxLength=1/0,this.contentEditable=!1,this.subscriptions=[],this.subscriptions=[],this.id=e.id||`region-${Math.random().toString(32).slice(2)}`,this.start=this.clampPosition(e.start),this.end=this.clampPosition((r=e.end)!==null&&r!==void 0?r:e.start),this.drag=(s=e.drag)===null||s===void 0||s,this.resize=(i=e.resize)===null||i===void 0||i,this.resizeStart=(o=e.resizeStart)===null||o===void 0||o,this.resizeEnd=(l=e.resizeEnd)===null||l===void 0||l,this.color=(p=e.color)!==null&&p!==void 0?p:"rgba(0, 0, 0, 0.1)",this.minLength=(c=e.minLength)!==null&&c!==void 0?c:this.minLength,this.maxLength=(v=e.maxLength)!==null&&v!==void 0?v:this.maxLength,this.channelIdx=(y=e.channelIdx)!==null&&y!==void 0?y:-1,this.contentEditable=(g=e.contentEditable)!==null&&g!==void 0?g:this.contentEditable,this.element=this.initElement(),this.setContent(e.content),this.setPart(),this.renderPosition(),this.initMouseEvents()}clampPosition(e){return Math.max(0,Math.min(this.totalDuration,e))}setPart(){const e=this.start===this.end;this.element.setAttribute("part",`${e?"marker":"region"} ${this.id}`)}addResizeHandles(e){const t={position:"absolute",zIndex:"2",width:"6px",height:"100%",top:"0",cursor:"ew-resize",wordBreak:"keep-all"},n=Ce("div",{part:"region-handle region-handle-left",style:Object.assign(Object.assign({},t),{left:"0",borderLeft:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"2px 0 0 2px"})},e),r=Ce("div",{part:"region-handle region-handle-right",style:Object.assign(Object.assign({},t),{right:"0",borderRight:"2px solid rgba(0, 0, 0, 0.5)",borderRadius:"0 2px 2px 0"})},e);this.subscriptions.push(Me(n,s=>this.onResize(s,"start"),()=>null,()=>this.onEndResizing(),1),Me(r,s=>this.onResize(s,"end"),()=>null,()=>this.onEndResizing(),1))}removeResizeHandles(e){const t=e.querySelector('[part*="region-handle-left"]'),n=e.querySelector('[part*="region-handle-right"]');t&&e.removeChild(t),n&&e.removeChild(n)}initElement(){const e=this.start===this.end;let t=0,n=100;this.channelIdx>=0&&this.channelIdx<this.numberOfChannels&&(n=100/this.numberOfChannels,t=n*this.channelIdx);const r=Ce("div",{style:{position:"absolute",top:`${t}%`,height:`${n}%`,backgroundColor:e?"none":this.color,borderLeft:e?"2px solid "+this.color:"none",borderRadius:"2px",boxSizing:"border-box",transition:"background-color 0.2s ease",cursor:this.drag?"grab":"default",pointerEvents:"all"}});return!e&&this.resize&&this.addResizeHandles(r),r}renderPosition(){const e=this.start/this.totalDuration,t=(this.totalDuration-this.end)/this.totalDuration;this.element.style.left=100*e+"%",this.element.style.right=100*t+"%"}toggleCursor(e){var t;this.drag&&(!((t=this.element)===null||t===void 0)&&t.style)&&(this.element.style.cursor=e?"grabbing":"grab")}initMouseEvents(){const{element:e}=this;e&&(e.addEventListener("click",t=>this.emit("click",t)),e.addEventListener("mouseenter",t=>this.emit("over",t)),e.addEventListener("mouseleave",t=>this.emit("leave",t)),e.addEventListener("dblclick",t=>this.emit("dblclick",t)),e.addEventListener("pointerdown",()=>this.toggleCursor(!0)),e.addEventListener("pointerup",()=>this.toggleCursor(!1)),this.subscriptions.push(Me(e,t=>this.onMove(t),()=>this.toggleCursor(!0),()=>{this.toggleCursor(!1),this.drag&&this.emit("update-end")})),this.contentEditable&&this.content&&(this.content.addEventListener("click",t=>this.onContentClick(t)),this.content.addEventListener("blur",()=>this.onContentBlur())))}_onUpdate(e,t){if(!this.element.parentElement)return;const{width:n}=this.element.parentElement.getBoundingClientRect(),r=e/n*this.totalDuration,s=t&&t!=="start"?this.start:this.start+r,i=t&&t!=="end"?this.end:this.end+r,o=i-s;s>=0&&i<=this.totalDuration&&s<=i&&o>=this.minLength&&o<=this.maxLength&&(this.start=s,this.end=i,this.renderPosition(),this.emit("update",t))}onMove(e){this.drag&&this._onUpdate(e)}onResize(e,t){this.resize&&(this.resizeStart||t!=="start")&&(this.resizeEnd||t!=="end")&&this._onUpdate(e,t)}onEndResizing(){this.resize&&this.emit("update-end")}onContentClick(e){e.stopPropagation(),e.target.focus(),this.emit("click",e)}onContentBlur(){this.emit("update-end")}_setTotalDuration(e){this.totalDuration=e,this.renderPosition()}play(e){this.emit("play",e&&this.end!==this.start?this.end:void 0)}getContent(e=!1){var t;return e?this.content||void 0:this.element instanceof HTMLElement?((t=this.content)===null||t===void 0?void 0:t.innerHTML)||void 0:""}setContent(e){var t;if((t=this.content)===null||t===void 0||t.remove(),e){if(typeof e=="string"){const n=this.start===this.end;this.content=Ce("div",{style:{padding:`0.2em ${n?.2:.4}em`,display:"inline-block"},textContent:e})}else this.content=e;this.contentEditable&&(this.content.contentEditable="true"),this.content.setAttribute("part","region-content"),this.element.appendChild(this.content),this.emit("content-changed")}else this.content=void 0}setOptions(e){var t,n;if(e.color&&(this.color=e.color,this.element.style.backgroundColor=this.color),e.drag!==void 0&&(this.drag=e.drag,this.element.style.cursor=this.drag?"grab":"default"),e.start!==void 0||e.end!==void 0){const r=this.start===this.end;this.start=this.clampPosition((t=e.start)!==null&&t!==void 0?t:this.start),this.end=this.clampPosition((n=e.end)!==null&&n!==void 0?n:r?this.start:this.end),this.renderPosition(),this.setPart()}if(e.content&&this.setContent(e.content),e.id&&(this.id=e.id,this.setPart()),e.resize!==void 0&&e.resize!==this.resize){const r=this.start===this.end;this.resize=e.resize,this.resize&&!r?this.addResizeHandles(this.element):this.removeResizeHandles(this.element)}e.resizeStart!==void 0&&(this.resizeStart=e.resizeStart),e.resizeEnd!==void 0&&(this.resizeEnd=e.resizeEnd)}remove(){this.emit("remove"),this.subscriptions.forEach(e=>e()),this.element.remove(),this.element=null}},Cn=class wt extends xn{constructor(e){super(e),this.regions=[],this.regionsContainer=this.initRegionsContainer()}static create(e){return new wt(e)}onInit(){if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");this.wavesurfer.getWrapper().appendChild(this.regionsContainer);let e=[];this.subscriptions.push(this.wavesurfer.on("timeupdate",t=>{const n=this.regions.filter(r=>r.start<=t&&(r.end===r.start?r.start+.05:r.end)>=t);n.forEach(r=>{e.includes(r)||this.emit("region-in",r)}),e.forEach(r=>{n.includes(r)||this.emit("region-out",r)}),e=n}))}initRegionsContainer(){return Ce("div",{style:{position:"absolute",top:"0",left:"0",width:"100%",height:"100%",zIndex:"5",pointerEvents:"none"}})}getRegions(){return this.regions}avoidOverlapping(e){e.content&&setTimeout(()=>{const t=e.content,n=t.getBoundingClientRect(),r=this.regions.map(s=>{if(s===e||!s.content)return 0;const i=s.content.getBoundingClientRect();return n.left<i.left+i.width&&i.left<n.left+n.width?i.height:0}).reduce((s,i)=>s+i,0);t.style.marginTop=`${r}px`},10)}adjustScroll(e){var t,n;const r=(n=(t=this.wavesurfer)===null||t===void 0?void 0:t.getWrapper())===null||n===void 0?void 0:n.parentElement;if(!r)return;const{clientWidth:s,scrollWidth:i}=r;if(i<=s)return;const o=r.getBoundingClientRect(),l=e.element.getBoundingClientRect(),p=l.left-o.left,c=l.right-o.left;p<0?r.scrollLeft+=p:c>s&&(r.scrollLeft+=c-s)}virtualAppend(e,t,n){const r=()=>{if(!this.wavesurfer)return;const s=this.wavesurfer.getWidth(),i=this.wavesurfer.getScroll(),o=t.clientWidth,l=this.wavesurfer.getDuration(),p=Math.round(e.start/l*o),c=p+(Math.round((e.end-e.start)/l*o)||1)>i&&p<i+s;c&&!n.parentElement?t.appendChild(n):!c&&n.parentElement&&n.remove()};setTimeout(()=>{if(!this.wavesurfer)return;r();const s=this.wavesurfer.on("scroll",r);this.subscriptions.push(e.once("remove",s),s)},0)}saveRegion(e){this.virtualAppend(e,this.regionsContainer,e.element),this.avoidOverlapping(e),this.regions.push(e);const t=[e.on("update",n=>{n||this.adjustScroll(e),this.emit("region-update",e,n)}),e.on("update-end",()=>{this.avoidOverlapping(e),this.emit("region-updated",e)}),e.on("play",n=>{var r;(r=this.wavesurfer)===null||r===void 0||r.play(e.start,n)}),e.on("click",n=>{this.emit("region-clicked",e,n)}),e.on("dblclick",n=>{this.emit("region-double-clicked",e,n)}),e.on("content-changed",()=>{this.emit("region-content-changed",e)}),e.once("remove",()=>{t.forEach(n=>n()),this.regions=this.regions.filter(n=>n!==e),this.emit("region-removed",e)})];this.subscriptions.push(...t),this.emit("region-created",e)}addRegion(e){var t,n;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");const r=this.wavesurfer.getDuration(),s=(n=(t=this.wavesurfer)===null||t===void 0?void 0:t.getDecodedData())===null||n===void 0?void 0:n.numberOfChannels,i=new it(e,r,s);return this.emit("region-initialized",i),r?this.saveRegion(i):this.subscriptions.push(this.wavesurfer.once("ready",o=>{i._setTotalDuration(o),this.saveRegion(i)})),i}enableDragSelection(e,t=3){var n;const r=(n=this.wavesurfer)===null||n===void 0?void 0:n.getWrapper();if(!(r&&r instanceof HTMLElement))return()=>{};let s=null,i=0;return Me(r,(o,l,p)=>{s&&s._onUpdate(o,p>i?"end":"start")},o=>{var l,p;if(i=o,!this.wavesurfer)return;const c=this.wavesurfer.getDuration(),v=(p=(l=this.wavesurfer)===null||l===void 0?void 0:l.getDecodedData())===null||p===void 0?void 0:p.numberOfChannels,{width:y}=this.wavesurfer.getWrapper().getBoundingClientRect(),g=o/y*c,u=(o+5)/y*c;s=new it(Object.assign(Object.assign({},e),{start:g,end:u}),c,v),this.emit("region-initialized",s),this.regionsContainer.appendChild(s.element)},()=>{s&&(this.saveRegion(s),s=null)},t)}clearRegions(){this.regions.slice().forEach(e=>e.remove()),this.regions=[]}destroy(){this.clearRegions(),super.destroy(),this.regionsContainer.remove()}},kn=class{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),n==null?void 0:n.once){const r=()=>{this.un(e,r),this.un(e,t)};return this.on(e,r),r}return()=>this.un(e,t)}un(e,t){var n;(n=this.listeners[e])===null||n===void 0||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(n=>n(...t))}},Tn=class extends kn{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}};function xt(d,e){const t=e.xmlns?document.createElementNS(e.xmlns,d):document.createElement(d);for(const[n,r]of Object.entries(e))if(n==="children")for(const[s,i]of Object.entries(e))typeof i=="string"?t.appendChild(document.createTextNode(i)):t.appendChild(xt(s,i));else n==="style"?Object.assign(t.style,r):n==="textContent"?t.textContent=r:t.setAttribute(n,r.toString());return t}function Oe(d,e,t){return xt(d,e||{})}const jn={height:20,timeOffset:0,formatTimeCallback:d=>d/60>1?`${Math.floor(d/60)}:${`${(d=Math.round(d%60))<10?"0":""}${d}`}`:`${Math.round(1e3*d)/1e3}`};let En=class Ct extends Tn{constructor(e){super(e||{}),this.options=Object.assign({},jn,e),this.timelineWrapper=this.initTimelineWrapper()}static create(e){return new Ct(e)}onInit(){var e;if(!this.wavesurfer)throw Error("WaveSurfer is not initialized");let t=this.wavesurfer.getWrapper();if(this.options.container instanceof HTMLElement)t=this.options.container;else if(typeof this.options.container=="string"){const n=document.querySelector(this.options.container);if(!n)throw Error(`No Timeline container found matching ${this.options.container}`);t=n}this.options.insertPosition?(t.firstElementChild||t).insertAdjacentElement(this.options.insertPosition,this.timelineWrapper):t.appendChild(this.timelineWrapper),this.subscriptions.push(this.wavesurfer.on("redraw",()=>this.initTimeline())),(!((e=this.wavesurfer)===null||e===void 0)&&e.getDuration()||this.options.duration)&&this.initTimeline()}destroy(){this.timelineWrapper.remove(),super.destroy()}initTimelineWrapper(){return Oe("div",{part:"timeline-wrapper",style:{pointerEvents:"none"}})}defaultTimeInterval(e){return e>=25?1:5*e>=25?5:15*e>=25?15:60*Math.ceil(.5/e)}defaultPrimaryLabelInterval(e){return e>=25?10:5*e>=25?6:4}defaultSecondaryLabelInterval(e){return e>=25?5:2}virtualAppend(e,t,n){let r=!1;const s=(l,p)=>{if(!this.wavesurfer)return;const c=n.clientWidth,v=e>l&&e+c<p;v!==r&&(r=v,v?t.appendChild(n):n.remove())};if(!this.wavesurfer)return;const i=this.wavesurfer.getScroll(),o=i+this.wavesurfer.getWidth();s(i,o),this.subscriptions.push(this.wavesurfer.on("scroll",(l,p,c,v)=>{s(c,v)}))}initTimeline(){var e,t,n,r,s,i,o,l;const p=(n=(t=(e=this.wavesurfer)===null||e===void 0?void 0:e.getDuration())!==null&&t!==void 0?t:this.options.duration)!==null&&n!==void 0?n:0,c=(((r=this.wavesurfer)===null||r===void 0?void 0:r.getWrapper().scrollWidth)||this.timelineWrapper.scrollWidth)/p,v=(s=this.options.timeInterval)!==null&&s!==void 0?s:this.defaultTimeInterval(c),y=(i=this.options.primaryLabelInterval)!==null&&i!==void 0?i:this.defaultPrimaryLabelInterval(c),g=this.options.primaryLabelSpacing,u=(o=this.options.secondaryLabelInterval)!==null&&o!==void 0?o:this.defaultSecondaryLabelInterval(c),h=this.options.secondaryLabelSpacing,f=this.options.insertPosition==="beforebegin",b=Oe("div",{style:Object.assign({height:`${this.options.height}px`,overflow:"hidden",fontSize:this.options.height/2+"px",whiteSpace:"nowrap"},f?{position:"absolute",top:"0",left:"0",right:"0",zIndex:"2"}:{position:"relative"})});b.setAttribute("part","timeline"),typeof this.options.style=="string"?b.setAttribute("style",b.getAttribute("style")+this.options.style):typeof this.options.style=="object"&&Object.assign(b.style,this.options.style);const k=Oe("div",{style:{width:"0",height:"50%",display:"flex",flexDirection:"column",justifyContent:f?"flex-start":"flex-end",top:f?"0":"auto",bottom:f?"auto":"0",overflow:"visible",borderLeft:"1px solid currentColor",opacity:`${(l=this.options.secondaryLabelOpacity)!==null&&l!==void 0?l:.25}`,position:"absolute",zIndex:"1"}});for(let L=0,C=0;L<p;L+=v,C++){const T=k.cloneNode(),P=Math.round(100*L)%Math.round(100*y)==0||g&&C%g==0,j=Math.round(100*L)%Math.round(100*u)==0||h&&C%h==0;(P||j)&&(T.style.height="100%",T.style.textIndent="3px",T.textContent=this.options.formatTimeCallback(L),P&&(T.style.opacity="1"));const S=P?"primary":j?"secondary":"tick";T.setAttribute("part",`timeline-notch timeline-notch-${S}`);const z=Math.round(100*(L+this.options.timeOffset))/100*c;T.style.left=`${z}px`,this.virtualAppend(z,b,T)}this.timelineWrapper.innerHTML="",this.timelineWrapper.appendChild(b),this.emit("ready")}};const st=[["#75BBC1","#108188"],["#74a9cf","#0570b0"],["#8c96c6","#88419d"],["#df65b0","#ae017e"],["#fa9fb5","#ce1256"],["#fdbb84","#ef6548"],["#fec44f","#cc4c02"],["#bf812d","#543005"]],Sn=(d,e)=>{const t=_t();let n,r;const s={cursor:wn.create(),regions:Cn.create(),timeline:En.create({style:{backgroundColor:"#18181b",position:"relative",color:"#fff",zIndex:"5"}})};t.debug("create instance",{});const i=ye.create({container:d,media:e,cursorWidth:2,height:200,barWidth:2,barRadius:3,barGap:1,barHeight:.85,minPxPerSec:16,splitChannels:st.map((g,u)=>({waveColor:g[0],progressColor:g[1]}),{}),plugins:Object.values(s).filter(Boolean)});i.getMediaElement().crossOrigin="anonymous",i.on("ready",()=>{const g=i.decodedData.numberOfChannels;t.info("Found channels",{},g),i.setOptions({height:200/g})}),i.on("error",g=>{t.debug("error",{},g)}),s.regions.on("region-double-clicked",g=>{const{id:u,start:h,end:f}=g;t.debug("play region",{},{id:u,start:h,end:f}),setTimeout(()=>{i.setTime(h)},10),n=g,g.play()}),s.regions.on("region-out",g=>{n&&(i.pause(),n=void 0)});const o=()=>{try{i==null||i.destroy()}catch{}},l=(g=[])=>{i.setOptions({splitChannels:st.map(([u,h],f)=>{var b,k;return{waveColor:((b=g[f])==null?void 0:b[0])??u,progressColor:((k=g[f])==null?void 0:k[1])??h}})})},p=g=>{s.regions.clearRegions();const u=i.options.splitChannels;g==null||g.forEach(({channel:h=-1,...f})=>{var b,k;s.regions.addRegion({...f,channelIdx:h,color:`${((k=(b=u==null?void 0:u[h])==null?void 0:b.waveColor)==null?void 0:k.toString())??"#a37f4f"}30`,drag:!1,resize:!1})})};return{loadAudio:async g=>{const u=t.timer("load audio");if(i){try{i.setVolume(.5)}catch{}try{i.setPlaybackRate(1)}catch{}try{s.regions.clearRegions()}catch{}return await i.load(g).then(()=>{u.end()})}return await Promise.resolve()},destroy:o,setColors:l,setRegions:p,enableUserRegions:()=>{r=s.regions.enableDragSelection({color:"#a37f4f30"}),s.regions.clearRegions()},disableUserRegions:g=>{r==null||r(),p(g)},instance:i,regions:s.regions}},Pn=({ref:d,src:e,fallback:t,colors:n,regions:r,userDefinedRegions:s,onRegionChange:i,onLoad:o,onError:l,onChange:p,onPlay:c,onPause:v,onRegionStart:y,onRegionEnd:g})=>{const u=m.useRef(null),h=m.useRef(null),[f,b]=m.useState(),[k,L]=m.useReducer((j,S)=>(S.type==="loaded"&&(j.isLoading=!1,j.isLoaded=!0,o==null||o()),S.type==="metadata"&&(j.duration=S.duration,j.volume=S.volume,j.speed=S.speed),S.type==="errored"&&(j.errorLevel++,j.errorLevel===1&&(t?j.src=t:j.errorLevel++),j.errorLevel===2&&(j.isLoading=!1,j.isLoaded=!0,l==null||l())),S.type==="reset"?{...j,src:S.audio}:S.type==="toggleEqs"?{...j,showEqs:!j.showEqs}:S.type==="play"?(c==null||c(),{...j,isPlaying:!0}):S.type==="pause"?(v==null||v(),{...j,isPlaying:!1}):S.type==="playing"?(p==null||p(S.time),{...j,time:S.time}):S.type==="volume"?{...j,volume:S.volume}:S.type==="speed"?{...j,speed:S.speed}:{...j}),{errorLevel:0,src:"",isLoading:!0,isLoaded:!1,isErrored:!1,isPlaying:!1,showEqs:!1,time:0,duration:0,volume:.5,speed:1});m.useImperativeHandle(d,()=>({play:()=>{var j;(j=u.current)==null||j.play()},pause:()=>{var j;return(j=u.current)==null?void 0:j.pause()},playRegion:j=>{var S;u.current&&(u.current.currentTime=j),(S=u.current)==null||S.play()}}),[f]),m.useEffect(()=>{const j=Sn(h.current,u.current);return b(j),()=>{j.destroy()}},[]),m.useEffect(()=>{L({type:"reset",audio:e})},[e]);const C=m.useCallback(()=>{L({type:"loaded"})},[]),T=m.useCallback(()=>{L({type:"errored"})},[]),P=m.useCallback(()=>{L({type:"toggleEqs"})},[]);return m.useEffect(()=>{f==null||f.loadAudio(k.src)},[k.src]),m.useEffect(()=>{if(f!=null){const j=z=>{y==null||y(z.id)},S=z=>{g==null||g(z.id)};return f.regions.on("region-in",j),f.regions.on("region-out",S),()=>{f.regions.un("region-in",j),f.regions.un("region-out",S)}}},[f,y,g]),m.useLayoutEffect(()=>{f!=null&&f.setColors(n)},[f,n]),m.useLayoutEffect(()=>{f==null||f.instance.on("ready",()=>{f.setRegions(r)})},[f,r]),m.useEffect(()=>{if(f){const j=Kt(()=>{i==null||i(f.regions.getRegions().map(S=>({start:S.start,end:S.end,remove:()=>S.remove()})).sort(Jt("asc","start")))});return s?(f.enableUserRegions(),f.regions.on("region-created",j),f.regions.on("region-updated",j),f.regions.on("region-removed",j)):f.disableUserRegions(r),()=>{f.regions.un("region-created",j),f.regions.un("region-updated",j),f.regions.un("region-removed",j)}}},[f,r,s,i]),a.jsx(pt.Provider,{value:{audioRef:u,wavesurfer:f,state:k,toggleEqs:P,handleLoad:C,handleError:T},children:a.jsxs(Yt,{className:"bg-base",dir:"ltr",children:[a.jsx("audio",{onLoadedData:C,onError:T,ref:u,onPlay:()=>L({type:"play"}),onPause:()=>L({type:"pause"}),onRateChange:()=>{var j;return L({type:"speed",speed:((j=u.current)==null?void 0:j.playbackRate)??0})},onVolumeChange:()=>{var j;return L({type:"volume",volume:((j=u.current)==null?void 0:j.volume)??0})},onLoadedMetadata:()=>{var j,S,z;return L({type:"metadata",speed:((j=u.current)==null?void 0:j.playbackRate)??0,volume:((S=u.current)==null?void 0:S.volume)??0,duration:((z=u.current)==null?void 0:z.duration)??0})},onSeeking:()=>{var j;return L({type:"playing",time:((j=u.current)==null?void 0:j.currentTime)??0})},onTimeUpdate:()=>{var j;return L({type:"playing",time:((j=u.current)==null?void 0:j.currentTime)??0})},children:a.jsx("track",{kind:"captions",default:!0})}),a.jsxs("div",{className:"overflow-hidden relative",children:[a.jsx("div",{ref:h,className:"h-[200px]"}),k.isLoading&&a.jsx(mt,{})]}),a.jsx(gt,{}),a.jsx(Fe,{})]})})};Pn.__docgenInfo={description:`Audio player component that uses Wavesurfer.js to render audio waveforms.
It supports loading audio files, displaying waveforms, and managing playback.
It also allows for defining regions within the audio for interaction.
It provides a context for managing audio state and actions.
It includes tools for playback control, equalizers, and loading indicators.
It supports user-defined regions for custom interaction.
It provides callbacks for various audio events such as loading, error handling, playback control, and region management.
It allows customization of colors for the waveform and progress indicators.

@param {AudioProps} props - The properties for the AudioPlayer component.
@returns {JSX.Element} The rendered AudioPlayer component.

@example
\`\`\`jsx
<AudioPlayer
  src="path/to/audio.mp3"
  fallback="path/to/fallback.mp3"
  colors={[["#ff0000", "#00ff00"], ["#0000ff", "#ffff00"]]}
  regions={[{ id: "1", start: 0, end: 10 }, { id: "2", start: 15, end: 20 }]}
  onRegionChange={(regions) => console.log(regions)}
  onLoad={() => console.log("Audio loaded")}
  onError={() => console.error("Error loading audio")}
  onChange={(time) => console.log("Current time:", time)}
  onPlay={() => console.log("Audio playing")}
  onPause={() => console.log("Audio paused")}
  onRegionStart={(id) => console.log("Region started:", id)}
  onRegionEnd={(id) => console.log("Region ended:", id)}
/>
\`\`\`

@see {@link https://adarshpastakia.github.io/react-fabric/?path=/story/media-audioplayer--audio-player} for more details on the properties.
@see {@link https://wavesurfer-js.org/} for more details on Wavesurfer.js.`,methods:[{name:"play",docblock:null,modifiers:[],params:[],returns:null},{name:"pause",docblock:null,modifiers:[],params:[],returns:null},{name:"playRegion",docblock:null,modifiers:[],params:[{name:"start",optional:!1,type:{name:"number"}}],returns:null}],displayName:"AudioPlayer",props:{src:{required:!0,tsType:{name:"string"},description:"audio source"},fallback:{required:!1,tsType:{name:"string"},description:"fallback source"},colors:{required:!1,tsType:{name:"Array",elements:[{name:"tuple",raw:"[wave: string, progress: string]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[wave: string, progress: string]>"},description:"channel colors"},regions:{required:!1,tsType:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ id: string; start: number; end: number; channel?: number }",signature:{properties:[{key:"id",value:{name:"string",required:!0}},{key:"start",value:{name:"number",required:!0}},{key:"end",value:{name:"number",required:!0}},{key:"channel",value:{name:"number",required:!1}}]}}],raw:"Array<{ id: string; start: number; end: number; channel?: number }>"},description:"scene list"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(currentTime: number) => void",signature:{arguments:[{type:{name:"number"},name:"currentTime"}],return:{name:"void"}}},description:"onChange playback time"},onPlay:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"play handler"},onPause:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"pause handler"},onRegionStart:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:"on enter region handler"},onRegionEnd:{required:!1,tsType:{name:"signature",type:"function",raw:"(id: string) => void",signature:{arguments:[{type:{name:"string"},name:"id"}],return:{name:"void"}}},description:"on region exit handler"},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"source loaded"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"error loading audio"},userDefinedRegions:{required:!1,tsType:{name:"boolean"},description:""},onRegionChange:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  regions: Array<{ start: number; end: number; remove: () => void }>,
) => void`,signature:{arguments:[{type:{name:"Array",elements:[{name:"signature",type:"object",raw:"{ start: number; end: number; remove: () => void }",signature:{properties:[{key:"start",value:{name:"number",required:!0}},{key:"end",value:{name:"number",required:!0}},{key:"remove",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}}]}}],raw:"Array<{ start: number; end: number; remove: () => void }>"},name:"regions"}],return:{name:"void"}}},description:""}},composes:["RefProp"]};function qe(d,e,t,n){return new(t||(t=Promise))(function(r,s){function i(p){try{l(n.next(p))}catch(c){s(c)}}function o(p){try{l(n.throw(p))}catch(c){s(c)}}function l(p){var c;p.done?r(p.value):(c=p.value,c instanceof t?c:new t(function(v){v(c)})).then(i,o)}l((n=n.apply(d,[])).next())})}class kt{constructor(){this.listeners={}}on(e,t,n){if(this.listeners[e]||(this.listeners[e]=new Set),this.listeners[e].add(t),n==null?void 0:n.once){const r=()=>{this.un(e,r),this.un(e,t)};return this.on(e,r),r}return()=>this.un(e,t)}un(e,t){var n;(n=this.listeners[e])===null||n===void 0||n.delete(t)}once(e,t){return this.on(e,t,{once:!0})}unAll(){this.listeners={}}emit(e,...t){this.listeners[e]&&this.listeners[e].forEach(n=>n(...t))}}class Mn extends kt{constructor(e){super(),this.subscriptions=[],this.options=e}onInit(){}_init(e){this.wavesurfer=e,this.onInit()}destroy(){this.emit("destroy"),this.subscriptions.forEach(e=>e())}}class Rn extends kt{constructor(){super(...arguments),this.unsubscribe=()=>{}}start(){this.unsubscribe=this.on("tick",()=>{requestAnimationFrame(()=>{this.emit("tick")})}),this.emit("tick")}stop(){this.unsubscribe()}destroy(){this.unsubscribe()}}const Dn=["audio/webm","audio/wav","audio/mpeg","audio/mp4","audio/mp3"];class Xe extends Mn{constructor(e){var t,n,r,s,i,o;super(Object.assign(Object.assign({},e),{audioBitsPerSecond:(t=e.audioBitsPerSecond)!==null&&t!==void 0?t:128e3,scrollingWaveform:(n=e.scrollingWaveform)!==null&&n!==void 0&&n,scrollingWaveformWindow:(r=e.scrollingWaveformWindow)!==null&&r!==void 0?r:5,continuousWaveform:(s=e.continuousWaveform)!==null&&s!==void 0&&s,renderRecordedAudio:(i=e.renderRecordedAudio)===null||i===void 0||i,mediaRecorderTimeslice:(o=e.mediaRecorderTimeslice)!==null&&o!==void 0?o:void 0})),this.stream=null,this.mediaRecorder=null,this.dataWindow=null,this.isWaveformPaused=!1,this.lastStartTime=0,this.lastDuration=0,this.duration=0,this.timer=new Rn,this.subscriptions.push(this.timer.on("tick",()=>{const l=performance.now()-this.lastStartTime;this.duration=this.isPaused()?this.duration:this.lastDuration+l,this.emit("record-progress",this.duration)}))}static create(e){return new Xe(e||{})}renderMicStream(e){var t;const n=new AudioContext,r=n.createMediaStreamSource(e),s=n.createAnalyser();r.connect(s),this.options.continuousWaveform&&(s.fftSize=32);const i=s.frequencyBinCount,o=new Float32Array(i);let l=0;this.wavesurfer&&((t=this.originalOptions)!==null&&t!==void 0||(this.originalOptions=Object.assign({},this.wavesurfer.options)),this.wavesurfer.options.interact=!1,this.options.scrollingWaveform&&(this.wavesurfer.options.cursorWidth=0));const p=setInterval(()=>{var c,v,y,g;if(!this.isWaveformPaused){if(s.getFloatTimeDomainData(o),this.options.scrollingWaveform){const u=Math.floor((this.options.scrollingWaveformWindow||0)*n.sampleRate),h=Math.min(u,this.dataWindow?this.dataWindow.length+i:i),f=new Float32Array(u);if(this.dataWindow){const b=Math.max(0,u-this.dataWindow.length);f.set(this.dataWindow.slice(-h+i),b)}f.set(o,u-i),this.dataWindow=f}else if(this.options.continuousWaveform){if(!this.dataWindow){const h=this.options.continuousWaveformDuration?Math.round(100*this.options.continuousWaveformDuration):((v=(c=this.wavesurfer)===null||c===void 0?void 0:c.getWidth())!==null&&v!==void 0?v:0)*window.devicePixelRatio;this.dataWindow=new Float32Array(h)}let u=0;for(let h=0;h<i;h++){const f=Math.abs(o[h]);f>u&&(u=f)}if(l+1>this.dataWindow.length){const h=new Float32Array(2*this.dataWindow.length);h.set(this.dataWindow,0),this.dataWindow=h}this.dataWindow[l]=u,l++}else this.dataWindow=o;if(this.wavesurfer){const u=((g=(y=this.dataWindow)===null||y===void 0?void 0:y.length)!==null&&g!==void 0?g:0)/100;this.wavesurfer.load("",[this.dataWindow],this.options.scrollingWaveform?this.options.scrollingWaveformWindow:u).then(()=>{this.wavesurfer&&this.options.continuousWaveform&&(this.wavesurfer.setTime(this.getDuration()/1e3),this.wavesurfer.options.minPxPerSec||this.wavesurfer.setOptions({minPxPerSec:this.wavesurfer.getWidth()/this.wavesurfer.getDuration()}))}).catch(h=>{console.error("Error rendering real-time recording data:",h)})}}},10);return{onDestroy:()=>{clearInterval(p),r==null||r.disconnect(),n==null||n.close()},onEnd:()=>{this.isWaveformPaused=!0,clearInterval(p),this.stopMic()}}}startMic(e){return qe(this,void 0,void 0,function*(){let t;try{t=yield navigator.mediaDevices.getUserMedia({audio:e==null||e})}catch(s){throw new Error("Error accessing the microphone: "+s.message)}const{onDestroy:n,onEnd:r}=this.renderMicStream(t);return this.subscriptions.push(this.once("destroy",n)),this.subscriptions.push(this.once("record-end",r)),this.stream=t,t})}stopMic(){this.stream&&(this.stream.getTracks().forEach(e=>e.stop()),this.stream=null,this.mediaRecorder=null)}startRecording(e){return qe(this,void 0,void 0,function*(){const t=this.stream||(yield this.startMic(e));this.dataWindow=null;const n=this.mediaRecorder||new MediaRecorder(t,{mimeType:this.options.mimeType||Dn.find(i=>MediaRecorder.isTypeSupported(i)),audioBitsPerSecond:this.options.audioBitsPerSecond});this.mediaRecorder=n,this.stopRecording();const r=[];n.ondataavailable=i=>{i.data.size>0&&r.push(i.data),this.emit("record-data-available",i.data)};const s=i=>{var o;const l=new Blob(r,{type:n.mimeType});this.emit(i,l),this.options.renderRecordedAudio&&(this.applyOriginalOptionsIfNeeded(),(o=this.wavesurfer)===null||o===void 0||o.load(URL.createObjectURL(l)))};n.onpause=()=>s("record-pause"),n.onstop=()=>s("record-end"),n.start(this.options.mediaRecorderTimeslice),this.lastStartTime=performance.now(),this.lastDuration=0,this.duration=0,this.isWaveformPaused=!1,this.timer.start(),this.emit("record-start")})}getDuration(){return this.duration}isRecording(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="recording"}isPaused(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)==="paused"}isActive(){var e;return((e=this.mediaRecorder)===null||e===void 0?void 0:e.state)!=="inactive"}stopRecording(){var e;this.isActive()&&((e=this.mediaRecorder)===null||e===void 0||e.stop(),this.timer.stop())}pauseRecording(){var e,t;this.isRecording()&&(this.isWaveformPaused=!0,(e=this.mediaRecorder)===null||e===void 0||e.requestData(),(t=this.mediaRecorder)===null||t===void 0||t.pause(),this.timer.stop(),this.lastDuration=this.duration)}resumeRecording(){var e;this.isPaused()&&(this.isWaveformPaused=!1,(e=this.mediaRecorder)===null||e===void 0||e.resume(),this.timer.start(),this.lastStartTime=performance.now(),this.emit("record-resume"))}static getAvailableAudioDevices(){return qe(this,void 0,void 0,function*(){return navigator.mediaDevices.enumerateDevices().then(e=>e.filter(t=>t.kind==="audioinput"))})}destroy(){this.applyOriginalOptionsIfNeeded(),super.destroy(),this.stopRecording(),this.stopMic()}applyOriginalOptionsIfNeeded(){this.wavesurfer&&this.originalOptions&&(this.wavesurfer.setOptions(this.originalOptions),delete this.originalOptions)}}const Wn=({ref:d,hotkey:e="alt+t",size:t,icon:n,iconBg:r,iconColor:s,variant:i,onRecord:o})=>{const[l,p]=m.useState(""),[c,v]=m.useState(0),[y,g]=m.useState(!1),u=m.useRef(null),h=m.useRef(null),f=m.useRef(null);m.useEffect(()=>{if(f.current)return u.current=new ye({container:f.current,waveColor:"#0190ff",cursorWidth:0,width:96,height:t==="sm"?28:32,barWidth:1,barRadius:3,barGap:1,barHeight:1.5,minPxPerSec:16}),h.current=u.current.registerPlugin(Xe.create({scrollingWaveform:!0,renderRecordedAudio:!1})),h.current.on("record-progress",L=>{v(L)}),()=>{var L;(L=u.current)==null||L.destroy()}},[t]),m.useEffect(()=>{var L;(L=h.current)==null||L.on("record-end",C=>{g(!1),o==null||o(C)})},[o]);const b=m.useRef(()=>{var L;(L=h.current)==null||L.startRecording().then(()=>{g(!0)}).catch(()=>{p("Unable to access microphone")})}),k=m.useRef(()=>{var L;(L=h.current)==null||L.stopRecording()});return m.useImperativeHandle(d,()=>({start:b.current,stop:k.current}),[]),a.jsxs("div",{className:X("inline-flex rounded-full overflow-hidden items-center outline outline-tint-100 bg-dimmed -outline-offset-1 self-center",t==="sm"?"h-7":"h-8"),children:[a.jsx("div",{ref:f,className:X("overflow-hidden w-24 bg-base rounded-full",t==="sm"?"h-7":"h-8",!y&&"hidden"),style:{boxShadow:"inset 0 1px 2px 0 var(--tw-shadow-color)"}}),l&&a.jsx("span",{className:"text-xs font-medium text-danger-500 px-2",children:l}),!l&&!y&&a.jsxs(m.Fragment,{children:[e&&a.jsx(O,{global:!0,keyCombo:e,handler:b.current}),a.jsx(V,{size:t,icon:n??N.mic,iconBg:r,iconColor:s,"aria-label":"Start dictation",rounded:!0,variant:i,onClick:b.current})]}),!l&&y&&a.jsxs(m.Fragment,{children:[e&&a.jsx(O,{global:!0,keyCombo:e,handler:k.current}),a.jsx("span",{className:"text-xs px-2",children:oe.duration(c)}),a.jsx(V,{size:t,icon:N.stop,"aria-label":"Stop dictation",rounded:!0,iconAlign:"end",variant:"solid",color:"danger",onClick:k.current})]})]})};Wn.__docgenInfo={description:`Dictation component for recording audio using the microphone.
It uses WaveSurfer.js for audio visualization and recording.
The component provides a button to start and stop recording,
and displays the recording progress.
It also supports a hotkey to start/stop recording.

@param {DictationProps} props - The properties for the Dictation component.
@returns {JSX.Element} The rendered Dictation component.

@example
\`\`\`jsx
<Dictation
  hotkey="alt+t"
  size="md"
  icon={CoreIcons.mic}
  iconBg="bg-blue-500"
  iconColor="text-white"
  variant="solid"
  onRecord={(blob) => {
    // Handle the recorded audio blob
    console.log("Recorded audio blob:", blob);
  }}
/>
\`\`\`

@see {@link https://adarshpastakia.github.io/react-fabric/?path=/story/media-dictation--dictation} for more details on the properties.`,methods:[],displayName:"Dictation",props:{hotkey:{required:!1,tsType:{name:"string"},description:"",defaultValue:{value:'"alt+t"',computed:!1}},onRecord:{required:!1,tsType:{name:"signature",type:"function",raw:"(blob: Blob) => void",signature:{arguments:[{type:{name:"Blob"},name:"blob"}],return:{name:"void"}}},description:""},ref:{required:!1,tsType:{name:"RefObject",elements:[{name:"signature",type:"object",raw:"{ start: () => void; stop: () => void }",signature:{properties:[{key:"start",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}},{key:"stop",value:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}},required:!0}}]}}],raw:"RefObject<{ start: () => void; stop: () => void }>"},description:""}},composes:["Pick"]};const De=({size:d})=>{const[e,t]=m.useState(!1);return e?null:a.jsx("div",{role:"none","data-inner-clickable":"true",className:"bg-tint-50/80 backdrop-blur-xl absolute inset-0 grid place-content-center text-center shadow-inset select-none",onClick:n=>[t(!0),n.stopPropagation(),n.preventDefault()],children:a.jsxs("div",{className:d==="sm"?"text-sm":"text-2xl",children:[a.jsx("div",{children:"Not Safe For Work"}),a.jsx(ue,{size:d==="sm"?32:64,color:"danger",icon:N.mediaNsfw}),a.jsx("div",{children:"Click to view"})]})})};De.__docgenInfo={description:"",methods:[],displayName:"NsfwOverlay",props:{size:{required:!1,tsType:{name:"union",raw:'"sm" | "md"',elements:[{name:"literal",value:'"sm"'},{name:"literal",value:'"md"'}]},description:""}}};const Tt=m.createContext({}),Ye=({children:d,ref:e,mediaEl:t,width:n})=>{const r=m.useRef(null),[s,i]=m.useReducer((l,p)=>p.type==="clear"?[]:p.type==="unhilight"?[...l]:p.type==="drawBox"?[...l,p.payload]:l,[]);m.useImperativeHandle(e,()=>({clear:()=>{i({type:"clear"})},unhilight:()=>{i({type:"unhilight"})},drawBox:(l,p={})=>{i({type:"drawBox",payload:{box:l,...p}})},drawPolygon:(l,p={})=>{i({type:"drawBox",payload:{polygon:l,...p}})},hilightBox:l=>{i({type:"hilight",payload:l})},hilightPolygon:l=>{i({type:"hilightPolygon",payload:l})}}),[r,i]);const o=m.useCallback(()=>{const l=t.current;let p=1;return l instanceof HTMLImageElement&&(p=Math.min(l.offsetWidth/l.naturalWidth,l.offsetHeight/l.naturalHeight)),l instanceof HTMLVideoElement&&(p=Math.min(l.offsetWidth/l.videoWidth,l.offsetHeight/l.videoHeight)),p},[]);return m.useEffect(()=>{var c;const l=(c=r.current)==null?void 0:c.getContext("2d");l==null||l.clearRect(0,0,l.canvas.width,l.canvas.height);const p=o();l!=null&&s.forEach(({box:v,polygon:y,...g})=>{if(v){let[u,h,f,b]=Ve(v);if(u*=p,h*=p,f*=p,b*=p,l.lineWidth=2,l.strokeStyle=(g==null?void 0:g.stroke)??"#fc0",l.strokeRect(u,h,f,b),g.labelTop){const k=u-1;let L=h-18;L<0&&(L+=18),l.fillStyle=g.colorTop??"rgb(0 0 0 / 0.5)",l.fillRect(k,L,f+2,18),l.fillStyle="#ffffff",l.font="13px sans-serif",l.globalCompositeOperation="screen",l.fillText(`${g.labelTop}`,k+2,L+15,f-4)}if(l.globalCompositeOperation="source-over",g.labelBottom){const k=u-1;let L=h+b;L>l.canvas.height&&(L-=18),l.fillStyle=g.colorBottom??"rgb(0 0 0 / 0.5)",l.fillRect(k,L,f+2,18),l.fillStyle="#ffffff",l.font="13px sans-serif",l.globalCompositeOperation="screen",l.fillText(`${g.labelBottom}`,k+2,L+15,f-4)}l.globalCompositeOperation="source-over"}y!=null&&(l.lineWidth=2,l.strokeStyle=(g==null?void 0:g.stroke)??"#fc0",l.beginPath(),y.forEach((u,h)=>{const[f,b]=Ve(u);h===0&&l.moveTo(f*p,b*p),h>0&&l.lineTo(f*p,b*p)}),l.closePath(),l.stroke())})},[s,n]),a.jsx(Tt.Provider,{value:{canvasRef:r},children:d})},jt=()=>m.useContext(Tt);Ye.__docgenInfo={description:"",methods:[{name:"clear",docblock:null,modifiers:[],params:[],returns:null},{name:"unhilight",docblock:null,modifiers:[],params:[],returns:null},{name:"drawBox",docblock:null,modifiers:[],params:[{name:"box",optional:!1,type:null},{name:"options",optional:!0,type:null}],returns:null},{name:"drawPolygon",docblock:null,modifiers:[],params:[{name:"polygon",optional:!1,type:null},{name:"options",optional:!0,type:null}],returns:null},{name:"hilightBox",docblock:null,modifiers:[],params:[{name:"box",optional:!1,type:null}],returns:null},{name:"hilightPolygon",docblock:null,modifiers:[],params:[{name:"polygon",optional:!1,type:null}],returns:null}],displayName:"CanvasProvider",props:{width:{required:!0,tsType:{name:"number"},description:""},mediaEl:{required:!0,tsType:{name:"RefObject",elements:[{name:"union",raw:"HTMLImageElement | HTMLVideoElement | null",elements:[{name:"HTMLImageElement"},{name:"HTMLVideoElement"},{name:"null"}]}],raw:"RefObject<HTMLImageElement | HTMLVideoElement | null>"},description:""}}};const Et=m.createContext({}),St=({children:d,src:e,ref:t,defaultSplitter:n=!0,fallback:r,overlay:s,onLoad:i,onError:o})=>{const l=m.useRef(null),p=m.useRef(null),[c,v]=m.useReducer((w,M)=>{if(M.type==="loaded"&&(w.isLoading=!1,w.isLoaded=!0,w.colorScheme=M.colorScheme,setTimeout(()=>i==null?void 0:i(),10)),M.type==="errored"&&(w.errorLevel++,w.errorLevel===1&&(r?(w.image=r,w.src=r):w.errorLevel++),w.errorLevel===2&&(w.isLoading=!1,w.isLoaded=!0,setTimeout(()=>o==null?void 0:o(),10))),M.type==="resize"&&(w.ratio=M.ratio,w.containerWidth=M.containerWidth,w.containerHeight=M.containerHeight),M.type==="toggleFit"&&(w.zoom=w.zoom===0?1:0),M.type==="fitToView"&&(w.zoom=0),M.type==="fitToSize"&&(w.zoom=1),M.type==="image"&&(w.overlay=void 0,w.splitter=!1,w.isLoaded=!1,w.isErrored=!1,w.isLoading=!0,w.errorLevel=0,w.image=M.src,w.src=M.src),M.type==="overlay"&&(w.overlay=M.overlay,M.overlay?(w.splitter=n,w.src=n?w.image:M.overlay):(w.splitter=!1,w.src=w.image)),M.type==="toggleSplitter"&&(w.splitter=!w.splitter,w.overlay?w.src=w.splitter?w.image:w.overlay:w.src=w.image),M.type==="toggleCropping"&&(w.cropping=!w.cropping),M.type==="startCropping"&&(w.cropping=!1),M.type==="cancelCropping"&&(w.cropping=!1),M.type==="zoom"&&(w.zoom+=M.zoom,M.reset&&w.zoom>5&&(w.zoom=.5),w.zoom=Math.min(5,Math.max(.1,w.zoom))),M.type==="zoomScale"&&(w.zoom=M.zoom),M.type==="rotate"&&(w.rotate+=M.rotate,w.rotate=w.rotate>270?0:w.rotate<0?270:w.rotate),w.zoom===0){const{containerWidth:$,containerHeight:F,ratio:x}=w;let[W,A]=$>F?[F*x,F]:[$,$*x];w.rotate%180!==0&&($>F?(W=F,A=F/x):(W=$/x,A=$)),w.imageWidth=W-16,w.imageHeight=A-16}if(w.zoom>0&&l.current){const{naturalWidth:$,naturalHeight:F}=l.current,x=w.splitter?1:w.zoom;w.imageWidth=$*x,w.imageHeight=F*x}return w.width=w.rotate%180===0?w.imageWidth:w.imageHeight,w.height=w.rotate%180===0?w.imageHeight:w.imageWidth,{...w}},{imageWidth:0,imageHeight:0,containerWidth:0,containerHeight:0,ratio:0,width:0,height:0,rotate:0,zoom:0,errorLevel:0,src:"",colorScheme:"light",isLoading:!0,isLoaded:!1,isErrored:!1,showSplitter:!0});m.useEffect(()=>{v({type:"image",src:e})},[e]),m.useEffect(()=>{v({type:"overlay",overlay:s})},[s]);const y=m.useCallback(()=>{if(l.current&&p.current){const{naturalWidth:w,naturalHeight:M}=l.current,{offsetWidth:$,offsetHeight:F}=p.current;if(w>0&&M>0){const x=w/M;v({type:"resize",ratio:x,containerWidth:$,containerHeight:F})}}},[]);m.useEffect(()=>{if(p.current!=null){const w=new ResizeObserver(y);return w.observe(p.current),()=>{w.disconnect()}}},[y]);const g=m.useCallback(w=>{v({type:"loaded",colorScheme:at(w.currentTarget)}),y()},[]),u=m.useCallback(()=>{v({type:"errored"})},[]),h=m.useCallback((w,M=!1)=>{v({type:"zoom",zoom:w,reset:M})},[]),f=m.useCallback(w=>{v({type:"zoomScale",zoom:w})},[]),b=m.useCallback(w=>{v({type:"rotate",rotate:w})},[]),k=m.useCallback(()=>{v({type:"fitToSize"})},[]),L=m.useCallback(()=>{v({type:"fitToView"})},[]),C=m.useCallback(()=>{v({type:"toggleFit"})},[]),T=m.useCallback(()=>{v({type:"toggleCropping"})},[]),P=m.useCallback(()=>{v({type:"startCropping"})},[]),j=m.useCallback(()=>{v({type:"cancelCropping"})},[]),S=m.useCallback(()=>{v({type:"toggleSplitter"})},[]),z=m.useCallback(()=>{v({type:"zoomScale",zoom:0}),v({type:"rotate",rotate:0})},[]);return a.jsx(Et.Provider,{value:{imageRef:l,scrollerRef:p,state:c,reset:z,rotate:b,handleLoad:g,handleError:u,zoomScale:f,fitToSize:k,fitToView:L,toggleFit:C,changeZoom:h,toggleSplitter:S,toggleCropping:T,cancelCropping:j,startCropping:P},children:a.jsx(Ye,{ref:t,mediaEl:l,width:c.width,children:d})})},We=()=>m.useContext(Et);St.__docgenInfo={description:"",methods:[],displayName:"ImageProvider",props:{src:{required:!0,tsType:{name:"string"},description:""},defaultSplitter:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},fallback:{required:!1,tsType:{name:"string"},description:""},overlay:{required:!1,tsType:{name:"string"},description:""},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:""}}};const Pt=({onCrop:d})=>{const e=m.useRef({x:0,y:0,top:100,left:100,width:500,height:500,dragging:!1}),t=m.useRef(null),{state:n,imageRef:r,toggleCropping:s}=We(),[i,o]=m.useState(),l=m.useCallback(([y,g,u,h])=>{if(r.current){if(n.rotate===90){const b=y,k=u;y=g,g=n.width-(b+u),u=h,h=k}if(n.rotate===180&&(y=n.width-(y+u),g=n.height-(g+h)),n.rotate===270){const b=y,k=u;y=n.height-(g+h),g=b,u=h,h=k}let f=n.zoom;f===0&&(f=n.imageWidth/r.current.naturalWidth),y=y/f,g=g/f,u=u/f,h=h/f,s(),d==null||d([y,g,u,h])}},[d,n.zoom,n.rotate,n.width,n.height]),p=m.useCallback(()=>{if(o(void 0),t.current){const{top:y,left:g,width:u,height:h}=e.current;l([g,y,u,h])}e.current={...e.current,dragging:!1},document.removeEventListener("mouseup",p)},[d]),c=m.useCallback(y=>{const g=y.clientX,u=y.clientY;if(t.current){const{top:h,left:f}=t.current.getBoundingClientRect();e.current={x:g,y:u,top:u+h*-1,left:g+f*-1,width:0,height:0,dragging:!0},document.addEventListener("mouseup",p)}},[p]),v=m.useCallback(y=>{if(e.current.dragging){const{x:g,y:u}=e.current;let h=Math.abs(y.clientX-g),f=Math.abs(y.clientY-u);if(t.current){const{top:b,left:k,height:L,width:C}=t.current.getBoundingClientRect();let T=Math.min(y.clientY,u)+b*-1,P=Math.min(y.clientX,g)+k*-1;T<0&&(f=Math.max(f+T,0),T=0),P<0&&(h=Math.max(h+P,0),P=0),T+f>L&&(f=L-T),P+h>C&&(h=C-P),e.current={...e.current,top:T,left:P,width:h,height:f},o(e.current)}}},[]);return a.jsx("div",{role:"none",className:"absolute inset-0 overflow-hidden cursor-crosshair pointer-events-auto grid place-items-center",onMouseDown:c,onMouseMove:v,children:a.jsx("div",{ref:t,className:"relative m-auto",style:{width:n.width,height:n.height},children:i&&a.jsx("div",{style:i,className:"absolute bg-black/50 border-2 border-dashed border-white mix-blend-difference pointer-events-none"})})})};Pt.__docgenInfo={description:"",methods:[],displayName:"Cropper",props:{onCrop:{required:!1,tsType:{name:"signature",type:"function",raw:"(box: number[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"number"}],raw:"number[]"},name:"box"}],return:{name:"void"}}},description:""}}};const Mt=({src:d})=>{const{state:e}=We(),t=m.useRef(null),[n,r]=m.useState(0),[s,i]=m.useState(!1),{ref:o,onMouseDown:l}=Qt(({x:p,y:c})=>{t.current!=null&&r(s?t.current.offsetHeight+c:t.current.offsetWidth+p)},{isVertical:s});return m.useEffect(()=>{r((s?e.containerHeight:e.containerWidth)/2)},[e.containerHeight,e.containerWidth,s]),a.jsxs(m.Fragment,{children:[a.jsxs("div",{className:"absolute overflow-hidden pointer-events-none min-h-2 min-w-2",ref:t,style:s?{top:0,insetInline:0,height:n,maxHeight:e.containerHeight}:{insetInlineStart:0,insetBlock:0,width:n,maxWidth:e.containerWidth},children:[a.jsx("div",{className:"grid p-[8px]",style:{width:e.containerWidth,height:e.containerHeight},children:a.jsx("div",{className:"origin-center relative m-auto pointer-events-none",style:{width:e.imageWidth,height:e.imageHeight,transform:`rotate(${e.rotate}deg)`},children:a.jsx("img",{alt:d,src:d,loading:"lazy",crossOrigin:"anonymous",className:"object-contain size-full"})})}),a.jsx("div",{role:"none",ref:o,onMouseDown:l,className:X("bg-white outline outline-2 outline-black -outline-offset-2 absolute pointer-events-auto",s&&"h-2 inset-x-0 bottom-0 cursor-ns-resize",!s&&"w-2 inset-y-0 end-0 cursor-ew-resize")})]}),a.jsx("div",{className:X("absolute leading-none bg-accent-500 rounded-full p-1 ring-1 ring-white",s&&"left-1/2 -translate-x-1/2",!s&&"top-1/2 -translate-y-1/2"),style:s?{top:Math.min(Math.max(n,0),e.containerHeight)-16}:{insetInlineStart:Math.min(Math.max(n,0),e.containerWidth)-16},children:a.jsx(ue,{icon:N.mediaOrient,"data-orient":s?"vertical":"horizontal",onClick:()=>i(!s)})})]})};Mt.__docgenInfo={description:"",methods:[],displayName:"Overlay",props:{src:{required:!0,tsType:{name:"string"},description:""}}};const Rt=({onCrop:d})=>{const{imageRef:e,scrollerRef:t,state:n,handleLoad:r,handleError:s}=We(),{canvasRef:i}=jt(),o=l=>{let p=l.clientX,c=l.clientY;const v=y=>{t.current&&(t.current.scrollTop-=Math.floor(y.clientY-c),t.current.scrollLeft-=Math.floor(y.clientX-p),p=y.clientX,c=y.clientY,y.preventDefault(),y.stopPropagation())};document.addEventListener("mousemove",v),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",v)},{capture:!0,once:!0})};return a.jsxs("div",{ref:t,className:"area-content overflow-auto relative scroll-hide grid bg-tint-50 select-none p-[8px]",children:[a.jsxs(ut,{children:[a.jsx("div",{role:"none",className:"relative overflow-hidden m-auto grid place-content-center size-full cursor-grab active:cursor-grabbing",onMouseDown:o,style:{width:n.width,height:n.height},children:a.jsxs("div",{className:X("origin-center relative pointer-events-none",n.colorScheme.startsWith("dark")&&"bg-light"),style:{width:n.imageWidth,height:n.imageHeight,transform:`rotate(${n.rotate}deg)`},children:[n.src&&a.jsx("img",{alt:n.src,src:n.src,onLoad:r,onError:s,ref:e,loading:"lazy",crossOrigin:"anonymous",className:"object-contain size-full"}),a.jsx("canvas",{ref:i,width:n.imageWidth,height:n.imageHeight,className:"absolute inset-0"})]})}),n.isLoading&&a.jsx(He,{})]}),n.cropping&&a.jsx(Pt,{onCrop:d}),n.overlay&&n.splitter&&a.jsx(Mt,{src:n.overlay})]})};Rt.__docgenInfo={description:"",methods:[],displayName:"Image",props:{onCrop:{required:!1,tsType:{name:"signature",type:"function",raw:"(box: number[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"number"}],raw:"number[]"},name:"box"}],return:{name:"void"}}},description:""}}};const Dt=({zoom:d=0})=>a.jsx("svg",{viewBox:"0 0 500 500",style:{transform:`rotate(${68-d/5*136}deg)`},children:a.jsx("g",{transform:"scale(1.000000,-1.000000) translate(0,-500)",children:a.jsx("path",{d:"M 6.555585 21.188976 L 6.206033 20.500752 L 5.931069 19.834808 L 5.658183 19.168236 L 5.483647 18.532660 L 5.310983 17.896956 L 5.236253 17.293136 L 5.163183 16.689588 L 5.163660 16.110546 L 5.204560 15.548065 L 5.380193 14.472769 L 5.680006 13.464121 L 6.102920 12.522391 L 6.360214 12.076632 L 6.643557 11.646527 L 6.958955 11.237889 L 7.274940 10.829952 L 7.633211 10.450260 L 7.991942 10.071186 L 8.392715 9.720167 L 8.793829 9.369659 L 9.226385 9.040140 L 9.672875 8.729473 L 10.119561 8.419139 L 10.728600 8.052173 L 11.337824 7.685547 L 11.947232 7.319261 L 12.414125 7.079228 L 12.881041 6.839244 L 13.351569 6.623566 L 13.822075 6.407840 L 14.481102 6.156440 L 15.139976 5.904688 L 15.798698 5.652584 L 16.316325 5.490216 L 16.833810 5.327490 L 17.357857 5.185334 L 17.878199 5.078665 L 18.398344 4.971415 L 18.913563 4.911351 L 19.428568 4.850547 L 19.938637 4.836624 L 20.448494 4.821812 L 20.954618 4.841725 L 21.456096 4.888389 L 22.438961 5.073664 L 23.395506 5.380906 L 24.326480 5.809479 L 24.782671 6.069101 L 25.228033 6.365643 L 25.650055 6.728418 L 26.072708 7.089754 L 26.464764 7.539958 L 26.857848 7.988786 L 27.221212 8.526661 L 27.586077 9.063272 L 27.929793 9.666561 L 28.248893 10.292745 L 28.499451 10.897620 L 28.751921 11.501923 L 28.911994 12.079034 L 29.073794 12.656040 L 29.142826 13.206701 L 29.213401 13.757626 L 29.214504 14.289353 L 29.178503 14.809326 L 29.021353 15.816494 L 28.749909 16.780372 L 28.363262 17.701238 L 28.126454 18.145561 L 27.864894 18.579316 L 27.572274 18.997106 L 27.280279 19.415558 L 26.946407 19.812367 L 26.613036 20.209761 L 26.237539 20.585334 L 25.862419 20.961392 L 25.455617 21.321038 L 25.034331 21.664433 L 24.613267 22.008145 L 24.035757 22.422734 L 23.458459 22.837647 L 22.881373 23.252883 L 22.436200 23.531134 L 21.991056 23.809431 L 21.540271 24.063807 L 21.089460 24.318138 L 20.453332 24.623024 L 19.817023 24.927572 L 19.180533 25.231781 L 18.676665 25.433822 L 18.172626 25.635518 L 17.659592 25.815748 L 17.146306 25.958175 L 16.632780 26.100036 L 16.118926 26.191356 L 15.604809 26.281952 L 15.090339 26.321697 L 14.575606 26.360566 L 14.060559 26.360857 L 13.546913 26.331059 L 12.529031 26.168953 L 11.524184 25.869482 L 10.533176 25.431927 L 10.043178 25.161173 L 9.561230 24.847002 L 9.097788 24.455393 L 8.635029 24.062253 L 8.197558 23.566372 L 7.761235 23.068989 L 7.351209 22.468977 L 6.942883 21.867552 L 6.555585 21.188976 Z M 8.128964 20.340798 L 8.430380 20.863901 L 9.078392 21.779198 L 9.784754 22.519466 L 10.547516 23.084373 L 10.949539 23.301036 L 11.359791 23.481624 L 12.188675 23.758070 L 13.028262 23.921958 L 13.878136 23.973851 L 14.306846 23.957997 L 14.736425 23.918975 L 15.593316 23.785485 L 16.447223 23.578549 L 17.298256 23.298767 L 17.722750 23.131751 L 18.546958 22.775853 L 19.299136 22.409082 L 20.051111 22.041931 L 20.731369 21.664541 L 21.408622 21.254662 L 22.104835 20.782926 L 22.801280 20.311557 L 23.517074 19.778914 L 23.871345 19.497867 L 24.538501 18.908235 L 25.150844 18.282282 L 25.708829 17.620423 L 25.967585 17.276140 L 26.207558 16.922638 L 26.615338 16.186975 L 26.927424 15.413195 L 27.144456 14.601258 L 27.217529 14.180921 L 27.258076 13.751582 L 27.214924 12.867330 L 27.006667 11.947860 L 26.633944 10.991450 L 26.386100 10.498736 L 26.110720 10.020865 L 25.516615 9.183798 L 24.862969 8.504428 L 24.147993 7.982343 L 23.767040 7.780227 L 23.375731 7.610230 L 22.578153 7.345249 L 21.760204 7.180648 L 20.921500 7.116940 L 20.494284 7.123106 L 20.064447 7.150031 L 19.204835 7.252370 L 18.345341 7.419855 L 17.486062 7.653095 L 17.056550 7.794569 L 16.218143 8.099766 L 15.441560 8.422477 L 14.664798 8.744793 L 13.950131 9.085270 L 13.260955 9.446116 L 12.540911 9.872500 L 11.821075 10.299264 L 11.070728 10.792177 L 10.697878 11.054994 L 9.996374 11.612154 L 9.354146 12.211755 L 8.771633 12.854219 L 8.502913 13.191636 L 8.254025 13.541062 L 7.830236 14.279563 L 7.505661 15.071027 L 7.280999 15.915419 L 7.206362 16.357401 L 7.166385 16.812337 L 7.219044 17.760047 L 7.449200 18.757028 L 7.857645 19.801470 L 8.128964 20.340798 Z M 30.877823 39.309891 L 30.652729 38.925903 L 30.428938 38.091225 L 30.430419 37.641253 L 30.505041 37.210712 L 30.864912 36.530358 L 31.149430 36.280217 L 31.496506 36.092890 L 32.274053 35.972158 L 32.704451 36.037968 L 33.126644 36.179810 L 33.839185 36.668958 L 34.130202 37.016630 L 34.351651 37.393978 L 34.574214 38.216586 L 34.575516 38.662551 L 34.505599 39.091448 L 34.156939 39.776412 L 33.877464 40.032160 L 33.534194 40.226389 L 32.757752 40.359696 L 32.324497 40.297990 L 31.897754 40.157639 L 31.174076 39.663410 L 30.877823 39.309891 Z M 44.425035 56.692265 L 44.164251 56.331562 L 43.861665 55.522112 L 43.820108 55.074060 L 43.853214 54.638356 L 44.146373 53.926706 L 44.405666 53.650502 L 44.733237 53.430843 L 45.495675 53.236306 L 45.930394 53.260655 L 46.364216 53.361473 L 47.120269 53.780237 L 47.443200 54.098486 L 47.699720 54.452927 L 47.999930 55.250481 L 48.043874 55.694278 L 48.015294 56.127895 L 47.733736 56.843063 L 47.479999 57.124365 L 47.156877 57.350531 L 46.396742 57.557479 L 45.959571 57.537488 L 45.521362 57.438591 L 44.753737 57.015833 L 44.425035 56.692265 Z M 59.572451 72.699440 L 59.278368 72.365329 L 58.899760 71.588525 L 58.815546 71.146501 L 58.806834 70.709628 L 59.030593 69.973204 L 59.262284 69.673470 L 59.567348 69.423491 L 60.307687 69.156933 L 60.742742 69.139598 L 61.184218 69.198467 L 61.976853 69.543010 L 62.328738 69.828918 L 62.617978 70.157204 L 62.993083 70.922393 L 63.079266 71.359953 L 63.092284 71.794317 L 62.880408 72.533132 L 62.654735 72.837410 L 62.354723 73.093440 L 61.617862 73.372132 L 61.180783 73.394040 L 60.735126 73.337502 L 59.930590 72.990090 L 59.572451 72.699440 Z M 70.866921 91.143049 L 71.342026 90.551374 L 71.817130 89.959699 L 72.653127 90.627866 L 73.492157 91.292219 L 74.334203 91.952746 L 75.179247 92.609432 L 76.027273 93.262264 L 76.878261 93.911229 L 77.732195 94.556313 L 78.317691 93.777581 L 78.903186 92.998848 L 79.488681 92.220116 L 80.074176 91.441383 L 80.659671 90.662651 L 81.245167 89.883918 L 81.830662 89.105186 L 82.416157 88.326453 L 83.001652 87.547721 L 83.587147 86.768988 L 84.172643 85.990256 L 84.758138 85.211523 L 85.343633 84.432791 L 85.929128 83.654058 L 86.514623 82.875326 L 87.100119 82.096593 L 87.685614 81.317861 L 88.271109 80.539128 L 88.900953 81.010900 L 89.532500 81.480390 L 90.165740 81.947593 L 89.583183 82.740182 L 89.000625 83.532771 L 88.418067 84.325360 L 87.835509 85.117949 L 87.252951 85.910538 L 86.670393 86.703127 L 86.087835 87.495716 L 85.505277 88.288305 L 84.922719 89.080894 L 84.340162 89.873483 L 83.757604 90.666072 L 83.175046 91.458661 L 82.592488 92.251250 L 82.009930 93.043839 L 81.427372 93.836428 L 80.844814 94.629017 L 80.262256 95.421606 L 79.679699 96.214195 L 79.097141 97.006785 L 78.514583 97.799374 L 77.932025 98.591963 L 77.349467 99.384552 L 76.766909 100.177141 L 76.184351 100.969730 L 75.332213 100.340516 L 74.482848 99.707565 L 74.805096 98.994254 L 74.987825 98.346036 L 75.171718 97.698384 L 75.216445 97.115722 L 75.182148 96.565238 L 74.916441 95.526621 L 74.685087 95.037994 L 74.391166 94.561166 L 74.007413 94.089343 L 73.625115 93.616777 L 73.153063 93.148412 L 72.633808 92.672752 L 72.061336 92.172457 L 71.490568 91.670405 L 70.866921 91.143049 Z M 103.498088 105.772623 L 103.133156 105.517789 L 102.581122 104.852939 L 102.394479 104.443498 L 102.282406 104.021155 L 102.325129 103.252674 L 102.479125 102.906543 L 102.716200 102.591347 L 103.372200 102.156813 L 103.790732 102.036794 L 104.233574 101.989283 L 105.085307 102.136013 L 105.494960 102.330310 L 105.853805 102.580633 L 106.399682 103.235031 L 106.587179 103.639669 L 106.702839 104.058552 L 106.672228 104.826538 L 106.525157 105.175656 L 106.294424 105.495533 L 105.644681 105.941030 L 105.225267 106.065971 L 104.778915 106.116739 L 103.914940 105.970044 L 103.498088 105.772623 Z M 123.068366 115.905641 L 122.680737 115.686875 L 122.067652 115.077863 L 121.842710 114.688147 L 121.690761 114.278457 L 121.659798 113.509413 L 121.779987 113.150142 L 121.985833 112.813718 L 122.597272 112.318442 L 123.002408 112.158949 L 123.438677 112.069306 L 124.300538 112.133912 L 124.726894 112.288143 L 125.108033 112.503002 L 125.713989 113.102198 L 125.939323 113.487050 L 126.094511 113.892953 L 126.137483 114.660347 L 126.024473 115.021930 L 125.825387 115.362405 L 125.221226 115.867996 L 124.815683 116.032473 L 124.376232 116.125694 L 123.502187 116.062294 L 123.068366 115.905641 Z M 143.517981 124.120694 L 143.111208 123.939999 L 142.442693 123.392409 L 142.181512 123.025991 L 141.991081 122.632710 L 141.886715 121.870151 L 141.971996 121.501033 L 142.144726 121.146465 L 142.705999 120.594987 L 143.094026 120.397481 L 143.519722 120.266528 L 144.383812 120.248417 L 144.822963 120.361168 L 145.222903 120.538594 L 145.883383 121.077096 L 146.144488 121.438635 L 146.337782 121.827837 L 146.453943 122.587604 L 146.376029 122.958337 L 146.210416 123.316291 L 145.657374 123.877341 L 145.269419 124.079847 L 144.840896 124.214666 L 143.964795 124.235142 L 143.517981 124.120694 Z M 180.770713 120.816177 L 180.598837 121.778987 L 180.426961 122.741797 L 179.393173 122.554697 L 178.360291 122.362650 L 177.328341 122.165662 L 176.297346 121.963737 L 175.267329 121.756879 L 174.238314 121.545093 L 173.210324 121.328385 L 172.183383 121.106759 L 171.157515 120.880220 L 170.132743 120.648774 L 169.109090 120.412425 L 168.086581 120.171179 L 167.065237 119.925042 L 166.045084 119.674019 L 166.057264 120.273200 L 166.203138 120.869438 L 166.350464 121.465655 L 166.632696 122.058540 L 166.981200 122.644918 L 167.391042 123.215620 L 167.803316 123.785594 L 168.277213 124.339414 L 168.781422 124.879161 L 169.312176 125.394042 L 169.845436 125.907661 L 170.405088 126.396151 L 170.935582 126.851534 L 171.468204 127.305657 L 171.923408 127.711417 L 172.380255 128.116254 L 172.962859 128.624524 L 173.518495 129.147829 L 174.076752 129.669769 L 174.608046 130.207024 L 175.113385 130.754630 L 175.565116 131.319247 L 176.019314 131.882986 L 176.419661 132.464180 L 176.776852 133.058732 L 177.056047 133.676533 L 177.337199 134.294032 L 177.539807 134.935180 L 177.678458 135.594345 L 177.702024 136.283956 L 177.726435 136.973627 L 177.634596 137.693809 L 177.552619 138.092411 L 177.333383 138.841153 L 177.039827 139.525086 L 176.671329 140.143915 L 176.458817 140.428804 L 175.986027 140.949852 L 175.427346 141.373996 L 174.866816 141.796844 L 174.220306 142.121950 L 173.523380 142.383342 L 172.763135 142.553300 L 172.001480 142.720819 L 171.177188 142.796080 L 170.320358 142.809246 L 169.429525 142.731545 L 168.538606 142.650484 L 167.614915 142.478043 L 167.047510 142.343704 L 165.981730 142.026294 L 165.008623 141.644933 L 164.128824 141.200767 L 163.724078 140.955463 L 163.342350 140.696894 L 162.646580 140.146551 L 162.041121 139.552600 L 161.525962 138.915752 L 161.302215 138.581437 L 161.100739 138.237643 L 160.763692 137.524919 L 160.514222 136.779006 L 160.351905 136.000215 L 160.303274 135.598561 L 160.275712 135.190802 L 160.281897 134.363131 L 160.369252 133.519263 L 160.537041 132.659132 L 160.650856 132.222923 L 161.467192 132.432524 L 162.284280 132.639171 L 163.102111 132.842861 L 162.950014 133.474014 L 162.873788 134.097850 L 162.797960 134.721758 L 162.798737 135.338434 L 162.855658 135.942726 L 163.003500 136.516943 L 163.152624 137.091131 L 163.393214 137.634981 L 163.699476 138.152786 L 164.109587 138.622948 L 164.521451 139.092412 L 165.037282 139.513476 L 165.627852 139.891738 L 166.336677 140.191104 L 167.046863 140.488319 L 167.874521 140.705200 L 168.515170 140.823745 L 169.142109 140.876144 L 169.768978 140.926866 L 170.381494 140.911597 L 170.974982 140.851102 L 172.076816 140.592820 L 172.584792 140.395438 L 173.058523 140.153898 L 173.886795 139.542466 L 174.241399 139.173004 L 174.547486 138.760657 L 174.768116 138.283514 L 174.988220 137.806200 L 175.123537 137.264427 L 175.215493 136.585660 L 175.186653 135.957867 L 175.158581 135.330128 L 175.010710 134.753278 L 174.787788 134.189485 L 174.458248 133.613990 L 174.130709 133.038061 L 173.697560 132.449811 L 173.211482 131.860266 L 172.669263 131.280179 L 172.129952 130.698828 L 171.534825 130.126384 L 170.919922 129.559334 L 170.308124 128.990632 L 169.692829 128.427462 L 169.080620 127.862629 L 168.473875 127.296693 L 167.887289 126.720120 L 167.303793 126.142034 L 166.740466 125.553525 L 166.205104 124.953373 L 165.730305 124.330239 L 165.258497 123.706138 L 164.847057 123.059596 L 164.487284 122.395334 L 164.219174 121.701021 L 163.953549 121.006482 L 163.778982 120.282382 L 163.718021 119.911700 L 163.662025 119.147981 L 163.693404 118.354531 L 163.811450 117.531350 L 163.902730 117.108580 L 164.947899 117.379450 L 165.994398 117.645130 L 167.042204 117.905612 L 168.091289 118.160890 L 169.141629 118.410958 L 170.193197 118.655810 L 171.245967 118.895440 L 172.299913 119.129842 L 173.355010 119.359010 L 174.411231 119.582938 L 175.468551 119.801621 L 176.526943 120.015054 L 177.586381 120.223231 L 178.646840 120.426147 L 179.708292 120.623797 L 180.770713 120.816177 Z M 197.243826 135.818155 L 196.805804 135.739086 L 196.026494 135.365665 L 195.685864 135.071643 L 195.407595 134.734745 L 195.125357 134.018693 L 195.120664 133.639880 L 195.204376 133.254464 L 195.618846 132.585607 L 195.948962 132.301710 L 196.331456 132.073534 L 197.166598 131.851011 L 197.619960 131.856396 L 198.050569 131.933909 L 198.819918 132.300406 L 199.159317 132.589707 L 199.439400 132.921963 L 199.732435 133.632505 L 199.744668 134.011139 L 199.668673 134.398158 L 199.264468 135.074362 L 198.935608 135.363099 L 198.551285 135.595700 L 197.705035 135.823370 L 197.243826 135.818155 Z M 219.257737 136.848474 L 218.814162 136.811656 L 218.002712 136.514472 L 217.635526 136.254373 L 217.326314 135.945630 L 216.976893 135.259851 L 216.935995 134.883223 L 216.982466 134.491568 L 217.331073 133.786140 L 217.632527 133.471975 L 217.991447 133.208267 L 218.801482 132.906898 L 219.253281 132.868902 L 219.689328 132.904881 L 220.490200 133.196125 L 220.855709 133.451643 L 221.166283 133.755591 L 221.525925 134.434853 L 221.574311 134.810583 L 221.535675 135.203095 L 221.197989 135.914854 L 220.898248 136.233717 L 220.537931 136.502005 L 219.717331 136.809560 L 219.257737 136.848474 Z M 241.269286 135.768859 L 240.824223 135.774630 L 239.988072 135.556408 L 239.597696 135.332615 L 239.260375 135.054857 L 238.846974 134.405637 L 238.770246 134.034646 L 238.779050 133.640342 L 239.058598 132.904809 L 239.328626 132.563256 L 239.660683 132.266432 L 240.438185 131.888980 L 240.884280 131.807952 L 241.321770 131.802067 L 242.146823 132.015388 L 242.535092 132.234781 L 242.873310 132.507636 L 243.296262 133.149392 L 243.380357 133.518772 L 243.379435 133.913180 L 243.111362 134.653970 L 242.843489 135.000036 L 242.510479 135.301552 L 241.723053 135.686172 L 241.269286 135.768859 Z M 260.457736 127.870986 L 259.657254 128.019511 L 258.856240 128.165140 L 258.054704 128.307870 L 257.946600 127.845885 L 257.810766 126.949493 L 257.781137 126.090003 L 257.856659 125.267441 L 257.933557 124.869974 L 258.033859 124.482671 L 258.296743 123.741397 L 258.642297 123.044288 L 259.070168 122.390928 L 259.314890 122.080498 L 259.578369 121.781134 L 260.156373 121.216309 L 260.802496 120.696202 L 261.516879 120.220174 L 261.899735 119.998470 L 262.297376 119.789070 L 263.130142 119.411539 L 264.013391 119.088519 L 264.947779 118.819356 L 265.434372 118.704756 L 266.307683 118.540781 L 267.172010 118.462673 L 268.036460 118.381040 L 268.893258 118.385416 L 269.316046 118.409644 L 270.134804 118.506152 L 270.918219 118.667090 L 271.666717 118.892872 L 272.027981 119.030203 L 272.379079 119.183741 L 273.046179 119.539211 L 273.666537 119.959600 L 274.240127 120.445351 L 274.509349 120.712869 L 274.763363 120.997782 L 275.215161 121.622752 L 275.591470 122.321668 L 275.891540 123.094969 L 276.012707 123.509629 L 276.135677 124.066569 L 276.183507 124.606458 L 276.230910 125.146422 L 276.177474 125.663679 L 276.123240 126.180991 L 275.810603 127.169892 L 275.576869 127.646943 L 275.293161 128.104629 L 274.581215 128.938445 L 274.129608 129.300615 L 273.676632 129.661880 L 273.128907 129.967893 L 272.579951 130.272565 L 271.959890 130.534762 L 271.975418 130.600400 L 272.539874 130.602656 L 273.594834 130.712296 L 274.552215 130.963286 L 275.412865 131.356932 L 275.807063 131.607624 L 276.173088 131.888391 L 276.808011 132.522682 L 277.312654 133.254917 L 277.685815 134.086024 L 277.822628 134.538882 L 277.908529 134.918622 L 278.001145 135.654435 L 277.987511 136.358757 L 277.866916 137.031537 L 277.766316 137.356043 L 277.501139 137.980064 L 277.125636 138.552804 L 276.747975 139.124988 L 276.259723 139.645137 L 275.706252 140.129708 L 275.070123 140.560754 L 274.431921 140.990082 L 273.711408 141.364974 L 272.952322 141.699589 L 272.161763 141.970425 L 271.369977 142.238601 L 270.547559 142.442581 L 270.033987 142.544841 L 269.032893 142.683798 L 268.067365 142.735716 L 267.138310 142.701041 L 266.687716 142.651369 L 266.248587 142.582219 L 265.411134 142.391790 L 264.628395 142.132332 L 263.900652 141.804394 L 263.557465 141.614906 L 263.228550 141.409205 L 262.614923 140.951554 L 262.060167 140.432622 L 261.564120 139.852831 L 261.338036 139.540234 L 261.128420 139.214092 L 260.764027 138.525954 L 260.472250 137.790294 L 260.252421 137.007394 L 260.169255 136.598299 L 261.000767 136.447865 L 261.831730 136.294425 L 262.662132 136.137979 L 262.789928 136.769156 L 262.992041 137.344333 L 263.194605 137.919387 L 263.472241 138.438164 L 263.798252 138.914211 L 264.193305 139.318657 L 264.589498 139.722466 L 265.054985 140.054191 L 265.563985 140.334680 L 266.132859 140.534537 L 266.702822 140.733024 L 267.332331 140.850286 L 267.999240 140.907623 L 268.717839 140.868205 L 269.436636 140.826584 L 270.206108 140.687572 L 270.836171 140.532628 L 271.421420 140.337335 L 272.006008 140.140578 L 272.545414 139.903923 L 273.048531 139.638550 L 273.928164 139.016892 L 274.304473 138.661091 L 274.632615 138.279144 L 275.127331 137.448298 L 275.294109 136.999759 L 275.398674 136.526027 L 275.397662 136.009700 L 275.396131 135.493437 L 275.289690 134.934611 L 275.129126 134.420606 L 274.645124 133.549808 L 274.322295 133.192640 L 273.959008 132.883035 L 273.150676 132.392974 L 272.705569 132.212203 L 272.238890 132.071587 L 271.257754 131.902946 L 270.742965 131.874699 L 270.227299 131.879068 L 269.239116 131.971988 L 268.766218 132.060725 L 267.736786 132.285555 L 266.706337 132.505683 L 266.521626 131.631261 L 266.336914 130.756839 L 267.359383 130.538416 L 268.380845 130.315327 L 269.039858 130.149361 L 269.653272 129.933320 L 270.265865 129.715596 L 270.832348 129.448301 L 271.360086 129.148382 L 271.818914 128.801582 L 272.276421 128.453851 L 272.664812 128.059819 L 273.000907 127.637429 L 273.499343 126.715994 L 273.661936 126.217362 L 273.759172 125.692356 L 273.747541 125.125979 L 273.735293 124.559685 L 273.614984 123.952037 L 273.432008 123.372089 L 273.156796 122.867417 L 272.882259 122.362480 L 272.516337 121.932319 L 272.102226 121.550693 L 271.633561 121.240609 L 271.166122 120.929550 L 270.644153 120.689529 L 270.093563 120.496576 L 269.510332 120.375195 L 268.928004 120.252241 L 268.312550 120.200481 L 267.684118 120.193302 L 267.049300 120.250628 L 266.414556 120.306069 L 265.772702 120.425931 L 265.024679 120.617340 L 264.352359 120.877209 L 263.678835 121.134967 L 263.080224 121.462144 L 262.535257 121.828106 L 262.078184 122.242516 L 261.619365 122.655972 L 261.248406 123.118641 L 260.935301 123.613197 L 260.709698 124.154631 L 260.482600 124.695868 L 260.343410 125.284368 L 260.267805 125.899236 L 260.296386 126.545870 L 260.324444 127.192563 L 260.457736 127.870986 Z M 294.968801 123.951115 L 294.537804 124.062273 L 293.673755 124.048579 L 293.241440 123.923753 L 292.847870 123.733920 L 292.292293 123.201264 L 292.129769 122.859055 L 292.044807 122.473912 L 292.141940 121.693066 L 292.323261 121.297217 L 292.575449 120.930110 L 293.241252 120.379033 L 293.655403 120.194521 L 294.079015 120.085047 L 294.931121 120.096611 L 295.360345 120.217662 L 295.753624 120.402520 L 296.316709 120.925659 L 296.486008 121.264556 L 296.578651 121.647931 L 296.493914 122.431163 L 296.315756 122.830885 L 296.063756 123.202776 L 295.390011 123.763170 L 294.968801 123.951115 Z M 315.399968 115.690288 L 314.981576 115.842153 L 314.120178 115.911152 L 313.677907 115.828241 L 313.267987 115.676915 L 312.664018 115.199831 L 312.469513 114.874732 L 312.348109 114.499480 L 312.370124 113.712923 L 312.512758 113.301549 L 312.728683 112.912008 L 313.338735 112.299785 L 313.733343 112.076512 L 314.144544 111.927030 L 314.993851 111.857053 L 315.432684 111.936502 L 315.841839 112.082903 L 316.452371 112.549796 L 316.653304 112.870950 L 316.782184 113.243708 L 316.772737 114.031454 L 316.633621 114.446381 L 316.418340 114.840667 L 315.801275 115.462924 L 315.399968 115.690288 Z M 334.947505 105.513469 L 334.545554 105.704649 L 333.694702 105.855709 L 333.246530 105.815472 L 332.824016 105.704041 L 332.177191 105.286902 L 331.952489 104.981894 L 331.795755 104.619971 L 331.742450 103.834914 L 331.845090 103.411785 L 332.022774 103.003380 L 332.571482 102.335623 L 332.942929 102.075637 L 333.337951 101.887516 L 334.176673 101.736640 L 334.621093 101.773758 L 335.042373 101.880361 L 335.694757 102.286728 L 335.925480 102.587195 L 336.089418 102.945919 L 336.155346 103.730959 L 336.056548 104.157288 L 335.879960 104.570354 L 335.325229 105.248769 L 334.947505 105.513469 Z M 357.164969 84.490946 L 356.257817 85.192075 L 355.347107 85.888577 L 354.432863 86.580432 L 353.515109 87.267624 L 352.593867 87.950135 L 351.669163 88.627946 L 350.741020 89.301041 L 349.809461 89.969402 L 348.874513 90.633011 L 349.861904 90.917873 L 350.851961 91.198603 L 351.844667 91.475188 L 352.840006 91.747616 L 353.837964 92.015873 L 354.838523 92.279947 L 355.841670 92.539826 L 356.847387 92.795496 L 357.855660 93.046946 L 358.866471 93.294162 L 359.879806 93.537134 L 360.895648 93.775847 L 361.913982 94.010290 L 362.934790 94.240450 L 363.958057 94.466316 L 364.983768 94.687876 L 365.048537 94.637570 L 364.442109 93.857060 L 363.835681 93.076551 L 363.229252 92.296041 L 362.622824 91.515532 L 362.016396 90.735022 L 361.409967 89.954513 L 360.803539 89.174003 L 360.197111 88.393494 L 359.590682 87.612984 L 358.984254 86.832475 L 358.377826 86.051965 L 357.771397 85.271456 L 357.164969 84.490946 Z M 347.215341 92.121276 L 346.825374 91.557208 L 346.435406 90.993139 L 346.045439 90.429071 L 346.973332 89.784099 L 347.897951 89.134442 L 348.819272 88.480116 L 349.737272 87.821139 L 350.651926 87.157526 L 351.563212 86.489295 L 352.471107 85.816463 L 353.375586 85.139048 L 354.276628 84.457066 L 355.174208 83.770536 L 356.068305 83.079474 L 355.468243 82.307158 L 354.868181 81.534843 L 354.268120 80.762528 L 353.668058 79.990213 L 353.067996 79.217898 L 352.467935 78.445583 L 353.324413 77.776692 L 354.177538 77.103531 L 354.785286 77.869813 L 355.393034 78.636094 L 356.000782 79.402376 L 356.608530 80.168657 L 357.216278 80.934938 L 357.824026 81.701220 L 358.614096 81.071689 L 359.401312 80.438593 L 360.185657 79.801943 L 360.967115 79.161753 L 361.535045 79.851817 L 362.102974 80.541881 L 361.315264 81.187193 L 360.524643 81.828936 L 359.731129 82.467098 L 358.934737 83.101665 L 359.554274 83.882810 L 360.173810 84.663954 L 360.793346 85.445099 L 361.412882 86.226244 L 362.032418 87.007388 L 362.651954 87.788533 L 363.271490 88.569678 L 363.891026 89.350822 L 364.510562 90.131967 L 365.130098 90.913112 L 365.749634 91.694256 L 366.369171 92.475401 L 366.988707 93.256546 L 367.608243 94.037690 L 368.227779 94.818835 L 368.847315 95.599980 L 367.917943 96.333368 L 366.984982 97.062184 L 365.973614 96.853973 L 364.964565 96.641605 L 363.957850 96.425091 L 362.953483 96.204442 L 361.951481 95.979671 L 360.951857 95.750788 L 359.954629 95.517805 L 358.959809 95.280733 L 357.967414 95.039585 L 356.977459 94.794372 L 355.989958 94.545106 L 355.004926 94.291798 L 354.022379 94.034461 L 353.042330 93.773106 L 352.064795 93.507745 L 351.089789 93.238390 L 350.117326 92.965054 L 349.147421 92.687748 L 348.180087 92.406484 L 347.215341 92.121276 Z M 378.798968 72.342002 L 378.453825 72.623056 L 377.663073 72.971595 L 377.218145 73.038796 L 376.781258 73.030748 L 376.053958 72.778912 L 375.763330 72.535896 L 375.525233 72.221470 L 375.287263 71.471453 L 375.286625 71.036053 L 375.362381 70.597160 L 375.737068 69.818321 L 376.036260 69.477660 L 376.375396 69.201222 L 377.154408 68.855737 L 377.594951 68.786398 L 378.029494 68.790047 L 378.759641 69.030100 L 379.055041 69.267276 L 379.299377 69.576886 L 379.549606 70.323893 L 379.554736 70.761490 L 379.481149 71.204652 L 379.103139 71.995273 L 378.798968 72.342002 Z M 393.910499 56.300946 L 393.593816 56.613718 L 392.840019 57.036280 L 392.403556 57.145722 L 391.967903 57.179491 L 391.219852 56.998362 L 390.907316 56.784253 L 390.640242 56.494037 L 390.331638 55.770215 L 390.289365 55.336872 L 390.322802 54.892746 L 390.621291 54.081645 L 390.886533 53.713932 L 391.197680 53.406329 L 391.940082 52.987930 L 392.371975 52.876779 L 392.804876 52.838856 L 393.554632 53.007984 L 393.871360 53.215823 L 394.144184 53.500649 L 394.464704 54.220302 L 394.511658 54.655403 L 394.480788 55.103571 L 394.180119 55.926718 L 393.910499 56.300946 Z M 407.418751 38.888279 L 407.133429 39.229902 L 406.423497 39.722614 L 405.999501 39.873293 L 405.569074 39.948569 L 404.807130 39.839807 L 404.475551 39.656568 L 404.181947 39.393223 L 403.805538 38.702230 L 403.722017 38.274915 L 403.712829 37.829627 L 403.932383 36.993699 L 404.161245 36.602306 L 404.441549 36.266357 L 405.140537 35.778880 L 405.559821 35.626935 L 405.987111 35.547788 L 406.749605 35.644440 L 407.084757 35.821038 L 407.383569 36.078468 L 407.771441 36.764171 L 407.859789 37.192788 L 407.871920 37.641854 L 407.651346 38.489981 L 407.418751 38.888279 Z M 413.299482 18.692391 L 412.892951 19.394533 L 412.483883 20.095200 L 412.072283 20.794382 L 411.724035 20.565425 L 411.085785 20.071049 L 410.524767 19.528590 L 410.040438 18.938573 L 409.826855 18.625863 L 409.632014 18.304380 L 409.297690 17.644084 L 409.036859 16.960694 L 408.849139 16.254140 L 408.782579 15.892129 L 408.702983 15.154078 L 408.730525 14.390501 L 408.755159 13.627797 L 408.886361 12.838665 L 408.977812 12.439537 L 409.211100 11.640451 L 409.511525 10.839670 L 409.879042 10.036436 L 410.087948 9.633646 L 410.315834 9.229133 L 410.808872 8.461570 L 411.352175 7.748767 L 411.946403 7.090131 L 412.262810 6.780951 L 412.588929 6.487387 L 413.260884 5.953857 L 413.959680 5.491740 L 414.685913 5.101032 L 415.059484 4.932470 L 415.438501 4.782634 L 416.208278 4.541830 L 416.994020 4.379811 L 417.796013 4.296983 L 418.203168 4.285406 L 418.611010 4.295448 L 419.418432 4.385714 L 420.214772 4.570296 L 420.999838 4.850100 L 421.388045 5.026000 L 421.781547 5.228377 L 422.517952 5.675721 L 423.186503 6.180463 L 423.786696 6.743249 L 424.060988 7.046580 L 424.316764 7.362303 L 424.768873 8.024136 L 425.141319 8.726605 L 425.433604 9.469755 L 425.549524 9.856567 L 425.644782 10.252603 L 425.771786 11.069476 L 425.813722 11.919103 L 425.770123 12.801003 L 425.716101 13.253873 L 425.639369 13.712218 L 425.414177 14.637819 L 425.093172 15.574479 L 424.676165 16.521115 L 424.431609 16.997806 L 424.224419 17.363841 L 423.764469 18.062443 L 423.244144 18.715903 L 422.663900 19.323615 L 422.351451 19.610131 L 422.029228 19.879205 L 421.370919 20.347617 L 420.694703 20.723145 L 420.001177 21.005964 L 419.648080 21.112679 L 419.667216 21.215239 L 420.627968 21.504790 L 421.589468 21.792587 L 422.551715 22.078627 L 423.514706 22.362910 L 424.478438 22.645435 L 425.442909 22.926201 L 426.408116 23.205206 L 427.374056 23.482449 L 427.931454 22.482583 L 428.484053 21.480058 L 429.031843 20.474896 L 429.574809 19.467121 L 430.112940 18.456755 L 430.646223 17.443822 L 431.174646 16.428346 L 431.698197 15.410349 L 432.216863 14.389855 L 432.730634 13.366887 L 433.239496 12.341468 L 434.116623 12.774126 L 434.993751 13.206783 L 434.455727 14.290649 L 433.912264 15.371798 L 433.363376 16.450203 L 432.809077 17.525837 L 432.249380 18.598672 L 431.684300 19.668682 L 431.113852 20.735839 L 430.538049 21.800116 L 429.956906 22.861487 L 429.370437 23.919925 L 428.778659 24.975403 L 428.181584 26.027894 L 427.256448 25.748872 L 426.331985 25.468280 L 425.408197 25.186119 L 424.485087 24.902390 L 423.562656 24.617094 L 422.640907 24.330232 L 421.719841 24.041805 L 420.799462 23.751814 L 419.879770 23.460260 L 418.960768 23.167144 L 418.042458 22.872468 L 417.124843 22.576231 L 416.207923 22.278435 L 416.743516 21.359963 L 417.274831 20.439009 L 417.690932 20.371589 L 418.500129 20.157053 L 419.278204 19.836042 L 420.024500 19.408389 L 420.385487 19.154546 L 420.734421 18.877601 L 421.384339 18.265338 L 421.969670 17.575742 L 422.489587 16.809470 L 422.724745 16.397805 L 423.059129 15.712132 L 423.291995 15.023571 L 423.522554 14.334615 L 423.651613 13.643938 L 423.714815 12.963793 L 423.684410 12.316481 L 423.652068 11.669947 L 423.526624 11.056793 L 423.342001 10.469419 L 423.074570 9.924804 L 422.805923 9.381306 L 422.455023 8.880531 L 422.050114 8.418505 L 421.566360 8.028782 L 421.082221 7.639655 L 420.519877 7.322066 L 419.940261 7.064992 L 419.341679 6.895322 L 418.743325 6.725060 L 418.126249 6.641316 L 417.506397 6.616593 L 416.896501 6.683694 L 416.286854 6.749184 L 415.686938 6.905906 L 415.101146 7.121221 L 414.547870 7.423225 L 413.994265 7.723174 L 413.472539 8.109754 L 412.979849 8.557835 L 412.543058 9.106023 L 412.104739 9.652472 L 411.721117 10.299601 L 411.425773 10.897861 L 411.209342 11.499075 L 410.991042 12.099907 L 410.851641 12.704558 L 410.764901 13.304423 L 410.759236 13.885877 L 410.751903 14.467880 L 410.825955 15.031983 L 410.952929 15.579939 L 411.158806 16.096409 L 411.363532 16.613795 L 411.647624 17.099734 L 411.983561 17.556093 L 412.396588 17.954125 L 412.809193 18.352715 L 413.299482 18.692391 Z",transform:"scale(1.000000,1.000000) translate(31.000000,334.000000)",fill:"#feffff",opacity:"1.000000"})})});Dt.__docgenInfo={description:"",methods:[],displayName:"ZoomMeter",props:{zoom:{required:!1,tsType:{name:"number"},description:"",defaultValue:{value:"0",computed:!1}}}};const Wt=({enableZoom:d=!0,enableCrop:e=!0})=>{const{state:t,reset:n,rotate:r,zoomScale:s,fitToSize:i,fitToView:o,toggleFit:l,changeZoom:p,toggleSplitter:c,toggleCropping:v,cancelCropping:y,startCropping:g}=We(),u=f=>{const b=f.currentTarget;let k=f.clientX,L=t.zoom||1;const C=T=>{b.parentElement!=null&&(L+=(k-T.clientX)*.05,s(Math.max(.1,Math.min(5,L))),k=T.clientX,T.preventDefault(),T.stopPropagation())};document.addEventListener("mousemove",C),document.addEventListener("mouseup",()=>{document.removeEventListener("mousemove",C)},{capture:!0,once:!0})},h=m.useMemo(()=>({rotateDown:()=>r(-90),rotateUp:()=>r(90),zoomDown:()=>p(-.5,!0),zoomUp:()=>p(.5,!0),toggleFit:()=>l(),startCropping:()=>g(),cancelCropping:()=>y(),reset:()=>n()}),[]);return a.jsxs(fe,{flex:!0,justify:"center",className:"select-none",children:[t.isLoaded&&a.jsxs(m.Fragment,{children:[!t.splitter&&d&&a.jsx(O,{global:!0,keyCombo:",",handler:h.zoomDown}),!t.splitter&&d&&a.jsx(O,{global:!0,keyCombo:".",handler:h.zoomUp}),a.jsx(O,{global:!0,keyCombo:"[",handler:h.rotateDown}),a.jsx(O,{global:!0,keyCombo:"]",handler:h.rotateUp}),d&&a.jsx(O,{global:!0,keyCombo:"f",handler:h.toggleFit}),a.jsx(O,{global:!0,keyCombo:"r",handler:h.reset}),e&&a.jsx(O,{global:!0,keyCombo:"c",handler:h.startCropping}),t.cropping&&a.jsx(O,{global:!0,keyCombo:"esc",handler:h.cancelCropping})]}),d&&a.jsxs(m.Fragment,{children:[a.jsxs("label",{className:"text-xs basis-16 whitespace-nowrap",children:["Zoom: ",t.zoom===0?"FIT":t.zoom.toFixed(2)]}),a.jsx(V,{variant:"link","aria-label":"fit-to-view",onClick:o,disabled:!t.isLoaded,icon:N.mediaFitToView}),!t.splitter&&a.jsx(V,{variant:"link","aria-label":"fit-to-size",onClick:i,disabled:!t.isLoaded,icon:N.mediaAspect}),!t.splitter&&a.jsxs(Re,{placement:"top",dropdownEvent:"hover",dropdownClassName:"overflow-hidden bg-black/80 backdrop-blur-md w-[12rem] h-[6rem] rounded-t-full",children:[a.jsx(V,{variant:"link","aria-label":"zoom",icon:N.mediaZoomer,disabled:!t.isLoaded,onWheel:f=>{p(f.deltaY*.05),f.stopPropagation()},onClick:h.zoomUp}),a.jsxs("div",{role:"none",className:"select-none",onMouseDown:u,onWheel:f=>{p(f.deltaY*.05),f.stopPropagation()},children:[a.jsx(Dt,{zoom:t.zoom}),a.jsx("span",{className:"absolute top-0.5 left-1/2 -translate-x-1/2 bg-accent-300 outline -outline-offset-1 outline-accent-700 rounded-full text-white text-xs py-px px-1",children:t.zoom>0?t.zoom.toFixed(1):"FIT"})]})]}),a.jsx(Le,{vertical:!0})]}),t.overlay&&a.jsx(V,{"aria-label":"splitter",disabled:!t.isLoaded,variant:t.splitter?"solid":"link",icon:N.mediaSplitter,onClick:c}),!t.splitter&&e&&a.jsx(V,{"aria-label":"crop",disabled:!t.isLoaded,variant:t.cropping?"solid":"link",icon:N.mediaCrop,onClick:v}),a.jsx(Le,{vertical:!0}),a.jsx(V,{variant:"link",disabled:!t.isLoaded,"aria-label":"rotate-ccw",icon:N.mediaRotateCCW,onClick:h.rotateDown}),a.jsx(V,{variant:"link",disabled:!t.isLoaded,"aria-label":"rotate-cw",icon:N.mediaRotateCW,onClick:h.rotateUp}),a.jsxs("label",{className:"text-xs basis-16 whitespace-nowrap",children:["Rotate: ",t.rotate,"°"]})]})};Wt.__docgenInfo={description:"",methods:[],displayName:"Tools",props:{enableZoom:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}},enableCrop:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"true",computed:!1}}}};const zn=({nsfw:d,enableZoom:e,onCrop:t,...n})=>a.jsx(lt,{colorScheme:"dark",children:a.jsx(St,{...n,children:a.jsxs(_e,{dir:"ltr",children:[a.jsx(Rt,{onCrop:t}),a.jsx(Wt,{enableCrop:!!t,enableZoom:e}),d&&a.jsx(De,{})]})})});zn.__docgenInfo={description:`ImageViewer component for displaying and interacting with images.
It provides features like zooming, cropping, and NSFW overlay.

@param {ImageProps} props - The properties for the ImageViewer component.
@returns {JSX.Element} The rendered ImageViewer component.

@example
\`\`\`jsx
<ImageViewer
  src="https://example.com/image.jpg"
  fallback="https://example.com/convert?image=image.jpg"
  nsfw={true}
  enableZoom={true}
  onCrop={(box) => console.log("Cropped box:", box)}
  onLoad={() => console.log("Image loaded")}
  onError={() => console.log("Image failed to load")}
/>
\`\`\`

@see {@link https://adarshpastakia.github.io/react-fabric/?path=/story/media-imageviewer--image-viewer} for more details on the properties.`,methods:[],displayName:"ImageViewer",props:{src:{required:!0,tsType:{name:"string"},description:"image source"},fallback:{required:!1,tsType:{name:"string"},description:"fallback alternate source"},nsfw:{required:!1,tsType:{name:"boolean"},description:"NSFW overlay"},overlay:{required:!1,tsType:{name:"string"},description:"image overlay"},defaultSplitter:{required:!1,tsType:{name:"boolean"},description:"default splitter toggle (default: true)"},enableZoom:{required:!1,tsType:{name:"boolean"},description:"enable zoom tool (default: true)"},onCrop:{required:!1,tsType:{name:"signature",type:"function",raw:"(box: number[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"number"}],raw:"number[]"},name:"box"}],return:{name:"void"}}},description:"crop selection handler"},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"error handler"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"error handler"}},composes:["RefProp"]};const Nn=({src:d,nsfw:e,fallback:t,videoReel:n,height:r,className:s,missingIcon:i,width:o="8rem"})=>{const[l,p]=m.useReducer((v,y)=>y.type==="reset"?{...v,src:d??t,errorLevel:d??t?0:2}:y.type==="loaded"?{...v,colorScheme:y.colorScheme,transparent:y.colorScheme.includes("transparent"),loading:!1}:y.type==="colorScheme"?{...v,colorScheme:v.colorScheme==="light_transparent"?"dark_transparent":"light_transparent"}:y.type==="errored"?(v.errorLevel++,v.errorLevel===1&&(t||v.errorLevel++,v.src=t),v.errorLevel===2&&(v.loading=!1),{...v}):{...v},{src:d,loading:!0,errorLevel:0,transparent:!1,colorScheme:""}),c=v=>{p({type:"loaded",colorScheme:at(v.currentTarget)})};return m.useEffect(()=>{p({type:"reset"})},[d]),a.jsxs("div",{className:X("fabric-thumbnail",s,n&&"fabric-reel","overflow-hidden relative grid place-content-center p-1 shadow-inset",l.errorLevel!==2&&l.colorScheme.startsWith("light")&&"bg-dark",l.errorLevel!==2&&l.colorScheme.startsWith("dark")&&"bg-light"),style:{width:o,height:r??(Ht(o)?o*1.325:`calc(${o} * 1.325)`)},children:[l.errorLevel!==2&&a.jsx("img",{className:"max-w-full max-h-full object-contain text-transparent overflow-hidden",alt:d,loading:"lazy",src:l.src,crossOrigin:"anonymous",onLoad:c,width:l.errorLevel===2?48:void 0,onError:()=>p({type:"errored"})}),l.errorLevel===2&&a.jsx(ue,{icon:i??N.mediaImageBroken,className:"text-muted",size:"3rem"}),l.transparent&&a.jsx(ue,{icon:N.mediaContrast,className:X("contrastAction","absolute bottom-2 end-2 rounded-full opacity-50 hover:opacity-100"),onClick:v=>[v.stopPropagation(),p({type:"colorScheme"})]}),e&&a.jsx(De,{size:"sm"}),l.loading&&a.jsx(Bt,{size:"1.5rem"})]})};Nn.__docgenInfo={description:`Thumbnail component for displaying images with various features.
It supports loading states, error handling, NSFW overlays, and color scheme toggling.
The component is designed to be flexible with width and height, and can display a fallback image if the original fails to load.

@param {ThumbnailProps} props - The properties for the Thumbnail component.
@returns {JSX.Element} The rendered Thumbnail component.

@example
\`\`\`jsx
<Thumbnail
  src="https://example.com/image.jpg"
  fallback="https://example.com/fallback.jpg"
  nsfw={true}
  videoReel={true}
  width="8rem"
  height="10rem"
  className="custom-thumbnail"
  missingIcon={CoreIcons.mediaImageBroken}
/>
\`\`\`

@see {@link https://adarshpastakia.github.io/react-fabric/?path=/story/media-thumbnail--thumbnail} for more details on the properties.`,methods:[],displayName:"Thumbnail",props:{src:{required:!0,tsType:{name:"string"},description:"original source"},fallback:{required:!1,tsType:{name:"string"},description:"fallback alternate source"},missingIcon:{required:!1,tsType:{name:"string"},description:"icon image for missing media"},nsfw:{required:!1,tsType:{name:"boolean"},description:"NSFW overlay"},videoReel:{required:!1,tsType:{name:"boolean"},description:"decorate like video reel"},width:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"width",defaultValue:{value:'"8rem"',computed:!1}},height:{required:!1,tsType:{name:"union",raw:"number | string",elements:[{name:"number"},{name:"string"}]},description:"height, defaults to 1.325 * width"}},composes:["CssProp"]};const zt=m.createContext({}),Nt=({children:d,src:e,ref:t,fallback:n,onLoad:r,onError:s,onChange:i,onPause:o,onPlay:l})=>{const p=m.useRef(null),c=m.useRef(null),v=m.useRef(null),[y,g]=m.useReducer((x,W)=>{if(W.type==="loaded"&&(x.isLoading=!1,x.isLoaded=!0,setTimeout(()=>r==null?void 0:r(),10)),W.type==="errored"&&(x.errorLevel++,x.errorLevel===1&&(n?x.src=n:x.errorLevel++),x.errorLevel===2&&(x.isLoading=!1,x.isLoaded=!0,setTimeout(()=>s==null?void 0:s(W.data),10))),W.type==="metadata"&&(x.duration=W.duration,x.volume=W.volume,x.speed=W.speed),W.type==="play")return l==null||l(),{...x,isPlaying:!0};if(W.type==="pause")return o==null||o(),{...x,isPlaying:!1};if(W.type==="playing")return i==null||i(W.time),{...x,time:W.time};if(W.type==="volume")return{...x,volume:W.volume};if(W.type==="speed")return{...x,speed:W.speed};if(W.type==="toggleVtt")return{...x,showVtt:!x.showVtt};if(W.type==="srcChange"&&(x.isLoaded=!1,x.isLoading=!0,x.src=W.src),W.type==="resize"&&(x.ratio=W.ratio,x.containerWidth=W.containerWidth,x.containerHeight=W.containerHeight),W.type==="toggleFit"&&(x.zoom=x.zoom===0?1:0),W.type==="fitToView"&&(x.zoom=0),W.type==="fitToSize"&&(x.zoom=1),W.type==="rotate"&&(x.rotate+=W.rotate,x.rotate=x.rotate>270?0:x.rotate<0?270:x.rotate),x.zoom===0){const{containerWidth:A,containerHeight:B,ratio:K}=x;let[ee,te]=A>B?[B*K,B]:[A,A*K];x.rotate%180!==0&&(A>B?(ee=B,te=B/K):(ee=A/K,te=A)),x.videoWidth=ee-8,x.videoHeight=te-8}if(x.zoom>0&&c.current){const{videoWidth:A,videoHeight:B}=c.current;x.videoWidth=Math.min(x.containerWidth,A),x.videoHeight=Math.min(x.containerHeight,B)}return x.width=x.rotate%180===0?x.videoWidth:x.videoHeight,x.height=x.rotate%180===0?x.videoHeight:x.videoWidth,{...x}},{videoWidth:0,videoHeight:0,containerWidth:0,containerHeight:0,ratio:0,width:0,height:0,rotate:0,zoom:0,errorLevel:0,src:"",isLoading:!0,isLoaded:!1,isErrored:!1,isPlaying:!1,time:0,duration:0,volume:.5,speed:1,showVtt:!1});m.useImperativeHandle(t,()=>{var x,W;return c.current&&p.current?{seek:A=>c.current&&(c.current.currentTime=A),play:async()=>{var A;return await((A=c.current)==null?void 0:A.play())},playAt:async A=>{var B;return await(c.current&&(c.current.currentTime=A,(B=c.current)==null?void 0:B.play()))},pause:()=>{var A;return(A=c.current)==null?void 0:A.pause()},currentTime:()=>{var A;return((A=c.current)==null?void 0:A.currentTime)??0},on:(x=c.current)==null?void 0:x.addEventListener.bind(c.current),off:(W=c.current)==null?void 0:W.removeEventListener.bind(c.current),...p.current}:null},[]),m.useEffect(()=>{g({type:"srcChange",src:e})},[e]);const u=m.useCallback(()=>{if(c.current&&v.current){const{videoWidth:x,videoHeight:W}=c.current,{offsetWidth:A,offsetHeight:B}=v.current;if(x>0&&W>0){const K=x/W;g({type:"resize",ratio:K,containerWidth:A,containerHeight:B})}}},[]);m.useEffect(()=>{if(v.current!=null){const x=new ResizeObserver(u);return x.observe(v.current),()=>{x.disconnect()}}},[u]);const h=m.useCallback(()=>{g({type:"loaded"}),u()},[]),f=m.useCallback(x=>{g({type:"errored",data:x.currentTarget.error??void 0})},[]),b=m.useCallback(()=>{var x,W,A;g({type:"metadata",speed:((x=c.current)==null?void 0:x.playbackRate)??0,volume:((W=c.current)==null?void 0:W.volume)??0,duration:((A=c.current)==null?void 0:A.duration)??0})},[]),k=m.useCallback(x=>{g({type:"rotate",rotate:x})},[]),L=m.useCallback(()=>{g({type:"fitToSize"})},[]),C=m.useCallback(()=>{g({type:"fitToView"})},[]),T=m.useCallback(()=>{g({type:"toggleFit"})},[]),P=m.useCallback(()=>{g({type:"rotate",rotate:0})},[]),j=m.useCallback(()=>{g({type:"toggleVtt"})},[]),S=m.useCallback(()=>g({type:"play"}),[]),z=m.useCallback(()=>g({type:"pause"}),[]),w=m.useCallback(()=>{var x;return g({type:"speed",speed:((x=c.current)==null?void 0:x.playbackRate)??0})},[]),M=m.useCallback(()=>{var x;return g({type:"volume",volume:((x=c.current)==null?void 0:x.volume)??0})},[]),$=m.useCallback(()=>{var x;return g({type:"playing",time:((x=c.current)==null?void 0:x.currentTime)??0})},[]),F=m.useCallback(()=>{var x;return g({type:"playing",time:((x=c.current)==null?void 0:x.currentTime)??0})},[]);return a.jsx(zt.Provider,{value:{videoRef:c,scrollerRef:v,state:y,reset:P,rotate:k,handleLoad:h,handleError:f,fitToSize:L,fitToView:C,toggleFit:T,toggleVtt:j,handleMetadata:b,handlePlay:S,handlePause:z,handleRateChange:w,handleVolumeChange:M,handleSeeking:$,handleTimeUpdate:F},children:a.jsx(Ye,{ref:t,mediaEl:c,width:y.width,children:d})})},Ze=()=>m.useContext(zt);Nt.__docgenInfo={description:"",methods:[{name:"seek",docblock:null,modifiers:[],params:[{name:"ts",optional:!1,type:{name:"number"}}],returns:null},{name:"play",docblock:null,modifiers:["async"],params:[],returns:null},{name:"playAt",docblock:null,modifiers:["async"],params:[{name:"time",optional:!1,type:{name:"number"}}],returns:null},{name:"pause",docblock:null,modifiers:[],params:[],returns:null},{name:"currentTime",docblock:null,modifiers:[],params:[],returns:null}],displayName:"VideoProvider",props:{src:{required:!0,tsType:{name:"string"},description:"video source"},poster:{required:!1,tsType:{name:"string"},description:"video poster"},fallback:{required:!1,tsType:{name:"string"},description:"fallback alternate source"},nsfw:{required:!1,tsType:{name:"boolean"},description:"NSFW overlay"},enableZoom:{required:!1,tsType:{name:"boolean"},description:"enable zoom tool (default: true)"},vttText:{required:!1,tsType:{name:"string"},description:""},markers:{required:!1,tsType:{name:"Array",elements:[{name:"tuple",raw:"[time: number, score: number]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[time: number, score: number]>"},description:"timeline markers"},annotations:{required:!1,tsType:{name:"Array",elements:[{name:"tuple",raw:"[time: number, text: string]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[time: number, text: string]>"},description:"annotation list"},onAnnotationChange:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  annotations: Array<[time: number, text: string]>,
) => void`,signature:{arguments:[{type:{name:"Array",elements:[{name:"tuple",raw:"[time: number, text: string]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[time: number, text: string]>"},name:"annotations"}],return:{name:"void"}}},description:""},onCut:{required:!1,tsType:{name:"signature",type:"function",raw:"(start: number, end: number) => void",signature:{arguments:[{type:{name:"number"},name:"start"},{type:{name:"number"},name:"end"}],return:{name:"void"}}},description:""},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"error handler"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error?: MediaError) => void",signature:{arguments:[{type:{name:"MediaError"},name:"error"}],return:{name:"void"}}},description:"error handler"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(currentTime: number) => void",signature:{arguments:[{type:{name:"number"},name:"currentTime"}],return:{name:"void"}}},description:"onChange playback time"},onPlay:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"play handler"},onPause:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"pause handler"}},composes:["RefProp"]};const At=({onChange:d,onOpen:e})=>{const[t,n]=m.useState();return a.jsxs(Re,{showArrow:!0,children:[a.jsx(V,{variant:"link","aria-label":"annotate",icon:N.mediaCommentAdd,onClick:e}),a.jsxs("div",{children:[a.jsx("div",{className:"p-2 w-96 max-w-screen",children:a.jsx(dt,{rows:5,autoFocus:!0,value:t,onChange:r=>n(r??"")})}),a.jsx(fe,{flex:!0,justify:"end",className:"p-1",children:a.jsx(Pe,{children:a.jsx(V,{size:"sm",variant:"solid",onClick:()=>[d==null?void 0:d(t),n("")],children:"Update"})})})]})]})},It=({time:d,duration:e,text:t,onChange:n,onDelete:r,onPlay:s})=>{const[i,o]=m.useState(t),l=m.useCallback(p=>{p==="edit"&&o(t)},[]);return a.jsx("div",{className:"absolute hover:text-primary -top-5",style:{insetInlineStart:`${d/e*100}%`},children:a.jsxs(Re,{showArrow:!0,children:[a.jsx(ue,{icon:N.mediaComment,className:"hover:text-primary"}),a.jsxs(nn,{onPanelChange:l,children:[a.jsxs(Ke,{width:360,height:192,className:"max-w-screen",children:[a.jsx(Je,{children:t}),a.jsxs(fe,{flex:!0,justify:"between",className:"p-1",children:[a.jsx(V,{size:"sm",variant:"outline",icon:N.edit,"data-panel":"edit",children:"Edit"}),a.jsx(Pe,{children:a.jsx(V,{size:"sm",variant:"solid",onClick:s,children:"Play"})})]})]}),a.jsxs(Ke,{panelId:"edit",width:360,className:"max-w-screen",children:[a.jsx(Je,{className:"p-1",children:a.jsx(dt,{autoFocus:!0,rows:5,value:i,onChange:o})}),a.jsxs(fe,{flex:!0,justify:"between",className:"p-1",children:[a.jsx(Pe,{children:a.jsx(V,{size:"sm",variant:"link",icon:N.trash,color:"danger",onClick:r,children:"Delete"})}),a.jsx(Pe,{children:a.jsx(V,{size:"sm",variant:"solid",onClick:()=>n==null?void 0:n(i),children:"Update"})})]})]})]})]})},d)};At.__docgenInfo={description:"",methods:[],displayName:"AnnotationTool"};It.__docgenInfo={description:"",methods:[],displayName:"AnnotationTag"};const Ot=({onCut:d})=>{const{videoRef:e,state:t}=Ze(),[n,r]=m.useState(t.time),[s,i]=m.useState(t.duration),o=m.useMemo(()=>({insetInlineStart:`${n/Math.max(t.duration,1)*100}%`,insetInlineEnd:`${Math.max(0,t.duration-s)/Math.max(t.duration,1)*100}%`}),[n,s,t.duration]),l=m.useCallback(c=>{var u,h,f;const v=c.clientX,{left:y=0,width:g=0}=((u=c.currentTarget.closest(".slider-parent"))==null?void 0:u.getBoundingClientRect())??{};if(v-y>0){let b=(v-y)/g*t.duration;const k=n+(s-n)/2;b=Math.trunc(b*1e3)/1e3,"dataTransfer"in c&&((h=c.currentTarget.dataset)==null?void 0:h.pos)==="start"?b<s&&r(Math.min(b,s-1)):"dataTransfer"in c&&((f=c.currentTarget.dataset)==null?void 0:f.pos)==="end"?b>n&&i(Math.max(b,n+1)):b<k||b<n?r(b):(b>k||b>s)&&i(b)}return c.preventDefault(),!1},[t.duration,n,s]);m.useEffect(()=>{const c=e.current;if(c){const v=()=>{Math.trunc(c.currentTime*100)<Math.trunc(n*100)&&(c.currentTime=n),Math.trunc(c.currentTime*100)>Math.trunc(s*100)&&(c.currentTime=n)};return c.addEventListener("timeupdate",v),()=>{c.removeEventListener("timeupdate",v)}}},[n,s]),m.useEffect(()=>{e.current&&(e.current.currentTime=n)},[n]),m.useEffect(()=>{e.current&&(e.current.currentTime=s)},[s]);const p=m.useRef(null);return a.jsxs(a.Fragment,{children:[a.jsx("span",{className:"text-dimmed text-xs px-1",children:`${oe.duration(n,!0)}`}),a.jsx("span",{ref:p,className:"select-none absolute -left-[100vw]",children:"|"}),a.jsxs("div",{role:"none",className:"flex-1 relative h-6 ms-1 bg-tint-50 slider-parent",onClick:l,children:[a.jsxs("div",{className:"bg-primary-200 absolute h-6 flex justify-between",style:{insetInlineStart:o.insetInlineStart,insetInlineEnd:o.insetInlineEnd},children:[a.jsx("div",{className:"w-1 cursor-ew-resize bg-primary-500 h-6",draggable:!0,"data-pos":"start",onDrag:l,onDragStart:c=>p.current&&(c.dataTransfer.setData("text","start"),c.dataTransfer.setDragImage(p.current,0,0))}),a.jsx("div",{className:"w-1 cursor-ew-resize bg-primary-500 h-6",draggable:!0,"data-pos":"end",onDrag:l,onDragStart:c=>p.current&&(c.dataTransfer.setData("text","end"),c.dataTransfer.setDragImage(p.current,0,0))})]}),t.isPlaying&&a.jsx("div",{className:"w-0.5 cursor-ew-resize bg-white h-6 absolute",style:{insetInlineStart:`${t.time/t.duration*100}%`}})]}),a.jsx("span",{className:"text-dimmed text-xs px-1",children:`${oe.duration(s,!0)}`}),a.jsx(V,{variant:"link","aria-label":"toggle-cut",onClick:()=>d(n,s),icon:N.tick})]})};Ot.__docgenInfo={description:"",methods:[],displayName:"CutStrip",props:{onCut:{required:!0,tsType:{name:"signature",type:"function",raw:"(start: number, end: number) => void",signature:{arguments:[{type:{name:"number"},name:"start"},{type:{name:"number"},name:"end"}],return:{name:"void"}}},description:""}}};const qt=({hasVtt:d=!1,markers:e,annotations:t=[],enableZoom:n=!0,onAnnotationChange:r,onCut:s})=>{const{videoRef:i,state:o,fitToSize:l,fitToView:p,toggleFit:c,toggleVtt:v}=Ze(),y=m.useRef(null),[g,u]=m.useState(!1),h=m.useCallback(()=>{var C;const L=(C=y.current)==null?void 0:C.getContext("2d");L!=null&&o.duration>0&&(e==null||e.forEach(T=>{const[P,j]=T,{width:S,height:z}=L==null?void 0:L.canvas,w=P/o.duration*S,M=z*j;L&&(L.strokeStyle="#fc0000"),L==null||L.strokeRect(w,z-M,1,M)}))},[e,o.duration]);m.useEffect(()=>{const L=()=>{y.current!=null&&(y.current.width=y.current.offsetWidth,y.current.height=y.current.offsetHeight,h())},C=new ResizeObserver(L);return y.current!=null&&C.observe(y.current),L(),()=>{C.disconnect()}},[h]),m.useEffect(()=>{var C;const L=(C=y.current)==null?void 0:C.getContext("2d");return h(),()=>{L==null||L.clearRect(0,0,L.canvas.width,L.canvas.height)}},[h]);const f=m.useMemo(()=>o.volume===0?N.mediaVolume0:o.volume<=.4?N.mediaVolume1:o.volume<=.7?N.mediaVolume2:N.mediaVolume3,[o.volume]),b=m.useMemo(()=>({toggleFit:()=>c(),toggleVtt:()=>v(),pause:()=>{var L;return(L=i.current)==null?void 0:L.pause()},togglePlay:async()=>{var L,C,T;return(L=i.current)!=null&&L.paused?await((C=i.current)==null?void 0:C.play()):(T=i.current)==null?void 0:T.pause()},mute:()=>i.current&&(i.current.volume=i.current.volume===0?.5:0),volumeUp:()=>i.current&&i.current.volume<1&&(i.current.volume=Math.min(1,i.current.volume+.1)),volumeDown:()=>i.current&&i.current.volume>0&&(i.current.volume=Math.max(0,i.current.volume-.1)),jumpDown:()=>i.current&&i.current.currentTime>0&&(i.current.currentTime-=1),jumpUp:()=>i.current&&(i.current.currentTime+=1),seekDown:()=>i.current&&i.current.currentTime>0&&(i.current.currentTime-=.165),seekUp:()=>i.current&&(i.current.currentTime+=.165),speedDown:()=>i.current&&i.current.playbackRate>0&&(i.current.playbackRate-=.5),speedUp:()=>i.current&&i.current.playbackRate<5&&(i.current.playbackRate+=.5),cutStart:()=>u(!0),cutStop:()=>u(!1)}),[]),k=m.useCallback((L,C=-1)=>{var T;if(L)if(C===-1)r==null||r([...t,[((T=i.current)==null?void 0:T.currentTime)??0,L]]);else{const P=[...t];L==="[DELETE]"?P.splice(C,1):P[C][1]=L,r==null||r(P)}},[t]);return a.jsxs(fe,{flex:!0,className:"gap-0 select-none",children:[o.isLoaded&&a.jsxs(m.Fragment,{children:[a.jsx(O,{global:!0,keyCombo:"space",handler:b.togglePlay}),n&&a.jsx(O,{global:!0,keyCombo:"f",handler:b.toggleFit}),s&&a.jsx(O,{global:!0,keyCombo:"x",handler:b.cutStart}),s&&a.jsx(O,{global:!0,keyCombo:"escape",handler:b.cutStop}),d&&a.jsx(O,{global:!0,keyCombo:"c",handler:b.toggleVtt}),a.jsx(O,{global:!0,keyCombo:"0",handler:b.mute}),a.jsx(O,{global:!0,keyCombo:",",handler:b.jumpDown}),a.jsx(O,{global:!0,keyCombo:".",handler:b.jumpUp}),a.jsx(O,{global:!0,keyCombo:"-",handler:b.volumeDown}),a.jsx(O,{global:!0,keyCombo:"=",handler:b.volumeUp}),a.jsx(O,{global:!0,keyCombo:"shift+{",handler:b.speedDown}),a.jsx(O,{global:!0,keyCombo:"shift+}",handler:b.speedUp}),a.jsx(O,{global:!0,keyCombo:"shift+<",handler:b.seekDown}),a.jsx(O,{global:!0,keyCombo:"shift+>",handler:b.seekUp})]}),!g&&a.jsxs(m.Fragment,{children:[a.jsx(V,{variant:"link","aria-label":"togglePlay",onClick:b.togglePlay,disabled:!o.isLoaded,icon:o.isPlaying?N.mediaPause:N.mediaPlay}),a.jsx(ke,{icon:f,value:o.volume,disabled:!o.isLoaded,max:1,onClick:()=>{const L=o.volume===1?0:o.volume>=.5?1:.5;i.current&&(i.current.volume=L)},onChange:L=>i.current&&(i.current.volume=L)}),a.jsx(ke,{icon:`${o.speed.toFixed(1)}x`,value:o.speed,disabled:!o.isLoaded,max:5,min:.1,textIcon:!0,onClick:()=>{const L=o.speed>=2?.5:o.speed>=1.5?2:o.speed>=1?1.5:o.volume>=.5?1:.5;i.current&&(i.current.playbackRate=L)},onChange:L=>i.current&&(i.current.playbackRate=L)}),a.jsx(Le,{vertical:!0}),n&&a.jsxs(m.Fragment,{children:[a.jsx(V,{variant:"link","aria-label":"fit-to-view",onClick:p,disabled:!o.isLoaded,icon:N.mediaFitToView}),a.jsx(V,{variant:"link","aria-label":"fit-to-size",onClick:l,disabled:!o.isLoaded,icon:N.mediaAspect}),a.jsx(Le,{vertical:!0})]}),r&&a.jsx(At,{onChange:k,onOpen:b.pause}),s&&a.jsx(V,{variant:"link","aria-label":"toggle-cut",onClick:()=>u(!0),disabled:!o.isLoaded,icon:N.cut}),d&&a.jsx(V,{variant:"link","aria-label":"toggle-vtt",onClick:v,disabled:!o.isLoaded,icon:o.showVtt?N.mediaCaptionOn:N.mediaCaptionOff}),a.jsxs(Ue,{time:o.time,duration:o.duration,onChange:L=>i.current&&(i.current.currentTime=L),children:[a.jsx("canvas",{ref:y,className:"pointer-events-none absolute inset-y-0 inset-x-px w-full h-full block mix-blend-color-dodge"}),t==null?void 0:t.map(([L,C],T)=>a.jsx(It,{time:L,text:C,duration:o.duration,onPlay:()=>{var P;return[i.current&&(i.current.currentTime=L),(P=i.current)==null?void 0:P.play()]},onDelete:()=>k("[DELETE]",T),onChange:P=>k(P,T)},T))]})]}),g&&a.jsxs(m.Fragment,{children:[a.jsx(Ot,{onCut:(L,C)=>[s==null?void 0:s(L,C),u(!1)]}),a.jsx(V,{variant:"link","aria-label":"toggle-cut",onClick:()=>u(!1),disabled:!o.isLoaded,icon:N.close})]})]})};qt.__docgenInfo={description:"",methods:[],displayName:"Tools",props:{hasVtt:{required:!1,tsType:{name:"boolean"},description:"",defaultValue:{value:"false",computed:!1}},annotations:{defaultValue:{value:"[]",computed:!1},required:!1},enableZoom:{defaultValue:{value:"true",computed:!1},required:!1}}};const Vt=({poster:d,vttText:e})=>{const{videoRef:t,scrollerRef:n,state:r,handleLoad:s,handleMetadata:i,handleError:o,handlePlay:l,handlePause:p,handleRateChange:c,handleVolumeChange:v,handleSeeking:y,handleTimeUpdate:g}=Ze(),{canvasRef:u}=jt(),h=m.useCallback(async()=>{var k,L,C;return(k=t.current)!=null&&k.paused?await((L=t.current)==null?void 0:L.play()):(C=t.current)==null?void 0:C.pause()},[]),[f,b]=m.useState();return m.useEffect(()=>{if(e&&r.showVtt){const k=URL.createObjectURL(new Blob([e],{type:"text/vtt"}));return b(k),()=>{b(void 0),URL.revokeObjectURL(k)}}},[e,r.showVtt]),a.jsx("div",{role:"none",ref:n,onClick:h,className:"area-content overflow-hidden relative scroll-hide grid bg-tint-50 select-none p-[8px]",children:a.jsxs(ut,{children:[a.jsx("div",{className:"relative overflow-hidden m-auto grid place-content-center size-full",style:{width:r.width,height:r.height},children:a.jsxs("div",{className:"origin-center relative pointer-events-none",style:{width:r.videoWidth,height:r.videoHeight,transform:`rotate(${r.rotate}deg)`},children:[r.src&&a.jsxs("video",{poster:d,onLoadedMetadata:i,onLoadedData:s,onError:o,ref:t,className:"object-contain size-full",onPlay:l,onPause:p,onRateChange:c,onVolumeChange:v,onSeeking:y,onTimeUpdate:g,children:[r.src&&a.jsx("source",{src:r.src}),a.jsx("track",{kind:"captions",src:f,default:!0})]}),a.jsx("canvas",{ref:u,width:r.videoWidth,height:r.videoHeight,className:"absolute inset-0"})]})}),r.isLoading&&a.jsx(He,{})]})})};Vt.__docgenInfo={description:"",methods:[],displayName:"Video",props:{poster:{required:!1,tsType:{name:"string"},description:""},vttText:{required:!1,tsType:{name:"string"},description:""}}};const An=({nsfw:d,poster:e,vttText:t,markers:n,annotations:r,enableZoom:s=!0,onAnnotationChange:i,onCut:o,...l})=>a.jsx(lt,{colorScheme:"dark",children:a.jsx(Nt,{...l,children:a.jsxs(_e,{dir:"ltr",children:[a.jsx(Vt,{poster:e,vttText:t}),a.jsx(qt,{enableZoom:s,hasVtt:!!t,markers:n,annotations:r,onAnnotationChange:i,onCut:o}),d&&a.jsx(De,{})]})})});An.__docgenInfo={description:`Video player component that provides a video player with tools for annotations, markers, and zoom functionality.
It also supports NSFW overlays and video poster images.

It includes features such as:
- Video playback with support for subtitles (VTT)
- Annotation tools for adding text to specific timestamps in the video
- Marker support for displaying marker bars on timebar at specific timestamps in the video
- NSFW overlay for content that may not be suitable for all audiences
- Zoom functionality to enhance video viewing experience

@param {VideoProps} props - The properties for the video player.
@returns {JSX.Element} The rendered video player component.

@example
\`\`\`jsx
<VideoPlayer
  src="https://example.com/video.mp4"
  poster="https://example.com/poster.jpg"
  vttText="https://example.com/subtitles.vtt"
  nsfw={true}
  markers={[{ time: 10, label: "Marker 1" }, { time: 20, label: "Marker 2" }]}
  annotations={[{ start: 5, end: 15, text: "Annotation 1" }]}
  onAnnotationChange={(annotations) => console.log(annotations)}
  onCut={(start, end) => console.log(\`Cut from \${start} to \${end}\`)}
/>
\`\`\`

@see {@link https://adarshpastakia.github.io/react-fabric/?path=/story/media-videoplayer--video-player} for more details on the properties.`,methods:[],displayName:"VideoPlayer",props:{src:{required:!0,tsType:{name:"string"},description:"video source"},poster:{required:!1,tsType:{name:"string"},description:"video poster"},fallback:{required:!1,tsType:{name:"string"},description:"fallback alternate source"},nsfw:{required:!1,tsType:{name:"boolean"},description:"NSFW overlay"},enableZoom:{required:!1,tsType:{name:"boolean"},description:"enable zoom tool (default: true)",defaultValue:{value:"true",computed:!1}},vttText:{required:!1,tsType:{name:"string"},description:""},markers:{required:!1,tsType:{name:"Array",elements:[{name:"tuple",raw:"[time: number, score: number]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[time: number, score: number]>"},description:"timeline markers"},annotations:{required:!1,tsType:{name:"Array",elements:[{name:"tuple",raw:"[time: number, text: string]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[time: number, text: string]>"},description:"annotation list"},onAnnotationChange:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  annotations: Array<[time: number, text: string]>,
) => void`,signature:{arguments:[{type:{name:"Array",elements:[{name:"tuple",raw:"[time: number, text: string]",elements:[{name:"unknown"},{name:"unknown"}]}],raw:"Array<[time: number, text: string]>"},name:"annotations"}],return:{name:"void"}}},description:""},onCut:{required:!1,tsType:{name:"signature",type:"function",raw:"(start: number, end: number) => void",signature:{arguments:[{type:{name:"number"},name:"start"},{type:{name:"number"},name:"end"}],return:{name:"void"}}},description:""},onLoad:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"error handler"},onError:{required:!1,tsType:{name:"signature",type:"function",raw:"(error?: MediaError) => void",signature:{arguments:[{type:{name:"MediaError"},name:"error"}],return:{name:"void"}}},description:"error handler"},onChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(currentTime: number) => void",signature:{arguments:[{type:{name:"number"},name:"currentTime"}],return:{name:"void"}}},description:"onChange playback time"},onPlay:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"play handler"},onPause:{required:!1,tsType:{name:"signature",type:"function",raw:"() => void",signature:{arguments:[],return:{name:"void"}}},description:"pause handler"}},composes:["RefProp"]};export{hn as A,Wn as D,zn as I,Nn as T,An as V,Pn as a};
