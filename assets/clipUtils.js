const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["./intersectsOperator.js","./ProjectionTransformation.js","./Point2D.js","./Envelope2D.js","./Transformation2D.js","./ShadowCastClear.glsl.js","./iframe-DwvN93Ge.js","./iframe-CGchYWp9.css","./index.js","./Viewport.js","./Section.js","./ErrorBoundary.js","./createClass.js","./Global.js","./useIsDark.js","./debounce.js","./index2.js","./ShadowCastClear-Cq39gfL_.css","./OperatorDefinitions.js","./jsonConverter.js","./OperatorIntersects.js","./apiConverter.js","./containsOperator.js"])))=>i.map(i=>d[i]);
import{b8 as O}from"./iframe-DwvN93Ge.js";import{b0 as q,fq as C,a5 as L}from"./ShadowCastClear.glsl.js";import{c as E}from"./PixelBlock.js";function V(e,r){if(e.spatialReference.equals(r))return e;const t=C(e.spatialReference),i=C(r);if(t===i)return e;const n=t/i;return{x:e.x*n,y:e.y*n}}async function Q(e,r,t){if(t.type==="extent")return F(e,r,t);const{width:i,height:n}=e,a=new Uint8Array(i*n);return(await O(async()=>{const{execute:h}=await import("./intersectsOperator.js").then(o=>o.i);return{execute:h}},__vite__mapDeps([0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21]),import.meta.url)).execute(r,t)?t.type==="polyline"?G(e,r,t):(await O(async()=>{const{execute:h}=await import("./containsOperator.js").then(o=>o.c);return{execute:h}},__vite__mapDeps([22,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,21]),import.meta.url)).execute(t,r)?e:$(e,r,t):new E({pixelType:e.pixelType,width:i,height:n,mask:a,maskIsAlpha:!1,pixels:[...e.pixels]})}function $(e,r,t){if(!e)return e;const{width:i,height:n}=e,a=j({geometry:t,size:[i,n],srcExtent:r,srcMask:e.mask});return new E({pixelType:e.pixelType,width:i,height:n,mask:a,maskIsAlpha:!1,pixels:[...e.pixels]})}function j(e){const{geometry:r,size:t,srcExtent:i,srcMask:n}=e,[a,h]=t;let o;const l=i.width/a,y=i.height/h,{xmin:m,ymax:x}=i;if(r.type==="extent"){const f=(r.xmin-m)/l,s=(r.xmax-m)/l,p=(x-r.ymax)/y,c=(x-r.ymin)/y;o=[[[f,p],[f,c],[s,c],[s,p],[f,p]]]}else o=r.rings.map(f=>f.map(([s,p])=>[(s-m)/l,(x-p)/y]));return B(o,t,n)}function B(e,r,t){const[i,n]=r,a=new OffscreenCanvas(i,n).getContext("2d");a.fillStyle="#f00",a.beginPath(),e.forEach(m=>{a.moveTo(m[0][0],m[0][1]);for(let x=0;x<m.length;x++)a.lineTo(m[x][0],m[x][1]);a.closePath()}),a.fill();const h=a.getImageData(0,0,i,n).data,o=i*n,l=new Uint8Array(o);let y=!1;for(let m=0;m<o;m++)t&&!t[m]||(h[4*m+3]>127?l[m]=255:y=!0);return y||t?l:void 0}function F(e,r,t){const{width:i,height:n}=e,a=new Uint8Array(i*n),h=r.width/i,o=r.height/n;if(t.width/h<.5||t.height/o<.5)return new E({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]});const{xmin:l,xmax:y,ymin:m,ymax:x}=r,{xmin:f,xmax:s,ymin:p,ymax:c}=t,u=Math.max(l,f),_=Math.min(y,s),R=Math.max(m,p),I=Math.min(x,c),S=.5*h,T=.5*o;if(_-u<S||I-R<T||_<l+S||u>y-S||R>x-T||I<m+T)return new E({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]});const v=Math.max(0,(u-l)/h),z=Math.min(i,Math.max(0,(_-l)/h)),A=Math.max(0,(x-I)/o),g=Math.min(n,Math.max(0,(x-R)/o)),M=Math.round(v),w=Math.round(z)-1,d=Math.round(A),P=Math.round(g)-1;if(M===w&&v%1>.5&&z%1<.5||d===P&&A%1>.5&&g%1<.5)return new E({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]});if(M===0&&d===0&&w===i&&P===n)return e;const U=e.mask;for(let k=d;k<=P;k++)for(let b=M;b<=w;b++){const D=k*i+b;a[D]=U?U[D]:255}return new E({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]})}function G(e,r,t){const{width:i,height:n}=e,a=new Uint8Array(i*n),h=r.width/i,o=r.height/n,{xmin:l,ymax:y}=r,{paths:m}=t,x=e.mask;for(let f=0;f<m.length;f++){const s=m[f];for(let p=0;p<s.length-1;p++){const[c,u]=s[p],[_,R]=s[p+1],I=Math.min(u,R),S=Math.max(u,R),T=Math.max(0,Math.floor((y-S)/o)),v=Math.min(n-1,Math.floor((y-I)/o));if(!(v<T))if(T===v){const z=Math.min(c,_),A=Math.max(c,_),g=Math.max(0,Math.floor((z-l)/h)),M=Math.min(i-1,Math.floor((A-l)/h));if(M<g)continue;const w=T*i;for(let d=w+g;d<=w+M;d++)a[d]=x?x[d]:255}else{const z=(c-l)/h,A=(_-c)/(R-u)/h,g=o*A;for(let M=T;M<=v;M++){const w=A*(y-M*o-u)+z,d=Math.max(0,Math.floor(g>0?w-g:w)),P=Math.min(i-1,Math.floor(g>0?w:w-g));if(P<d)continue;const U=M*i;for(let k=U+d;k<=U+P;k++)a[k]=x?x[k]:255}}}}return new E({pixelType:e.pixelType,width:i,height:n,mask:a,pixels:[...e.pixels]})}function W(e,r){const{extent:t}=H(e,r,new L({x:e.pixelSize.x,y:e.pixelSize.y,spatialReference:e.spatialReference})),{extent:i}=e.extent;if(t.xmax=Math.min(t.xmax,i.xmax),t.ymax=Math.min(t.ymax,i.ymax),t.xmin<t.xmax&&t.ymin<t.ymax){const{x:n,y:a}=e.pixelSize,h=Math.round(t.width/n),o=Math.round(t.height/a);e.extent=t,e.width=h,e.height=o}}function H(e,r,t,i=!0){const{spatialReference:n}=e,{x:a,y:h}=V(t,n);let o,l,y;const m=r.type==="extent"?r:r.extent;let{xmin:x,xmax:f,ymax:s,ymin:p}=m;const{xmin:c,ymax:u}=e.extent;return i?(x=c+(x>c?a*Math.round((x-c)/a):0),s=u-(s<u?h*Math.round((u-s)/h):0),f=c+(f>c?a*Math.round((f-c)/a):0),p=u-(p<u?h*Math.round((u-p)/h):0),o=new q({xmin:x,ymax:s,xmax:f,ymin:p,spatialReference:n}),l=Math.round(o.width/a),y=Math.round(o.height/h)):(l=Math.floor((f-x)/a+.8),y=Math.floor((s-p)/h+.8),x=c+(x>c?a*Math.floor((x-c)/a+.1):0),s=u-(s<u?h*Math.floor((u-s)/h+.1):0),f=x+l*a,p=s-y*h,o=new q({xmin:x,ymax:s,xmax:f,ymin:p,spatialReference:n})),{extent:o,width:l,height:y}}export{j as h,W as l,H as p,Q as r};
