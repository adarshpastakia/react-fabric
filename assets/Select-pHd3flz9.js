import{t as cr,bR as dr,_ as pe,r as c,s as tr,j as d,m as J,l as re,bS as pr,bT as $e,aS as ar,bl as Fe,bp as Se,bQ as Ae,bk as K,aM as ke,aP as he,G as vr}from"./iframe-DcfUrZ2L.js";import{n as fr}from"./Menu-BypgFP0F.js";import{_ as le,C as He}from"./index-Bl9sirez.js";import{T as gr,I as Re}from"./Tooltip-Dv6V4Byx.js";import{g as mr,a as hr,B as De}from"./Button-7pM1lgGA.js";import{D as yr}from"./DropdownTool-CCLyIfh9.js";import{a as br,u as Or,o as Pr,F as jr,_ as xr,D as Dr,Y as wr,b as Cr,B as qe,T as Be,C as Sr}from"./BasePanel-CZJafQ4J.js";import{u as Me}from"./useDebounce-oR1dm03r.js";import{C as kr}from"./Content-Cwxt_19N.js";import{S as Er}from"./Section-Dbs60dt2.js";import{P as W,D as _}from"./Google-DSP-6Nrb.js";import{e as Ee}from"./endOfDay-Danle8jh.js";import{e as Tr,a as Ve,d as Nr,i as Ir}from"./zh-CN-DsRk4IYs.js";import{u as Fr}from"./Global-CmkQSaMP.js";import{i as Ye}from"./getDay-B6LYz-AP.js";import{c as Rr}from"./cloneElement-B4wm8_Ia.js";import{F as Mr,I as or}from"./InputWrapper-Bmbugn7q.js";import{u as $r}from"./eventHandlers-BDcAz1uA.js";import{a as Ar,s as Hr,f as qr,o as Br,b as Vr,c as Yr,d as Kr,e as zr,g as Qr,F as Ur,h as Gr}from"./floating-ui.react-DaYvvi0U.js";import{E as Lr}from"./EmptyContent-6xVjGj3J.js";import{m as Wr,c as Jr}from"./_isEqual-PxFgnGsO.js";import{d as Ke,g as Xr}from"./_dedupe-BYXvNVJ3.js";function ze(t,e,n){const r=cr(t,n==null?void 0:n.in);return isNaN(+r)?dr(t,NaN):(r.setFullYear(e),r)}var Zr=["ref","as","id","className","label","icon","iconBg","iconColor","rtlFlip","badge","disabled","onClose","active","onClick","tabFlex","color","actions","tooltip","activeClassName"];function Qe(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Pe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Qe(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Qe(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var _r=function(e){var n=e.ref,r=e.as,l=e.id,f=e.className,j=e.label,g=e.icon,S=e.iconBg,D=e.iconColor,A=e.rtlFlip,k=e.badge,m=e.disabled,R=e.onClose,P=e.active,y=e.onClick,h=e.tabFlex,C=e.color,v=e.actions,i=e.tooltip,O=e.activeClassName,x=pe(e,Zr),M=c.useMemo(function(){return mr(k)},[k]),E=c.useMemo(function(){return!j},[j]),w=c.useMemo(function(){return tr(i)?{content:i}:i??{}},[i]),b=r??"button",N=i?gr:c.Fragment;return d.jsx(N,Pe(Pe({},w),{},{children:d.jsxs(b,Pe(Pe({"data-id":l,disabled:m,"data-color":C,"data-inner-clickable":!0,className:J("fabric-tabButton",f,P&&"active pointer-events-none",P&&O,m&&"text-tint-500 pointer-events-none",h?"flex-1":"flex-initial max-w-36",E?"min-w-6":"min-w-18","flex items-center justify-center px-1 rounded overflow-hidden cursor-pointer"),onClick:function(){return!P&&(y==null?void 0:y(l))},ref:n},x),{},{children:[g&&d.jsx(Re,{icon:g,bg:S,color:D,rtlFlip:A,className:"flex-content p-2"}),!E&&d.jsx("label",{className:"flex-initial truncate text-center px-1 py-1",children:j}),k&&d.jsx(hr,Pe(Pe({},M),{},{placement:E?"end":"",className:J("me-1",M.className)})),v&&P&&d.jsx(yr,{className:"bg-tint-50/20 me-1 z-5",children:v}),R&&d.jsx("span",{role:"none",className:J("cursor-pointer me-1 opacity-65 hover:opacity-90 pointer-events-auto"),onClick:function(ge){R==null||R(),ge.stopPropagation()},children:"Ã—"})]}))}))},qn=function(e){var n=e.children,r=e.headerClassName,l=e.orientation,f=l===void 0?"top":l,j=e.activeTab,g=e.justify,S=e.variant,D=e.tabFlex,A=e.append,k=e.prepend,m=e.gap,R=e.onBeforeChange,P=e.onChange,y=c.useState(),h=re(y,2),C=h[0],v=h[1],i=c.useMemo(function(){return c.Children.toArray(n).reduce(function(b,N){return fr(N,_r)?b[0].push(N):b[1].push(N),b},[[],[]])},[n]),O=re(i,2),x=O[0],M=O[1];c.useEffect(function(){v(j)},[j]);var E=c.useMemo(function(){var b;return(b=x.find(function(N){return N.props.id===C}))===null||b===void 0?void 0:b.props.children},[x,C]),w=c.useCallback(function(b){Promise.resolve(R==null?void 0:R(b,C)).then(function(N){N!==!1&&(v(b),P==null||P(b))})},[R,P,C]);return d.jsxs("div",{className:J("fabric-tabPanel","area-content grid bg-base overflow-hidden"),"data-orientation":f,"data-variant":S??"default",children:[d.jsxs("div",{className:J("fabric-tabHeader",r,g&&"justify-".concat(g),["start","end"].includes(f)&&"flex-col","flex flex-nowrap overflow-hidden items-center"),children:[k,d.jsx("div",{className:J("fabric-tabList",g&&"justify-".concat(g),["start","end"].includes(f)&&"flex-col",["bottom","end"].includes(f)?"self-start":"self-end","flex flex-1 flex-nowrap overflow-auto scroll-thin"),style:{gap:m},children:x.map(function(b){var N;return c.cloneElement(b,{tabFlex:(N=b.props.tabFlex)!==null&&N!==void 0?N:D,onClick:w,active:b.props.id===C})})}),A]}),M,E]})},en=["name","children"],rn=["ref","onChange"];function Ue(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function je(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ue(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ue(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Bn=function(e){var n=e.name,r=e.children,l=pe(e,en);if(!n)throw Error("Form Controller missing `name` prop");return d.jsx(br,{name:n,render:function(j){var g,S=j.field,D=S.ref,A=S.onChange,k=pe(S,rn),m=j.fieldState.error,R=j.formState.isSubmitting;return c.isValidElement(r)?c.cloneElement(c.Children.only(r),je(je(je({},k),l),{},{ref:function(y){y&&D(y);try{var h;r.props.ref&&"current"in r.props.ref&&(r.props.ref.current=y),(h=r.props.ref)!==null&&h!==void 0&&h.prototype&&r.props.ref(y)}catch{}},checked:!!k.value,readOnly:R||r.props.readOnly,invalid:!!(m!=null&&m.message)||r.props.invalid,error:(g=m==null?void 0:m.message)!==null&&g!==void 0?g:r.props.error,onChange:function(y){var h,C;A(y),(h=(C=r.props).onChange)===null||h===void 0||h.call(C,y)}})):r(je(je(je({},k),l),{},{ref:function(y){y&&D(y)},readOnly:R,invalid:!!(m!=null&&m.message),checked:!!k.value,error:m==null?void 0:m.message,onChange:function(y){A(y)}}))}})},nn=["formRef","schema","children","defaultValues","onSubmit","onChange"];function Ge(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ge(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ge(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var tn=function(){},Vn=function(e){var n=e.formRef,r=e.schema,l=e.children,f=e.defaultValues,j=f===void 0?pr:f,g=e.onSubmit,S=g===void 0?tn:g,D=e.onChange,A=pe(e,nn),k=c.useRef(null),m=Or({shouldFocusError:!0,resolver:r&&Pr(r),defaultValues:j}),R=c.useTransition(),P=re(R,2),y=P[1],h=Me(D,[D],300);c.useEffect(function(){var i=m.watch(function(O){y(function(){return h==null?void 0:h(O)})});return function(){return i.unsubscribe()}},[m.watch,h]);var C=c.useCallback(function(){var i,O=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};m.reset(O),m.clearErrors(),(i=k.current)===null||i===void 0||(i=i.querySelector("[auto-focus], input, textarea"))===null||i===void 0||i.focus()},[j]);c.useImperativeHandle(n,function(){return{state:m.formState,reset:function(){return C(j)},clear:function(){return C()},submit:function(){return m.handleSubmit(S)},validate:function(){var i=xr($e.mark(function x(){return $e.wrap(function(E){for(;;)switch(E.prev=E.next){case 0:return E.next=2,m.trigger();case 2:return E.abrupt("return",E.sent);case 3:case"end":return E.stop()}},x)}));function O(){return i.apply(this,arguments)}return O}(),getValues:function(){return m.getValues()},setValues:function(O){return setTimeout(function(){return m.reset(O)},50)},setValue:function(O,x){return setTimeout(function(){return m.setValue(O,x,{shouldDirty:!1,shouldTouch:!1})},50)}}},[S,m,m.formState,j]);var v=c.useCallback(function(i,O){var x=O.target;setTimeout(function(){var M;return(M=x.querySelector("input[aria-invalid='true'],textarea[aria-invalid='true']"))===null||M===void 0?void 0:M.focus()},10)},[]);return d.jsx(jr,Ce(Ce({},m),{},{children:d.jsxs("form",Ce(Ce({ref:k,onReset:function(){return C(j)},onSubmit:function(O){O.stopPropagation(),m.handleSubmit(S,v)(O)},"data-loading":m.formState.isSubmitting,className:"contents",autoComplete:"off"},A),{},{children:[l,d.jsx("input",{type:"submit",className:"absolute invisible"})]}))}))};function Le(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function an(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Le(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Le(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var on=function(e){var n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],r=arguments.length>2&&arguments[2]!==void 0?arguments[2]:[],l=K(r);n.forEach(function(g){return l.push({label:g.label,hijri:g.hijri,icon:g.icon,start:ze(_.parseDate(g.start),e),end:ze(_.parseDate(g.end),e)})}),l.push({label:"superdate:event.newYear",start:Se(new Date("".concat(e-1,"-12-31"))),end:Ee(new Date("".concat(e,"-01-01")))}),l.push({label:"superdate:event.christmas",start:Se(new Date("".concat(e,"-12-24"))),end:Ee(new Date("".concat(e,"-12-26")))});var f=_.startOfYear(new Date("".concat(e-1,"-12-31")),!0);f=_.addMonths(f,8,!0),f.getFullYear()!==e&&(f=_.addYears(f,f.getFullYear()>e?-1:1,!0));var j=_.endOfMonth(f,!0);return l.push({label:"superdate:event.ramadan",start:Se(f),end:Ee(j)}),l.sort(function(g,S){return g.start.getTime()<S.start.getTime()?-1:1})},Yn=function(e){var n=e.isHijri,r=e.onChange,l=e.events,f=l===void 0?Fe:l,j=e.recurringEvents,g=j===void 0?Fe:j,S=ar(),D=S.t,A=c.useState({}),k=re(A,2),m=k[0],R=k[1],P=c.useReducer(function(v,i){var O=!1;if(i.type==="init"&&(v.pageDate=new Date,O=!0),i.type==="changePage"&&(v.page=Math.max(i.page,W.MONTH)),i.type==="changePageDate"&&(O=!0,v.pageDate=i.date,i.changePage&&(v.page=Math.max(v.page-1,W.MONTH))),O){var x,M=v.pageDate.getFullYear();v.events=on(M,g??[],(x=m[M])!==null&&x!==void 0?x:[])}return an({},v)},{pageDate:new Date,page:W.MONTH,events:[]}),y=re(P,2),h=y[0],C=y[1];return c.useEffect(function(){C({type:"init"})},[]),c.useEffect(function(){var v={};f.forEach(function(i){var O=Se(new Date(i.start)),x=Ee(new Date(i.end));v[O.getFullYear()]||(v[O.getFullYear()]=[]),v[O.getFullYear()].push(i),O.getFullYear()!==x.getFullYear()&&(v[x.getFullYear()]||(v[x.getFullYear()]=[]),v[x.getFullYear()].push(i))}),R(v)},[f]),d.jsxs(Er,{children:[d.jsx(Dr,{page:h.page,pageDate:h.pageDate,changePage:function(i){return C({type:"changePage",page:i})},changePageDate:function(i){return C({type:"changePageDate",date:i,changePage:!1})}}),h.page===W.MONTH&&d.jsx(kr,{className:"p-2 max-h-48",children:h.events.map(function(v){return d.jsxs("div",{role:"none",onClick:function(){r==null||r("".concat(v.start.toISOString(),"|").concat(v.end.toISOString()),[v.start.toISOString(),v.end.toISOString()])},className:"text-sm my-1 py-1 px-2 flex flex-nowrap items-center cursor-pointer rounded hover:bg-primary-50",children:[d.jsx("div",{className:"flex-1 truncate",children:D(v.label,{defaultValue:v.label})}),d.jsxs("div",{className:"text-muted text-xs",children:[_.format(v.start,Tr(v.start,v.end)?"dd":"dd/MMM",Ae.language,n),d.jsx("span",{children:" - "}),_.format(v.end,"dd/MMM",Ae.language,n)]})]},v.label)})}),h.page===W.YEAR&&d.jsx(wr,{isHijri:n,page:h.page,pageDate:h.pageDate,changePageDate:function(i){return C({type:"changePageDate",date:i})}}),h.page===W.DECADE&&d.jsx(Cr,{isHijri:n,page:h.page,pageDate:h.pageDate,changePageDate:function(i){return C({type:"changePageDate",date:i})}})]})},ln=["className","max","min","dateDisabled","onChange","showHijriToggle","value","withTime","showApply"];function We(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function ce(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?We(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):We(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Kn=function(e){var n=e.className,r=e.max,l=e.min,f=e.dateDisabled,j=e.onChange,g=e.showHijriToggle,S=e.value,D=e.withTime,A=e.showApply,k=A===void 0?!1:A,m=pe(e,ln),R=ar("date"),P=R.t,y=Fr(),h=y.currentCalendar,C=c.useState(h==="hijri"),v=re(C,2),i=v[0],O=v[1],x=Me(j,[j]);c.useEffect(function(){O(h==="hijri")},[h]);var M=c.useReducer(function(a,u){if(u.type==="reset")if(ke(u.date))a.hilight=void 0,a.selected=void 0,a.start.pageDate=new Date,a.start.hour=0,a.start.minute=0,a.end.pageDate=_.addMonths(new Date,1),a.end.hour=0,a.end.minute=0;else{var Z=re(u.date,2),ye=Z[0],X=Z[1],s=new Date(ye),oe=new Date(X);a.hilight=void 0,a.selected=[s,oe],a.start.pageDate=s,a.start.hour=s.getHours(),a.start.minute=s.getMinutes(),a.end.pageDate=oe,a.end.hour=oe.getHours(),a.end.minute=oe.getMinutes()}if(u.type==="changeDate")if(!a.hilight)a.hilight=[u.date,u.date],a.start.pageDate=u.date,a.end.pageDate=_.addMonths(u.date,1,i);else{var ue=Ve(a.hilight[0],u.date),ve=ue?u.date:a.hilight[0],be=ue?a.hilight[0]:u.date;a.selected=[ve,be],a.hilight=void 0,a.start.pageDate=ve,a.end.pageDate=be}if(u.type==="changeHilight")if(a.hilight&&u.date){var ie=re(a.hilight,1),Oe=ie[0];a.hilight=[Oe,u.date]}else a.hilight=void 0;if(u.type==="changeTime"){if(u.range==="start"&&(a.start.hour=u.hour,a.start.minute=u.minute,a.selected)){var o,p;(o=a.selected[0])===null||o===void 0||o.setHours(u.hour),(p=a.selected[0])===null||p===void 0||p.setMinutes(u.minute)}if(u.range==="end"&&(a.end.hour=u.hour,a.end.minute=u.minute,a.selected)){var F,V;(F=a.selected[1])===null||F===void 0||F.setHours(u.hour),(V=a.selected[1])===null||V===void 0||V.setMinutes(u.minute)}}return u.type==="changePage"&&(a[u.range].page=u.page),u.type==="changePageDate"&&(a[u.range].pageDate=u.date,u.pageChange&&(a[u.range].page=Math.max(a[u.range].page-1,0),u.range==="start"&&a.start.page===W.DATE&&(a.end.pageDate=Nr(u.date,1)))),(u.type==="changeDate"||u.type==="changeTime")&&(l&&a.selected&&Ir(a.selected[0],new Date(l))&&(a.selected[0]=new Date(l),a.start.hour=a.selected[0].getHours(),a.start.minute=a.selected[0].getMinutes()),r&&a.selected&&Ve(a.selected[1],new Date(r))&&(a.selected[1]=new Date(r),a.end.hour=a.selected[1].getHours(),a.end.minute=a.selected[1].getMinutes()),!k&&a.selected&&!a.hilight&&(x==null||x([a.selected[0].toISOString(),a.selected[1].toISOString()]))),ce({},a)},{start:{page:W.DATE,pageDate:new Date,hour:0,minute:0},end:{page:W.DATE,pageDate:_.addMonths(new Date,1,i),hour:0,minute:0}}),E=re(M,2),w=E[0],b=E[1];c.useEffect(function(){b({type:"reset",date:S})},[S]);var N=c.useCallback(function(a){return w.start.page===W.DATE&&he(f)?!!f.find(function(u){return Ye(new Date(u),a)}):_.isDisabled(a,w.start.page,l,r)},[w.start.page,l,r,f]),Q=c.useCallback(function(a){return w.end.page===W.DATE&&he(f)?!!f.find(function(u){return Ye(new Date(u),a)}):_.isDisabled(a,w.end.page,l,r)},[w.end.page,l,r,f]),ge=c.useCallback(function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;b({type:"changePageDate",pageChange:u,range:"start",date:a})},[]),U=c.useCallback(function(a){var u=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;b({type:"changePageDate",pageChange:u,range:"end",date:a})},[]),H=c.useCallback(function(a){b({type:"changeDate",date:a})},[]);return d.jsxs("div",ce(ce({className:J("block overflow-hidden bg-base rounded-capped",n)},m),{},{children:[d.jsxs("div",{className:"flex flex-nowrap",children:[d.jsx(qe,ce(ce({},w.start),{},{max:r,min:l,hideNext:!0,withTime:D,isHijri:i,hilight:w.hilight,selected:w.selected,selectDate:H,isDateDisabled:N,changeTime:function(u){return b(ce({type:"changeTime",range:"start"},u))},changePage:function(u){return b({type:"changePage",range:"start",page:u})},mouseOver:function(u){return b({type:"changeHilight",date:u})},changePageDate:ge})),d.jsx("div",{className:"border-s border-s-dimmed"}),d.jsx(qe,ce(ce({},w.end),{},{max:r,min:l,hidePrevious:!0,withTime:D,isHijri:i,hilight:w.hilight,selected:w.selected,selectDate:H,isDateDisabled:Q,changeTime:function(u){return b(ce({type:"changeTime",range:"end"},u))},changePage:function(u){return b({type:"changePage",range:"end",page:u})},mouseOver:function(u){return b({type:"changeHilight",date:u})},changePageDate:U}))]}),d.jsxs("div",{className:"border-t flex flex-nowrap justify-between px-2",children:[d.jsx("span",{children:g&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){O(!i)},children:P(i?"label.gregorian":"label.hijri")})}),w.start.page!==W.DATE&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return b({type:"changePage",range:"start",page:W.DATE})},children:P("core:action.cancel")}),w.end.page!==W.DATE&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return b({type:"changePage",range:"end",page:W.DATE})},children:P("core:action.cancel")}),w.hilight&&d.jsx(De,{size:"sm",variant:"link",color:"primary",className:"my-1",onClick:function(){return b({type:"changeHilight"})},children:P("core:action.cancel")}),!w.hilight&&k&&d.jsx(De,{size:"sm",variant:"solid",color:"primary",disabled:!w.selected,className:"my-1",onClick:function(){var u,Z;return x==null?void 0:x([(u=w.selected)===null||u===void 0?void 0:u[0].toISOString(),(Z=w.selected)===null||Z===void 0?void 0:Z[1].toISOString()])},children:P("core:action.apply")})]})]}))},un=["children","vertical","noOutline","plain"];function Je(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function Xe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Je(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Je(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var zn=function(e){var n=e.children,r=e.vertical,l=e.noOutline,f=e.plain,j=pe(e,un);return d.jsx(Mr,Xe(Xe({},j),{},{children:d.jsx("div",{className:J("fabric-fieldGroup",!f&&!l&&"outline",!f&&"bg-base",f&&"flex-wrap","flex-1 rounded",!r&&"flex"),"data-vertical":!!r,children:Rr(n,function(g){return c.cloneElement(g,{"data-inner":!0})})})}))},sn=["ref","value","invalid","readOnly","disabled","required","placeholder","autoFocus","name","min","max","step","onBlur","onFocus","onChange","onEnterPressed"];function Ze(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function _e(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Ze(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Ze(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Qn=function(e){var n=e.ref,r=e.value,l=e.invalid,f=e.readOnly,j=e.disabled,g=e.required,S=e.placeholder,D=e.autoFocus,A=e.name,k=e.min,m=e.max,R=e.step,P=e.onBlur,y=e.onFocus,h=e.onChange,C=e.onEnterPressed,v=pe(e,sn),i=c.useState(""),O=re(i,2),x=O[0],M=O[1],E=c.useDeferredValue(r),w=$r(C);c.useEffect(function(){M(E??"")},[E]);var b=c.useCallback(function(N){var Q=N==null?void 0:N.target.valueAsNumber;M(Q??""),h==null||h(Q??null)},[h]);return d.jsx(or,_e(_e({showClear:!!x&&!j&&!f,onClear:b,invalid:l,readOnly:f,disabled:j,required:g},v),{},{children:d.jsx("input",{className:"appearance-none bg-transparent py-1 px-2 flex-1 border-none outline-none ring-0 peer","aria-invalid":l,"aria-disabled":j,"aria-readonly":f,placeholder:S,disabled:j,readOnly:f,"data-testid":A,name:A,type:"number",size:1,min:k,max:m,step:R,ref:n,autoComplete:"off",autoFocus:D,value:x,onBlur:P,onFocus:y,onChange:b,onKeyDown:w})}))},cn=["ref","style","items","active","className","itemRef","empty","valueProperty","labelProperty","itemProps","children"];function er(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function xe(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?er(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):er(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var dn=function(e){var n=e.ref,r=e.style,l=e.items,f=e.active,j=e.className,g=e.itemRef,S=e.empty;e.valueProperty;var D=e.labelProperty,A=D===void 0?"label":D,k=e.itemProps,m=e.children,R=pe(e,cn);return d.jsxs("div",xe(xe({ref:n,className:J("bg-base select-none overflow-x-hidden overflow-y-auto",j),style:r},R),{},{children:[l.length===0&&(S??d.jsx(Lr,{message:d.jsx(Be,{i18nKey:"form:select.emptyList"})})),l.map(function(P,y){var h,C;return P.___group___?d.jsx("p",{className:"px-2 py-1 text-muted text-xs sticky -top-px z-2 bg-base border-t",children:P.label},y):P.___create___?d.jsx("div",xe(xe({role:"none",tabIndex:f===y?0:-1,ref:function(i){return g(y,i)},"data-active":f===y?!0:void 0,className:J("block text-start truncate px-2 py-1 leading-normal cursor-pointer select-none","data-[active]:bg-primary-200 data-[selected]:bg-primary-600 data-[selected]:text-white data-[active]:data-[selected]:underline")},k(P)),{},{children:d.jsx(Be,{i18nKey:"form:select.createOption",values:{query:(h=P.value)!==null&&h!==void 0?h:P},components:[d.jsx("strong",{children:"query"},"t0")]})}),y):d.jsx("div",xe(xe({role:"none",tabIndex:f===y?0:-1,ref:function(i){return g(y,i)},"data-active":f===y?!0:void 0,className:J("block text-start truncate px-2 py-1 leading-normal cursor-pointer","data-[active]:bg-primary-200 data-[selected]:bg-primary-600 data-[selected]:text-white data-[active]:data-[selected]:underline")},k(P)),{},{children:m(P,(C=P[A])!==null&&C!==void 0?C:P)}),y)})]}))},pn=function(e){return e},vn=function(e,n){var r,l,f=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"";return he(e)?e.map(function(j){var g;return(g=j[f])!==null&&g!==void 0?g:j}):(r=(l=e==null?void 0:e[f])!==null&&l!==void 0?l:e)!==null&&r!==void 0?r:n};function rr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function z(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?rr(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):rr(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var fn=function(e){var n=e.options,r=n===void 0?Fe:n,l=e.value,f=e.defaultOpen,j=f===void 0?!1:f,g=e.autoComplete,S=e.multiple,D=S===void 0?!1:S,A=e.allowCreate,k=A===void 0?!1:A,m=e.groupProperty,R=m===void 0?"":m,P=e.valueProperty,y=P===void 0?"id":P,h=e.labelProperty,C=h===void 0?"label":h,v=e.sortProperty,i=e.createOption,O=i===void 0?pn:i,x=e.matcher,M=e.onQuery,E=e.onChange,w=e.onSelect,b=c.useMemo(function(){return D?[]:""},[D]),N=c.useDeferredValue(l??b),Q=c.useRef([]),ge=c.useRef(null),U=c.useRef([]),H=c.useRef([]),a=c.useCallback(function(o,p){var F,V;return(F=x==null?void 0:x(o,p))!==null&&F!==void 0?F:Wr((V=o[C])!==null&&V!==void 0?V:o,p)},[x]),u=c.useCallback(function(o){setTimeout(function(){w==null||w(o??b),E==null||E(vn(o,b,y))},50)},[b,w,E]),Z=c.useReducer(function(o,p){if(p.type==="open"){var F=o.items.indexOf(o.multiple?o.value[0]:o.value);return z(z({},o),{},{open:!0,activeIndex:F>-1?F:null})}if(p.type==="close")return z(z({},o),{},{activeIndex:null,open:!1});if(p.type==="active"&&o.open)return g&&p.index!==null&&(o.query=o.items[p.index]),z(z({},o),{},{activeIndex:p.index});if(p.type==="setValue")return z(z({},o),{},{value:p.value,selectedIndex:o.items.indexOf(o.multiple?p.value[0]:p.value)});if(p.type==="changeValue"){var V,q=z(z({},o),{},{value:o.emptyValue,activeIndex:null,selectedIndex:g?o.multiple?(V=p.value)===null||V===void 0?void 0:V.length:0:o.items.indexOf(p.value)});if(p.value!==void 0)if(D){var Y=[];tr(p.value)?Y.push.apply(Y,K(p.value.split(/,\s?/))):Y.push(p.value),q.value=K(o.value),Y.forEach(function(te){var se,fe;q.value=(se=(fe=q.value).includes)!==null&&se!==void 0&&se.call(fe,te)?q.value.filter(function(me){return me!==te}):[].concat(K(q.value),[te])})}else q.value=p.value;return o.multiple||(q.open=!1),u(q.value),q}if(p.type==="removeItem"){var ee=o.value;if(o.multiple){var G;ee=K(ee),ee.splice((G=p.index)!==null&&G!==void 0?G:-1,1)}else ee="";return u(ee),z(z({},o),{},{value:ee})}if(p.type==="startQuery")return z(z({},o),{},{loading:!0,query:p.query});if(p.type==="options"){var L=z(z({},o),{},{loading:!1,query:p.query}),ne=K(p.options);g&&p.query!==void 0&&(ne=Ke([p.query].concat(K(ne)))),v&&(ne=ne.sort(Jr("asc",v)));var Te=Xr(ne,R,"");if(p.open&&(L.open=!0),L.items=[],k&&p.query&&L.items.push({___create___:!0,value:p.query}),Object.entries(Te).forEach(function(te){var se,fe=re(te,2),me=fe[0],Ne=fe[1];me&&L.items.push({___group___:!0,label:me}),(se=L.items).push.apply(se,K(Ne))}),p.setActive){var we=L.items.findIndex(function(te){return!te.___group___});L.activeIndex=we>=0?we:null}else L.activeIndex=null;return U.current=L.items,L}return o},{multiple:D,emptyValue:b,open:j,loading:!1,activeIndex:null,selectedIndex:null,value:b,query:void 0,items:[]}),ye=re(Z,2),X=ye[0],s=ye[1];c.useEffect(function(){if(!D){var o,p=(k||g)&&N?O(N):void 0,F=r.find(function(q){var Y;return((Y=q[y])!==null&&Y!==void 0?Y:q)===N});H.current=r,!F&&p&&(H.current=[p].concat(K(r??[]))),s({type:"options",options:H.current}),s({type:"setValue",value:(o=F??p)!==null&&o!==void 0?o:N})}if(D){H.current=[];var V=(he(N)?N:[]).map(function(q){var Y,ee=(k||g)&&q?O(q):void 0,G=r.find(function(L){var ne;return((ne=L[y])!==null&&ne!==void 0?ne:L)===q});return!G&&ee&&H.current.push(ee),(Y=G??ee)!==null&&Y!==void 0?Y:q});H.current=[].concat(K(H.current),K(r??[])),s({type:"options",options:H.current}),s({type:"setValue",value:V})}},[N,r,D,k,g,O]);var oe=Me(function(o){Promise.resolve(M==null?void 0:M(o)).then(function(p){var F=K(p);g&&F.push.apply(F,K(H.current.filter(function(V){return a==null?void 0:a(V,o)}))),s({type:"options",query:o,options:F,open:!0,setActive:!0})})},[M],300),ue=c.useCallback(function(o){if(!o)s({type:"options",query:"",options:H.current});else{if(M)return s({type:"startQuery",query:o}),oe(o);s({type:"options",query:o,open:!0,setActive:!0,options:H.current.filter(function(p){return a==null?void 0:a(p,o)})})}},[a,M]),ve=c.useCallback(function(o){var p=o;if(g&&D&&o&&(p=o.split(/,\s?/)),s({type:"changeValue",value:o!=null&&o.___create___?o.value:o}),o!=null&&o.___create___){var F=[o.value];D&&(F=o.value.split(/,\s?/)),H.current=[].concat(K(H.current),K(F.map(O)))}g&&(H.current=Ke([].concat(K(he(p)?p:[p]),K(H.current)))),s({type:"options",options:H.current})},[]),be=c.useCallback(function(o){s({type:"removeItem",index:o})},[]),ie=c.useCallback(function(o){s({type:o?"open":"close"}),s({type:"options",query:void 0,options:H.current})},[]),Oe=c.useCallback(function(o){s({type:"active",index:o})},[]);return{state:X,listRef:Q,focusableRef:ge,listContentRef:U,handleChange:ve,handleRemove:be,handleQuery:ue,macthOption:a,setActiveIndex:Oe,setOpen:ie,setItemRef:function(p,F){Q.current[p]=F}}},gn=["ref","name","value","invalid","readOnly","disabled","required","placeholder","autoFocus","error","options","defaultOpen","hideHandle","groupProperty","labelProperty","valueProperty","sortProperty","multiple","searchable","allowCreate","emptyDisplay","createOption","matcher","renderer","onQuery","onChange","onSelect","onEnterPressed"];function nr(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter(function(l){return Object.getOwnPropertyDescriptor(t,l).enumerable})),n.push.apply(n,r)}return n}function de(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?nr(Object(n),!0).forEach(function(r){le(t,r,n[r])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):nr(Object(n)).forEach(function(r){Object.defineProperty(t,r,Object.getOwnPropertyDescriptor(n,r))})}return t}var Un=function(e){var n,r,l=e.ref,f=e.name,j=e.value,g=e.invalid,S=e.readOnly,D=e.disabled,A=e.required,k=e.placeholder,m=e.autoFocus,R=e.error,P=e.options,y=e.defaultOpen,h=e.hideHandle,C=e.groupProperty,v=e.labelProperty,i=v===void 0?"label":v,O=e.valueProperty,x=O===void 0?"id":O,M=e.sortProperty,E=e.multiple,w=e.searchable,b=e.allowCreate,N=e.emptyDisplay,Q=e.createOption,ge=e.matcher,U=e.renderer,H=e.onQuery,a=e.onChange,u=e.onSelect,Z=e.onEnterPressed,ye=pe(e,gn),X=fn({value:j,options:P,multiple:E,defaultOpen:y,groupProperty:C,labelProperty:i,valueProperty:x,sortProperty:M,allowCreate:b,createOption:Q,matcher:ge,onChange:a,onSelect:u,onQuery:H}),s=X.state,oe=X.listRef,ue=X.listContentRef,ve=X.setOpen,be=X.macthOption,ie=X.handleChange,Oe=X.handleRemove,o=X.handleQuery,p=X.setItemRef,F=X.setActiveIndex,V=c.useId(),q=Ar({open:s.open,onOpenChange:function($,T,B){!$&&(oe.current=[]),ve($)},strategy:"fixed",placement:"bottom",whileElementsMounted:vr,middleware:[Hr({padding:8}),qr(),Br(2)]}),Y=q.context,ee=q.floatingStyles,G=q.refs,L=Vr(Y,{}),ne=Yr(Y,{}),Te=Kr(Y,{listRef:oe,activeIndex:s.activeIndex,selectedIndex:s.selectedIndex,loop:!0,virtual:!0,focusItemOnOpen:!1,onNavigate:F}),we=zr(Y,{listRef:ue,activeIndex:s.activeIndex,selectedIndex:s.selectedIndex,findMatch:function($,T){return $.find(function(B){return be(B,T)})},onMatch:function($){s.open&&F($),!w&&!E&&!s.open&&ie(ue.current[$])}}),te=Qr([ne,w?void 0:L,Te,we]),se=te.getReferenceProps,fe=te.getFloatingProps,me=te.getItemProps,Ne=c.useMemo(function(){var I=se();return de(de({},I),{},{onBlur:function(T){var B;if((B=T.relatedTarget)!==null&&B!==void 0&&B.closest('[data-select-dropdown="'.concat(V,'"]'))){var ae;(ae=G.domReference.current)===null||ae===void 0||(ae=ae.querySelector("input"))===null||ae===void 0||ae.focus();return}o(""),ve(!1)},onKeyDown:function(T){if(T.key==="Enter"){if(s.activeIndex!==null)return ie(ue.current[s.activeIndex]),T.preventDefault(),T.stopPropagation(),!1;if(s.query)return o(""),T.preventDefault(),T.stopPropagation(),!1;Z==null||Z(T)}else T.key==="Tab"&&s.activeIndex!==null?ie(ue.current[s.activeIndex]):T.key==="Backspace"?!s.query&&Oe():(!w||["ArrowUp","ArrowDown"].includes(T.key))&&(["ArrowUp","ArrowDown"].includes(T.key)&&s.activeIndex===null&&F(s.selectedIndex),setTimeout(function(){var B;(B=I.onKeyDown)===null||B===void 0||B.call(I,T)},50))}})},[se,Z,o,G,s.query,s.activeIndex]),ir=c.useMemo(function(){return fe({"data-select-dropdown":V})},[fe]),lr=c.useCallback(function(I){var $,T,B=he(s.value)?($=s.value)===null||$===void 0||(T=$.includes)===null||T===void 0?void 0:T.call($,I):s.value===I;return me({"data-selected":B?!0:void 0,onClick:function(){ie(I)}})},[me,ie,s.value]),ur=c.useMemo(function(){if(he(s.value))return s.value.map(function(T,B){var ae,Ie;return d.jsx(Sr,{onRemove:function(){return Oe(B)},children:(ae=(Ie=U==null?void 0:U(T))!==null&&Ie!==void 0?Ie:T[i])!==null&&ae!==void 0?ae:T},B)});if(!ke(s.value)&&!s.query){var I,$;return d.jsx("span",{className:"self-center pointer-events-none select-none",children:(I=($=U==null?void 0:U(s.value))!==null&&$!==void 0?$:s.value[i])!==null&&I!==void 0?I:s.value})}},[s.value,s.query,k,U]),sr=c.useCallback(function(){var I;ve(!0),(I=G.domReference.current)===null||I===void 0||(I=I.querySelector("input"))===null||I===void 0||I.focus()},[]);return c.useLayoutEffect(function(){s.open&&setTimeout(function(){var I;s.selectedIndex&&((I=oe.current[s.selectedIndex])===null||I===void 0||I.scrollIntoView({block:"center"}))},100)},[s.open]),d.jsxs(or,de(de({showClear:!ke(s.value),onClear:ie,invalid:g,readOnly:S,disabled:D,required:A,error:R,wrapperRef:G.setReference,className:s.open?"!z-[99]":""},ye),{},{children:[d.jsxs("div",de(de({role:"none","data-select-display":"true",className:J("group flex-1 py-1 px-2 truncate text-start flex gap-1 relative min-h-5 justify-start",E?"flex-wrap":"flex-nowrap overflow-hidden")},Ne),{},{onMouseUp:function($){var T;return(T=$.currentTarget.querySelector("input"))===null||T===void 0?void 0:T.focus()},children:[ur,d.jsx("input",{readOnly:!w||S,disabled:D,value:(n=s.query)!==null&&n!==void 0?n:"","aria-invalid":g,"data-testid":f,name:f,size:1,ref:l,autoFocus:m,className:J("appearance-none bg-transparent outline-none border-none ring-0 flex-1 peer",D&&"cursor-not-allowed pointer-events-none",E&&"min-w-24"),placeholder:ke(s.value)?k:"",onChange:function($){return o($.target.value)}})]})),!s.loading&&!h&&d.jsx(Re,{className:J("flex-content p-2 z-0 order-9 text-muted cursor-pointer self-stretch flex items-center h-auto",s.open&&"-scale-y-100 pointer-events-none",D&&"pointer-events-none"),onClick:function(){return!D&&sr()},icon:He.chevronDown}),s.loading&&d.jsx(Re,{animate:"spin",className:J("flex-content p-2 z-0 order-9 text-muted pointer-events-none"),icon:He.spinner}),s.open&&!s.loading&&d.jsx(Ur,{children:d.jsx(Gr,{context:Y,initialFocus:-1,visuallyHiddenDismiss:!0,children:d.jsx(dn,de(de({ref:G.setFloating,className:"outline shadow-lg max-h-[40vh] z-(--z-popover)",style:de({width:(r=G.reference.current)===null||r===void 0?void 0:r.getBoundingClientRect().width},ee)},ir),{},{items:s.items,active:s.activeIndex,valueProperty:x,labelProperty:i,itemRef:p,itemProps:lr,empty:N,children:function($,T){var B;return(B=U==null?void 0:U($))!==null&&B!==void 0?B:T}}))})})]}))};export{Bn as C,Yn as E,zn as F,Qn as N,dn as O,Kn as R,Un as S,qn as T,Vn as a,_r as b,fn as u};
