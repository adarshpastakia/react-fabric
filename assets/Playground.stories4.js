var No=Object.defineProperty;var Do=(n,t,i)=>t in n?No(n,t,{enumerable:!0,configurable:!0,writable:!0,value:i}):n[t]=i;var ee=(n,t,i)=>Do(n,typeof t!="symbol"?t+"":t,i);import{r as B,l as Le,j as P,m as ae,_ as Yi,az as bn,aN as Yt,aQ as _n,aP as Pi,bk as Ot,aO as or,aS as pt,bn as Go,c2 as ar,bB as En,aL as wn}from"./iframe-DZ_tjZ0H.js";import{f as ue}from"./index4.js";import{c as Po,d as zo,e as Oo,f as Io,g as Fo,h as Mo,i as $o}from"./mdi.js";import{u as Uo,C as fe,_ as Jt,b as jo,c as Ho}from"./index2.js";import{L as Vo,B as he,S as xn}from"./Button.js";import{I as We}from"./Tooltip.js";import{u as Bo}from"./usePropToggle.js";import{u as Wo}from"./useResize.js";import{E as qo}from"./ErrorBoundary.js";import{C as Xo}from"./Content.js";import{V as Yo}from"./Viewport.js";import{E as Ko}from"./EmptyContent.js";import{M as Zo,m as Ki,u as Tn}from"./memoize-one.esm.js";import{C as sr}from"./Copy.js";import{T as Qo}from"./Text.js";import"./Google.js";import"./ColorPicker.js";import{u as Sn}from"./useDebounce.js";import{B as At}from"./ButtonGroup2.js";import{d as at}from"./debounce.js";import{S as Jo}from"./Section.js";import{u as ea}from"./useIsDark.js";import"./createClass.js";import"./Global.js";import"./useResizeObserver.js";import"./types.js";import"./zh-CN.js";import"./endOfDay.js";import"./index5.js";import"./index3.js";import"./cloneElement.js";function lr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function ur(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?lr(Object(i),!0).forEach(function(e){Jt(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):lr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}var ta=function(t){var i=t.children,e=t.title,r=t.icon,o=t.iconBg,a=t.iconColor,s=t.rtlFlip,l=t.className,u=t.bodyClassName,c=t.headerClassName,d=t.resizeable,f=t.flyout,h=t.onFlyout,g=t.collapsed,m=t.collapsable,y=t.onCollapse,A=t.actions,x=t.loading,C=t.align,E=C===void 0?"start":C,S=t.width,R=S===void 0?"20rem":S,p=t.minWidth,T=p===void 0?"2rem":p,w=t.maxWidth,L=w===void 0?"30vw":w,k=t["data-testid"],D=t["data-test-value"],_=B.useRef(null),$=B.useState(R),M=Le($,2),b=M[0],v=M[1],N=B.useState(!1),F=Le(N,2),z=F[0],V=F[1],X=Bo(g,y),O=Le(X,2),j=O[0],W=O[1];B.useEffect(function(){v(R)},[R]);var oe=B.useRef(function(Y){var ie=Y.x;_.current!=null&&v(_.current.offsetWidth+ie)}),H=Wo(oe.current,{isReverse:E==="end"}),J=B.useCallback(function(){j&&(f?(V(!z),!z&&(h==null||h())):W())},[z,f,j,h,W]);Uo(function(){if(z){var Y=function(te){te.target.closest('[data-ref="asideBody"]')==null&&te.target.closest('[data-ref="asidePlaceholder"]')==null&&V(!1)};return document.addEventListener("mouseup",Y),function(){return document.removeEventListener("mouseup",Y)}}},[z],"Aside peek");var ne=B.useMemo(function(){return{width:b,minWidth:T,maxWidth:L}},[b,T,L]);return P.jsxs("aside",{className:ae("fabric-aside",l,"overflow-hidden grid"),"data-align":E,"data-flyout":z,"data-loading":x,"data-collapsed":j,style:j?void 0:ne,"data-testid":k,"data-test-value":D,children:[P.jsxs("header",{className:ae("fabric-asideHeader",c,"grid area-head items-center"),"data-ref":"asideHeader",children:[e&&P.jsx("div",{className:ae("fabric-asideTitle","truncate py-0.5 px-1 select-none pointer-events-none"),children:e}),m&&P.jsx(We,{"aria-label":j?"expand":"collapse",className:ae("fabric-asideCollapse","p-2 select-none"),icon:fe.chevronLeft,rtlFlip:!0,onClick:W,"data-ref":"asideToggle"}),r&&P.jsx(We,{icon:r,bg:o,color:a,rtlFlip:s,className:ae("fabric-asideIcon","p-1 text-lg select-none pointer-events-none")}),A&&P.jsx("div",{className:"fabric-asideActions",children:A})]}),x&&P.jsx(Vo,{}),j&&P.jsx("div",{role:"none",onClick:J,"data-ref":"asidePlaceholder",className:"fabric-asidePlaceholder"}),P.jsx("section",{ref:_,"data-ref":"asideBody",className:ae("fabric-asideBody",u,"overflow-hidden grid"),style:j?ne:void 0,children:P.jsx(qo,{children:i})}),d&&P.jsx("div",ur(ur({},H),{},{className:ae("fabric-asideResizer","before:absolute before:inset-0 before:w-1 before:top-1/2 before:-translate-y-1/2 before:transition-all before:delay-150")}))]})},ia={noRecords:"لا تسجيلات"},ra={noItems:"لا توجد عناصر",error:"خطأ في تحميل العناصر",loading:"تحميل العناصر…"},na={empty:"لا توجد سجلات متاحة"},oa={empty:"لا توجد خصائص بيانات",true:"نعم",false:"رقم"},aa={empty:"لا توجد عناصر قائمة"},sa={empty:"لا توجد رسوم بيانية"},la={find:"تجد…",copy:"قيمة النسخ",filter:"منقي…",showShortcuts:"اختصارات لوحة المفاتيح…",collapseAll:"انهيار جميع",expandAll:"توسيع الكل",checkAll:"تحقق من الكل",uncheckAll:"الغاءالكل",addFilter:"أضف عامل تصفية",addFilterNot:"إضافة لا تصفية"},ua={tree:{noItems:"لا توجد عناصر شجرة متوفرة"}},ca={label:ia,tree:ra,datagrid:na,json:oa,checkList:aa,histogram:sa,action:la,data:ua},da={noRecords:"No Records"},ha={noItems:"No items",error:"Error loading items",loading:"Loading items..."},fa={empty:"No records available"},ga={empty:"No data properties",true:"Yes",false:"No"},va={empty:"No list items"},pa={empty:"No histograms"},ma={find:"Find...",copy:"Copy Value",filter:"Filter...",showShortcuts:"Keyboard shortcuts...",collapseAll:"Collapse All",expandAll:"Expand All",checkAll:"Check All",uncheckAll:"Uncheck All",addFilter:"Add Filter",addFilterNot:"Add not Filter"},ya={tree:{noItems:"No tree items available"}},ba={label:da,tree:ha,datagrid:fa,json:ga,checkList:va,histogram:pa,action:ma,data:ya};jo("data",{en:ba,ar:ca});var _a=["className","json","copy","propertyScheme","filters","inline","labelWidth","formatter","labeler","onFilter","emptyMessage","showPropertyTree"];function cr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function nt(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?cr(Object(i),!0).forEach(function(e){Jt(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):cr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}var Ea=function n(t){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",r=[];return Object.entries(t).forEach(function(o){var a=Le(o,2),s=a[0],l=a[1];if(_n(l)&&Pi(l[0]))r.push.apply(r,Ot(n(l,[].concat(Ot(i),[s]),s)));else{var u={field:e?"".concat(e,".").concat(s):s,value:l,path:[].concat(Ot(i),[s]).join(".")};Pi(l)&&!Yt(l)&&!("_score_"in l)&&(u.children=n(l,[].concat(Ot(i),[s]))),r.push(u)}}),r.flat(99)},wa=function n(t){var i=t.value,e=t.path,r=t.field,o=t.children,a=t.copy,s=t.filters,l=t.labeler,u=t.formatter,c=t.propertyScheme,d=t.showPropertyTree,f=t.onFilter,h=t.inline,g=t.labelWidth,m=g===void 0?"30%":g,y=t.level,A=y===void 0?0:y,x=bn("data"),C=x.t,E=B.useState(!0),S=Le(E,2),R=S[0],p=S[1],T=B.useMemo(function(){return!!o},[o]),w=B.useMemo(function(){var M,b;return(M=(b=i==null?void 0:i._label_)!==null&&b!==void 0?b:i)!==null&&M!==void 0?M:""},[i]),L=B.useMemo(function(){var M,b,v,N,F,z,V,X;if(o)return null;if(or(i))return P.jsx("span",{className:"text-muted",children:"null"});if(Yt(i))return P.jsx("span",{className:"text-muted",children:"empty"});var O=w;if(u){var j=u==null?void 0:u(e,w);or(j)||(O=j)}return _n(w)&&(O="[".concat(w.join(", "),"]")),c!=null&&(M=c.date)!==null&&M!==void 0&&M.includes(e),c!=null&&(b=c.time)!==null&&b!==void 0&&b.includes(e)&&(O=pt.date(w,"pp")),c!=null&&(v=c.number)!==null&&v!==void 0&&v.phone(e)&&(O=pt.phone(w)),c!=null&&(N=c.bytes)!==null&&N!==void 0&&N.includes(e)&&(O=pt.bytes(w)),c!=null&&(F=c.percent)!==null&&F!==void 0&&F.includes(e)&&(O=pt.percent(w)),c!=null&&(z=c.number)!==null&&z!==void 0&&z.includes(e)&&(O=pt.number(w)),(c!=null&&(V=c.boolean)!==null&&V!==void 0&&V.includes(e)||Go(w))&&(O=C(w?"json.true":"json.false")),((X=O)===null||X===void 0?void 0:X.length)>128?O=P.jsx(Qo,{clamp:3,children:O}):O=P.jsx("div",{className:"break-words",children:O}),P.jsxs(B.Fragment,{children:[O,Pi(i)&&i._score_>0&&P.jsx(Zo,{className:"text-xs",value:i._score_})]})},[i,e,u,c,w]),k=B.useMemo(function(){return e.replace(/\.\d*\./,".")},[e]),D=B.useMemo(function(){var M,b;return!Yt(i)&&(ar(a)||(a==null||(M=a.includes)===null||M===void 0?void 0:M.call(a,e))||(a==null||(b=a.includes)===null||b===void 0?void 0:b.call(a,k)))},[a,i,e,k]),_=B.useMemo(function(){var M,b;return ar(s)||(s==null||(M=s.includes)===null||M===void 0?void 0:M.call(s,e))||(s==null||(b=s.includes)===null||b===void 0?void 0:b.call(s,k))},[s,e,k]),$=B.useMemo(function(){var M;return P.jsxs("div",{className:ae("text-dimmed text-sm px-2 flex-1 group",h?"truncate":"break-words"),children:[!T&&_&&P.jsxs("div",{className:"hidden pe-1 group-hover:inline-block",children:[P.jsx(he,{color:"danger",size:"xs",variant:"link",icon:fe.funnelMinus,"aria-label":"Filter Negative",onClick:function(){return f==null?void 0:f(k,w,!0)}},"negative"),P.jsx(he,{color:"primary",size:"xs",variant:"link",icon:fe.funnelPlus,"aria-label":"Filter",onClick:function(){return f==null?void 0:f(k,w)}},"positive")]}),(M=l==null?void 0:l(e))!==null&&M!==void 0?M:r]})},[r,l,k,w,T,_]);return P.jsxs(B.Fragment,{children:[d&&P.jsxs("div",{className:ae("py-2",h&&"flex flex-nowrap items-center"),style:{paddingInlineStart:A*8},children:[P.jsxs("div",{role:"none",className:ae("flex overflow-hidden items-center",h&&"flex-content"),style:{flexBasis:m},onClick:function(){return T&&p(!R)},children:[T&&P.jsx(We,{rtlFlip:!0,icon:R?fe.chevronDown:fe.chevronRight}),$]}),L&&P.jsxs("div",{className:ae("px-2 flex flex-nowrap overflow-hidden",h&&"flex-1"),children:[D&&P.jsx(sr,{size:"xs",text:w}),P.jsx("div",{className:"flex-1",children:L})]})]}),!d&&!o&&P.jsxs("div",{className:ae("py-2",h&&"flex flex-nowrap items-center"),children:[P.jsx("div",{role:"none",className:ae("flex overflow-hidden items-center",h&&"flex-content"),style:{flexBasis:m},children:$}),P.jsxs("div",{className:ae("px-2 flex flex-nowrap overflow-hidden",h&&"flex-1"),children:[D&&P.jsx(sr,{size:"xs",text:i}),P.jsx("div",{className:"flex-1",children:L})]})]}),R&&(o==null?void 0:o.map(function(M){return P.jsx(n,nt(nt({},M),{},{level:A+1,copy:a,inline:h,showPropertyTree:d,propertyScheme:c,filters:s,labelWidth:m,formatter:u,labeler:l,onFilter:f}),M.path)}))]})},xa=function(t){var i=t.className,e=t.json,r=t.copy,o=t.propertyScheme,a=t.filters,s=t.inline,l=t.labelWidth,u=t.formatter,c=t.labeler,d=t.onFilter,f=t.emptyMessage,h=t.showPropertyTree,g=h===void 0?!0:h,m=Yi(t,_a),y=bn("data"),A=y.t,x=B.useMemo(function(){return Ea(e)},[e]);return P.jsx("div",nt(nt({},m),{},{className:ae(i,"bg-alternate"),children:Yt(e)?P.jsx(Ko,{size:"sm",message:f??A("json.empty")}):x.map(function(C){return P.jsx(wa,nt(nt({},C),{},{copy:r,inline:s,showPropertyTree:g,propertyScheme:o,filters:a,labelWidth:l,formatter:u,labeler:c,onFilter:d}),C.path)})}))},Ta=B.memo(function(n){var t=n.page,i=n.ranges,e=n.totalPages,r=n.minimal,o=n.onPageChange,a=Le(i,3),s=a[0],l=a[1],u=a[2],c=B.useMemo(function(){return P.jsxs(B.Fragment,{children:[s==null?void 0:s.map(function(d){return P.jsx("button",{onClick:function(){return o(d)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t===d&&"bg-primary-500 text-white pointer-events-none"),children:d+1},d)}),l&&P.jsx("span",{className:"leading-none inline-block w-8 text-center text-dimmed",children:"..."}),l==null?void 0:l.map(function(d){return P.jsx("button",{onClick:function(){return o(d)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t===d&&"bg-primary-500 text-white pointer-events-none"),children:d+1},d)}),u&&P.jsx("span",{className:"leading-none inline-block w-8 text-center text-dimmed",children:"..."}),u==null?void 0:u.map(function(d){return P.jsx("button",{onClick:function(){return o(d)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t===d&&"bg-primary-500 text-white pointer-events-none"),children:d+1},d)})]})},[s,l,u,t]);return P.jsxs("div",{className:"inline-flex items-center",children:[P.jsx("button",{onClick:function(){return o(0)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t===0&&"pointer-events-none text-tint-300"),children:P.jsx(We,{icon:fe.chevronsLeft,rtlFlip:!0})}),P.jsx("button",{onClick:function(){return o(t-1)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t===0&&"pointer-events-none text-tint-300"),children:P.jsx(We,{icon:fe.chevronLeft,rtlFlip:!0})}),!r&&c,r&&P.jsxs("label",{className:"leading-none inline-block px-1 text-center text-sm select-none fixed-numbers",children:[t+1,"/",e]}),P.jsx("button",{onClick:function(){return o(t+1)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t+1>=e&&"pointer-events-none text-tint-300"),children:P.jsx(We,{icon:fe.chevronRight,rtlFlip:!0})}),P.jsx("button",{onClick:function(){return o(e-1)},className:ae("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",t+1>=e&&"pointer-events-none text-tint-300"),children:P.jsx(We,{icon:fe.chevronsRight,rtlFlip:!0})})]})});Ta.displayName="Pagination";Ki(function(n){return n});var An=function(t){var i=t.vertical,e=i===void 0?!0:i,r=t.scrollActive,o=t.onStart,a=t.onEnd,s=t.onPrevious,l=t.onNext;return P.jsxs(At,{vertical:e,variant:"link",className:"outline",children:[P.jsx(he,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll to top",icon:e?fe.chevronsUp:fe.chevronsLeft,disabled:(r&2)===0,onClick:o}),P.jsx(he,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll up",icon:e?fe.chevronUp:fe.chevronLeft,disabled:(r&2)===0,onClick:s}),P.jsx(he,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll down",icon:e?fe.chevronDown:fe.chevronRight,disabled:r%2===0,onClick:l}),P.jsx(he,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll to bottom",icon:e?fe.chevronsDown:fe.chevronsRight,disabled:r%2===0,onClick:a})]})},Sa=["items","children","columns","fullWidth","maxWidth","minWidth","total","padding","defaultHeight","defaultWidth","hideScroller","initialScroll","loading","onLoadMore","onScroll","galleryRef"];function dr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function hr(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?dr(Object(i),!0).forEach(function(e){Jt(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):dr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}var Aa=Ki(function(n){return n}),Rn=function(t){var i,e=t.items,r=t.children,o=t.columns,a=t.fullWidth,s=t.maxWidth,l=t.minWidth,u=t.total,c=u===void 0?0:u,d=t.padding,f=d===void 0?"md":d,h=t.defaultHeight,g=h===void 0?48:h,m=t.defaultWidth,y=m===void 0?48:m,A=t.hideScroller,x=t.initialScroll,C=t.loading,E=t.onLoadMore,S=t.onScroll,R=t.galleryRef,p=Yi(t,Sa),T=B.useDeferredValue(e.length),w=B.useMemo(function(){return E?8:0},[E]),L=Aa(e.map(function(H,J){return{index:J,item:H,isLast:J+1===e.length}})),k=B.useRef(null),D=B.useState(1),_=Le(D,2),$=_[0],M=_[1],b=B.useMemo(function(){return new Array($).fill(0).map(function(H,J){return J})},[$]);Ho(function(){if(k.current){var H=k.current,J=function(){var ie,te,se,K=parseInt((ie=getComputedStyle((te=H.firstElementChild)===null||te===void 0?void 0:te.firstElementChild).padding)!==null&&ie!==void 0?ie:8);M(o??Math.max(1,Math.floor((((se=H==null?void 0:H.offsetWidth)!==null&&se!==void 0?se:800)-32-(isNaN(K)?8:K)*2)/y)))},ne=new ResizeObserver(J);return J(),ne.observe(H),function(){ne.unobserve(H),ne.disconnect()}}},[k.current,o,y],"virtualGallery recalculate view count");var v=Tn({count:Math.ceil(T/$),getScrollElement:function(){return k.current},estimateSize:function(){return g},overscan:2}),N=v.getVirtualItems(),F=B.useRef(0);B.useEffect(function(){var H,J;F.current=(H=(J=N[2])===null||J===void 0?void 0:J.index)!==null&&H!==void 0?H:0,k.current&&N[0]&&k.current.scrollTop<N[0].size&&(F.current=0)},[N]);var z=B.useCallback(function(){var H,J=(H=k.current)!==null&&H!==void 0?H:{},ne=J.scrollTop,Y=ne===void 0?0:ne,ie=J.scrollHeight,te=ie===void 0?0:ie,se=J.offsetHeight,K=se===void 0?0:se;return te===K?0:Y===0?1:Y>=te-K-w*2?2:3},[]),V=B.useState(0),X=Le(V,2),O=X[0],j=X[1],W=Sn(function(H){return S==null?void 0:S(F.current*H)},[S]),oe=B.useCallback(function(){j(z()),W($)},[$,E]);return B.useEffect(function(){j(z())},[T,z]),B.useEffect(function(){if(E){var H,J,ne=(H=N[0])===null||H===void 0?void 0:H.index,Y=N==null||(J=N.slice(-1).pop())===null||J===void 0?void 0:J.index,ie=ne*$,te=(Y??0)*$+$,se=ne!==void 0&&e[ie]===null,K=Y!==void 0&&te>=T-1&&T<c,Z=at(E);return se?Z(ie):!C&&K&&Z(te+1),function(){return Z.cancel()}}},[E,N]),B.useLayoutEffect(function(){setTimeout(function(){x&&v.scrollToIndex(Math.floor(x/$),{align:"start"})},100)},[$]),B.useImperativeHandle(R,function(){return{scrollToItem:function(J){v.scrollToIndex(Math.floor(J/$),{align:"auto"})},hilight:function(J){var ne;(ne=k.current)===null||ne===void 0||(ne=ne.querySelector(".hilight"))===null||ne===void 0||ne.classList.remove("hilight","ring-1"),v.scrollToIndex(Math.floor(J/$),{align:"auto"}),setTimeout(function(){var Y;(Y=k.current)===null||Y===void 0||(Y=Y.querySelector('[data-index="'.concat(J,'"]')))===null||Y===void 0||Y.classList.add("hilight","ring-1")},100)},unhilight:function(){var J;(J=k.current)===null||J===void 0||(J=J.querySelector(".hilight"))===null||J===void 0||J.classList.remove("hilight","ring-1")}}},[v,$]),P.jsx("div",hr(hr({ref:k,onScroll:oe,className:ae("area-content bg-base overflow-auto")},p),{},{children:P.jsxs("div",{className:ae("flex flex-nowrap justify-center gap-2 min-h-full"),children:[P.jsx("div",{className:ae("box-content",a&&"flex-1",f==="sm"&&"p-1",f==="md"&&"p-2",f==="lg"&&"p-4"),style:{minWidth:l,maxWidth:s},children:P.jsxs("div",{style:{height:v.getTotalSize()+w},children:[P.jsx("div",{style:{height:(i=N[0])===null||i===void 0?void 0:i.start}}),N.map(function(H){var J=H.key,ne=H.index;return P.jsx("div",{className:"flex","data-index":ne,ref:v.measureElement,children:b.map(function(Y){return P.jsx("div",{"data-index":ne*$+Y,className:ae("grid rounded-capped"),children:L[ne*$+Y]&&r(L[ne*$+Y])},"".concat(J,":").concat(Y))})},J)}),E&&P.jsx("div",{className:"h-16",children:C&&P.jsx(xn,{})})]})}),!A&&P.jsx("div",{className:ae("self-end sticky bottom-2"),children:P.jsx(An,{vertical:!0,scrollActive:O,onStart:function(){return v.scrollToIndex(0)},onPrevious:function(){return k.current&&v.scrollBy(-k.current.offsetHeight)},onNext:function(){return k.current&&v.scrollBy(k.current.offsetHeight)},onEnd:function(){return v.scrollToIndex(T-1)}})})]})}))};Rn.displayName="VirtualGallery";var Ra=B.memo;Ra(Rn);var Ca=["items","total","children","fullWidth","maxWidth","minWidth","padding","orientation","defaultHeight","defaultWidth","hideScroller","initialScroll","loading","onLoadMore","onScroll","listRef"];function fr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function gr(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?fr(Object(i),!0).forEach(function(e){Jt(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):fr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}var La=Ki(function(n){return n}),Cn=function(t){var i,e,r=t.items,o=t.total,a=o===void 0?0:o,s=t.children,l=t.fullWidth,u=t.maxWidth,c=t.minWidth,d=t.padding,f=d===void 0?"md":d,h=t.orientation,g=h===void 0?"vertical":h,m=t.defaultHeight,y=m===void 0?48:m,A=t.defaultWidth,x=A===void 0?48:A,C=t.hideScroller,E=t.initialScroll,S=t.loading,R=t.onLoadMore,p=t.onScroll,T=t.listRef,w=Yi(t,Ca),L=B.useDeferredValue(r.length),k=B.useMemo(function(){return R?8:0},[R]),D=La(r.map(function(j,W){return{index:W,item:j,isLast:W+1===r.length}})),_=B.useRef(null),$=Tn({count:L,overscan:2,horizontal:g==="horizontal",getScrollElement:function(){return _.current},estimateSize:function(){return g==="horizontal"?x:y}}),M=$.getVirtualItems(),b=B.useRef(0);B.useEffect(function(){var j,W;b.current=(j=(W=M[2])===null||W===void 0?void 0:W.index)!==null&&j!==void 0?j:0,_.current&&M[0]&&_.current.scrollTop<M[0].size&&(b.current=0)},[M]);var v=B.useCallback(function(){var j,W=(j=_.current)!==null&&j!==void 0?j:{},oe=W.scrollTop,H=oe===void 0?0:oe,J=W.scrollLeft,ne=J===void 0?0:J,Y=W.scrollWidth,ie=Y===void 0?0:Y,te=W.scrollHeight,se=te===void 0?0:te,K=W.offsetWidth,Z=K===void 0?0:K,G=W.offsetHeight,Se=G===void 0?0:G;if(g==="vertical"){if(se===Se)return 0;if(H===0)return 1;if(H>=se-Se-k*2)return 2}if(g==="horizontal"){if(ie===Z)return 0;if(Math.abs(ne)===0)return 1;if(Math.abs(ne)>=ie-Z-k*2)return 2}return 3},[g]),N=B.useState(0),F=Le(N,2),z=F[0],V=F[1],X=Sn(function(){return p==null?void 0:p(b.current)},[p]),O=B.useCallback(function(){V(v()),X()},[g,R]);return B.useEffect(function(){V(v())},[D,v]),B.useEffect(function(){if(R){var j,W,oe=(j=M[0])===null||j===void 0?void 0:j.index,H=M==null||(W=M.slice(-1).pop())===null||W===void 0?void 0:W.index,J=oe!==void 0&&r[oe]===null,ne=H!==void 0&&H===L-1&&L<a,Y=at(R);return J?Y(oe):!S&&ne&&Y(H+1),function(){return Y.cancel()}}},[R,M]),B.useLayoutEffect(function(){setTimeout(function(){E&&$.scrollToIndex(E,{align:"start"})},100)},[]),B.useImperativeHandle(T,function(){return{scrollToItem:function(W){$.scrollToIndex(W,{align:"auto"})},hilight:function(W){var oe;(oe=_.current)===null||oe===void 0||(oe=oe.querySelector(".hilight"))===null||oe===void 0||oe.classList.remove("hilight","ring-1"),$.scrollToIndex(Math.floor(W),{align:"auto"}),setTimeout(function(){var H;(H=_.current)===null||H===void 0||(H=H.querySelector('[data-index="'.concat(W,'"]')))===null||H===void 0||H.classList.add("hilight","ring-1")},100)},unhilight:function(){var W;(W=_.current)===null||W===void 0||(W=W.querySelector(".hilight"))===null||W===void 0||W.classList.remove("hilight","ring-1")}}},[$]),P.jsx("div",gr(gr({ref:_,onScroll:O,className:ae("area-content bg-base overflow-auto")},w),{},{children:P.jsxs("div",{className:ae("flex flex-nowrap gap-2 justify-center min-h-full min-w-full",g==="horizontal"&&"flex-col"),children:[P.jsxs("div",{className:ae("box-content inline-flex flex-nowrap",g==="vertical"&&"flex-col",g==="horizontal"&&"flex-row",l&&"flex-1",f==="sm"&&"p-1",f==="md"&&"p-2",f==="lg"&&"p-4"),style:{minWidth:c,maxWidth:u},children:[P.jsxs("div",{style:g==="vertical"?{height:$.getTotalSize()+k}:{width:$.getTotalSize()+k},children:[P.jsx("div",{style:g==="vertical"?{height:(i=M[0])===null||i===void 0?void 0:i.start}:{width:(e=M[0])===null||e===void 0?void 0:e.start,display:"inline-block"}}),M.map(function(j){var W=j.key,oe=j.index;return P.jsx("div",{"data-index":oe,ref:$.measureElement,className:ae("rounded-capped",g==="horizontal"?"inline-grid":"grid"),children:s(D[oe])},W)})]}),S&&P.jsx("div",{className:g==="horizontal"?"min-w-16":"",children:P.jsx(xn,{})})]}),!C&&P.jsx("div",{className:ae(g==="vertical"&&"self-end sticky bottom-2",g==="horizontal"&&"self-end sticky end-2"),children:P.jsx(An,{vertical:g==="vertical",scrollActive:z,onStart:function(){return $.scrollToIndex(0)},onPrevious:function(){return _.current&&$.scrollBy(-(g==="vertical"?_.current.offsetHeight:_.current.offsetWidth))},onNext:function(){return _.current&&$.scrollBy(g==="vertical"?_.current.offsetHeight:_.current.offsetWidth)},onEnd:function(){return $.scrollToIndex(L-1)}})})]})}))};Cn.displayName="VirtualList";var ka=B.memo;ka(Cn);var ai,vr;function ct(){return vr||(vr=1,ai=function(t){return t!==null&&typeof t=="object"&&typeof t.addUndirectedEdgeWithKey=="function"&&typeof t.dropNode=="function"&&typeof t.multi=="boolean"}),ai}var Na=ct();const Da=En(Na);function Ga(n){if(Array.isArray(n))return n}function Pa(n,t){var i=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(i!=null){var e,r,o,a,s=[],l=!0,u=!1;try{if(o=(i=i.call(n)).next,t===0){if(Object(i)!==i)return;l=!1}else for(;!(l=(e=o.call(i)).done)&&(s.push(e.value),s.length!==t);l=!0);}catch(c){u=!0,r=c}finally{try{if(!l&&i.return!=null&&(a=i.return(),Object(a)!==a))return}finally{if(u)throw r}}return s}}function zi(n,t){(t==null||t>n.length)&&(t=n.length);for(var i=0,e=Array(t);i<t;i++)e[i]=n[i];return e}function Ln(n,t){if(n){if(typeof n=="string")return zi(n,t);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?zi(n,t):void 0}}function za(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function st(n,t){return Ga(n)||Pa(n,t)||Ln(n,t)||za()}var si={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"},kn=new Int8Array(4),li=new Int32Array(kn.buffer,0,1),Oa=new Float32Array(kn.buffer,0,1),Ia=/^\s*rgba?\s*\(/,Fa=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function Ma(n){var t=0,i=0,e=0,r=1;if(n[0]==="#")n.length===4?(t=parseInt(n.charAt(1)+n.charAt(1),16),i=parseInt(n.charAt(2)+n.charAt(2),16),e=parseInt(n.charAt(3)+n.charAt(3),16)):(t=parseInt(n.charAt(1)+n.charAt(2),16),i=parseInt(n.charAt(3)+n.charAt(4),16),e=parseInt(n.charAt(5)+n.charAt(6),16)),n.length===9&&(r=parseInt(n.charAt(7)+n.charAt(8),16)/255);else if(Ia.test(n)){var o=n.match(Fa);o&&(t=+o[1],i=+o[2],e=+o[3],o[4]&&(r=+o[4]))}return{r:t,g:i,b:e,a:r}}var ot={};for(var It in si)ot[It]=ce(si[It]),ot[si[It]]=ot[It];function Nn(n,t,i,e,r){return li[0]=e<<24|i<<16|t<<8|n,li[0]=li[0]&4278190079,Oa[0]}function ce(n){if(n=n.toLowerCase(),typeof ot[n]<"u")return ot[n];var t=Ma(n),i=t.r,e=t.g,r=t.b,o=t.a;o=o*255|0;var a=Nn(i,e,r,o);return ot[n]=a,a}var ui={};function Dn(n){if(typeof ui[n]<"u")return ui[n];var t=(n&16711680)>>>16,i=(n&65280)>>>8,e=n&255,r=255,o=Nn(t,i,e,r);return ui[n]=o,o}function pr(n,t,i,e){return i+(t<<8)+(n<<16)}function mr(n,t,i,e,r,o){var a=Math.floor(i/o*r),s=Math.floor(n.drawingBufferHeight/o-e/o*r),l=new Uint8Array(4);n.bindFramebuffer(n.FRAMEBUFFER,t),n.readPixels(a,s,1,1,n.RGBA,n.UNSIGNED_BYTE,l);var u=st(l,4),c=u[0],d=u[1],f=u[2],h=u[3];return[c,d,f,h]}var $a=function(t){return t},Ua=function(t){return t*t},ja=function(t){return t*(2-t)},Ha=function(t){return(t*=2)<1?.5*t*t:-.5*(--t*(t-2)-1)},Va=function(t){return t*t*t},Ba=function(t){return--t*t*t+1},Wa=function(t){return(t*=2)<1?.5*t*t*t:.5*((t-=2)*t*t+2)},Gn={linear:$a,quadraticIn:Ua,quadraticOut:ja,quadraticInOut:Ha,cubicIn:Va,cubicOut:Ba,cubicInOut:Wa},Pn={easing:"quadraticInOut",duration:150};function ci(n,t,i,e){var r=Object.assign({},Pn,i),o=typeof r.easing=="function"?r.easing:Gn[r.easing],a=Date.now(),s={};for(var l in t){var u=t[l];s[l]={};for(var c in u)s[l][c]=n.getNodeAttribute(l,c)}var d=null,f=function(){d=null;var g=(Date.now()-a)/r.duration;if(g>=1){for(var m in t){var y=t[m];for(var A in y)n.setNodeAttribute(m,A,y[A])}typeof e=="function"&&e();return}g=o(g);for(var x in t){var C=t[x],E=s[x];for(var S in C)n.setNodeAttribute(x,S,C[S]*g+E[S]*(1-g))}d=requestAnimationFrame(f)};return f(),function(){d&&cancelAnimationFrame(d)}}function xe(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function Ft(n,t,i){return n[0]=t,n[4]=typeof i=="number"?i:t,n}function yr(n,t){var i=Math.sin(t),e=Math.cos(t);return n[0]=e,n[1]=i,n[3]=-i,n[4]=e,n}function br(n,t,i){return n[6]=t,n[7]=i,n}function Ge(n,t){var i=n[0],e=n[1],r=n[2],o=n[3],a=n[4],s=n[5],l=n[6],u=n[7],c=n[8],d=t[0],f=t[1],h=t[2],g=t[3],m=t[4],y=t[5],A=t[6],x=t[7],C=t[8];return n[0]=d*i+f*o+h*l,n[1]=d*e+f*a+h*u,n[2]=d*r+f*s+h*c,n[3]=g*i+m*o+y*l,n[4]=g*e+m*a+y*u,n[5]=g*r+m*s+y*c,n[6]=A*i+x*o+C*l,n[7]=A*e+x*a+C*u,n[8]=A*r+x*s+C*c,n}function Oi(n,t){var i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,e=n[0],r=n[1],o=n[3],a=n[4],s=n[6],l=n[7],u=t.x,c=t.y;return{x:u*e+c*o+s*i,y:u*r+c*a+l*i}}function zn(n,t){var i=n.height/n.width,e=t.height/t.width;return i<1&&e>1||i>1&&e<1?1:Math.min(Math.max(e,1/e),Math.max(1/i,i))}function mt(n,t,i,e,r){var o=n.angle,a=n.ratio,s=n.x,l=n.y,u=t.width,c=t.height,d=xe(),f=Math.min(u,c)-2*e,h=zn(t,i);return r?(Ge(d,br(xe(),s,l)),Ge(d,Ft(xe(),a)),Ge(d,yr(xe(),o)),Ge(d,Ft(xe(),u/f/2/h,c/f/2/h))):(Ge(d,Ft(xe(),2*(f/u)*h,2*(f/c)*h)),Ge(d,yr(xe(),-o)),Ge(d,Ft(xe(),1/a)),Ge(d,br(xe(),-s,-l))),d}function qa(n,t,i){var e=Oi(n,{x:Math.cos(t.angle),y:Math.sin(t.angle)},0),r=e.x,o=e.y;return 1/Math.sqrt(Math.pow(r,2)+Math.pow(o,2))/i.width}function Xa(n){if(!n.order)return{x:[0,1],y:[0,1]};var t=1/0,i=-1/0,e=1/0,r=-1/0;return n.forEachNode(function(o,a){var s=a.x,l=a.y;s<t&&(t=s),s>i&&(i=s),l<e&&(e=l),l>r&&(r=l)}),{x:[t,i],y:[e,r]}}function Ya(n){if(!Da(n))throw new Error("Sigma: invalid graph instance.");n.forEachNode(function(t,i){if(!Number.isFinite(i.x)||!Number.isFinite(i.y))throw new Error("Sigma: Coordinates of node ".concat(t," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function Ka(n,t,i){var e=document.createElement(n);if(t)for(var r in t)e.style[r]=t[r];if(i)for(var o in i)e.setAttribute(o,i[o]);return e}function _r(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}function Er(n,t,i){return i.sort(function(e,r){var o=t(e)||0,a=t(r)||0;return o<a?-1:o>a?1:0})}function wr(n){var t=st(n.x,2),i=t[0],e=t[1],r=st(n.y,2),o=r[0],a=r[1],s=Math.max(e-i,a-o),l=(e+i)/2,u=(a+o)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(l)&&(l=0),isNaN(u)&&(u=0);var c=function(f){return{x:.5+(f.x-l)/s,y:.5+(f.y-u)/s}};return c.applyTo=function(d){d.x=.5+(d.x-l)/s,d.y=.5+(d.y-u)/s},c.inverse=function(d){return{x:l+s*(d.x-.5),y:u+s*(d.y-.5)}},c.ratio=s,c}function Ii(n){"@babel/helpers - typeof";return Ii=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(t){return typeof t}:function(t){return t&&typeof Symbol=="function"&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Ii(n)}function xr(n,t){var i=t.size;if(i!==0){var e=n.length;n.length+=i;var r=0;t.forEach(function(o){n[e+r]=o,r++})}}function di(n){n=n||{};for(var t=0,i=arguments.length<=1?0:arguments.length-1;t<i;t++){var e=t+1<1||arguments.length<=t+1?void 0:arguments[t+1];e&&Object.assign(n,e)}return n}function Fi(){Fi=function(){return t};var n,t={},i=Object.prototype,e=i.hasOwnProperty,r=Object.defineProperty||function(b,v,N){b[v]=N.value},o=typeof Symbol=="function"?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",l=o.toStringTag||"@@toStringTag";function u(b,v,N){return Object.defineProperty(b,v,{value:N,enumerable:!0,configurable:!0,writable:!0}),b[v]}try{u({},"")}catch{u=function(v,N,F){return v[N]=F}}function c(b,v,N,F){var z=v&&v.prototype instanceof A?v:A,V=Object.create(z.prototype),X=new $(F||[]);return r(V,"_invoke",{value:L(b,N,X)}),V}function d(b,v,N){try{return{type:"normal",arg:b.call(v,N)}}catch(F){return{type:"throw",arg:F}}}t.wrap=c;var f="suspendedStart",h="suspendedYield",g="executing",m="completed",y={};function A(){}function x(){}function C(){}var E={};u(E,a,function(){return this});var S=Object.getPrototypeOf,R=S&&S(S(M([])));R&&R!==i&&e.call(R,a)&&(E=R);var p=C.prototype=A.prototype=Object.create(E);function T(b){["next","throw","return"].forEach(function(v){u(b,v,function(N){return this._invoke(v,N)})})}function w(b,v){function N(z,V,X,O){var j=d(b[z],b,V);if(j.type!=="throw"){var W=j.arg,oe=W.value;return oe&&typeof oe=="object"&&e.call(oe,"__await")?v.resolve(oe.__await).then(function(H){N("next",H,X,O)},function(H){N("throw",H,X,O)}):v.resolve(oe).then(function(H){W.value=H,X(W)},function(H){return N("throw",H,X,O)})}O(j.arg)}var F;r(this,"_invoke",{value:function(z,V){function X(){return new v(function(O,j){N(z,V,O,j)})}return F=F?F.then(X,X):X()}})}function L(b,v,N){var F=f;return function(z,V){if(F===g)throw Error("Generator is already running");if(F===m){if(z==="throw")throw V;return{value:n,done:!0}}for(N.method=z,N.arg=V;;){var X=N.delegate;if(X){var O=k(X,N);if(O){if(O===y)continue;return O}}if(N.method==="next")N.sent=N._sent=N.arg;else if(N.method==="throw"){if(F===f)throw F=m,N.arg;N.dispatchException(N.arg)}else N.method==="return"&&N.abrupt("return",N.arg);F=g;var j=d(b,v,N);if(j.type==="normal"){if(F=N.done?m:h,j.arg===y)continue;return{value:j.arg,done:N.done}}j.type==="throw"&&(F=m,N.method="throw",N.arg=j.arg)}}}function k(b,v){var N=v.method,F=b.iterator[N];if(F===n)return v.delegate=null,N==="throw"&&b.iterator.return&&(v.method="return",v.arg=n,k(b,v),v.method==="throw")||N!=="return"&&(v.method="throw",v.arg=new TypeError("The iterator does not provide a '"+N+"' method")),y;var z=d(F,b.iterator,v.arg);if(z.type==="throw")return v.method="throw",v.arg=z.arg,v.delegate=null,y;var V=z.arg;return V?V.done?(v[b.resultName]=V.value,v.next=b.nextLoc,v.method!=="return"&&(v.method="next",v.arg=n),v.delegate=null,y):V:(v.method="throw",v.arg=new TypeError("iterator result is not an object"),v.delegate=null,y)}function D(b){var v={tryLoc:b[0]};1 in b&&(v.catchLoc=b[1]),2 in b&&(v.finallyLoc=b[2],v.afterLoc=b[3]),this.tryEntries.push(v)}function _(b){var v=b.completion||{};v.type="normal",delete v.arg,b.completion=v}function $(b){this.tryEntries=[{tryLoc:"root"}],b.forEach(D,this),this.reset(!0)}function M(b){if(b||b===""){var v=b[a];if(v)return v.call(b);if(typeof b.next=="function")return b;if(!isNaN(b.length)){var N=-1,F=function z(){for(;++N<b.length;)if(e.call(b,N))return z.value=b[N],z.done=!1,z;return z.value=n,z.done=!0,z};return F.next=F}}throw new TypeError(typeof b+" is not iterable")}return x.prototype=C,r(p,"constructor",{value:C,configurable:!0}),r(C,"constructor",{value:x,configurable:!0}),x.displayName=u(C,l,"GeneratorFunction"),t.isGeneratorFunction=function(b){var v=typeof b=="function"&&b.constructor;return!!v&&(v===x||(v.displayName||v.name)==="GeneratorFunction")},t.mark=function(b){return Object.setPrototypeOf?Object.setPrototypeOf(b,C):(b.__proto__=C,u(b,l,"GeneratorFunction")),b.prototype=Object.create(p),b},t.awrap=function(b){return{__await:b}},T(w.prototype),u(w.prototype,s,function(){return this}),t.AsyncIterator=w,t.async=function(b,v,N,F,z){z===void 0&&(z=Promise);var V=new w(c(b,v,N,F),z);return t.isGeneratorFunction(v)?V:V.next().then(function(X){return X.done?X.value:V.next()})},T(p),u(p,l,"Generator"),u(p,a,function(){return this}),u(p,"toString",function(){return"[object Generator]"}),t.keys=function(b){var v=Object(b),N=[];for(var F in v)N.push(F);return N.reverse(),function z(){for(;N.length;){var V=N.pop();if(V in v)return z.value=V,z.done=!1,z}return z.done=!0,z}},t.values=M,$.prototype={constructor:$,reset:function(b){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(_),!b)for(var v in this)v.charAt(0)==="t"&&e.call(this,v)&&!isNaN(+v.slice(1))&&(this[v]=n)},stop:function(){this.done=!0;var b=this.tryEntries[0].completion;if(b.type==="throw")throw b.arg;return this.rval},dispatchException:function(b){if(this.done)throw b;var v=this;function N(j,W){return V.type="throw",V.arg=b,v.next=j,W&&(v.method="next",v.arg=n),!!W}for(var F=this.tryEntries.length-1;F>=0;--F){var z=this.tryEntries[F],V=z.completion;if(z.tryLoc==="root")return N("end");if(z.tryLoc<=this.prev){var X=e.call(z,"catchLoc"),O=e.call(z,"finallyLoc");if(X&&O){if(this.prev<z.catchLoc)return N(z.catchLoc,!0);if(this.prev<z.finallyLoc)return N(z.finallyLoc)}else if(X){if(this.prev<z.catchLoc)return N(z.catchLoc,!0)}else{if(!O)throw Error("try statement without catch or finally");if(this.prev<z.finallyLoc)return N(z.finallyLoc)}}}},abrupt:function(b,v){for(var N=this.tryEntries.length-1;N>=0;--N){var F=this.tryEntries[N];if(F.tryLoc<=this.prev&&e.call(F,"finallyLoc")&&this.prev<F.finallyLoc){var z=F;break}}z&&(b==="break"||b==="continue")&&z.tryLoc<=v&&v<=z.finallyLoc&&(z=null);var V=z?z.completion:{};return V.type=b,V.arg=v,z?(this.method="next",this.next=z.finallyLoc,y):this.complete(V)},complete:function(b,v){if(b.type==="throw")throw b.arg;return b.type==="break"||b.type==="continue"?this.next=b.arg:b.type==="return"?(this.rval=this.arg=b.arg,this.method="return",this.next="end"):b.type==="normal"&&v&&(this.next=v),y},finish:function(b){for(var v=this.tryEntries.length-1;v>=0;--v){var N=this.tryEntries[v];if(N.finallyLoc===b)return this.complete(N.completion,N.afterLoc),_(N),y}},catch:function(b){for(var v=this.tryEntries.length-1;v>=0;--v){var N=this.tryEntries[v];if(N.tryLoc===b){var F=N.completion;if(F.type==="throw"){var z=F.arg;_(N)}return z}}throw Error("illegal catch attempt")},delegateYield:function(b,v,N){return this.delegate={iterator:M(b),resultName:v,nextLoc:N},this.method==="next"&&(this.arg=n),y}},t}function Tr(n,t,i,e,r,o,a){try{var s=n[o](a),l=s.value}catch(u){return void i(u)}s.done?t(l):Promise.resolve(l).then(e,r)}function Za(n){return function(){var t=this,i=arguments;return new Promise(function(e,r){var o=n.apply(t,i);function a(l){Tr(o,e,r,a,s,"next",l)}function s(l){Tr(o,e,r,a,s,"throw",l)}a(void 0)})}}function Qa(n,t){if(typeof n!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var e=i.call(n,t);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function Ja(n){var t=Qa(n,"string");return typeof t=="symbol"?t:t+""}function es(n,t,i){return(t=Ja(t))in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function Sr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function Kt(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Sr(Object(i),!0).forEach(function(e){es(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Sr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}var ts={animate:!0};function is(n,t){if(!t.length)throw new Error("getCameraStateToFitViewportToNodes: There should be at least one node.");var i=1/0,e=-1/0,r=1/0,o=-1/0,a=1/0,s=-1/0,l=1/0,u=-1/0,c=n.getGraph();t.forEach(function(L){var k=n.getNodeDisplayData(L);if(!k)throw new Error("getCameraStateToFitViewportToNodes: Node ".concat(L," not found in sigma's graph."));var D=c.getNodeAttributes(L),_=D.x,$=D.y,M=k.x,b=k.y;i=Math.min(i,_),e=Math.max(e,_),r=Math.min(r,$),o=Math.max(o,$),a=Math.min(a,M),s=Math.max(s,M),l=Math.min(l,b),u=Math.max(u,b)});var d=n.getCustomBBox()||n.getBBox(),f=d.x,h=d.y,g=f[1]-f[0]||1,m=h[1]-h[0]||1,y=(a+s)/2,A=(l+u)/2,x=e-i||g,C=o-r||m,E=n.getDimensions(),S=E.width,R=E.height,p=zn({width:S,height:R},{width:g,height:m}),T=(C/x<R/S?x:C)/Math.max(g,m)*p,w=n.getCamera();return Kt(Kt({},w.getState()),{},{angle:0,x:y,y:A,ratio:T})}function Ar(n,t){return Mi.apply(this,arguments)}function Mi(){return Mi=Za(Fi().mark(function n(t,i){var e,r,o,a,s,l=arguments;return Fi().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(e=l.length>2&&l[2]!==void 0?l[2]:{},r=Kt(Kt({},ts),e),o=r.animate,a=t.getCamera(),s=is(t,i),!o){c.next=9;break}return c.next=7,a.animate(s);case 7:c.next=10;break;case 9:a.setState(s);case 10:case"end":return c.stop()}},n)})),Mi.apply(this,arguments)}const rs=n=>{const t=B.useRef(!1),i=B.useRef([]),e=B.useRef(void 0),r=B.useRef(null),[o,a]=B.useState(!1),s=B.useRef(!1);B.useEffect(()=>{s.current=o},[o]);const l=y=>{if(t.current=!0,e.current){r.current=e.current.getContext("2d"),r.current&&(r.current.setLineDash([2,4]),r.current.lineWidth=2,r.current.strokeStyle="#3a766c40",r.current.fillStyle="#3a766c10",r.current.lineJoin="round",r.current.lineCap="round");const A=e.current.getBoundingClientRect();i.current=[{x:y.clientX-A.left,y:y.clientY-A.top}]}y.stopImmediatePropagation(),y.stopPropagation(),y.preventDefault()},u=y=>{if(t&&e.current){const A=e.current.getBoundingClientRect();if(r.current){if(s.current==="rectangle"){r.current.clearRect(0,0,e.current.width,e.current.height);const{x,y:C}=i.current[0];r.current.beginPath(),r.current.rect(Math.min(x,y.clientX),Math.min(C,y.clientY),Math.abs(y.clientX-A.left-x),Math.abs(y.clientY-A.top-C)),r.current.stroke(),r.current.fill()}if(s.current==="lasso"){i.current.push({x:y.clientX-A.left,y:y.clientY-A.top}),r.current.clearRect(0,0,r.current.canvas.width,r.current.canvas.height);let x=i.current[0],C=i.current[1];const E=i.current.length,S=function(R,p){return{x:R.x+(p.x-R.x)/2,y:R.y+(p.y-R.y)/2}};r.current.beginPath(),r.current.moveTo(x.x,x.y);for(let R=1;R<E;R++){const p=S(x,C);r.current.quadraticCurveTo(x.x,x.y,p.x,p.y),x=i.current[R],C=i.current[R+1]}r.current.lineTo(x.x,x.y),r.current.stroke(),r.current.fill()}}}},c=y=>{if(!n||!t)return;Array.from(n.getGraph().nodes()).forEach(x=>{var T,w;if(!n)return;const{x:C=0,y:E=0,hidden:S}=n.getNodeDisplayData(x),{x:R,y:p}=n.framedGraphToViewport({x:C,y:E});y.shiftKey?(T=r.current)!=null&&T.isPointInPath(R,p)&&!S&&n.getGraph().setNodeAttribute(x,"selected",!0):!S&&n.getGraph().setNodeAttribute(x,"selected",(w=r.current)==null?void 0:w.isPointInPath(R,p))}),f()},d=()=>{if(!n)return;e.current=document.createElement("canvas");const y=n.getContainer().getBoundingClientRect();e.current.width=y.width,e.current.height=y.height,e.current.style.setProperty("inset","0"),e.current.style.setProperty("position","absolute"),n.getContainer().appendChild(e.current),e.current.style.cursor="crosshair",e.current.addEventListener("mousedown",l,{capture:!0}),document.addEventListener("mousemove",u),document.addEventListener("mouseup",c)},f=()=>{var y;r.current&&(r.current.clearRect(0,0,r.current.canvas.width,r.current.canvas.height),r.current=null),e.current&&((y=e.current)==null||y.remove()),document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",c),t.current=!1,a(!1)};return{selectionMode:o,startRectangleSelection:()=>{a("rectangle"),d()},startLassoSelection:()=>{a("lasso"),d()},cancelSelection:()=>{f()}}};function ns(n,t){if(typeof n!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var e=i.call(n,t);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function Rt(n){var t=ns(n,"string");return typeof t=="symbol"?t:t+""}function ve(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function Rr(n,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,Rt(e.key),e)}}function pe(n,t,i){return t&&Rr(n.prototype,t),i&&Rr(n,i),Object.defineProperty(n,"prototype",{writable:!1}),n}function lt(n){return lt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lt(n)}function On(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(On=function(){return!!n})()}function os(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function as(n,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return os(n)}function _e(n,t,i){return t=lt(t),as(n,On()?Reflect.construct(t,i||[],lt(n).constructor):t.apply(n,i))}function $i(n,t){return $i=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},$i(n,t)}function Ee(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&$i(n,t)}function I(n,t,i){return(t=Rt(t))in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function Cr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function Q(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?Cr(Object(i),!0).forEach(function(e){I(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Cr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function ss(n,t){for(;!{}.hasOwnProperty.call(n,t)&&(n=lt(n))!==null;);return n}function Ui(){return Ui=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,t,i){var e=ss(n,t);if(e){var r=Object.getOwnPropertyDescriptor(e,t);return r.get?r.get.call(arguments.length<3?n:i):r.value}},Ui.apply(null,arguments)}function In(n,t,i,e){var r=Ui(lt(n.prototype),t,i);return typeof r=="function"?function(o){return r.apply(i,o)}:r}function ls(n){return n.normalized?1:n.size}function hi(n){var t=0;return n.forEach(function(i){return t+=ls(i)}),t}function Fn(n,t,i){var e=n==="VERTEX"?t.VERTEX_SHADER:t.FRAGMENT_SHADER,r=t.createShader(e);if(r===null)throw new Error("loadShader: error while creating the shader");t.shaderSource(r,i),t.compileShader(r);var o=t.getShaderParameter(r,t.COMPILE_STATUS);if(!o){var a=t.getShaderInfoLog(r);throw t.deleteShader(r),new Error(`loadShader: error while compiling the shader:
`.concat(a,`
`).concat(i))}return r}function us(n,t){return Fn("VERTEX",n,t)}function cs(n,t){return Fn("FRAGMENT",n,t)}function ds(n,t){var i=n.createProgram();if(i===null)throw new Error("loadProgram: error while creating the program.");var e,r;for(e=0,r=t.length;e<r;e++)n.attachShader(i,t[e]);n.linkProgram(i);var o=n.getProgramParameter(i,n.LINK_STATUS);if(!o)throw n.deleteProgram(i),new Error("loadProgram: error while linking the program.");return i}function Lr(n){var t=n.gl,i=n.buffer,e=n.program,r=n.vertexShader,o=n.fragmentShader;t.deleteShader(r),t.deleteShader(o),t.deleteProgram(e),t.deleteBuffer(i)}var kr=`#define PICKING_MODE
`,hs=I(I(I(I(I(I(I(I({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4),Mn=function(){function n(t,i,e){ve(this,n),I(this,"array",new Float32Array),I(this,"constantArray",new Float32Array),I(this,"capacity",0),I(this,"verticesCount",0);var r=this.getDefinition();if(this.VERTICES=r.VERTICES,this.VERTEX_SHADER_SOURCE=r.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=r.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=r.UNIFORMS,this.ATTRIBUTES=r.ATTRIBUTES,this.METHOD=r.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in r?r.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in r?r.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in r,this.ATTRIBUTES_ITEMS_COUNT=hi(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=e,this.normalProgram=this.getProgramInfo("normal",t,r.VERTEX_SHADER_SOURCE,r.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=i?this.getProgramInfo("pick",t,kr+r.VERTEX_SHADER_SOURCE,kr+r.FRAGMENT_SHADER_SOURCE,i):null,this.isInstanced){var o=hi(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw new Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*o);for(var a=0;a<this.CONSTANT_DATA.length;a++){var s=this.CONSTANT_DATA[a];if(s.length!==o)throw new Error("Program: error while getting constant data (one vector has ".concat(s.length," items instead of ").concat(o,")"));for(var l=0;l<s.length;l++)this.constantArray[a*o+l]=s[l]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return pe(n,[{key:"kill",value:function(){Lr(this.normalProgram),this.pickProgram&&(Lr(this.pickProgram),this.pickProgram=null)}},{key:"getProgramInfo",value:function(i,e,r,o,a){var s=this.getDefinition(),l=e.createBuffer();if(l===null)throw new Error("Program: error while creating the WebGL buffer.");var u=us(e,r),c=cs(e,o),d=ds(e,[u,c]),f={};s.UNIFORMS.forEach(function(m){var y=e.getUniformLocation(d,m);y&&(f[m]=y)});var h={};s.ATTRIBUTES.forEach(function(m){h[m.name]=e.getAttribLocation(d,m.name)});var g;if("CONSTANT_ATTRIBUTES"in s&&(s.CONSTANT_ATTRIBUTES.forEach(function(m){h[m.name]=e.getAttribLocation(d,m.name)}),g=e.createBuffer(),g===null))throw new Error("Program: error while creating the WebGL constant buffer.");return{name:i,program:d,gl:e,frameBuffer:a,buffer:l,constantBuffer:g||{},uniformLocations:f,attributeLocations:h,isPicking:i==="pick",vertexShader:u,fragmentShader:c}}},{key:"bindProgram",value:function(i){var e=this,r=0,o=i.gl,a=i.buffer;this.isInstanced?(o.bindBuffer(o.ARRAY_BUFFER,i.constantBuffer),r=0,this.CONSTANT_ATTRIBUTES.forEach(function(s){return r+=e.bindAttribute(s,i,r,!1)}),o.bufferData(o.ARRAY_BUFFER,this.constantArray,o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,i.buffer),r=0,this.ATTRIBUTES.forEach(function(s){return r+=e.bindAttribute(s,i,r,!0)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)):(o.bindBuffer(o.ARRAY_BUFFER,a),r=0,this.ATTRIBUTES.forEach(function(s){return r+=e.bindAttribute(s,i,r)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)),o.bindBuffer(o.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(i){var e=this;this.isInstanced?(this.CONSTANT_ATTRIBUTES.forEach(function(r){return e.unbindAttribute(r,i,!1)}),this.ATTRIBUTES.forEach(function(r){return e.unbindAttribute(r,i,!0)})):this.ATTRIBUTES.forEach(function(r){return e.unbindAttribute(r,i)})}},{key:"bindAttribute",value:function(i,e,r,o){var a=hs[i.type];if(typeof a!="number")throw new Error('Program.bind: yet unsupported attribute type "'.concat(i.type,'"'));var s=e.attributeLocations[i.name],l=e.gl;if(s!==-1){l.enableVertexAttribArray(s);var u=this.isInstanced?(o?this.ATTRIBUTES_ITEMS_COUNT:hi(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT:this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT;if(l.vertexAttribPointer(s,i.size,i.type,i.normalized||!1,u,r),this.isInstanced&&o)if(l instanceof WebGL2RenderingContext)l.vertexAttribDivisor(s,1);else{var c=l.getExtension("ANGLE_instanced_arrays");c&&c.vertexAttribDivisorANGLE(s,1)}}return i.size*a}},{key:"unbindAttribute",value:function(i,e,r){var o=e.attributeLocations[i.name],a=e.gl;if(o!==-1&&(a.disableVertexAttribArray(o),this.isInstanced&&r))if(a instanceof WebGL2RenderingContext)a.vertexAttribDivisor(o,0);else{var s=a.getExtension("ANGLE_instanced_arrays");s&&s.vertexAttribDivisorANGLE(o,0)}}},{key:"reallocate",value:function(i){i!==this.capacity&&(this.capacity=i,this.verticesCount=this.VERTICES*i,this.array=new Float32Array(this.isInstanced?this.capacity*this.ATTRIBUTES_ITEMS_COUNT:this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT))}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(i,e){var r=e.gl,o=e.program;r.enable(r.BLEND),r.useProgram(o),this.setUniforms(i,e),this.drawWebGL(this.METHOD,e)}},{key:"render",value:function(i){this.hasNothingToRender()||(this.pickProgram&&(this.pickProgram.gl.viewport(0,0,i.width*i.pixelRatio/i.downSizingRatio,i.height*i.pixelRatio/i.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(Q(Q({},i),{},{pixelRatio:i.pixelRatio/i.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram)),this.normalProgram.gl.viewport(0,0,i.width*i.pixelRatio,i.height*i.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(i,this.normalProgram),this.unbindProgram(this.normalProgram))}},{key:"drawWebGL",value:function(i,e){var r=e.gl,o=e.frameBuffer;if(r.bindFramebuffer(r.FRAMEBUFFER,o),!this.isInstanced)r.drawArrays(i,0,this.verticesCount);else if(r instanceof WebGL2RenderingContext)r.drawArraysInstanced(i,0,this.VERTICES,this.capacity);else{var a=r.getExtension("ANGLE_instanced_arrays");a&&a.drawArraysInstancedANGLE(i,0,this.VERTICES,this.capacity)}}}])}(),Ne=function(n){function t(){return ve(this,t),_e(this,t,arguments)}return Ee(t,n),pe(t,[{key:"kill",value:function(){In(t,"kill",this)([])}},{key:"process",value:function(e,r,o){var a=r*this.STRIDE;if(o.hidden){for(var s=a+this.STRIDE;a<s;a++)this.array[a]=0;return}return this.processVisibleItem(Dn(e),a,o)}}])}(Mn);function $n(n,t,i){return function(){function e(r,o,a){ve(this,e),I(this,"drawLabel",t),I(this,"drawHover",i),this.programs=n.map(function(s){return new s(r,o,a)})}return pe(e,[{key:"reallocate",value:function(o){this.programs.forEach(function(a){return a.reallocate(o)})}},{key:"process",value:function(o,a,s){this.programs.forEach(function(l){return l.process(o,a,s)})}},{key:"render",value:function(o){this.programs.forEach(function(a){return a.render(o)})}},{key:"kill",value:function(){this.programs.forEach(function(o){return o.kill()})}}])}()}var dt=function(n){function t(){var i;ve(this,t);for(var e=arguments.length,r=new Array(e),o=0;o<e;o++)r[o]=arguments[o];return i=_e(this,t,[].concat(r)),I(i,"drawLabel",void 0),i}return Ee(t,n),pe(t,[{key:"kill",value:function(){In(t,"kill",this)([])}},{key:"process",value:function(e,r,o,a,s){var l=r*this.STRIDE;if(s.hidden||o.hidden||a.hidden){for(var u=l+this.STRIDE;l<u;l++)this.array[l]=0;return}return this.processVisibleItem(Dn(e),l,o,a,s)}}])}(Mn);function fs(n,t){return function(){function i(e,r,o){ve(this,i),I(this,"drawLabel",t),this.programs=n.map(function(a){return new a(e,r,o)})}return pe(i,[{key:"reallocate",value:function(r){this.programs.forEach(function(o){return o.reallocate(r)})}},{key:"process",value:function(r,o,a,s,l){this.programs.forEach(function(u){return u.process(r,o,a,s,l)})}},{key:"render",value:function(r){this.programs.forEach(function(o){return o.render(r)})}},{key:"kill",value:function(){this.programs.forEach(function(r){return r.kill()})}}])}()}function gs(n,t,i,e,r){var o=r.edgeLabelSize,a=r.edgeLabelFont,s=r.edgeLabelWeight,l=r.edgeLabelColor.attribute?t[r.edgeLabelColor.attribute]||r.edgeLabelColor.color||"#000":r.edgeLabelColor.color,u=t.label;if(u){n.fillStyle=l,n.font="".concat(s," ").concat(o,"px ").concat(a);var c=i.size,d=e.size,f=i.x,h=i.y,g=e.x,m=e.y,y=(f+g)/2,A=(h+m)/2,x=g-f,C=m-h,E=Math.sqrt(x*x+C*C);if(!(E<c+d)){f+=x*c/E,h+=C*c/E,g-=x*d/E,m-=C*d/E,y=(f+g)/2,A=(h+m)/2,x=g-f,C=m-h,E=Math.sqrt(x*x+C*C);var S=n.measureText(u).width;if(S>E){var R="…";for(u=u+R,S=n.measureText(u).width;S>E&&u.length>1;)u=u.slice(0,-2)+R,S=n.measureText(u).width;if(u.length<4)return}var p;x>0?C>0?p=Math.acos(x/E):p=Math.asin(C/E):C>0?p=Math.acos(x/E)+Math.PI:p=Math.asin(x/E)+Math.PI/2,n.save(),n.translate(y,A),n.rotate(p),n.fillText(u,-S/2,t.size/2+o),n.restore()}}}function Un(n,t,i){if(t.label){var e=i.labelSize,r=i.labelFont,o=i.labelWeight,a=i.labelColor.attribute?t[i.labelColor.attribute]||i.labelColor.color||"#000":i.labelColor.color;n.fillStyle=a,n.font="".concat(o," ").concat(e,"px ").concat(r),n.fillText(t.label,t.x+t.size+3,t.y+e/3)}}function vs(n,t,i){var e=i.labelSize,r=i.labelFont,o=i.labelWeight;n.font="".concat(o," ").concat(e,"px ").concat(r),n.fillStyle="#FFF",n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=8,n.shadowColor="#000";var a=2;if(typeof t.label=="string"){var s=n.measureText(t.label).width,l=Math.round(s+5),u=Math.round(e+2*a),c=Math.max(t.size,e/2)+a,d=Math.asin(u/2/c),f=Math.sqrt(Math.abs(Math.pow(c,2)-Math.pow(u/2,2)));n.beginPath(),n.moveTo(t.x+f,t.y+u/2),n.lineTo(t.x+c+l,t.y+u/2),n.lineTo(t.x+c+l,t.y-u/2),n.lineTo(t.x+f,t.y-u/2),n.arc(t.x,t.y,c,d,-d),n.closePath(),n.fill()}else n.beginPath(),n.arc(t.x,t.y,t.size+a,0,Math.PI*2),n.closePath(),n.fill();n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,Un(n,t,i)}var ps=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,ms=ps,ys=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,bs=ys,jn=WebGLRenderingContext,Nr=jn.UNSIGNED_BYTE,fi=jn.FLOAT,_s=["u_sizeRatio","u_correctionRatio","u_matrix"],ei=function(n){function t(){return ve(this,t),_e(this,t,arguments)}return Ee(t,n),pe(t,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:bs,FRAGMENT_SHADER_SOURCE:ms,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:_s,ATTRIBUTES:[{name:"a_position",size:2,type:fi},{name:"a_size",size:1,type:fi},{name:"a_color",size:4,type:Nr,normalized:!0},{name:"a_id",size:4,type:Nr,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:fi}],CONSTANT_DATA:[[t.ANGLE_1],[t.ANGLE_2],[t.ANGLE_3]]}}},{key:"processVisibleItem",value:function(e,r,o){var a=this.array,s=ce(o.color);a[r++]=o.x,a[r++]=o.y,a[r++]=o.size,a[r++]=s,a[r++]=e}},{key:"setUniforms",value:function(e,r){var o=r.gl,a=r.uniformLocations,s=a.u_sizeRatio,l=a.u_correctionRatio,u=a.u_matrix;o.uniform1f(l,e.correctionRatio),o.uniform1f(s,e.sizeRatio),o.uniformMatrix3fv(u,!1,e.matrix)}}])}(Ne);I(ei,"ANGLE_1",0);I(ei,"ANGLE_2",2*Math.PI/3);I(ei,"ANGLE_3",4*Math.PI/3);var Es=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,ws=Es,xs=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Ts=xs,Hn=WebGLRenderingContext,Dr=Hn.UNSIGNED_BYTE,Mt=Hn.FLOAT,Ss=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],ti={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function Vn(n){var t=Q(Q({},ti),{});return function(i){function e(){return ve(this,e),_e(this,e,arguments)}return Ee(e,i),pe(e,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Ts,FRAGMENT_SHADER_SOURCE:ws,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ss,ATTRIBUTES:[{name:"a_position",size:2,type:Mt},{name:"a_normal",size:2,type:Mt},{name:"a_radius",size:1,type:Mt},{name:"a_color",size:4,type:Dr,normalized:!0},{name:"a_id",size:4,type:Dr,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:Mt}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(o,a,s,l,u){if(t.extremity==="source"){var c=[l,s];s=c[0],l=c[1]}var d=u.size||1,f=l.size||1,h=s.x,g=s.y,m=l.x,y=l.y,A=ce(u.color),x=m-h,C=y-g,E=x*x+C*C,S=0,R=0;E&&(E=1/Math.sqrt(E),S=-C*E*d,R=x*E*d);var p=this.array;p[a++]=m,p[a++]=y,p[a++]=-S,p[a++]=-R,p[a++]=f,p[a++]=A,p[a++]=o}},{key:"setUniforms",value:function(o,a){var s=a.gl,l=a.uniformLocations,u=l.u_matrix,c=l.u_sizeRatio,d=l.u_correctionRatio,f=l.u_minEdgeThickness,h=l.u_lengthToThicknessRatio,g=l.u_widenessToThicknessRatio;s.uniformMatrix3fv(u,!1,o.matrix),s.uniform1f(c,o.sizeRatio),s.uniform1f(d,o.correctionRatio),s.uniform1f(f,o.minEdgeThickness),s.uniform1f(h,t.lengthToThicknessRatio),s.uniform1f(g,t.widenessToThicknessRatio)}}])}(dt)}Vn();var As=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Bn=As,Rs=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Cs=Rs,Wn=WebGLRenderingContext,Gr=Wn.UNSIGNED_BYTE,je=Wn.FLOAT,Ls=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],ks={lengthToThicknessRatio:ti.lengthToThicknessRatio};function qn(n){var t=Q(Q({},ks),{});return function(i){function e(){return ve(this,e),_e(this,e,arguments)}return Ee(e,i),pe(e,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Cs,FRAGMENT_SHADER_SOURCE:Bn,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ls,ATTRIBUTES:[{name:"a_positionStart",size:2,type:je},{name:"a_positionEnd",size:2,type:je},{name:"a_normal",size:2,type:je},{name:"a_color",size:4,type:Gr,normalized:!0},{name:"a_id",size:4,type:Gr,normalized:!0},{name:"a_radius",size:1,type:je}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:je},{name:"a_normalCoef",size:1,type:je},{name:"a_radiusCoef",size:1,type:je}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(o,a,s,l,u){var c=u.size||1,d=s.x,f=s.y,h=l.x,g=l.y,m=ce(u.color),y=h-d,A=g-f,x=l.size||1,C=y*y+A*A,E=0,S=0;C&&(C=1/Math.sqrt(C),E=-A*C*c,S=y*C*c);var R=this.array;R[a++]=d,R[a++]=f,R[a++]=h,R[a++]=g,R[a++]=E,R[a++]=S,R[a++]=m,R[a++]=o,R[a++]=x}},{key:"setUniforms",value:function(o,a){var s=a.gl,l=a.uniformLocations,u=l.u_matrix,c=l.u_zoomRatio,d=l.u_feather,f=l.u_pixelRatio,h=l.u_correctionRatio,g=l.u_sizeRatio,m=l.u_minEdgeThickness,y=l.u_lengthToThicknessRatio;s.uniformMatrix3fv(u,!1,o.matrix),s.uniform1f(c,o.zoomRatio),s.uniform1f(g,o.sizeRatio),s.uniform1f(h,o.correctionRatio),s.uniform1f(f,o.pixelRatio),s.uniform1f(d,o.antiAliasingFeather),s.uniform1f(m,o.minEdgeThickness),s.uniform1f(y,t.lengthToThicknessRatio)}}])}(dt)}qn();function Ns(n){return fs([qn(),Vn()])}var Ds=Ns(),Gs=Ds,Ps=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,zs=Ps,Xn=WebGLRenderingContext,Pr=Xn.UNSIGNED_BYTE,yt=Xn.FLOAT,Os=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],Is=function(n){function t(){return ve(this,t),_e(this,t,arguments)}return Ee(t,n),pe(t,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:zs,FRAGMENT_SHADER_SOURCE:Bn,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Os,ATTRIBUTES:[{name:"a_positionStart",size:2,type:yt},{name:"a_positionEnd",size:2,type:yt},{name:"a_normal",size:2,type:yt},{name:"a_color",size:4,type:Pr,normalized:!0},{name:"a_id",size:4,type:Pr,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:yt},{name:"a_normalCoef",size:1,type:yt}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(e,r,o,a,s){var l=s.size||1,u=o.x,c=o.y,d=a.x,f=a.y,h=ce(s.color),g=d-u,m=f-c,y=g*g+m*m,A=0,x=0;y&&(y=1/Math.sqrt(y),A=-m*y*l,x=g*y*l);var C=this.array;C[r++]=u,C[r++]=c,C[r++]=d,C[r++]=f,C[r++]=A,C[r++]=x,C[r++]=h,C[r++]=e}},{key:"setUniforms",value:function(e,r){var o=r.gl,a=r.uniformLocations,s=a.u_matrix,l=a.u_zoomRatio,u=a.u_feather,c=a.u_pixelRatio,d=a.u_correctionRatio,f=a.u_sizeRatio,h=a.u_minEdgeThickness;o.uniformMatrix3fv(s,!1,e.matrix),o.uniform1f(l,e.zoomRatio),o.uniform1f(f,e.sizeRatio),o.uniform1f(d,e.correctionRatio),o.uniform1f(c,e.pixelRatio),o.uniform1f(u,e.antiAliasingFeather),o.uniform1f(h,e.minEdgeThickness)}}])}(dt);function Fs(n,t){if(typeof n!="object"||!n)return n;var i=n[Symbol.toPrimitive];if(i!==void 0){var e=i.call(n,t);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(t==="string"?String:Number)(n)}function Yn(n){var t=Fs(n,"string");return typeof t=="symbol"?t:t+""}function Kn(n,t,i){return(t=Yn(t))in n?Object.defineProperty(n,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):n[t]=i,n}function zr(n,t){var i=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);t&&(e=e.filter(function(r){return Object.getOwnPropertyDescriptor(n,r).enumerable})),i.push.apply(i,e)}return i}function ut(n){for(var t=1;t<arguments.length;t++){var i=arguments[t]!=null?arguments[t]:{};t%2?zr(Object(i),!0).forEach(function(e){Kn(n,e,i[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):zr(Object(i)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(i,e))})}return n}function Ms(n,t){if(!(n instanceof t))throw new TypeError("Cannot call a class as a function")}function $s(n,t){for(var i=0;i<t.length;i++){var e=t[i];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,Yn(e.key),e)}}function Us(n,t,i){return t&&$s(n.prototype,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function Zt(n){return Zt=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},Zt(n)}function Zn(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Zn=function(){return!!n})()}function Qn(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function js(n,t){if(t&&(typeof t=="object"||typeof t=="function"))return t;if(t!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return Qn(n)}function Hs(n,t,i){return t=Zt(t),js(n,Zn()?Reflect.construct(t,i||[],Zt(n).constructor):t.apply(n,i))}function ji(n,t){return ji=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(i,e){return i.__proto__=e,i},ji(n,t)}function Vs(n,t){if(typeof t!="function"&&t!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&ji(n,t)}function Hi(n,t){(t==null||t>n.length)&&(t=n.length);for(var i=0,e=Array(t);i<t;i++)e[i]=n[i];return e}function Bs(n){if(Array.isArray(n))return Hi(n)}function Ws(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function qs(n,t){if(n){if(typeof n=="string")return Hi(n,t);var i={}.toString.call(n).slice(8,-1);return i==="Object"&&n.constructor&&(i=n.constructor.name),i==="Map"||i==="Set"?Array.from(n):i==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?Hi(n,t):void 0}}function Xs(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function gi(n){return Bs(n)||Ws(n)||qs(n)||Xs()}function Jn(n,t,i,e){var r=Math.pow(1-n,2)*t.x+2*(1-n)*n*i.x+Math.pow(n,2)*e.x,o=Math.pow(1-n,2)*t.y+2*(1-n)*n*i.y+Math.pow(n,2)*e.y;return{x:r,y:o}}function Ys(n,t,i){for(var e=20,r=0,o=n,a=0;a<e;a++){var s=Jn((a+1)/e,n,t,i);r+=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2)),o=s}return r}function Ks(n){var t=n.curvatureAttribute,i=n.defaultCurvature,e=n.keepLabelUpright,r=e===void 0?!0:e;return function(o,a,s,l,u){var c=u.edgeLabelSize,d=a[t]||i,f=u.edgeLabelFont,h=u.edgeLabelWeight,g=u.edgeLabelColor.attribute?a[u.edgeLabelColor.attribute]||u.edgeLabelColor.color||"#000":u.edgeLabelColor.color,m=a.label;if(m){o.fillStyle=g,o.font="".concat(h," ").concat(c,"px ").concat(f);var y=!r||s.x<l.x,A=y?s.x:l.x,x=y?s.y:l.y,C=y?l.x:s.x,E=y?l.y:s.y,S=(A+C)/2,R=(x+E)/2,p=C-A,T=E-x,w=Math.sqrt(Math.pow(p,2)+Math.pow(T,2)),L=y?1:-1,k=S+T*d*L,D=R-p*d*L,_=a.size*.7+5,$={x:D-x,y:-(k-A)},M=Math.sqrt(Math.pow($.x,2)+Math.pow($.y,2)),b={x:E-D,y:-(C-k)},v=Math.sqrt(Math.pow(b.x,2)+Math.pow(b.y,2));A+=_*$.x/M,x+=_*$.y/M,C+=_*b.x/v,E+=_*b.y/v,k+=_*T/w,D-=_*p/w;var N={x:k,y:D},F={x:A,y:x},z={x:C,y:E},V=Ys(F,N,z);if(!(V<s.size+l.size)){var X=o.measureText(m).width,O=V-s.size-l.size;if(X>O){var j="…";for(m=m+j,X=o.measureText(m).width;X>O&&m.length>1;)m=m.slice(0,-2)+j,X=o.measureText(m).width;if(m.length<4)return}for(var W={},oe=0,H=m.length;oe<H;oe++){var J=m[oe];W[J]||(W[J]=o.measureText(J).width*(1+d*.35))}for(var ne=.5-X/V/2,Y=0,ie=m.length;Y<ie;Y++){var te=m[Y],se=Jn(ne,F,N,z),K=2*(1-ne)*(k-A)+2*ne*(C-k),Z=2*(1-ne)*(D-x)+2*ne*(E-D),G=Math.atan2(Z,K);o.save(),o.translate(se.x,se.y),o.rotate(G),o.fillText(te,0,0),o.restore(),ne+=W[te]/V}}}}}function Zs(n){var t=n.arrowHead,i=(t==null?void 0:t.extremity)==="target"||(t==null?void 0:t.extremity)==="both",e=(t==null?void 0:t.extremity)==="source"||(t==null?void 0:t.extremity)==="both",r=`
precision highp float;

varying vec4 v_color;
varying float v_thickness;
varying float v_feather;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;
`.concat(i?`
varying float v_targetSize;
varying vec2 v_targetPoint;`:"",`
`).concat(e?`
varying float v_sourceSize;
varying vec2 v_sourcePoint;`:"",`
`).concat(t?`
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;`:"",`

float det(vec2 a, vec2 b) {
  return a.x * b.y - b.x * a.y;
}

vec2 getDistanceVector(vec2 b0, vec2 b1, vec2 b2) {
  float a = det(b0, b2), b = 2.0 * det(b1, b0), d = 2.0 * det(b2, b1);
  float f = b * d - a * a;
  vec2 d21 = b2 - b1, d10 = b1 - b0, d20 = b2 - b0;
  vec2 gf = 2.0 * (b * d21 + d * d10 + a * d20);
  gf = vec2(gf.y, -gf.x);
  vec2 pp = -f * gf / dot(gf, gf);
  vec2 d0p = b0 - pp;
  float ap = det(d0p, d20), bp = 2.0 * det(d10, d0p);
  float t = clamp((ap + bp) / (2.0 * a + b + d), 0.0, 1.0);
  return mix(mix(b0, b1, t), mix(b1, b2, t), t);
}

float distToQuadraticBezierCurve(vec2 p, vec2 b0, vec2 b1, vec2 b2) {
  return length(getDistanceVector(b0 - p, b1 - p, b2 - p));
}

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = distToQuadraticBezierCurve(gl_FragCoord.xy, v_cpA, v_cpB, v_cpC);
  float thickness = v_thickness;
`).concat(i?`
  float distToTarget = length(gl_FragCoord.xy - v_targetPoint);
  float targetArrowLength = v_targetSize + thickness * u_lengthToThicknessRatio;
  if (distToTarget < targetArrowLength) {
    thickness = (distToTarget - v_targetSize) / (targetArrowLength - v_targetSize) * u_widenessToThicknessRatio * thickness;
  }`:"",`
`).concat(e?`
  float distToSource = length(gl_FragCoord.xy - v_sourcePoint);
  float sourceArrowLength = v_sourceSize + thickness * u_lengthToThicknessRatio;
  if (distToSource < sourceArrowLength) {
    thickness = (distToSource - v_sourceSize) / (sourceArrowLength - v_sourceSize) * u_widenessToThicknessRatio * thickness;
  }`:"",`

  float halfThickness = thickness / 2.0;
  if (dist < halfThickness) {
    #ifdef PICKING_MODE
    gl_FragColor = v_color;
    #else
    float t = smoothstep(
      halfThickness - v_feather,
      halfThickness,
      dist
    );

    gl_FragColor = mix(v_color, transparent, t);
    #endif
  } else {
    gl_FragColor = transparent;
  }
}
`);return r}function Qs(n){var t=n.arrowHead,i=(t==null?void 0:t.extremity)==="target"||(t==null?void 0:t.extremity)==="both",e=(t==null?void 0:t.extremity)==="source"||(t==null?void 0:t.extremity)==="both",r=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute float a_direction;
attribute float a_thickness;
attribute vec2 a_source;
attribute vec2 a_target;
attribute float a_current;
attribute float a_curvature;
`.concat(i?`attribute float a_targetSize;
`:"",`
`).concat(e?`attribute float a_sourceSize;
`:"",`

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform vec2 u_dimensions;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying float v_thickness;
varying float v_feather;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;
`).concat(i?`
varying float v_targetSize;
varying vec2 v_targetPoint;`:"",`
`).concat(e?`
varying float v_sourceSize;
varying vec2 v_sourcePoint;`:"",`
`).concat(t?`
uniform float u_widenessToThicknessRatio;`:"",`

const float bias = 255.0 / 254.0;
const float epsilon = 0.7;

vec2 clipspaceToViewport(vec2 pos, vec2 dimensions) {
  return vec2(
    (pos.x + 1.0) * dimensions.x / 2.0,
    (pos.y + 1.0) * dimensions.y / 2.0
  );
}

vec2 viewportToClipspace(vec2 pos, vec2 dimensions) {
  return vec2(
    pos.x / dimensions.x * 2.0 - 1.0,
    pos.y / dimensions.y * 2.0 - 1.0
  );
}

void main() {
  float minThickness = u_minEdgeThickness;

  // Selecting the correct position
  // Branchless "position = a_source if a_current == 1.0 else a_target"
  vec2 position = a_source * max(0.0, a_current) + a_target * max(0.0, 1.0 - a_current);
  position = (u_matrix * vec3(position, 1)).xy;

  vec2 source = (u_matrix * vec3(a_source, 1)).xy;
  vec2 target = (u_matrix * vec3(a_target, 1)).xy;

  vec2 viewportPosition = clipspaceToViewport(position, u_dimensions);
  vec2 viewportSource = clipspaceToViewport(source, u_dimensions);
  vec2 viewportTarget = clipspaceToViewport(target, u_dimensions);

  vec2 delta = viewportTarget.xy - viewportSource.xy;
  float len = length(delta);
  vec2 normal = vec2(-delta.y, delta.x) * a_direction;
  vec2 unitNormal = normal / len;
  float boundingBoxThickness = len * a_curvature;

  float curveThickness = max(minThickness, a_thickness / u_sizeRatio);
  v_thickness = curveThickness * u_pixelRatio;
  v_feather = u_feather;

  v_cpA = viewportSource;
  v_cpB = 0.5 * (viewportSource + viewportTarget) + unitNormal * a_direction * boundingBoxThickness;
  v_cpC = viewportTarget;

  vec2 viewportOffsetPosition = (
    viewportPosition +
    unitNormal * (boundingBoxThickness / 2.0 + sign(boundingBoxThickness) * (`).concat(t?"curveThickness * u_widenessToThicknessRatio":"curveThickness",` + epsilon)) *
    max(0.0, a_direction) // NOTE: cutting the bounding box in half to avoid overdraw
  );

  position = viewportToClipspace(viewportOffsetPosition, u_dimensions);
  gl_Position = vec4(position, 0, 1);
    
`).concat(i?`
  v_targetSize = a_targetSize * u_pixelRatio / u_sizeRatio;
  v_targetPoint = viewportTarget;
`:"",`
`).concat(e?`
  v_sourceSize = a_sourceSize * u_pixelRatio / u_sizeRatio;
  v_sourcePoint = viewportSource;
`:"",`

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`);return r}var Lt=.25,Js={arrowHead:null,curvatureAttribute:"curvature",defaultCurvature:Lt},el={edgeIndexAttribute:"parallelIndex",edgeMinIndexAttribute:"parallelMinIndex",edgeMaxIndexAttribute:"parallelMaxIndex"};function tl(n,t){var i=ut(ut({},el),t||{}),e={},r={},o={},a=0;n.forEachNode(function(R){e[R]=++a+""}),n.forEachEdge(function(R,p,T,w){var L=e[T],k=e[w],D=[L,k].join("-");r[R]=D,o[D]=[L,k].sort().join("-")});var s={},l={};n.forEachEdge(function(R){var p=r[R],T=o[p];s[p]=s[p]||[],s[p].push(R),l[T]=l[T]||[],l[T].push(R)});for(var u in s){var c=s[u],d=c.length,f=l[o[u]].length;if(d===1&&f===1){var h=c[0];n.setEdgeAttribute(h,i.edgeIndexAttribute,null),n.setEdgeAttribute(h,i.edgeMaxIndexAttribute,null)}else if(d===1){var g=c[0];n.setEdgeAttribute(g,i.edgeIndexAttribute,1),n.setEdgeAttribute(g,i.edgeMaxIndexAttribute,1)}else if(d===f)for(var m=(d-1)/2,y=-m,A=0;A<d;A++){var x=c[A],C=-(d-1)/2+A;n.setEdgeAttribute(x,i.edgeIndexAttribute,C),n.setEdgeAttribute(x,i.edgeMinIndexAttribute,y),n.setEdgeAttribute(x,i.edgeMaxIndexAttribute,m)}else for(var E=0;E<d;E++){var S=c[E];n.setEdgeAttribute(S,i.edgeIndexAttribute,E+1),n.setEdgeAttribute(S,i.edgeMaxIndexAttribute,d)}}}var eo=WebGLRenderingContext,Or=eo.UNSIGNED_BYTE,Pe=eo.FLOAT;function Zi(n){var t=ut(ut({},Js),n||{}),i=t,e=i.arrowHead,r=i.curvatureAttribute,o=i.drawLabel,a=(e==null?void 0:e.extremity)==="target"||(e==null?void 0:e.extremity)==="both",s=(e==null?void 0:e.extremity)==="source"||(e==null?void 0:e.extremity)==="both",l=["u_matrix","u_sizeRatio","u_dimensions","u_pixelRatio","u_feather","u_minEdgeThickness"].concat(gi(e?["u_lengthToThicknessRatio","u_widenessToThicknessRatio"]:[]));return function(u){Vs(c,u);function c(){var d;Ms(this,c);for(var f=arguments.length,h=new Array(f),g=0;g<f;g++)h[g]=arguments[g];return d=Hs(this,c,[].concat(h)),Kn(Qn(d),"drawLabel",o||Ks(t)),d}return Us(c,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Qs(t),FRAGMENT_SHADER_SOURCE:Zs(t),METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:l,ATTRIBUTES:[{name:"a_source",size:2,type:Pe},{name:"a_target",size:2,type:Pe}].concat(gi(a?[{name:"a_targetSize",size:1,type:Pe}]:[]),gi(s?[{name:"a_sourceSize",size:1,type:Pe}]:[]),[{name:"a_thickness",size:1,type:Pe},{name:"a_curvature",size:1,type:Pe},{name:"a_color",size:4,type:Or,normalized:!0},{name:"a_id",size:4,type:Or,normalized:!0}]),CONSTANT_ATTRIBUTES:[{name:"a_current",size:1,type:Pe},{name:"a_direction",size:1,type:Pe}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[0,-1],[1,1],[1,-1]]}}},{key:"processVisibleItem",value:function(f,h,g,m,y){var A,x=y.size||1,C=g.x,E=g.y,S=m.x,R=m.y,p=ce(y.color),T=(A=y[r])!==null&&A!==void 0?A:Lt,w=this.array;w[h++]=C,w[h++]=E,w[h++]=S,w[h++]=R,a&&(w[h++]=m.size),s&&(w[h++]=g.size),w[h++]=x,w[h++]=T,w[h++]=p,w[h++]=f}},{key:"setUniforms",value:function(f,h){var g=h.gl,m=h.uniformLocations,y=m.u_matrix,A=m.u_pixelRatio,x=m.u_feather,C=m.u_sizeRatio,E=m.u_dimensions,S=m.u_minEdgeThickness;if(g.uniformMatrix3fv(y,!1,f.matrix),g.uniform1f(A,f.pixelRatio),g.uniform1f(C,f.sizeRatio),g.uniform1f(x,f.antiAliasingFeather),g.uniform2f(E,f.width*f.pixelRatio,f.height*f.pixelRatio),g.uniform1f(S,f.minEdgeThickness),e){var R=m.u_lengthToThicknessRatio,p=m.u_widenessToThicknessRatio;g.uniform1f(R,e.lengthToThicknessRatio),g.uniform1f(p,e.widenessToThicknessRatio)}}}]),c}(dt)}Zi();Zi({arrowHead:ti});Zi({arrowHead:ut(ut({},ti),{},{extremity:"both"})});var $t={exports:{}},Ir;function il(){if(Ir)return $t.exports;Ir=1;var n=typeof Reflect=="object"?Reflect:null,t=n&&typeof n.apply=="function"?n.apply:function(S,R,p){return Function.prototype.apply.call(S,R,p)},i;n&&typeof n.ownKeys=="function"?i=n.ownKeys:Object.getOwnPropertySymbols?i=function(S){return Object.getOwnPropertyNames(S).concat(Object.getOwnPropertySymbols(S))}:i=function(S){return Object.getOwnPropertyNames(S)};function e(E){console&&console.warn&&console.warn(E)}var r=Number.isNaN||function(S){return S!==S};function o(){o.init.call(this)}$t.exports=o,$t.exports.once=A,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(E){if(typeof E!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof E)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(E){if(typeof E!="number"||E<0||r(E))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+E+".");a=E}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(S){if(typeof S!="number"||S<0||r(S))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+S+".");return this._maxListeners=S,this};function l(E){return E._maxListeners===void 0?o.defaultMaxListeners:E._maxListeners}o.prototype.getMaxListeners=function(){return l(this)},o.prototype.emit=function(S){for(var R=[],p=1;p<arguments.length;p++)R.push(arguments[p]);var T=S==="error",w=this._events;if(w!==void 0)T=T&&w.error===void 0;else if(!T)return!1;if(T){var L;if(R.length>0&&(L=R[0]),L instanceof Error)throw L;var k=new Error("Unhandled error."+(L?" ("+L.message+")":""));throw k.context=L,k}var D=w[S];if(D===void 0)return!1;if(typeof D=="function")t(D,this,R);else for(var _=D.length,$=g(D,_),p=0;p<_;++p)t($[p],this,R);return!0};function u(E,S,R,p){var T,w,L;if(s(R),w=E._events,w===void 0?(w=E._events=Object.create(null),E._eventsCount=0):(w.newListener!==void 0&&(E.emit("newListener",S,R.listener?R.listener:R),w=E._events),L=w[S]),L===void 0)L=w[S]=R,++E._eventsCount;else if(typeof L=="function"?L=w[S]=p?[R,L]:[L,R]:p?L.unshift(R):L.push(R),T=l(E),T>0&&L.length>T&&!L.warned){L.warned=!0;var k=new Error("Possible EventEmitter memory leak detected. "+L.length+" "+String(S)+" listeners added. Use emitter.setMaxListeners() to increase limit");k.name="MaxListenersExceededWarning",k.emitter=E,k.type=S,k.count=L.length,e(k)}return E}o.prototype.addListener=function(S,R){return u(this,S,R,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(S,R){return u(this,S,R,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(E,S,R){var p={fired:!1,wrapFn:void 0,target:E,type:S,listener:R},T=c.bind(p);return T.listener=R,p.wrapFn=T,T}o.prototype.once=function(S,R){return s(R),this.on(S,d(this,S,R)),this},o.prototype.prependOnceListener=function(S,R){return s(R),this.prependListener(S,d(this,S,R)),this},o.prototype.removeListener=function(S,R){var p,T,w,L,k;if(s(R),T=this._events,T===void 0)return this;if(p=T[S],p===void 0)return this;if(p===R||p.listener===R)--this._eventsCount===0?this._events=Object.create(null):(delete T[S],T.removeListener&&this.emit("removeListener",S,p.listener||R));else if(typeof p!="function"){for(w=-1,L=p.length-1;L>=0;L--)if(p[L]===R||p[L].listener===R){k=p[L].listener,w=L;break}if(w<0)return this;w===0?p.shift():m(p,w),p.length===1&&(T[S]=p[0]),T.removeListener!==void 0&&this.emit("removeListener",S,k||R)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(S){var R,p,T;if(p=this._events,p===void 0)return this;if(p.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):p[S]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete p[S]),this;if(arguments.length===0){var w=Object.keys(p),L;for(T=0;T<w.length;++T)L=w[T],L!=="removeListener"&&this.removeAllListeners(L);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(R=p[S],typeof R=="function")this.removeListener(S,R);else if(R!==void 0)for(T=R.length-1;T>=0;T--)this.removeListener(S,R[T]);return this};function f(E,S,R){var p=E._events;if(p===void 0)return[];var T=p[S];return T===void 0?[]:typeof T=="function"?R?[T.listener||T]:[T]:R?y(T):g(T,T.length)}o.prototype.listeners=function(S){return f(this,S,!0)},o.prototype.rawListeners=function(S){return f(this,S,!1)},o.listenerCount=function(E,S){return typeof E.listenerCount=="function"?E.listenerCount(S):h.call(E,S)},o.prototype.listenerCount=h;function h(E){var S=this._events;if(S!==void 0){var R=S[E];if(typeof R=="function")return 1;if(R!==void 0)return R.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?i(this._events):[]};function g(E,S){for(var R=new Array(S),p=0;p<S;++p)R[p]=E[p];return R}function m(E,S){for(;S+1<E.length;S++)E[S]=E[S+1];E.pop()}function y(E){for(var S=new Array(E.length),R=0;R<S.length;++R)S[R]=E[R].listener||E[R];return S}function A(E,S){return new Promise(function(R,p){function T(L){E.removeListener(S,w),p(L)}function w(){typeof E.removeListener=="function"&&E.removeListener("error",T),R([].slice.call(arguments))}C(E,S,w,{once:!0}),S!=="error"&&x(E,T,{once:!0})})}function x(E,S,R){typeof E.on=="function"&&C(E,"error",S,R)}function C(E,S,R,p){if(typeof E.on=="function")p.once?E.once(S,R):E.on(S,R);else if(typeof E.addEventListener=="function")E.addEventListener(S,function T(w){p.once&&E.removeEventListener(S,T),R(w)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof E)}return $t.exports}var ii=il();function rl(){const n=arguments[0];for(let t=1,i=arguments.length;t<i;t++)if(arguments[t])for(const e in arguments[t])n[e]=arguments[t][e];return n}let de=rl;typeof Object.assign=="function"&&(de=Object.assign);function be(n,t,i,e){const r=n._nodes.get(t);let o=null;return r&&(e==="mixed"?o=r.out&&r.out[i]||r.undirected&&r.undirected[i]:e==="directed"?o=r.out&&r.out[i]:o=r.undirected&&r.undirected[i]),o}function ge(n){return typeof n=="object"&&n!==null}function to(n){let t;for(t in n)return!1;return!0}function ye(n,t,i){Object.defineProperty(n,t,{enumerable:!1,configurable:!1,writable:!0,value:i})}function we(n,t,i){const e={enumerable:!0,configurable:!0};typeof i=="function"?e.get=i:(e.value=i,e.writable=!1),Object.defineProperty(n,t,e)}function Fr(n){return!(!ge(n)||n.attributes&&!Array.isArray(n.attributes))}function nl(){let n=Math.floor(Math.random()*256)&255;return()=>n++}function ke(){const n=arguments;let t=null,i=-1;return{[Symbol.iterator](){return this},next(){let e=null;do{if(t===null){if(i++,i>=n.length)return{done:!0};t=n[i][Symbol.iterator]()}if(e=t.next(),e.done){t=null;continue}break}while(!0);return e}}}function ht(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class Qi extends Error{constructor(t){super(),this.name="GraphError",this.message=t}}class q extends Qi{constructor(t){super(t),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,q.prototype.constructor)}}class U extends Qi{constructor(t){super(t),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,U.prototype.constructor)}}class re extends Qi{constructor(t){super(t),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,re.prototype.constructor)}}function io(n,t){this.key=n,this.attributes=t,this.clear()}io.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function ro(n,t){this.key=n,this.attributes=t,this.clear()}ro.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function no(n,t){this.key=n,this.attributes=t,this.clear()}no.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function ft(n,t,i,e,r){this.key=t,this.attributes=r,this.undirected=n,this.source=i,this.target=e}ft.prototype.attach=function(){let n="out",t="in";this.undirected&&(n=t="undirected");const i=this.source.key,e=this.target.key;this.source[n][e]=this,!(this.undirected&&i===e)&&(this.target[t][i]=this)};ft.prototype.attachMulti=function(){let n="out",t="in";const i=this.source.key,e=this.target.key;this.undirected&&(n=t="undirected");const r=this.source[n],o=r[e];if(typeof o>"u"){r[e]=this,this.undirected&&i===e||(this.target[t][i]=this);return}o.previous=this,this.next=o,r[e]=this,this.target[t][i]=this};ft.prototype.detach=function(){const n=this.source.key,t=this.target.key;let i="out",e="in";this.undirected&&(i=e="undirected"),delete this.source[i][t],delete this.target[e][n]};ft.prototype.detachMulti=function(){const n=this.source.key,t=this.target.key;let i="out",e="in";this.undirected&&(i=e="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[i][t],delete this.target[e][n]):(this.next.previous=void 0,this.source[i][t]=this.next,this.target[e][n]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const oo=0,ao=1,ol=2,so=3;function De(n,t,i,e,r,o,a){let s,l,u,c;if(e=""+e,i===oo){if(s=n._nodes.get(e),!s)throw new U(`Graph.${t}: could not find the "${e}" node in the graph.`);u=r,c=o}else if(i===so){if(r=""+r,l=n._edges.get(r),!l)throw new U(`Graph.${t}: could not find the "${r}" edge in the graph.`);const d=l.source.key,f=l.target.key;if(e===d)s=l.target;else if(e===f)s=l.source;else throw new U(`Graph.${t}: the "${e}" node is not attached to the "${r}" edge (${d}, ${f}).`);u=o,c=a}else{if(l=n._edges.get(e),!l)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`);i===ao?s=l.source:s=l.target,u=r,c=o}return[s,u,c]}function al(n,t,i){n.prototype[t]=function(e,r,o){const[a,s]=De(this,t,i,e,r,o);return a.attributes[s]}}function sl(n,t,i){n.prototype[t]=function(e,r){const[o]=De(this,t,i,e,r);return o.attributes}}function ll(n,t,i){n.prototype[t]=function(e,r,o){const[a,s]=De(this,t,i,e,r,o);return a.attributes.hasOwnProperty(s)}}function ul(n,t,i){n.prototype[t]=function(e,r,o,a){const[s,l,u]=De(this,t,i,e,r,o,a);return s.attributes[l]=u,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:l}),this}}function cl(n,t,i){n.prototype[t]=function(e,r,o,a){const[s,l,u]=De(this,t,i,e,r,o,a);if(typeof u!="function")throw new q(`Graph.${t}: updater should be a function.`);const c=s.attributes,d=u(c[l]);return c[l]=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:l}),this}}function dl(n,t,i){n.prototype[t]=function(e,r,o){const[a,s]=De(this,t,i,e,r,o);return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}function hl(n,t,i){n.prototype[t]=function(e,r,o){const[a,s]=De(this,t,i,e,r,o);if(!ge(s))throw new q(`Graph.${t}: provided attributes are not a plain object.`);return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function fl(n,t,i){n.prototype[t]=function(e,r,o){const[a,s]=De(this,t,i,e,r,o);if(!ge(s))throw new q(`Graph.${t}: provided attributes are not a plain object.`);return de(a.attributes,s),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:s}),this}}function gl(n,t,i){n.prototype[t]=function(e,r,o){const[a,s]=De(this,t,i,e,r,o);if(typeof s!="function")throw new q(`Graph.${t}: provided updater is not a function.`);return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const vl=[{name:n=>`get${n}Attribute`,attacher:al},{name:n=>`get${n}Attributes`,attacher:sl},{name:n=>`has${n}Attribute`,attacher:ll},{name:n=>`set${n}Attribute`,attacher:ul},{name:n=>`update${n}Attribute`,attacher:cl},{name:n=>`remove${n}Attribute`,attacher:dl},{name:n=>`replace${n}Attributes`,attacher:hl},{name:n=>`merge${n}Attributes`,attacher:fl},{name:n=>`update${n}Attributes`,attacher:gl}];function pl(n){vl.forEach(function({name:t,attacher:i}){i(n,t("Node"),oo),i(n,t("Source"),ao),i(n,t("Target"),ol),i(n,t("Opposite"),so)})}function ml(n,t,i){n.prototype[t]=function(e,r){let o;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+r;if(r=arguments[2],o=be(this,a,s,i),!o)throw new U(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}return o.attributes[r]}}function yl(n,t,i){n.prototype[t]=function(e){let r;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+e,a=""+arguments[1];if(r=be(this,o,a,i),!r)throw new U(`Graph.${t}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,r=this._edges.get(e),!r)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}return r.attributes}}function bl(n,t,i){n.prototype[t]=function(e,r){let o;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+r;if(r=arguments[2],o=be(this,a,s,i),!o)throw new U(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}return o.attributes.hasOwnProperty(r)}}function _l(n,t,i){n.prototype[t]=function(e,r,o){let a;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+e,l=""+r;if(r=arguments[2],o=arguments[3],a=be(this,s,l,i),!a)throw new U(`Graph.${t}: could not find an edge for the given path ("${s}" - "${l}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,a=this._edges.get(e),!a)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}return a.attributes[r]=o,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:r}),this}}function El(n,t,i){n.prototype[t]=function(e,r,o){let a;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+e,l=""+r;if(r=arguments[2],o=arguments[3],a=be(this,s,l,i),!a)throw new U(`Graph.${t}: could not find an edge for the given path ("${s}" - "${l}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,a=this._edges.get(e),!a)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}if(typeof o!="function")throw new q(`Graph.${t}: updater should be a function.`);return a.attributes[r]=o(a.attributes[r]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:r}),this}}function wl(n,t,i){n.prototype[t]=function(e,r){let o;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+r;if(r=arguments[2],o=be(this,a,s,i),!o)throw new U(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}return delete o.attributes[r],this.emit("edgeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:r}),this}}function xl(n,t,i){n.prototype[t]=function(e,r){let o;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+r;if(r=arguments[2],o=be(this,a,s,i),!o)throw new U(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}if(!ge(r))throw new q(`Graph.${t}: provided attributes are not a plain object.`);return o.attributes=r,this.emit("edgeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function Tl(n,t,i){n.prototype[t]=function(e,r){let o;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+r;if(r=arguments[2],o=be(this,a,s,i),!o)throw new U(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}if(!ge(r))throw new q(`Graph.${t}: provided attributes are not a plain object.`);return de(o.attributes,r),this.emit("edgeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:r}),this}}function Sl(n,t,i){n.prototype[t]=function(e,r){let o;if(this.type!=="mixed"&&i!=="mixed"&&i!==this.type)throw new re(`Graph.${t}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new re(`Graph.${t}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+r;if(r=arguments[2],o=be(this,a,s,i),!o)throw new U(`Graph.${t}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(i!=="mixed")throw new re(`Graph.${t}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new U(`Graph.${t}: could not find the "${e}" edge in the graph.`)}if(typeof r!="function")throw new q(`Graph.${t}: provided updater is not a function.`);return o.attributes=r(o.attributes),this.emit("edgeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Al=[{name:n=>`get${n}Attribute`,attacher:ml},{name:n=>`get${n}Attributes`,attacher:yl},{name:n=>`has${n}Attribute`,attacher:bl},{name:n=>`set${n}Attribute`,attacher:_l},{name:n=>`update${n}Attribute`,attacher:El},{name:n=>`remove${n}Attribute`,attacher:wl},{name:n=>`replace${n}Attributes`,attacher:xl},{name:n=>`merge${n}Attributes`,attacher:Tl},{name:n=>`update${n}Attributes`,attacher:Sl}];function Rl(n){Al.forEach(function({name:t,attacher:i}){i(n,t("Edge"),"mixed"),i(n,t("DirectedEdge"),"directed"),i(n,t("UndirectedEdge"),"undirected")})}const Cl=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Ll(n,t,i,e){let r=!1;for(const o in t){if(o===e)continue;const a=t[o];if(r=i(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),n&&r)return a.key}}function kl(n,t,i,e){let r,o,a,s=!1;for(const l in t)if(l!==e){r=t[l];do{if(o=r.source,a=r.target,s=i(r.key,r.attributes,o.key,a.key,o.attributes,a.attributes,r.undirected),n&&s)return r.key;r=r.next}while(r!==void 0)}}function vi(n,t){const i=Object.keys(n),e=i.length;let r,o=0;return{[Symbol.iterator](){return this},next(){do if(r)r=r.next;else{if(o>=e)return{done:!0};const a=i[o++];if(a===t){r=void 0;continue}r=n[a]}while(!r);return{done:!1,value:{edge:r.key,attributes:r.attributes,source:r.source.key,target:r.target.key,sourceAttributes:r.source.attributes,targetAttributes:r.target.attributes,undirected:r.undirected}}}}}function Nl(n,t,i,e){const r=t[i];if(!r)return;const o=r.source,a=r.target;if(e(r.key,r.attributes,o.key,a.key,o.attributes,a.attributes,r.undirected)&&n)return r.key}function Dl(n,t,i,e){let r=t[i];if(!r)return;let o=!1;do{if(o=e(r.key,r.attributes,r.source.key,r.target.key,r.source.attributes,r.target.attributes,r.undirected),n&&o)return r.key;r=r.next}while(r!==void 0)}function pi(n,t){let i=n[t];if(i.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!i)return{done:!0};const r={edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected};return i=i.next,{done:!1,value:r}}};let e=!1;return{[Symbol.iterator](){return this},next(){return e===!0?{done:!0}:(e=!0,{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}})}}}function Gl(n,t){if(n.size===0)return[];if(t==="mixed"||t===n.type)return Array.from(n._edges.keys());const i=t==="undirected"?n.undirectedSize:n.directedSize,e=new Array(i),r=t==="undirected",o=n._edges.values();let a=0,s,l;for(;s=o.next(),s.done!==!0;)l=s.value,l.undirected===r&&(e[a++]=l.key);return e}function lo(n,t,i,e){if(t.size===0)return;const r=i!=="mixed"&&i!==t.type,o=i==="undirected";let a,s,l=!1;const u=t._edges.values();for(;a=u.next(),a.done!==!0;){if(s=a.value,r&&s.undirected!==o)continue;const{key:c,attributes:d,source:f,target:h}=s;if(l=e(c,d,f.key,h.key,f.attributes,h.attributes,s.undirected),n&&l)return c}}function Pl(n,t){if(n.size===0)return ht();const i=t!=="mixed"&&t!==n.type,e=t==="undirected",r=n._edges.values();return{[Symbol.iterator](){return this},next(){let o,a;for(;;){if(o=r.next(),o.done)return o;if(a=o.value,!(i&&a.undirected!==e))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}}}}function Ji(n,t,i,e,r,o){const a=t?kl:Ll;let s;if(i!=="undirected"&&(e!=="out"&&(s=a(n,r.in,o),n&&s)||e!=="in"&&(s=a(n,r.out,o,e?void 0:r.key),n&&s))||i!=="directed"&&(s=a(n,r.undirected,o),n&&s))return s}function zl(n,t,i,e){const r=[];return Ji(!1,n,t,i,e,function(o){r.push(o)}),r}function Ol(n,t,i){let e=ht();return n!=="undirected"&&(t!=="out"&&typeof i.in<"u"&&(e=ke(e,vi(i.in))),t!=="in"&&typeof i.out<"u"&&(e=ke(e,vi(i.out,t?void 0:i.key)))),n!=="directed"&&typeof i.undirected<"u"&&(e=ke(e,vi(i.undirected))),e}function er(n,t,i,e,r,o,a){const s=i?Dl:Nl;let l;if(t!=="undirected"&&(typeof r.in<"u"&&e!=="out"&&(l=s(n,r.in,o,a),n&&l)||typeof r.out<"u"&&e!=="in"&&(e||r.key!==o)&&(l=s(n,r.out,o,a),n&&l))||t!=="directed"&&typeof r.undirected<"u"&&(l=s(n,r.undirected,o,a),n&&l))return l}function Il(n,t,i,e,r){const o=[];return er(!1,n,t,i,e,r,function(a){o.push(a)}),o}function Fl(n,t,i,e){let r=ht();return n!=="undirected"&&(typeof i.in<"u"&&t!=="out"&&e in i.in&&(r=ke(r,pi(i.in,e))),typeof i.out<"u"&&t!=="in"&&e in i.out&&(t||i.key!==e)&&(r=ke(r,pi(i.out,e)))),n!=="directed"&&typeof i.undirected<"u"&&e in i.undirected&&(r=ke(r,pi(i.undirected,e))),r}function Ml(n,t){const{name:i,type:e,direction:r}=t;n.prototype[i]=function(o,a){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return[];if(!arguments.length)return Gl(this,e);if(arguments.length===1){o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new U(`Graph.${i}: could not find the "${o}" node in the graph.`);return zl(this.multi,e==="mixed"?this.type:e,r,s)}if(arguments.length===2){o=""+o,a=""+a;const s=this._nodes.get(o);if(!s)throw new U(`Graph.${i}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new U(`Graph.${i}:  could not find the "${a}" target node in the graph.`);return Il(e,this.multi,r,s,a)}throw new q(`Graph.${i}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function $l(n,t){const{name:i,type:e,direction:r}=t,o="forEach"+i[0].toUpperCase()+i.slice(1,-1);n.prototype[o]=function(u,c,d){if(!(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)){if(arguments.length===1)return d=u,lo(!1,this,e,d);if(arguments.length===2){u=""+u,d=c;const f=this._nodes.get(u);if(typeof f>"u")throw new U(`Graph.${o}: could not find the "${u}" node in the graph.`);return Ji(!1,this.multi,e==="mixed"?this.type:e,r,f,d)}if(arguments.length===3){u=""+u,c=""+c;const f=this._nodes.get(u);if(!f)throw new U(`Graph.${o}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(c))throw new U(`Graph.${o}:  could not find the "${c}" target node in the graph.`);return er(!1,e,this.multi,r,f,c,d)}throw new q(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+i[0].toUpperCase()+i.slice(1);n.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop();let d;if(u.length===0){let f=0;e!=="directed"&&(f+=this.undirectedSize),e!=="undirected"&&(f+=this.directedSize),d=new Array(f);let h=0;u.push((g,m,y,A,x,C,E)=>{d[h++]=c(g,m,y,A,x,C,E)})}else d=[],u.push((f,h,g,m,y,A,x)=>{d.push(c(f,h,g,m,y,A,x))});return this[o].apply(this,u),d};const s="filter"+i[0].toUpperCase()+i.slice(1);n.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),c=u.pop(),d=[];return u.push((f,h,g,m,y,A,x)=>{c(f,h,g,m,y,A,x)&&d.push(f)}),this[o].apply(this,u),d};const l="reduce"+i[0].toUpperCase()+i.slice(1);n.prototype[l]=function(){let u=Array.prototype.slice.call(arguments);if(u.length<2||u.length>4)throw new q(`Graph.${l}: invalid number of arguments (expecting 2, 3 or 4 and got ${u.length}).`);if(typeof u[u.length-1]=="function"&&typeof u[u.length-2]!="function")throw new q(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,d;u.length===2?(c=u[0],d=u[1],u=[]):u.length===3?(c=u[1],d=u[2],u=[u[0]]):u.length===4&&(c=u[2],d=u[3],u=[u[0],u[1]]);let f=d;return u.push((h,g,m,y,A,x,C)=>{f=c(f,h,g,m,y,A,x,C)}),this[o].apply(this,u),f}}function Ul(n,t){const{name:i,type:e,direction:r}=t,o="find"+i[0].toUpperCase()+i.slice(1,-1);n.prototype[o]=function(l,u,c){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return!1;if(arguments.length===1)return c=l,lo(!0,this,e,c);if(arguments.length===2){l=""+l,c=u;const d=this._nodes.get(l);if(typeof d>"u")throw new U(`Graph.${o}: could not find the "${l}" node in the graph.`);return Ji(!0,this.multi,e==="mixed"?this.type:e,r,d,c)}if(arguments.length===3){l=""+l,u=""+u;const d=this._nodes.get(l);if(!d)throw new U(`Graph.${o}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(u))throw new U(`Graph.${o}:  could not find the "${u}" target node in the graph.`);return er(!0,e,this.multi,r,d,u,c)}throw new q(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+i[0].toUpperCase()+i.slice(1,-1);n.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,f,h,g,m,y,A)=>u(d,f,h,g,m,y,A)),!!this[o].apply(this,l)};const s="every"+i[0].toUpperCase()+i.slice(1,-1);n.prototype[s]=function(){const l=Array.prototype.slice.call(arguments),u=l.pop();return l.push((d,f,h,g,m,y,A)=>!u(d,f,h,g,m,y,A)),!this[o].apply(this,l)}}function jl(n,t){const{name:i,type:e,direction:r}=t,o=i.slice(0,-1)+"Entries";n.prototype[o]=function(a,s){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return ht();if(!arguments.length)return Pl(this,e);if(arguments.length===1){a=""+a;const l=this._nodes.get(a);if(!l)throw new U(`Graph.${o}: could not find the "${a}" node in the graph.`);return Ol(e,r,l)}if(arguments.length===2){a=""+a,s=""+s;const l=this._nodes.get(a);if(!l)throw new U(`Graph.${o}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new U(`Graph.${o}:  could not find the "${s}" target node in the graph.`);return Fl(e,r,l,s)}throw new q(`Graph.${o}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function Hl(n){Cl.forEach(t=>{Ml(n,t),$l(n,t),Ul(n,t),jl(n,t)})}const Vl=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function ri(){this.A=null,this.B=null}ri.prototype.wrap=function(n){this.A===null?this.A=n:this.B===null&&(this.B=n)};ri.prototype.has=function(n){return this.A!==null&&n in this.A||this.B!==null&&n in this.B};function bt(n,t,i,e,r){for(const o in e){const a=e[o],s=a.source,l=a.target,u=s===i?l:s;if(t&&t.has(u.key))continue;const c=r(u.key,u.attributes);if(n&&c)return u.key}}function tr(n,t,i,e,r){if(t!=="mixed"){if(t==="undirected")return bt(n,null,e,e.undirected,r);if(typeof i=="string")return bt(n,null,e,e[i],r)}const o=new ri;let a;if(t!=="undirected"){if(i!=="out"){if(a=bt(n,null,e,e.in,r),n&&a)return a;o.wrap(e.in)}if(i!=="in"){if(a=bt(n,o,e,e.out,r),n&&a)return a;o.wrap(e.out)}}if(t!=="directed"&&(a=bt(n,o,e,e.undirected,r),n&&a))return a}function Bl(n,t,i){if(n!=="mixed"){if(n==="undirected")return Object.keys(i.undirected);if(typeof t=="string")return Object.keys(i[t])}const e=[];return tr(!1,n,t,i,function(r){e.push(r)}),e}function _t(n,t,i){const e=Object.keys(i),r=e.length;let o=0;return{[Symbol.iterator](){return this},next(){let a=null;do{if(o>=r)return n&&n.wrap(i),{done:!0};const s=i[e[o++]],l=s.source,u=s.target;if(a=l===t?u:l,n&&n.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}}}}function Wl(n,t,i){if(n!=="mixed"){if(n==="undirected")return _t(null,i,i.undirected);if(typeof t=="string")return _t(null,i,i[t])}let e=ht();const r=new ri;return n!=="undirected"&&(t!=="out"&&(e=ke(e,_t(r,i,i.in))),t!=="in"&&(e=ke(e,_t(r,i,i.out)))),n!=="directed"&&(e=ke(e,_t(r,i,i.undirected))),e}function ql(n,t){const{name:i,type:e,direction:r}=t;n.prototype[i]=function(o){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return[];o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new U(`Graph.${i}: could not find the "${o}" node in the graph.`);return Bl(e==="mixed"?this.type:e,r,a)}}function Xl(n,t){const{name:i,type:e,direction:r}=t,o="forEach"+i[0].toUpperCase()+i.slice(1,-1);n.prototype[o]=function(u,c){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new U(`Graph.${o}: could not find the "${u}" node in the graph.`);tr(!1,e==="mixed"?this.type:e,r,d,c)};const a="map"+i[0].toUpperCase()+i.slice(1);n.prototype[a]=function(u,c){const d=[];return this[o](u,(f,h)=>{d.push(c(f,h))}),d};const s="filter"+i[0].toUpperCase()+i.slice(1);n.prototype[s]=function(u,c){const d=[];return this[o](u,(f,h)=>{c(f,h)&&d.push(f)}),d};const l="reduce"+i[0].toUpperCase()+i.slice(1);n.prototype[l]=function(u,c,d){if(arguments.length<3)throw new q(`Graph.${l}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f=d;return this[o](u,(h,g)=>{f=c(f,h,g)}),f}}function Yl(n,t){const{name:i,type:e,direction:r}=t,o=i[0].toUpperCase()+i.slice(1,-1),a="find"+o;n.prototype[a]=function(u,c){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return;u=""+u;const d=this._nodes.get(u);if(typeof d>"u")throw new U(`Graph.${a}: could not find the "${u}" node in the graph.`);return tr(!0,e==="mixed"?this.type:e,r,d,c)};const s="some"+o;n.prototype[s]=function(u,c){return!!this[a](u,c)};const l="every"+o;n.prototype[l]=function(u,c){return!this[a](u,(f,h)=>!c(f,h))}}function Kl(n,t){const{name:i,type:e,direction:r}=t,o=i.slice(0,-1)+"Entries";n.prototype[o]=function(a){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return ht();a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new U(`Graph.${o}: could not find the "${a}" node in the graph.`);return Wl(e==="mixed"?this.type:e,r,s)}}function Zl(n){Vl.forEach(t=>{ql(n,t),Xl(n,t),Yl(n,t),Kl(n,t)})}function Ut(n,t,i,e,r){const o=e._nodes.values(),a=e.type;let s,l,u,c,d,f;for(;s=o.next(),s.done!==!0;){let h=!1;if(l=s.value,a!=="undirected"){c=l.out;for(u in c){d=c[u];do f=d.target,h=!0,r(l.key,f.key,l.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(a!=="directed"){c=l.undirected;for(u in c)if(!(t&&l.key>u)){d=c[u];do f=d.target,f.key!==u&&(f=d.source),h=!0,r(l.key,f.key,l.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}i&&!h&&r(l.key,null,l.attributes,null,null,null,null)}}function Ql(n,t){const i={key:n};return to(t.attributes)||(i.attributes=de({},t.attributes)),i}function Jl(n,t,i){const e={key:t,source:i.source.key,target:i.target.key};return to(i.attributes)||(e.attributes=de({},i.attributes)),n==="mixed"&&i.undirected&&(e.undirected=!0),e}function eu(n){if(!ge(n))throw new q('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in n))throw new q("Graph.import: serialized node is missing its key.");if("attributes"in n&&(!ge(n.attributes)||n.attributes===null))throw new q("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function tu(n){if(!ge(n))throw new q('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in n))throw new q("Graph.import: serialized edge is missing its source.");if(!("target"in n))throw new q("Graph.import: serialized edge is missing its target.");if("attributes"in n&&(!ge(n.attributes)||n.attributes===null))throw new q("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in n&&typeof n.undirected!="boolean")throw new q("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const iu=nl(),ru=new Set(["directed","undirected","mixed"]),Mr=new Set(["domain","_events","_eventsCount","_maxListeners"]),nu=[{name:n=>`${n}Edge`,generateKey:!0},{name:n=>`${n}DirectedEdge`,generateKey:!0,type:"directed"},{name:n=>`${n}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:n=>`${n}EdgeWithKey`},{name:n=>`${n}DirectedEdgeWithKey`,type:"directed"},{name:n=>`${n}UndirectedEdgeWithKey`,type:"undirected"}],ou={allowSelfLoops:!0,multi:!1,type:"mixed"};function au(n,t,i){if(i&&!ge(i))throw new q(`Graph.addNode: invalid attributes. Expecting an object but got "${i}"`);if(t=""+t,i=i||{},n._nodes.has(t))throw new re(`Graph.addNode: the "${t}" node already exist in the graph.`);const e=new n.NodeDataClass(t,i);return n._nodes.set(t,e),n.emit("nodeAdded",{key:t,attributes:i}),e}function $r(n,t,i){const e=new n.NodeDataClass(t,i);return n._nodes.set(t,e),n.emit("nodeAdded",{key:t,attributes:i}),e}function uo(n,t,i,e,r,o,a,s){if(!e&&n.type==="undirected")throw new re(`Graph.${t}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(e&&n.type==="directed")throw new re(`Graph.${t}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!ge(s))throw new q(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`);if(o=""+o,a=""+a,s=s||{},!n.allowSelfLoops&&o===a)throw new re(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const l=n._nodes.get(o),u=n._nodes.get(a);if(!l)throw new U(`Graph.${t}: source node "${o}" not found.`);if(!u)throw new U(`Graph.${t}: target node "${a}" not found.`);const c={key:null,undirected:e,source:o,target:a,attributes:s};if(i)r=n._edgeKeyGenerator();else if(r=""+r,n._edges.has(r))throw new re(`Graph.${t}: the "${r}" edge already exists in the graph.`);if(!n.multi&&(e?typeof l.undirected[a]<"u":typeof l.out[a]<"u"))throw new re(`Graph.${t}: an edge linking "${o}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new ft(e,r,l,u,s);n._edges.set(r,d);const f=o===a;return e?(l.undirectedDegree++,u.undirectedDegree++,f&&(l.undirectedLoops++,n._undirectedSelfLoopCount++)):(l.outDegree++,u.inDegree++,f&&(l.directedLoops++,n._directedSelfLoopCount++)),n.multi?d.attachMulti():d.attach(),e?n._undirectedSize++:n._directedSize++,c.key=r,n.emit("edgeAdded",c),r}function su(n,t,i,e,r,o,a,s,l){if(!e&&n.type==="undirected")throw new re(`Graph.${t}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(e&&n.type==="directed")throw new re(`Graph.${t}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(l){if(typeof s!="function")throw new q(`Graph.${t}: invalid updater function. Expecting a function but got "${s}"`)}else if(!ge(s))throw new q(`Graph.${t}: invalid attributes. Expecting an object but got "${s}"`)}o=""+o,a=""+a;let u;if(l&&(u=s,s=void 0),!n.allowSelfLoops&&o===a)throw new re(`Graph.${t}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=n._nodes.get(o),d=n._nodes.get(a),f,h;if(!i&&(f=n._edges.get(r),f)){if((f.source.key!==o||f.target.key!==a)&&(!e||f.source.key!==a||f.target.key!==o))throw new re(`Graph.${t}: inconsistency detected when attempting to merge the "${r}" edge with "${o}" source & "${a}" target vs. ("${f.source.key}", "${f.target.key}").`);h=f}if(!h&&!n.multi&&c&&(h=e?c.undirected[a]:c.out[a]),h){const x=[h.key,!1,!1,!1];if(l?!u:!s)return x;if(l){const C=h.attributes;h.attributes=u(C),n.emit("edgeAttributesUpdated",{type:"replace",key:h.key,attributes:h.attributes})}else de(h.attributes,s),n.emit("edgeAttributesUpdated",{type:"merge",key:h.key,attributes:h.attributes,data:s});return x}s=s||{},l&&u&&(s=u(s));const g={key:null,undirected:e,source:o,target:a,attributes:s};if(i)r=n._edgeKeyGenerator();else if(r=""+r,n._edges.has(r))throw new re(`Graph.${t}: the "${r}" edge already exists in the graph.`);let m=!1,y=!1;c||(c=$r(n,o,{}),m=!0,o===a&&(d=c,y=!0)),d||(d=$r(n,a,{}),y=!0),f=new ft(e,r,c,d,s),n._edges.set(r,f);const A=o===a;return e?(c.undirectedDegree++,d.undirectedDegree++,A&&(c.undirectedLoops++,n._undirectedSelfLoopCount++)):(c.outDegree++,d.inDegree++,A&&(c.directedLoops++,n._directedSelfLoopCount++)),n.multi?f.attachMulti():f.attach(),e?n._undirectedSize++:n._directedSize++,g.key=r,n.emit("edgeAdded",g),[r,!0,m,y]}function Ze(n,t){n._edges.delete(t.key);const{source:i,target:e,attributes:r}=t,o=t.undirected,a=i===e;o?(i.undirectedDegree--,e.undirectedDegree--,a&&(i.undirectedLoops--,n._undirectedSelfLoopCount--)):(i.outDegree--,e.inDegree--,a&&(i.directedLoops--,n._directedSelfLoopCount--)),n.multi?t.detachMulti():t.detach(),o?n._undirectedSize--:n._directedSize--,n.emit("edgeDropped",{key:t.key,attributes:r,source:i.key,target:e.key,undirected:o})}let le=class Vi extends ii.EventEmitter{constructor(t){if(super(),t=de({},ou,t),typeof t.multi!="boolean")throw new q(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${t.multi}".`);if(!ru.has(t.type))throw new q(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${t.type}".`);if(typeof t.allowSelfLoops!="boolean")throw new q(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${t.allowSelfLoops}".`);const i=t.type==="mixed"?io:t.type==="directed"?ro:no;ye(this,"NodeDataClass",i);const e="geid_"+iu()+"_";let r=0;const o=()=>{let a;do a=e+r++;while(this._edges.has(a));return a};ye(this,"_attributes",{}),ye(this,"_nodes",new Map),ye(this,"_edges",new Map),ye(this,"_directedSize",0),ye(this,"_undirectedSize",0),ye(this,"_directedSelfLoopCount",0),ye(this,"_undirectedSelfLoopCount",0),ye(this,"_edgeKeyGenerator",o),ye(this,"_options",t),Mr.forEach(a=>ye(this,a,this[a])),we(this,"order",()=>this._nodes.size),we(this,"size",()=>this._edges.size),we(this,"directedSize",()=>this._directedSize),we(this,"undirectedSize",()=>this._undirectedSize),we(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),we(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),we(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),we(this,"multi",this._options.multi),we(this,"type",this._options.type),we(this,"allowSelfLoops",this._options.allowSelfLoops),we(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(t){return this._nodes.has(""+t)}hasDirectedEdge(t,i){if(this.type==="undirected")return!1;if(arguments.length===1){const e=""+t,r=this._edges.get(e);return!!r&&!r.undirected}else if(arguments.length===2){t=""+t,i=""+i;const e=this._nodes.get(t);return e?e.out.hasOwnProperty(i):!1}throw new q(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(t,i){if(this.type==="directed")return!1;if(arguments.length===1){const e=""+t,r=this._edges.get(e);return!!r&&r.undirected}else if(arguments.length===2){t=""+t,i=""+i;const e=this._nodes.get(t);return e?e.undirected.hasOwnProperty(i):!1}throw new q(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(t,i){if(arguments.length===1){const e=""+t;return this._edges.has(e)}else if(arguments.length===2){t=""+t,i=""+i;const e=this._nodes.get(t);return e?typeof e.out<"u"&&e.out.hasOwnProperty(i)||typeof e.undirected<"u"&&e.undirected.hasOwnProperty(i):!1}throw new q(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(t,i){if(this.type==="undirected")return;if(t=""+t,i=""+i,this.multi)throw new re("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const e=this._nodes.get(t);if(!e)throw new U(`Graph.directedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(i))throw new U(`Graph.directedEdge: could not find the "${i}" target node in the graph.`);const r=e.out&&e.out[i]||void 0;if(r)return r.key}undirectedEdge(t,i){if(this.type==="directed")return;if(t=""+t,i=""+i,this.multi)throw new re("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const e=this._nodes.get(t);if(!e)throw new U(`Graph.undirectedEdge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(i))throw new U(`Graph.undirectedEdge: could not find the "${i}" target node in the graph.`);const r=e.undirected&&e.undirected[i]||void 0;if(r)return r.key}edge(t,i){if(this.multi)throw new re("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.edge: could not find the "${t}" source node in the graph.`);if(!this._nodes.has(i))throw new U(`Graph.edge: could not find the "${i}" target node in the graph.`);const r=e.out&&e.out[i]||e.undirected&&e.undirected[i]||void 0;if(r)return r.key}areDirectedNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areDirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:i in e.in||i in e.out}areOutNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areOutNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:i in e.out}areInNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areInNeighbors: could not find the "${t}" node in the graph.`);return this.type==="undirected"?!1:i in e.in}areUndirectedNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areUndirectedNeighbors: could not find the "${t}" node in the graph.`);return this.type==="directed"?!1:i in e.undirected}areNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&(i in e.in||i in e.out)||this.type!=="directed"&&i in e.undirected}areInboundNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areInboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&i in e.in||this.type!=="directed"&&i in e.undirected}areOutboundNeighbors(t,i){t=""+t,i=""+i;const e=this._nodes.get(t);if(!e)throw new U(`Graph.areOutboundNeighbors: could not find the "${t}" node in the graph.`);return this.type!=="undirected"&&i in e.out||this.type!=="directed"&&i in e.undirected}inDegree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.inDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:i.inDegree}outDegree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.outDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:i.outDegree}directedDegree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.directedDegree: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:i.inDegree+i.outDegree}undirectedDegree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.undirectedDegree: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:i.undirectedDegree}inboundDegree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.inboundDegree: could not find the "${t}" node in the graph.`);let e=0;return this.type!=="directed"&&(e+=i.undirectedDegree),this.type!=="undirected"&&(e+=i.inDegree),e}outboundDegree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.outboundDegree: could not find the "${t}" node in the graph.`);let e=0;return this.type!=="directed"&&(e+=i.undirectedDegree),this.type!=="undirected"&&(e+=i.outDegree),e}degree(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.degree: could not find the "${t}" node in the graph.`);let e=0;return this.type!=="directed"&&(e+=i.undirectedDegree),this.type!=="undirected"&&(e+=i.inDegree+i.outDegree),e}inDegreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.inDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:i.inDegree-i.directedLoops}outDegreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.outDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:i.outDegree-i.directedLoops}directedDegreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.directedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="undirected"?0:i.inDegree+i.outDegree-i.directedLoops*2}undirectedDegreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);return this.type==="directed"?0:i.undirectedDegree-i.undirectedLoops*2}inboundDegreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let e=0,r=0;return this.type!=="directed"&&(e+=i.undirectedDegree,r+=i.undirectedLoops*2),this.type!=="undirected"&&(e+=i.inDegree,r+=i.directedLoops),e-r}outboundDegreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let e=0,r=0;return this.type!=="directed"&&(e+=i.undirectedDegree,r+=i.undirectedLoops*2),this.type!=="undirected"&&(e+=i.outDegree,r+=i.directedLoops),e-r}degreeWithoutSelfLoops(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.degreeWithoutSelfLoops: could not find the "${t}" node in the graph.`);let e=0,r=0;return this.type!=="directed"&&(e+=i.undirectedDegree,r+=i.undirectedLoops*2),this.type!=="undirected"&&(e+=i.inDegree+i.outDegree,r+=i.directedLoops*2),e-r}source(t){t=""+t;const i=this._edges.get(t);if(!i)throw new U(`Graph.source: could not find the "${t}" edge in the graph.`);return i.source.key}target(t){t=""+t;const i=this._edges.get(t);if(!i)throw new U(`Graph.target: could not find the "${t}" edge in the graph.`);return i.target.key}extremities(t){t=""+t;const i=this._edges.get(t);if(!i)throw new U(`Graph.extremities: could not find the "${t}" edge in the graph.`);return[i.source.key,i.target.key]}opposite(t,i){t=""+t,i=""+i;const e=this._edges.get(i);if(!e)throw new U(`Graph.opposite: could not find the "${i}" edge in the graph.`);const r=e.source.key,o=e.target.key;if(t===r)return o;if(t===o)return r;throw new U(`Graph.opposite: the "${t}" node is not attached to the "${i}" edge (${r}, ${o}).`)}hasExtremity(t,i){t=""+t,i=""+i;const e=this._edges.get(t);if(!e)throw new U(`Graph.hasExtremity: could not find the "${t}" edge in the graph.`);return e.source.key===i||e.target.key===i}isUndirected(t){t=""+t;const i=this._edges.get(t);if(!i)throw new U(`Graph.isUndirected: could not find the "${t}" edge in the graph.`);return i.undirected}isDirected(t){t=""+t;const i=this._edges.get(t);if(!i)throw new U(`Graph.isDirected: could not find the "${t}" edge in the graph.`);return!i.undirected}isSelfLoop(t){t=""+t;const i=this._edges.get(t);if(!i)throw new U(`Graph.isSelfLoop: could not find the "${t}" edge in the graph.`);return i.source===i.target}addNode(t,i){return au(this,t,i).key}mergeNode(t,i){if(i&&!ge(i))throw new q(`Graph.mergeNode: invalid attributes. Expecting an object but got "${i}"`);t=""+t,i=i||{};let e=this._nodes.get(t);return e?(i&&(de(e.attributes,i),this.emit("nodeAttributesUpdated",{type:"merge",key:t,attributes:e.attributes,data:i})),[t,!1]):(e=new this.NodeDataClass(t,i),this._nodes.set(t,e),this.emit("nodeAdded",{key:t,attributes:i}),[t,!0])}updateNode(t,i){if(i&&typeof i!="function")throw new q(`Graph.updateNode: invalid updater function. Expecting a function but got "${i}"`);t=""+t;let e=this._nodes.get(t);if(e){if(i){const o=e.attributes;e.attributes=i(o),this.emit("nodeAttributesUpdated",{type:"replace",key:t,attributes:e.attributes})}return[t,!1]}const r=i?i({}):{};return e=new this.NodeDataClass(t,r),this._nodes.set(t,e),this.emit("nodeAdded",{key:t,attributes:r}),[t,!0]}dropNode(t){t=""+t;const i=this._nodes.get(t);if(!i)throw new U(`Graph.dropNode: could not find the "${t}" node in the graph.`);let e;if(this.type!=="undirected"){for(const r in i.out){e=i.out[r];do Ze(this,e),e=e.next;while(e)}for(const r in i.in){e=i.in[r];do Ze(this,e),e=e.next;while(e)}}if(this.type!=="directed")for(const r in i.undirected){e=i.undirected[r];do Ze(this,e),e=e.next;while(e)}this._nodes.delete(t),this.emit("nodeDropped",{key:t,attributes:i.attributes})}dropEdge(t){let i;if(arguments.length>1){const e=""+arguments[0],r=""+arguments[1];if(i=be(this,e,r,this.type),!i)throw new U(`Graph.dropEdge: could not find the "${e}" -> "${r}" edge in the graph.`)}else if(t=""+t,i=this._edges.get(t),!i)throw new U(`Graph.dropEdge: could not find the "${t}" edge in the graph.`);return Ze(this,i),this}dropDirectedEdge(t,i){if(arguments.length<2)throw new re("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new re("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");t=""+t,i=""+i;const e=be(this,t,i,"directed");if(!e)throw new U(`Graph.dropDirectedEdge: could not find a "${t}" -> "${i}" edge in the graph.`);return Ze(this,e),this}dropUndirectedEdge(t,i){if(arguments.length<2)throw new re("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new re("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const e=be(this,t,i,"undirected");if(!e)throw new U(`Graph.dropUndirectedEdge: could not find a "${t}" -> "${i}" edge in the graph.`);return Ze(this,e),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const t=this._nodes.values();let i;for(;i=t.next(),i.done!==!0;)i.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(t){return this._attributes[t]}getAttributes(){return this._attributes}hasAttribute(t){return this._attributes.hasOwnProperty(t)}setAttribute(t,i){return this._attributes[t]=i,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}updateAttribute(t,i){if(typeof i!="function")throw new q("Graph.updateAttribute: updater should be a function.");const e=this._attributes[t];return this._attributes[t]=i(e),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:t}),this}removeAttribute(t){return delete this._attributes[t],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:t}),this}replaceAttributes(t){if(!ge(t))throw new q("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=t,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(t){if(!ge(t))throw new q("Graph.mergeAttributes: provided attributes are not a plain object.");return de(this._attributes,t),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:t}),this}updateAttributes(t){if(typeof t!="function")throw new q("Graph.updateAttributes: provided updater is not a function.");return this._attributes=t(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(t,i){if(typeof t!="function")throw new q("Graph.updateEachNodeAttributes: expecting an updater function.");if(i&&!Fr(i))throw new q("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const e=this._nodes.values();let r,o;for(;r=e.next(),r.done!==!0;)o=r.value,o.attributes=t(o.key,o.attributes);this.emit("eachNodeAttributesUpdated",{hints:i||null})}updateEachEdgeAttributes(t,i){if(typeof t!="function")throw new q("Graph.updateEachEdgeAttributes: expecting an updater function.");if(i&&!Fr(i))throw new q("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const e=this._edges.values();let r,o,a,s;for(;r=e.next(),r.done!==!0;)o=r.value,a=o.source,s=o.target,o.attributes=t(o.key,o.attributes,a.key,s.key,a.attributes,s.attributes,o.undirected);this.emit("eachEdgeAttributesUpdated",{hints:i||null})}forEachAdjacencyEntry(t){if(typeof t!="function")throw new q("Graph.forEachAdjacencyEntry: expecting a callback.");Ut(!1,!1,!1,this,t)}forEachAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new q("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Ut(!1,!1,!0,this,t)}forEachAssymetricAdjacencyEntry(t){if(typeof t!="function")throw new q("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Ut(!1,!0,!1,this,t)}forEachAssymetricAdjacencyEntryWithOrphans(t){if(typeof t!="function")throw new q("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Ut(!1,!0,!0,this,t)}nodes(){return Array.from(this._nodes.keys())}forEachNode(t){if(typeof t!="function")throw new q("Graph.forEachNode: expecting a callback.");const i=this._nodes.values();let e,r;for(;e=i.next(),e.done!==!0;)r=e.value,t(r.key,r.attributes)}findNode(t){if(typeof t!="function")throw new q("Graph.findNode: expecting a callback.");const i=this._nodes.values();let e,r;for(;e=i.next(),e.done!==!0;)if(r=e.value,t(r.key,r.attributes))return r.key}mapNodes(t){if(typeof t!="function")throw new q("Graph.mapNode: expecting a callback.");const i=this._nodes.values();let e,r;const o=new Array(this.order);let a=0;for(;e=i.next(),e.done!==!0;)r=e.value,o[a++]=t(r.key,r.attributes);return o}someNode(t){if(typeof t!="function")throw new q("Graph.someNode: expecting a callback.");const i=this._nodes.values();let e,r;for(;e=i.next(),e.done!==!0;)if(r=e.value,t(r.key,r.attributes))return!0;return!1}everyNode(t){if(typeof t!="function")throw new q("Graph.everyNode: expecting a callback.");const i=this._nodes.values();let e,r;for(;e=i.next(),e.done!==!0;)if(r=e.value,!t(r.key,r.attributes))return!1;return!0}filterNodes(t){if(typeof t!="function")throw new q("Graph.filterNodes: expecting a callback.");const i=this._nodes.values();let e,r;const o=[];for(;e=i.next(),e.done!==!0;)r=e.value,t(r.key,r.attributes)&&o.push(r.key);return o}reduceNodes(t,i){if(typeof t!="function")throw new q("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new q("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let e=i;const r=this._nodes.values();let o,a;for(;o=r.next(),o.done!==!0;)a=o.value,e=t(e,a.key,a.attributes);return e}nodeEntries(){const t=this._nodes.values();return{[Symbol.iterator](){return this},next(){const i=t.next();if(i.done)return i;const e=i.value;return{value:{node:e.key,attributes:e.attributes},done:!1}}}}export(){const t=new Array(this._nodes.size);let i=0;this._nodes.forEach((r,o)=>{t[i++]=Ql(o,r)});const e=new Array(this._edges.size);return i=0,this._edges.forEach((r,o)=>{e[i++]=Jl(this.type,o,r)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:t,edges:e}}import(t,i=!1){if(t instanceof Vi)return t.forEachNode((l,u)=>{i?this.mergeNode(l,u):this.addNode(l,u)}),t.forEachEdge((l,u,c,d,f,h,g)=>{i?g?this.mergeUndirectedEdgeWithKey(l,c,d,u):this.mergeDirectedEdgeWithKey(l,c,d,u):g?this.addUndirectedEdgeWithKey(l,c,d,u):this.addDirectedEdgeWithKey(l,c,d,u)}),this;if(!ge(t))throw new q("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(t.attributes){if(!ge(t.attributes))throw new q("Graph.import: invalid attributes. Expecting a plain object.");i?this.mergeAttributes(t.attributes):this.replaceAttributes(t.attributes)}let e,r,o,a,s;if(t.nodes){if(o=t.nodes,!Array.isArray(o))throw new q("Graph.import: invalid nodes. Expecting an array.");for(e=0,r=o.length;e<r;e++){a=o[e],eu(a);const{key:l,attributes:u}=a;i?this.mergeNode(l,u):this.addNode(l,u)}}if(t.edges){let l=!1;if(this.type==="undirected"&&(l=!0),o=t.edges,!Array.isArray(o))throw new q("Graph.import: invalid edges. Expecting an array.");for(e=0,r=o.length;e<r;e++){s=o[e],tu(s);const{source:u,target:c,attributes:d,undirected:f=l}=s;let h;"key"in s?(h=i?f?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:f?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,h.call(this,s.key,u,c,d)):(h=i?f?this.mergeUndirectedEdge:this.mergeDirectedEdge:f?this.addUndirectedEdge:this.addDirectedEdge,h.call(this,u,c,d))}}return this}nullCopy(t){const i=new Vi(de({},this._options,t));return i.replaceAttributes(de({},this.getAttributes())),i}emptyCopy(t){const i=this.nullCopy(t);return this._nodes.forEach((e,r)=>{const o=de({},e.attributes);e=new i.NodeDataClass(r,o),i._nodes.set(r,e)}),i}copy(t){if(t=t||{},typeof t.type=="string"&&t.type!==this.type&&t.type!=="mixed")throw new re(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${t.type}" because this would mean losing information about the current graph.`);if(typeof t.multi=="boolean"&&t.multi!==this.multi&&t.multi!==!0)throw new re("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof t.allowSelfLoops=="boolean"&&t.allowSelfLoops!==this.allowSelfLoops&&t.allowSelfLoops!==!0)throw new re("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const i=this.emptyCopy(t),e=this._edges.values();let r,o;for(;r=e.next(),r.done!==!0;)o=r.value,uo(i,"copy",!1,o.undirected,o.key,o.source.key,o.target.key,de({},o.attributes));return i}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const t={};this._nodes.forEach((o,a)=>{t[a]=o.attributes});const i={},e={};this._edges.forEach((o,a)=>{const s=o.undirected?"--":"->";let l="",u=o.source.key,c=o.target.key,d;o.undirected&&u>c&&(d=u,u=c,c=d);const f=`(${u})${s}(${c})`;a.startsWith("geid_")?this.multi&&(typeof e[f]>"u"?e[f]=0:e[f]++,l+=`${e[f]}. `):l+=`[${a}]: `,l+=f,i[l]=o.attributes});const r={};for(const o in this)this.hasOwnProperty(o)&&!Mr.has(o)&&typeof this[o]!="function"&&typeof o!="symbol"&&(r[o]=this[o]);return r.attributes=this._attributes,r.nodes=t,r.edges=i,ye(r,"constructor",this.constructor),r}};typeof Symbol<"u"&&(le.prototype[Symbol.for("nodejs.util.inspect.custom")]=le.prototype.inspect);nu.forEach(n=>{["add","merge","update"].forEach(t=>{const i=n.name(t),e=t==="add"?uo:su;n.generateKey?le.prototype[i]=function(r,o,a){return e(this,i,!0,(n.type||this.type)==="undirected",null,r,o,a,t==="update")}:le.prototype[i]=function(r,o,a,s){return e(this,i,!1,(n.type||this.type)==="undirected",r,o,a,s,t==="update")}})});pl(le);Rl(le);Hl(le);Zl(le);class co extends le{constructor(t){const i=de({type:"directed"},t);if("multi"in i&&i.multi!==!1)throw new q("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(i.type!=="directed")throw new q('DirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}class ho extends le{constructor(t){const i=de({type:"undirected"},t);if("multi"in i&&i.multi!==!1)throw new q("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(i.type!=="undirected")throw new q('UndirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}class fo extends le{constructor(t){const i=de({multi:!0},t);if("multi"in i&&i.multi!==!0)throw new q("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(i)}}class go extends le{constructor(t){const i=de({type:"directed",multi:!0},t);if("multi"in i&&i.multi!==!0)throw new q("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(i.type!=="directed")throw new q('MultiDirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}class vo extends le{constructor(t){const i=de({type:"undirected",multi:!0},t);if("multi"in i&&i.multi!==!0)throw new q("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(i.type!=="undirected")throw new q('MultiUndirectedGraph.from: inconsistent "'+i.type+'" type in given options!');super(i)}}function gt(n){n.from=function(t,i){const e=de({},t.options,i),r=new n(e);return r.import(t),r}}gt(le);gt(co);gt(ho);gt(fo);gt(go);gt(vo);le.Graph=le;le.DirectedGraph=co;le.UndirectedGraph=ho;le.MultiGraph=fo;le.MultiDirectedGraph=go;le.MultiUndirectedGraph=vo;le.InvalidArgumentsGraphError=q;le.NotFoundGraphError=U;le.UsageGraphError=re;var Qe={},mi,Ur;function ni(){if(Ur)return mi;Ur=1;function n(i){return!i||typeof i!="object"||typeof i=="function"||Array.isArray(i)||i instanceof Set||i instanceof Map||i instanceof RegExp||i instanceof Date}function t(i,e){i=i||{};var r={};for(var o in e){var a=i[o],s=e[o];if(!n(s)){r[o]=t(a,s);continue}a===void 0?r[o]=s:r[o]=a}return r}return mi=t,mi}var yi,jr;function lu(){if(jr)return yi;jr=1;function n(i){return function(e,r){return e+Math.floor(i()*(r-e+1))}}var t=n(Math.random);return t.createRandom=n,yi=t,yi}var bi,Hr;function uu(){if(Hr)return bi;Hr=1;var n=lu().createRandom;function t(e){var r=n(e);return function(o){for(var a=o.length,s=a-1,l=-1;++l<a;){var u=r(l,s),c=o[u];o[u]=o[l],o[l]=c}}}var i=t(Math.random);return i.createShuffleInPlace=t,bi=i,bi}var _i,Vr;function cu(){if(Vr)return _i;Vr=1;var n=ni(),t=ct(),i=uu(),e={attributes:{x:"x",y:"y"},center:0,hierarchyAttributes:[],rng:Math.random,scale:1};function r(p,T,w,L,k){this.wrappedCircle=k||null,this.children={},this.countChildren=0,this.id=p||null,this.next=null,this.previous=null,this.x=T||null,this.y=w||null,k?this.r=1010101:this.r=L||999}r.prototype.hasChildren=function(){return this.countChildren>0},r.prototype.addChild=function(p,T){this.children[p]=T,++this.countChildren},r.prototype.getChild=function(p){if(!this.children.hasOwnProperty(p)){var T=new r;this.children[p]=T,++this.countChildren}return this.children[p]},r.prototype.applyPositionToChildren=function(){if(this.hasChildren()){var p=this;for(var T in p.children){var w=p.children[T];w.x+=p.x,w.y+=p.y,w.applyPositionToChildren()}}};function o(p,T,w){for(var L in T.children){var k=T.children[L];k.hasChildren()?o(p,k,w):w[k.id]={x:k.x,y:k.y}}}function a(p,T){var w=p.r-T.r,L=T.x-p.x,k=T.y-p.y;return w<0||w*w<L*L+k*k}function s(p,T){var w=p.r-T.r+1e-6,L=T.x-p.x,k=T.y-p.y;return w>0&&w*w>L*L+k*k}function l(p,T){for(var w=0;w<T.length;++w)if(!s(p,T[w]))return!1;return!0}function u(p){return new r(null,p.x,p.y,p.r)}function c(p,T){var w=p.x,L=p.y,k=p.r,D=T.x,_=T.y,$=T.r,M=D-w,b=_-L,v=$-k,N=Math.sqrt(M*M+b*b);return new r(null,(w+D+M/N*v)/2,(L+_+b/N*v)/2,(N+k+$)/2)}function d(p,T,w){var L=p.x,k=p.y,D=p.r,_=T.x,$=T.y,M=T.r,b=w.x,v=w.y,N=w.r,F=L-_,z=L-b,V=k-$,X=k-v,O=M-D,j=N-D,W=L*L+k*k-D*D,oe=W-_*_-$*$+M*M,H=W-b*b-v*v+N*N,J=z*V-F*X,ne=(V*H-X*oe)/(J*2)-L,Y=(X*O-V*j)/J,ie=(z*oe-F*H)/(J*2)-k,te=(F*j-z*O)/J,se=Y*Y+te*te-1,K=2*(D+ne*Y+ie*te),Z=ne*ne+ie*ie-D*D,G=-(se?(K+Math.sqrt(K*K-4*se*Z))/(2*se):Z/K);return new r(null,L+ne+Y*G,k+ie+te*G,G)}function f(p){switch(p.length){case 1:return u(p[0]);case 2:return c(p[0],p[1]);case 3:return d(p[0],p[1],p[2]);default:throw new Error("graphology-layout/circlepack: Invalid basis length "+p.length)}}function h(p,T){var w,L;if(l(T,p))return[T];for(w=0;w<p.length;++w)if(a(T,p[w])&&l(c(p[w],T),p))return[p[w],T];for(w=0;w<p.length-1;++w)for(L=w+1;L<p.length;++L)if(a(c(p[w],p[L]),T)&&a(c(p[w],T),p[L])&&a(c(p[L],T),p[w])&&l(d(p[w],p[L],T),p))return[p[w],p[L],T];throw new Error("graphology-layout/circlepack: extendBasis failure !")}function g(p){var T=p.wrappedCircle,w=p.next.wrappedCircle,L=T.r+w.r,k=(T.x*w.r+w.x*T.r)/L,D=(T.y*w.r+w.y*T.r)/L;return k*k+D*D}function m(p,T){var w=0,L=p.slice(),k=p.length,D=[],_,$;for(T(L);w<k;)_=L[w],$&&s($,_)?++w:(D=h(D,_),$=f(D),w=0);return $}function y(p,T,w){var L=p.x-T.x,k,D,_=p.y-T.y,$,M,b=L*L+_*_;b?(D=T.r+w.r,D*=D,M=p.r+w.r,M*=M,D>M?(k=(b+M-D)/(2*b),$=Math.sqrt(Math.max(0,M/b-k*k)),w.x=p.x-k*L-$*_,w.y=p.y-k*_+$*L):(k=(b+D-M)/(2*b),$=Math.sqrt(Math.max(0,D/b-k*k)),w.x=T.x+k*L-$*_,w.y=T.y+k*_+$*L)):(w.x=T.x+w.r,w.y=T.y)}function A(p,T){var w=p.r+T.r-1e-6,L=T.x-p.x,k=T.y-p.y;return w>0&&w*w>L*L+k*k}function x(p,T){var w=p.length;if(w===0)return 0;var L,k,D,_,$,M,b,v,N,F;if(L=p[0],L.x=0,L.y=0,w<=1)return L.r;if(k=p[1],L.x=-k.r,k.x=L.r,k.y=0,w<=2)return L.r+k.r;D=p[2],y(k,L,D),L=new r(null,null,null,null,L),k=new r(null,null,null,null,k),D=new r(null,null,null,null,D),L.next=D.previous=k,k.next=L.previous=D,D.next=k.previous=L;e:for(M=3;M<w;++M){D=p[M],y(L.wrappedCircle,k.wrappedCircle,D),D=new r(null,null,null,null,D),b=k.next,v=L.previous,N=k.wrappedCircle.r,F=L.wrappedCircle.r;do if(N<=F){if(A(b.wrappedCircle,D.wrappedCircle)){k=b,L.next=k,k.previous=L,--M;continue e}N+=b.wrappedCircle.r,b=b.next}else{if(A(v.wrappedCircle,D.wrappedCircle)){L=v,L.next=k,k.previous=L,--M;continue e}F+=v.wrappedCircle.r,v=v.previous}while(b!==v.next);for(D.previous=L,D.next=k,L.next=k.previous=k=D,_=g(L);(D=D.next)!==k;)($=g(D))<_&&(L=D,_=$);k=L.next}L=[k.wrappedCircle],D=k;for(var z=1e4;(D=D.next)!==k&&--z!==0;)L.push(D.wrappedCircle);for(D=m(L,T),M=0;M<w;++M)L=p[M],L.x-=D.x,L.y-=D.y;return D.r}function C(p,T){var w=0;if(p.hasChildren()){for(var L in p.children){var k=p.children[L];k.hasChildren()&&(k.r=C(k,T))}w=x(Object.values(p.children),T)}return w}function E(p,T){C(p,T);for(var w in p.children){var L=p.children[w];L.applyPositionToChildren()}}function S(p,T,w){if(!t(T))throw new Error("graphology-layout/circlepack: the given graph is not a valid graphology instance.");w=n(w,e);var L={},k={},D=T.nodes(),_=w.center,$=w.hierarchyAttributes,M=i.createShuffleInPlace(w.rng),b=w.scale,v=new r;T.forEachNode(function(O,j){var W=j.size?j.size:1,oe=new r(O,null,null,W),H=v;$.forEach(function(J){var ne=j[J];H=H.getChild(ne)}),H.addChild(O,oe)}),E(v,M),o(T,v,L);var N=D.length,F,z,V;for(V=0;V<N;V++){var X=D[V];F=_+b*L[X].x,z=_+b*L[X].y,k[X]={x:F,y:z},p&&(T.setNodeAttribute(X,w.attributes.x,F),T.setNodeAttribute(X,w.attributes.y,z))}return k}var R=S.bind(null,!1);return R.assign=S.bind(null,!0),_i=R,_i}var Ei,Br;function du(){if(Br)return Ei;Br=1;var n=ni(),t=ct(),i={dimensions:["x","y"],center:.5,scale:1};function e(o,a,s){if(!t(a))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");s=n(s,i);var l=s.dimensions;if(!Array.isArray(l)||l.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var u=s.center,c=s.scale,d=Math.PI*2,f=(u-.5)*c,h=a.order,g=l[0],m=l[1];function y(C,E){return E[g]=c*Math.cos(C*d/h)+f,E[m]=c*Math.sin(C*d/h)+f,E}var A=0;if(!o){var x={};return a.forEachNode(function(C){x[C]=y(A++,{})}),x}a.updateEachNodeAttributes(function(C,E){return y(A++,E),E},{attributes:l})}var r=e.bind(null,!1);return r.assign=e.bind(null,!0),Ei=r,Ei}var wi,Wr;function hu(){if(Wr)return wi;Wr=1;var n=ni(),t=ct(),i={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function e(o,a,s){if(!t(a))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");s=n(s,i);var l=s.dimensions;if(!Array.isArray(l)||l.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var u=l.length,c=s.center,d=s.rng,f=s.scale,h=(c-.5)*f;function g(y){for(var A=0;A<u;A++)y[l[A]]=d()*f+h;return y}if(!o){var m={};return a.forEachNode(function(y){m[y]=g({})}),m}a.updateEachNodeAttributes(function(y,A){return g(A),A},{attributes:l})}var r=e.bind(null,!1);return r.assign=e.bind(null,!0),wi=r,wi}var xi,qr;function fu(){if(qr)return xi;qr=1;var n=ni(),t=ct(),i=Math.PI/180,e={dimensions:["x","y"],centeredOnZero:!1,degrees:!1};function r(a,s,l,u){if(!t(s))throw new Error("graphology-layout/rotation: the given graph is not a valid graphology instance.");u=n(u,e),u.degrees&&(l*=i);var c=u.dimensions;if(!Array.isArray(c)||c.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");if(s.order===0)return a?void 0:{};var d=c[0],f=c[1],h=0,g=0;if(!u.centeredOnZero){var m=1/0,y=-1/0,A=1/0,x=-1/0;s.forEachNode(function(p,T){var w=T[d],L=T[f];w<m&&(m=w),w>y&&(y=w),L<A&&(A=L),L>x&&(x=L)}),h=(m+y)/2,g=(A+x)/2}var C=Math.cos(l),E=Math.sin(l);function S(p){var T=p[d],w=p[f];return p[d]=h+(T-h)*C-(w-g)*E,p[f]=g+(T-h)*E+(w-g)*C,p}if(!a){var R={};return s.forEachNode(function(p,T){var w={};w[d]=T[d],w[f]=T[f],R[p]=S(w)}),R}s.updateEachNodeAttributes(function(p,T){return S(T),T},{attributes:c})}var o=r.bind(null,!1);return o.assign=r.bind(null,!0),xi=o,xi}var Xr;function gu(){return Xr||(Xr=1,Qe.circlepack=cu(),Qe.circular=du(),Qe.random=hu(),Qe.rotation=fu()),Qe}var Yr=gu(),Et={},Kr;function vu(){if(Kr)return Et;Kr=1;function n(e){return typeof e!="number"||isNaN(e)?1:e}function t(e,r){var o={},a=function(u){return typeof u>"u"?r:u};typeof r=="function"&&(a=r);var s=function(u){return a(u[e])},l=function(){return a(void 0)};return typeof e=="string"?(o.fromAttributes=s,o.fromGraph=function(u,c){return s(u.getNodeAttributes(c))},o.fromEntry=function(u,c){return s(c)}):typeof e=="function"?(o.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},o.fromGraph=function(u,c){return a(e(c,u.getNodeAttributes(c)))},o.fromEntry=function(u,c){return a(e(u,c))}):(o.fromAttributes=l,o.fromGraph=l,o.fromEntry=l),o}function i(e,r){var o={},a=function(u){return typeof u>"u"?r:u};typeof r=="function"&&(a=r);var s=function(u){return a(u[e])},l=function(){return a(void 0)};return typeof e=="string"?(o.fromAttributes=s,o.fromGraph=function(u,c){return s(u.getEdgeAttributes(c))},o.fromEntry=function(u,c){return s(c)},o.fromPartialEntry=o.fromEntry,o.fromMinimalEntry=o.fromEntry):typeof e=="function"?(o.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},o.fromGraph=function(u,c){var d=u.extremities(c);return a(e(c,u.getEdgeAttributes(c),d[0],d[1],u.getNodeAttributes(d[0]),u.getNodeAttributes(d[1]),u.isUndirected(c)))},o.fromEntry=function(u,c,d,f,h,g,m){return a(e(u,c,d,f,h,g,m))},o.fromPartialEntry=function(u,c,d,f){return a(e(u,c,d,f))},o.fromMinimalEntry=function(u,c){return a(e(u,c))}):(o.fromAttributes=l,o.fromGraph=l,o.fromEntry=l,o.fromMinimalEntry=l),o}return Et.createNodeValueGetter=t,Et.createEdgeValueGetter=i,Et.createEdgeWeightGetter=function(e){return i(e,n)},Et}var Ti,Zr;function pu(){if(Zr)return Ti;Zr=1;var n=0,t=1,i=2,e=3,r=4,o=5,a=6,s=7,l=8,u=9,c=0,d=1,f=2,h=0,g=1,m=2,y=3,A=4,x=5,C=6,E=7,S=8,R=3,p=10,T=3,w=9,L=10;return Ti=function(D,_,$){var M,b,v,N,F,z,V,X,O,j,W=_.length,oe=$.length,H=D.adjustSizes,J=D.barnesHutTheta*D.barnesHutTheta,ne,Y,ie,te,se,K,Z,G=[];for(v=0;v<W;v+=p)_[v+r]=_[v+i],_[v+o]=_[v+e],_[v+i]=0,_[v+e]=0;if(D.outboundAttractionDistribution){for(ne=0,v=0;v<W;v+=p)ne+=_[v+a];ne/=W/p}if(D.barnesHutOptimize){var Se=1/0,Xe=-1/0,$e=1/0,Ye=-1/0,me,Ke,oi;for(v=0;v<W;v+=p)Se=Math.min(Se,_[v+n]),Xe=Math.max(Xe,_[v+n]),$e=Math.min($e,_[v+t]),Ye=Math.max(Ye,_[v+t]);var kt=Xe-Se,Nt=Ye-$e;for(kt>Nt?($e-=(kt-Nt)/2,Ye=$e+kt):(Se-=(Nt-kt)/2,Xe=Se+Nt),G[0+h]=-1,G[0+g]=(Se+Xe)/2,G[0+m]=($e+Ye)/2,G[0+y]=Math.max(Xe-Se,Ye-$e),G[0+A]=-1,G[0+x]=-1,G[0+C]=0,G[0+E]=0,G[0+S]=0,M=1,v=0;v<W;v+=p)for(b=0,oi=R;;)if(G[b+x]>=0){_[v+n]<G[b+g]?_[v+t]<G[b+m]?me=G[b+x]:me=G[b+x]+w:_[v+t]<G[b+m]?me=G[b+x]+w*2:me=G[b+x]+w*3,G[b+E]=(G[b+E]*G[b+C]+_[v+n]*_[v+a])/(G[b+C]+_[v+a]),G[b+S]=(G[b+S]*G[b+C]+_[v+t]*_[v+a])/(G[b+C]+_[v+a]),G[b+C]+=_[v+a],b=me;continue}else if(G[b+h]<0){G[b+h]=v;break}else{if(G[b+x]=M*w,X=G[b+y]/2,O=G[b+x],G[O+h]=-1,G[O+g]=G[b+g]-X,G[O+m]=G[b+m]-X,G[O+y]=X,G[O+A]=O+w,G[O+x]=-1,G[O+C]=0,G[O+E]=0,G[O+S]=0,O+=w,G[O+h]=-1,G[O+g]=G[b+g]-X,G[O+m]=G[b+m]+X,G[O+y]=X,G[O+A]=O+w,G[O+x]=-1,G[O+C]=0,G[O+E]=0,G[O+S]=0,O+=w,G[O+h]=-1,G[O+g]=G[b+g]+X,G[O+m]=G[b+m]-X,G[O+y]=X,G[O+A]=O+w,G[O+x]=-1,G[O+C]=0,G[O+E]=0,G[O+S]=0,O+=w,G[O+h]=-1,G[O+g]=G[b+g]+X,G[O+m]=G[b+m]+X,G[O+y]=X,G[O+A]=G[b+A],G[O+x]=-1,G[O+C]=0,G[O+E]=0,G[O+S]=0,M+=4,_[G[b+h]+n]<G[b+g]?_[G[b+h]+t]<G[b+m]?me=G[b+x]:me=G[b+x]+w:_[G[b+h]+t]<G[b+m]?me=G[b+x]+w*2:me=G[b+x]+w*3,G[b+C]=_[G[b+h]+a],G[b+E]=_[G[b+h]+n],G[b+S]=_[G[b+h]+t],G[me+h]=G[b+h],G[b+h]=-1,_[v+n]<G[b+g]?_[v+t]<G[b+m]?Ke=G[b+x]:Ke=G[b+x]+w:_[v+t]<G[b+m]?Ke=G[b+x]+w*2:Ke=G[b+x]+w*3,me===Ke)if(oi--){b=me;continue}else{oi=R;break}G[Ke+h]=v;break}}if(D.barnesHutOptimize)for(Y=D.scalingRatio,v=0;v<W;v+=p)for(b=0;;)if(G[b+x]>=0)if(K=Math.pow(_[v+n]-G[b+E],2)+Math.pow(_[v+t]-G[b+S],2),j=G[b+y],4*j*j/K<J){if(ie=_[v+n]-G[b+E],te=_[v+t]-G[b+S],H===!0?K>0?(Z=Y*_[v+a]*G[b+C]/K,_[v+i]+=ie*Z,_[v+e]+=te*Z):K<0&&(Z=-Y*_[v+a]*G[b+C]/Math.sqrt(K),_[v+i]+=ie*Z,_[v+e]+=te*Z):K>0&&(Z=Y*_[v+a]*G[b+C]/K,_[v+i]+=ie*Z,_[v+e]+=te*Z),b=G[b+A],b<0)break;continue}else{b=G[b+x];continue}else{if(z=G[b+h],z>=0&&z!==v&&(ie=_[v+n]-_[z+n],te=_[v+t]-_[z+t],K=ie*ie+te*te,H===!0?K>0?(Z=Y*_[v+a]*_[z+a]/K,_[v+i]+=ie*Z,_[v+e]+=te*Z):K<0&&(Z=-Y*_[v+a]*_[z+a]/Math.sqrt(K),_[v+i]+=ie*Z,_[v+e]+=te*Z):K>0&&(Z=Y*_[v+a]*_[z+a]/K,_[v+i]+=ie*Z,_[v+e]+=te*Z)),b=G[b+A],b<0)break;continue}else for(Y=D.scalingRatio,N=0;N<W;N+=p)for(F=0;F<N;F+=p)ie=_[N+n]-_[F+n],te=_[N+t]-_[F+t],H===!0?(K=Math.sqrt(ie*ie+te*te)-_[N+l]-_[F+l],K>0?(Z=Y*_[N+a]*_[F+a]/K/K,_[N+i]+=ie*Z,_[N+e]+=te*Z,_[F+i]-=ie*Z,_[F+e]-=te*Z):K<0&&(Z=100*Y*_[N+a]*_[F+a],_[N+i]+=ie*Z,_[N+e]+=te*Z,_[F+i]-=ie*Z,_[F+e]-=te*Z)):(K=Math.sqrt(ie*ie+te*te),K>0&&(Z=Y*_[N+a]*_[F+a]/K/K,_[N+i]+=ie*Z,_[N+e]+=te*Z,_[F+i]-=ie*Z,_[F+e]-=te*Z));for(O=D.gravity/D.scalingRatio,Y=D.scalingRatio,v=0;v<W;v+=p)Z=0,ie=_[v+n],te=_[v+t],K=Math.sqrt(Math.pow(ie,2)+Math.pow(te,2)),D.strongGravityMode?K>0&&(Z=Y*_[v+a]*O):K>0&&(Z=Y*_[v+a]*O/K),_[v+i]-=ie*Z,_[v+e]-=te*Z;for(Y=1*(D.outboundAttractionDistribution?ne:1),V=0;V<oe;V+=T)N=$[V+c],F=$[V+d],X=$[V+f],se=Math.pow(X,D.edgeWeightInfluence),ie=_[N+n]-_[F+n],te=_[N+t]-_[F+t],H===!0?(K=Math.sqrt(ie*ie+te*te)-_[N+l]-_[F+l],D.linLogMode?D.outboundAttractionDistribution?K>0&&(Z=-Y*se*Math.log(1+K)/K/_[N+a]):K>0&&(Z=-Y*se*Math.log(1+K)/K):D.outboundAttractionDistribution?K>0&&(Z=-Y*se/_[N+a]):K>0&&(Z=-Y*se)):(K=Math.sqrt(Math.pow(ie,2)+Math.pow(te,2)),D.linLogMode?D.outboundAttractionDistribution?K>0&&(Z=-Y*se*Math.log(1+K)/K/_[N+a]):K>0&&(Z=-Y*se*Math.log(1+K)/K):D.outboundAttractionDistribution?(K=1,Z=-Y*se/_[N+a]):(K=1,Z=-Y*se)),K>0&&(_[N+i]+=ie*Z,_[N+e]+=te*Z,_[F+i]-=ie*Z,_[F+e]-=te*Z);var Dt,vt,Gt,Ue,Pt,zt;if(H===!0)for(v=0;v<W;v+=p)_[v+u]!==1&&(Dt=Math.sqrt(Math.pow(_[v+i],2)+Math.pow(_[v+e],2)),Dt>L&&(_[v+i]=_[v+i]*L/Dt,_[v+e]=_[v+e]*L/Dt),vt=_[v+a]*Math.sqrt((_[v+r]-_[v+i])*(_[v+r]-_[v+i])+(_[v+o]-_[v+e])*(_[v+o]-_[v+e])),Gt=Math.sqrt((_[v+r]+_[v+i])*(_[v+r]+_[v+i])+(_[v+o]+_[v+e])*(_[v+o]+_[v+e]))/2,Ue=.1*Math.log(1+Gt)/(1+Math.sqrt(vt)),Pt=_[v+n]+_[v+i]*(Ue/D.slowDown),_[v+n]=Pt,zt=_[v+t]+_[v+e]*(Ue/D.slowDown),_[v+t]=zt);else for(v=0;v<W;v+=p)_[v+u]!==1&&(vt=_[v+a]*Math.sqrt((_[v+r]-_[v+i])*(_[v+r]-_[v+i])+(_[v+o]-_[v+e])*(_[v+o]-_[v+e])),Gt=Math.sqrt((_[v+r]+_[v+i])*(_[v+r]+_[v+i])+(_[v+o]+_[v+e])*(_[v+o]+_[v+e]))/2,Ue=_[v+s]*Math.log(1+Gt)/(1+Math.sqrt(vt)),_[v+s]=Math.min(1,Math.sqrt(Ue*(Math.pow(_[v+i],2)+Math.pow(_[v+e],2))/(1+Math.sqrt(vt)))),Pt=_[v+n]+_[v+i]*(Ue/D.slowDown),_[v+n]=Pt,zt=_[v+t]+_[v+e]*(Ue/D.slowDown),_[v+t]=zt);return{}},Ti}var Ae={},Qr;function mu(){if(Qr)return Ae;Qr=1;var n=10,t=3;return Ae.assign=function(i){i=i||{};var e=Array.prototype.slice.call(arguments).slice(1),r,o,a;for(r=0,a=e.length;r<a;r++)if(e[r])for(o in e[r])i[o]=e[r][o];return i},Ae.validateSettings=function(i){return"linLogMode"in i&&typeof i.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in i&&typeof i.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in i&&typeof i.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in i&&typeof i.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in i&&!(typeof i.scalingRatio=="number"&&i.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in i&&typeof i.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in i&&!(typeof i.gravity=="number"&&i.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in i&&!(typeof i.slowDown=="number"||i.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in i&&typeof i.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in i&&!(typeof i.barnesHutTheta=="number"&&i.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},Ae.graphToByteArrays=function(i,e){var r=i.order,o=i.size,a={},s,l=new Float32Array(r*n),u=new Float32Array(o*t);return s=0,i.forEachNode(function(c,d){a[c]=s,l[s]=d.x,l[s+1]=d.y,l[s+2]=0,l[s+3]=0,l[s+4]=0,l[s+5]=0,l[s+6]=1,l[s+7]=1,l[s+8]=d.size||1,l[s+9]=d.fixed?1:0,s+=n}),s=0,i.forEachEdge(function(c,d,f,h,g,m,y){var A=a[f],x=a[h],C=e(c,d,f,h,g,m,y);l[A+6]+=C,l[x+6]+=C,u[s]=A,u[s+1]=x,u[s+2]=C,s+=t}),{nodes:l,edges:u}},Ae.assignLayoutChanges=function(i,e,r){var o=0;i.updateEachNodeAttributes(function(a,s){return s.x=e[o],s.y=e[o+1],o+=n,r?r(a,s):s})},Ae.readGraphPositions=function(i,e){var r=0;i.forEachNode(function(o,a){e[r]=a.x,e[r+1]=a.y,r+=n})},Ae.collectLayoutChanges=function(i,e,r){for(var o=i.nodes(),a={},s=0,l=0,u=e.length;s<u;s+=n){if(r){var c=Object.assign({},i.getNodeAttributes(o[l]));c.x=e[s],c.y=e[s+1],c=r(o[l],c),a[o[l]]={x:c.x,y:c.y}}else a[o[l]]={x:e[s],y:e[s+1]};l++}return a},Ae.createWorker=function(e){var r=window.URL||window.webkitURL,o=e.toString(),a=r.createObjectURL(new Blob(["("+o+").call(this);"],{type:"text/javascript"})),s=new Worker(a);return r.revokeObjectURL(a),s},Ae}var Si,Jr;function yu(){return Jr||(Jr=1,Si={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),Si}var Ai,en;function bu(){if(en)return Ai;en=1;var n=ct(),t=vu().createEdgeWeightGetter,i=pu(),e=mu(),r=yu();function o(l,u,c){if(!n(u))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof c=="number"&&(c={iterations:c});var d=c.iterations;if(typeof d!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(d<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var f=t("getEdgeWeight"in c?c.getEdgeWeight:"weight").fromEntry,h=typeof c.outputReducer=="function"?c.outputReducer:null,g=e.assign({},r,c.settings),m=e.validateSettings(g);if(m)throw new Error("graphology-layout-forceatlas2: "+m.message);var y=e.graphToByteArrays(u,f),A;for(A=0;A<d;A++)i(g,y.nodes,y.edges);if(l){e.assignLayoutChanges(u,y.nodes,h);return}return e.collectLayoutChanges(u,y.nodes)}function a(l){var u=typeof l=="number"?l:l.order;return{barnesHutOptimize:u>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(u)}}var s=o.bind(null,!1);return s.assign=o.bind(null,!0),s.inferSettings=a,Ai=s,Ai}var _u=bu();const tn=En(_u);let rn=class po extends le{constructor(t){super(t);const i=at(()=>this.checkParallelEdges());this.on("edgeAdded",i),this.on("edgeDropped",i);const e=at(()=>{this.emit("nodesSelected",this.filterNodes((o,a)=>a.selected))}),r=({name:o})=>{o==="selected"&&e()};this.on("nodeDropped",e),this.on("nodeAttributesUpdated",r)}on(t,i){return super.on(t,i)}off(t,i){return super.off(t,i)}emit(t,...i){return super.emit(t,...i)}mergeNodes(t,i,e,r){if(!i.length)return;let o={},a=[];const s=[];return i.forEach(l=>{const u=this.getNodeAttributes(l);u&&s.push(u);const c=this.edges(l);c.length&&c.forEach(d=>{const f=this.source(d),h=this.target(d),g=this.getEdgeAttributes(d);g&&a.push({key:d,source:f===l?t:f,target:h===l?t:h,attributes:g})})}),typeof e=="function"?o=e(s):typeof e=="object"&&Object.assign(o,e),typeof r=="function"&&(a=r(a)),this.dropNodes(i),this.import({nodes:[{key:t,attributes:o}],edges:a},!0),this}groupNodes(t,i,e,r){if(!i.length)return;let o={nodeList:i,isGroup:!0,expanded:!1},a=[];const s=[],l=[];return i.forEach(u=>{const c=this.getNodeAttributes(u);c&&l.push(c);const d=this.edges(u);if(d.length){const f=d.map(h=>{const g=this.source(h),m=this.target(h),y=this.getEdgeAttributes(h);return y&&(s.push({key:h,source:g===u?u:t,target:m===u?u:t,attributes:y}),a.push({key:`${t}-${h}`,source:g===u?t:g,target:m===u?t:m,attributes:y})),this.dropEdge(h),{key:h,source:g,target:m,attributes:y}});this.setNodeAttribute(u,"hidden",!0),this.setNodeAttribute(u,"selected",!1),this.setNodeAttribute(u,"originalEdges",f)}}),typeof e=="function"?o=Object.assign(o,e(l)):typeof e=="object"&&Object.assign(o,e),typeof r=="function"&&(a=r(a)),this.import({nodes:[{key:t,attributes:o}],edges:a.concat(s)},!0),this}ungroupNode(t){const i=this.getNodeAttributes(t);return!i||!i.isGroup?void 0:((i.nodeList||[]).forEach(r=>{const o=this.getNodeAttribute(r,"originalEdges");o&&Array.isArray(o)&&o.forEach(a=>{this.addEdgeWithKey(a.key,a.source,a.target,a.attributes)}),this.setNodeAttribute(r,"hidden",!1),this.removeNodeAttribute(r,"originalEdges")}),this.dropNode(t),this)}toggleExpanded(t,i){const e=i??!this.getNodeAttribute(t,"expanded"),r=this.getNodeAttribute(t,"nodeList");return this.setNodeAttribute(t,"expanded",e),r.forEach(o=>{this.setNodeAttribute(o,"hidden",!e)}),this}import(t,i){const e=[];t instanceof po?e.push(...t.nodes()):e.push(...t.nodes.map(o=>o.key)),super.import(t,i),this.emit("nodesLoaded",e);const r=Yr.random(this);return ci(this,r,{duration:1e3}),this.emit("layoutDone"),this}circularLayout(){if(this.size===0)return this;const t=Yr.circular(this);return ci(this,t,{duration:1e3},()=>{this.emit("layoutDone")}),this}forceLayout(t=1e3,i){if(this.size===0)return this;const e=tn.inferSettings(this),r=tn(this,{iterations:t,settings:{...e,...i}});return ci(this,r,{duration:1e3},()=>{this.emit("layoutDone")}),this}dropNodes(t){t.length&&t.forEach(i=>this.dropNode(i))}getCurvature(t,i=0){if(i<=0)throw new Error("Invalid maxIndex");if(t<0)return-this.getCurvature(-t,i);const e=.25;return e*(1-Math.exp(-i/e))*Lt*t/i}checkParallelEdges(){tl(this,{edgeIndexAttribute:"parallelIndex",edgeMinIndexAttribute:"parallelMinIndex",edgeMaxIndexAttribute:"parallelMaxIndex"}),this.forEachEdge((t,{parallelIndex:i,parallelMinIndex:e,parallelMaxIndex:r})=>{typeof e=="number"?this.mergeEdgeAttributes(t,{type:i?"curved":"line",curvature:this.getCurvature(i??1,r??1)}):typeof i=="number"?this.mergeEdgeAttributes(t,{type:"curved",curvature:this.getCurvature(i??1,r??1)}):this.setEdgeAttribute(t,"type","line")})}};const Eu=n=>{const[t,i]=B.useState(new rn({multi:!0})),[e,r]=B.useState([]);return B.useEffect(()=>{if(n instanceof rn){i(n);return}t.clear(),n&&t.import(n,!1)},[n]),B.useEffect(()=>{const o=a=>{r(a)};return t.on("nodesSelected",o),()=>{t.off("nodesSelected",o)}},[t]),{graph:t,selected:e}};var ir=function(n){function t(){var i;return ve(this,t),i=_e(this,t),i.rawEmitter=i,i}return Ee(t,n),pe(t)}(ii.EventEmitter),rr={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:gs,defaultDrawNodeLabel:Un,defaultDrawNodeHover:vs,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},wu={circle:ei},xu={arrow:Gs,line:Is};function Ri(n){if(typeof n.labelDensity!="number"||n.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var t=n.minCameraRatio,i=n.maxCameraRatio;if(typeof t=="number"&&typeof i=="number"&&i<t)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function Tu(n){var t=di({},rr,n);return t.nodeProgramClasses=di({},wu,t.nodeProgramClasses),t.edgeProgramClasses=di({},xu,t.edgeProgramClasses),t}var jt=1.5,nn=function(n){function t(){var i;return ve(this,t),i=_e(this,t),I(i,"x",.5),I(i,"y",.5),I(i,"angle",0),I(i,"ratio",1),I(i,"minRatio",null),I(i,"maxRatio",null),I(i,"enabledZooming",!0),I(i,"enabledPanning",!0),I(i,"enabledRotation",!0),I(i,"clean",null),I(i,"nextFrame",null),I(i,"previousState",null),I(i,"enabled",!0),i.previousState=i.getState(),i}return Ee(t,n),pe(t,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(e){return this.x===e.x&&this.y===e.y&&this.ratio===e.ratio&&this.angle===e.angle}},{key:"getPreviousState",value:function(){var e=this.previousState;return e?{x:e.x,y:e.y,angle:e.angle,ratio:e.ratio}:null}},{key:"getBoundedRatio",value:function(e){var r=e;return typeof this.minRatio=="number"&&(r=Math.max(r,this.minRatio)),typeof this.maxRatio=="number"&&(r=Math.min(r,this.maxRatio)),r}},{key:"validateState",value:function(e){var r={};return this.enabledPanning&&typeof e.x=="number"&&(r.x=e.x),this.enabledPanning&&typeof e.y=="number"&&(r.y=e.y),this.enabledZooming&&typeof e.ratio=="number"&&(r.ratio=this.getBoundedRatio(e.ratio)),this.enabledRotation&&typeof e.angle=="number"&&(r.angle=e.angle),this.clean?this.clean(Q(Q({},this.getState()),r)):r}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(e){if(!this.enabled)return this;this.previousState=this.getState();var r=this.validateState(e);return typeof r.x=="number"&&(this.x=r.x),typeof r.y=="number"&&(this.y=r.y),typeof r.ratio=="number"&&(this.ratio=r.ratio),typeof r.angle=="number"&&(this.angle=r.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(e){return this.setState(e(this.getState())),this}},{key:"animate",value:function(e){var r=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;if(!a)return new Promise(function(h){return r.animate(e,o,h)});if(this.enabled){var s=Q(Q({},Pn),o),l=this.validateState(e),u=typeof s.easing=="function"?s.easing:Gn[s.easing],c=Date.now(),d=this.getState(),f=function(){var g=(Date.now()-c)/s.duration;if(g>=1){r.nextFrame=null,r.setState(l),r.animationCallback&&(r.animationCallback.call(null),r.animationCallback=void 0);return}var m=u(g),y={};typeof l.x=="number"&&(y.x=d.x+(l.x-d.x)*m),typeof l.y=="number"&&(y.y=d.y+(l.y-d.y)*m),r.enabledRotation&&typeof l.angle=="number"&&(y.angle=d.angle+(l.angle-d.angle)*m),typeof l.ratio=="number"&&(y.ratio=d.ratio+(l.ratio-d.ratio)*m),r.setState(y),r.nextFrame=requestAnimationFrame(f)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(f)):f(),this.animationCallback=a}}},{key:"animatedZoom",value:function(e){return e?typeof e=="number"?this.animate({ratio:this.ratio/e}):this.animate({ratio:this.ratio/(e.factor||jt)},e):this.animate({ratio:this.ratio/jt})}},{key:"animatedUnzoom",value:function(e){return e?typeof e=="number"?this.animate({ratio:this.ratio*e}):this.animate({ratio:this.ratio*(e.factor||jt)},e):this.animate({ratio:this.ratio*jt})}},{key:"animatedReset",value:function(e){return this.animate({x:.5,y:.5,ratio:1,angle:0},e)}},{key:"copy",value:function(){return t.from(this.getState())}}],[{key:"from",value:function(e){var r=new t;return r.setState(e)}}])}(ir);function Te(n,t){var i=t.getBoundingClientRect();return{x:n.clientX-i.left,y:n.clientY-i.top}}function Re(n,t){var i=Q(Q({},Te(n,t)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){i.sigmaDefaultPrevented=!0},original:n});return i}function wt(n){var t="x"in n?n:Q(Q({},n.touches[0]||n.previousTouches[0]),{},{original:n.original,sigmaDefaultPrevented:n.sigmaDefaultPrevented,preventSigmaDefault:function(){n.sigmaDefaultPrevented=!0,t.sigmaDefaultPrevented=!0}});return t}function Su(n,t){return Q(Q({},Re(n,t)),{},{delta:mo(n)})}var Au=2;function Xt(n){for(var t=[],i=0,e=Math.min(n.length,Au);i<e;i++)t.push(n[i]);return t}function xt(n,t,i){var e={touches:Xt(n.touches).map(function(r){return Te(r,i)}),previousTouches:t.map(function(r){return Te(r,i)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){e.sigmaDefaultPrevented=!0},original:n};return e}function mo(n){if(typeof n.deltaY<"u")return n.deltaY*-3/360;if(typeof n.detail<"u")return n.detail/-9;throw new Error("Captor: could not extract delta from event.")}var yo=function(n){function t(i,e){var r;return ve(this,t),r=_e(this,t),r.container=i,r.renderer=e,r}return Ee(t,n),pe(t)}(ir),Ru=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],Cu=Ru.reduce(function(n,t){return Q(Q({},n),{},I({},t,rr[t]))},{}),Lu=function(n){function t(i,e){var r;return ve(this,t),r=_e(this,t,[i,e]),I(r,"enabled",!0),I(r,"draggedEvents",0),I(r,"downStartTime",null),I(r,"lastMouseX",null),I(r,"lastMouseY",null),I(r,"isMouseDown",!1),I(r,"isMoving",!1),I(r,"movingTimeout",null),I(r,"startCameraState",null),I(r,"clicks",0),I(r,"doubleClickTimeout",null),I(r,"currentWheelDirection",0),I(r,"settings",Cu),r.handleClick=r.handleClick.bind(r),r.handleRightClick=r.handleRightClick.bind(r),r.handleDown=r.handleDown.bind(r),r.handleUp=r.handleUp.bind(r),r.handleMove=r.handleMove.bind(r),r.handleWheel=r.handleWheel.bind(r),r.handleLeave=r.handleLeave.bind(r),r.handleEnter=r.handleEnter.bind(r),i.addEventListener("click",r.handleClick,{capture:!1}),i.addEventListener("contextmenu",r.handleRightClick,{capture:!1}),i.addEventListener("mousedown",r.handleDown,{capture:!1}),i.addEventListener("wheel",r.handleWheel,{capture:!1}),i.addEventListener("mouseleave",r.handleLeave,{capture:!1}),i.addEventListener("mouseenter",r.handleEnter,{capture:!1}),document.addEventListener("mousemove",r.handleMove,{capture:!1}),document.addEventListener("mouseup",r.handleUp,{capture:!1}),r}return Ee(t,n),pe(t,[{key:"kill",value:function(){var e=this.container;e.removeEventListener("click",this.handleClick),e.removeEventListener("contextmenu",this.handleRightClick),e.removeEventListener("mousedown",this.handleDown),e.removeEventListener("wheel",this.handleWheel),e.removeEventListener("mouseleave",this.handleLeave),e.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(e){var r=this;if(this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(e);setTimeout(function(){r.clicks=0,r.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",Re(e,this.container))}}},{key:"handleRightClick",value:function(e){this.enabled&&this.emit("rightClick",Re(e,this.container))}},{key:"handleDoubleClick",value:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var r=Re(e,this.container);if(this.emit("doubleClick",r),!r.sigmaDefaultPrevented){var o=this.renderer.getCamera(),a=o.getBoundedRatio(o.getState().ratio/this.settings.doubleClickZoomingRatio);o.animate(this.renderer.getViewportZoomedState(Te(e,this.container),a),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(e){if(this.enabled){if(e.button===0){this.startCameraState=this.renderer.getCamera().getState();var r=Te(e,this.container),o=r.x,a=r.y;this.lastMouseX=o,this.lastMouseY=a,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",Re(e,this.container))}}},{key:"handleUp",value:function(e){var r=this;if(!(!this.enabled||!this.isMouseDown)){var o=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var a=Te(e,this.container),s=a.x,l=a.y,u=o.getState(),c=o.getPreviousState()||{x:0,y:0};this.isMoving?o.animate({x:u.x+this.settings.inertiaRatio*(u.x-c.x),y:u.y+this.settings.inertiaRatio*(u.y-c.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==s||this.lastMouseY!==l)&&o.setState({x:u.x,y:u.y}),this.isMoving=!1,setTimeout(function(){var d=r.draggedEvents>0;r.draggedEvents=0,d&&r.renderer.getSetting("hideEdgesOnMove")&&r.renderer.refresh()},0),this.emit("mouseup",Re(e,this.container))}}},{key:"handleMove",value:function(e){var r=this;if(this.enabled){var o=Re(e,this.container);if(this.emit("mousemovebody",o),(e.target===this.container||e.composedPath()[0]===this.container)&&this.emit("mousemove",o),!o.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){r.movingTimeout=null,r.isMoving=!1},this.settings.dragTimeout);var a=this.renderer.getCamera(),s=Te(e,this.container),l=s.x,u=s.y,c=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),d=this.renderer.viewportToFramedGraph({x:l,y:u}),f=c.x-d.x,h=c.y-d.y,g=a.getState(),m=g.x+f,y=g.y+h;a.setState({x:m,y}),this.lastMouseX=l,this.lastMouseY=u,e.preventDefault(),e.stopPropagation()}}}},{key:"handleLeave",value:function(e){this.emit("mouseleave",Re(e,this.container))}},{key:"handleEnter",value:function(e){this.emit("mouseenter",Re(e,this.container))}},{key:"handleWheel",value:function(e){var r=this,o=this.renderer.getCamera();if(!(!this.enabled||!o.enabledZooming)){var a=mo(e);if(a){var s=Su(e,this.container);if(this.emit("wheel",s),s.sigmaDefaultPrevented){e.preventDefault(),e.stopPropagation();return}var l=o.getState().ratio,u=a>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,c=o.getBoundedRatio(l*u),d=a>0?1:-1,f=Date.now();l!==c&&(e.preventDefault(),e.stopPropagation(),!(this.currentWheelDirection===d&&this.lastWheelTriggerTime&&f-this.lastWheelTriggerTime<this.settings.zoomDuration/5)&&(o.animate(this.renderer.getViewportZoomedState(Te(e,this.container),c),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){r.currentWheelDirection=0}),this.currentWheelDirection=d,this.lastWheelTriggerTime=f))}}}},{key:"setSettings",value:function(e){this.settings=e}}])}(yo),ku=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],Nu=ku.reduce(function(n,t){return Q(Q({},n),{},I({},t,rr[t]))},{}),Du=function(n){function t(i,e){var r;return ve(this,t),r=_e(this,t,[i,e]),I(r,"enabled",!0),I(r,"isMoving",!1),I(r,"hasMoved",!1),I(r,"touchMode",0),I(r,"startTouchesPositions",[]),I(r,"lastTouches",[]),I(r,"lastTap",null),I(r,"settings",Nu),r.handleStart=r.handleStart.bind(r),r.handleLeave=r.handleLeave.bind(r),r.handleMove=r.handleMove.bind(r),i.addEventListener("touchstart",r.handleStart,{capture:!1}),i.addEventListener("touchcancel",r.handleLeave,{capture:!1}),document.addEventListener("touchend",r.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",r.handleMove,{capture:!1,passive:!1}),r}return Ee(t,n),pe(t,[{key:"kill",value:function(){var e=this.container;e.removeEventListener("touchstart",this.handleStart),e.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(e){var r=this;if(this.enabled){e.preventDefault();var o=Xt(e.touches);if(this.touchMode=o.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=o.map(function(h){return Te(h,r.container)}),this.touchMode===2){var a=st(this.startTouchesPositions,2),s=a[0],l=s.x,u=s.y,c=a[1],d=c.x,f=c.y;this.startTouchesAngle=Math.atan2(f-u,d-l),this.startTouchesDistance=Math.sqrt(Math.pow(d-l,2)+Math.pow(f-u,2))}this.emit("touchdown",xt(e,this.lastTouches,this.container)),this.lastTouches=o,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(e){if(!(!this.enabled||!this.startTouchesPositions.length)){switch(e.cancelable&&e.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(e.touches.length===1){this.handleStart(e),e.preventDefault();break}case 1:if(this.isMoving){var r=this.renderer.getCamera(),o=r.getState(),a=r.getPreviousState()||{x:0,y:0};r.animate({x:o.x+this.settings.inertiaRatio*(o.x-a.x),y:o.y+this.settings.inertiaRatio*(o.y-a.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",xt(e,this.lastTouches,this.container)),!e.touches.length){var s=Te(this.lastTouches[0],this.container),l=this.startTouchesPositions[0],u=Math.pow(s.x-l.x,2)+Math.pow(s.y-l.y,2);if(!e.touches.length&&u<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var c=xt(e,this.lastTouches,this.container);if(this.emit("doubletap",c),this.lastTap=null,!c.sigmaDefaultPrevented){var d=this.renderer.getCamera(),f=d.getBoundedRatio(d.getState().ratio/this.settings.doubleClickZoomingRatio);d.animate(this.renderer.getViewportZoomedState(s,f),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var h=xt(e,this.lastTouches,this.container);this.emit("tap",h),this.lastTap={time:Date.now(),position:h.touches[0]||h.previousTouches[0]}}}this.lastTouches=Xt(e.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(e){var r=this;if(!(!this.enabled||!this.startTouchesPositions.length)){e.preventDefault();var o=Xt(e.touches),a=o.map(function(V){return Te(V,r.container)}),s=this.lastTouches;this.lastTouches=o,this.lastTouchesPositions=a;var l=xt(e,s,this.container);if(this.emit("touchmove",l),!l.sigmaDefaultPrevented&&(this.hasMoved||(this.hasMoved=a.some(function(V,X){var O=r.startTouchesPositions[X];return O&&(V.x!==O.x||V.y!==O.y)})),!!this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){r.isMoving=!1},this.settings.dragTimeout);var u=this.renderer.getCamera(),c=this.startCameraState,d=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var f=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),h=f.x,g=f.y,m=this.renderer.viewportToFramedGraph(a[0]),y=m.x,A=m.y;u.setState({x:c.x+h-y,y:c.y+g-A});break}case 2:{var x={x:.5,y:.5,angle:0,ratio:1},C=a[0],E=C.x,S=C.y,R=a[1],p=R.x,T=R.y,w=Math.atan2(T-S,p-E)-this.startTouchesAngle,L=Math.hypot(T-S,p-E)/this.startTouchesDistance,k=u.getBoundedRatio(c.ratio/L);x.ratio=k,x.angle=c.angle+w;var D=this.getDimensions(),_=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:c}),$=Math.min(D.width,D.height)-2*d,M=$/D.width,b=$/D.height,v=k/$,N=E-$/2/M,F=S-$/2/b,z=[N*Math.cos(-x.angle)-F*Math.sin(-x.angle),F*Math.cos(-x.angle)+N*Math.sin(-x.angle)];N=z[0],F=z[1],x.x=_.x-N*v,x.y=_.y+F*v,u.setState(x);break}}}}}},{key:"setSettings",value:function(e){this.settings=e}}])}(yo);function Gu(n){if(Array.isArray(n))return zi(n)}function Pu(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function zu(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function on(n){return Gu(n)||Pu(n)||Ln(n)||zu()}function Ou(n,t){if(n==null)return{};var i={};for(var e in n)if({}.hasOwnProperty.call(n,e)){if(t.indexOf(e)!==-1)continue;i[e]=n[e]}return i}function Ci(n,t){if(n==null)return{};var i,e,r=Ou(n,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(e=0;e<o.length;e++)i=o[e],t.indexOf(i)===-1&&{}.propertyIsEnumerable.call(n,i)&&(r[i]=n[i])}return r}var an=function(){function n(t,i){ve(this,n),this.key=t,this.size=i}return pe(n,null,[{key:"compare",value:function(i,e){return i.size>e.size?-1:i.size<e.size||i.key>e.key?1:-1}}])}(),sn=function(){function n(){ve(this,n),I(this,"width",0),I(this,"height",0),I(this,"cellSize",0),I(this,"columns",0),I(this,"rows",0),I(this,"cells",{})}return pe(n,[{key:"resizeAndClear",value:function(i,e){this.width=i.width,this.height=i.height,this.cellSize=e,this.columns=Math.ceil(i.width/e),this.rows=Math.ceil(i.height/e),this.cells={}}},{key:"getIndex",value:function(i){var e=Math.floor(i.x/this.cellSize),r=Math.floor(i.y/this.cellSize);return r*this.columns+e}},{key:"add",value:function(i,e,r){var o=new an(i,e),a=this.getIndex(r),s=this.cells[a];s||(s=[],this.cells[a]=s),s.push(o)}},{key:"organize",value:function(){for(var i in this.cells){var e=this.cells[i];e.sort(an.compare)}}},{key:"getLabelsToDisplay",value:function(i,e){var r=this.cellSize*this.cellSize,o=r/i/i,a=o*e/r,s=Math.ceil(a),l=[];for(var u in this.cells)for(var c=this.cells[u],d=0;d<Math.min(s,c.length);d++)l.push(c[d].key);return l}}])}();function Iu(n){var t=n.graph,i=n.hoveredNode,e=n.highlightedNodes,r=n.displayedNodeLabels,o=[];return t.forEachEdge(function(a,s,l,u){(l===i||u===i||e.has(l)||e.has(u)||r.has(l)&&r.has(u))&&o.push(a)}),o}var ln=150,un=50,Ce=Object.prototype.hasOwnProperty;function Fu(n,t,i){if(!Ce.call(i,"x")||!Ce.call(i,"y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(t,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return i.color||(i.color=n.defaultNodeColor),!i.label&&i.label!==""&&(i.label=null),i.label!==void 0&&i.label!==null?i.label=""+i.label:i.label=null,i.size||(i.size=2),Ce.call(i,"hidden")||(i.hidden=!1),Ce.call(i,"highlighted")||(i.highlighted=!1),Ce.call(i,"forceLabel")||(i.forceLabel=!1),(!i.type||i.type==="")&&(i.type=n.defaultNodeType),i.zIndex||(i.zIndex=0),i}function Mu(n,t,i){return i.color||(i.color=n.defaultEdgeColor),i.label||(i.label=""),i.size||(i.size=.5),Ce.call(i,"hidden")||(i.hidden=!1),Ce.call(i,"forceLabel")||(i.forceLabel=!1),(!i.type||i.type==="")&&(i.type=n.defaultEdgeType),i.zIndex||(i.zIndex=0),i}var $u=function(n){function t(i,e){var r,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(ve(this,t),r=_e(this,t),I(r,"elements",{}),I(r,"canvasContexts",{}),I(r,"webGLContexts",{}),I(r,"pickingLayers",new Set),I(r,"textures",{}),I(r,"frameBuffers",{}),I(r,"activeListeners",{}),I(r,"labelGrid",new sn),I(r,"nodeDataCache",{}),I(r,"edgeDataCache",{}),I(r,"nodeProgramIndex",{}),I(r,"edgeProgramIndex",{}),I(r,"nodesWithForcedLabels",new Set),I(r,"edgesWithForcedLabels",new Set),I(r,"nodeExtent",{x:[0,1],y:[0,1]}),I(r,"nodeZExtent",[1/0,-1/0]),I(r,"edgeZExtent",[1/0,-1/0]),I(r,"matrix",xe()),I(r,"invMatrix",xe()),I(r,"correctionRatio",1),I(r,"customBBox",null),I(r,"normalizationFunction",wr({x:[0,1],y:[0,1]})),I(r,"graphToViewportRatio",1),I(r,"itemIDsIndex",{}),I(r,"nodeIndices",{}),I(r,"edgeIndices",{}),I(r,"width",0),I(r,"height",0),I(r,"pixelRatio",_r()),I(r,"pickingDownSizingRatio",2*r.pixelRatio),I(r,"displayedNodeLabels",new Set),I(r,"displayedEdgeLabels",new Set),I(r,"highlightedNodes",new Set),I(r,"hoveredNode",null),I(r,"hoveredEdge",null),I(r,"renderFrame",null),I(r,"renderHighlightedNodesFrame",null),I(r,"needToProcess",!1),I(r,"checkEdgesEventsFrame",null),I(r,"nodePrograms",{}),I(r,"nodeHoverPrograms",{}),I(r,"edgePrograms",{}),r.settings=Tu(o),Ri(r.settings),Ya(i),!(e instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");r.graph=i,r.container=e,r.createWebGLContext("edges",{picking:o.enableEdgeEvents}),r.createCanvasContext("edgeLabels"),r.createWebGLContext("nodes",{picking:!0}),r.createCanvasContext("labels"),r.createCanvasContext("hovers"),r.createWebGLContext("hoverNodes"),r.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),r.resize();for(var a in r.settings.nodeProgramClasses)r.registerNodeProgram(a,r.settings.nodeProgramClasses[a],r.settings.nodeHoverProgramClasses[a]);for(var s in r.settings.edgeProgramClasses)r.registerEdgeProgram(s,r.settings.edgeProgramClasses[s]);return r.camera=new nn,r.bindCameraHandlers(),r.mouseCaptor=new Lu(r.elements.mouse,r),r.mouseCaptor.setSettings(r.settings),r.touchCaptor=new Du(r.elements.mouse,r),r.touchCaptor.setSettings(r.settings),r.bindEventHandlers(),r.bindGraphHandlers(),r.handleSettingsUpdate(),r.refresh(),r}return Ee(t,n),pe(t,[{key:"registerNodeProgram",value:function(e,r,o){return this.nodePrograms[e]&&this.nodePrograms[e].kill(),this.nodeHoverPrograms[e]&&this.nodeHoverPrograms[e].kill(),this.nodePrograms[e]=new r(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[e]=new(o||r)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(e,r){return this.edgePrograms[e]&&this.edgePrograms[e].kill(),this.edgePrograms[e]=new r(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(e){if(this.nodePrograms[e]){var r=this.nodePrograms,o=r[e],a=Ci(r,[e].map(Rt));o.kill(),this.nodePrograms=a}if(this.nodeHoverPrograms[e]){var s=this.nodeHoverPrograms,l=s[e],u=Ci(s,[e].map(Rt));l.kill(),this.nodePrograms=u}return this}},{key:"unregisterEdgeProgram",value:function(e){if(this.edgePrograms[e]){var r=this.edgePrograms,o=r[e],a=Ci(r,[e].map(Rt));o.kill(),this.edgePrograms=a}return this}},{key:"resetWebGLTexture",value:function(e){var r=this.webGLContexts[e],o=this.frameBuffers[e],a=this.textures[e];a&&r.deleteTexture(a);var s=r.createTexture();return r.bindFramebuffer(r.FRAMEBUFFER,o),r.bindTexture(r.TEXTURE_2D,s),r.texImage2D(r.TEXTURE_2D,0,r.RGBA,this.width,this.height,0,r.RGBA,r.UNSIGNED_BYTE,null),r.framebufferTexture2D(r.FRAMEBUFFER,r.COLOR_ATTACHMENT0,r.TEXTURE_2D,s,0),this.textures[e]=s,this}},{key:"bindCameraHandlers",value:function(){var e=this;return this.activeListeners.camera=function(){e.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(e){var r=e.x,o=e.y,a=mr(this.webGLContexts.nodes,this.frameBuffers.nodes,r,o,this.pixelRatio,this.pickingDownSizingRatio),s=pr.apply(void 0,on(a)),l=this.itemIDsIndex[s];return l&&l.type==="node"?l.id:null}},{key:"bindEventHandlers",value:function(){var e=this;this.activeListeners.handleResize=function(){e.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(o){var a=wt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}},l=e.getNodeAtPosition(a);if(l&&e.hoveredNode!==l&&!e.nodeDataCache[l].hidden){e.hoveredNode&&e.emit("leaveNode",Q(Q({},s),{},{node:e.hoveredNode})),e.hoveredNode=l,e.emit("enterNode",Q(Q({},s),{},{node:l})),e.scheduleHighlightedNodesRender();return}if(e.hoveredNode&&e.getNodeAtPosition(a)!==e.hoveredNode){var u=e.hoveredNode;e.hoveredNode=null,e.emit("leaveNode",Q(Q({},s),{},{node:u})),e.scheduleHighlightedNodesRender();return}if(e.settings.enableEdgeEvents){var c=e.hoveredNode?null:e.getEdgeAtPoint(s.event.x,s.event.y);c!==e.hoveredEdge&&(e.hoveredEdge&&e.emit("leaveEdge",Q(Q({},s),{},{edge:e.hoveredEdge})),c&&e.emit("enterEdge",Q(Q({},s),{},{edge:c})),e.hoveredEdge=c)}},this.activeListeners.handleMoveBody=function(o){var a=wt(o);e.emit("moveBody",{event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(o){var a=wt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};e.hoveredNode&&(e.emit("leaveNode",Q(Q({},s),{},{node:e.hoveredNode})),e.scheduleHighlightedNodesRender()),e.settings.enableEdgeEvents&&e.hoveredEdge&&(e.emit("leaveEdge",Q(Q({},s),{},{edge:e.hoveredEdge})),e.scheduleHighlightedNodesRender()),e.emit("leaveStage",Q({},s))},this.activeListeners.handleEnter=function(o){var a=wt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};e.emit("enterStage",Q({},s))};var r=function(a){return function(s){var l=wt(s),u={event:l,preventSigmaDefault:function(){l.preventSigmaDefault()}},c=e.getNodeAtPosition(l);if(c)return e.emit("".concat(a,"Node"),Q(Q({},u),{},{node:c}));if(e.settings.enableEdgeEvents){var d=e.getEdgeAtPoint(l.x,l.y);if(d)return e.emit("".concat(a,"Edge"),Q(Q({},u),{},{edge:d}))}return e.emit("".concat(a,"Stage"),u)}};return this.activeListeners.handleClick=r("click"),this.activeListeners.handleRightClick=r("rightClick"),this.activeListeners.handleDoubleClick=r("doubleClick"),this.activeListeners.handleWheel=r("wheel"),this.activeListeners.handleDown=r("down"),this.activeListeners.handleUp=r("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var e=this,r=this.graph,o=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(a){var s,l=(s=a.hints)===null||s===void 0?void 0:s.attributes;e.graph.forEachNode(function(c){return e.updateNode(c)});var u=!l||l.some(function(c){return o.has(c)});e.refresh({partialGraph:{nodes:r.nodes()},skipIndexation:!u,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(a){var s,l=(s=a.hints)===null||s===void 0?void 0:s.attributes;e.graph.forEachEdge(function(c){return e.updateEdge(c)});var u=l&&["zIndex","type"].some(function(c){return l==null?void 0:l.includes(c)});e.refresh({partialGraph:{edges:r.edges()},skipIndexation:!u,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(a){var s=a.key;e.addNode(s),e.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(a){var s=a.key;e.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(a){var s=a.key;e.removeNode(s),e.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(a){var s=a.key;e.addEdge(s),e.refresh({partialGraph:{edges:[s]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(a){var s=a.key;e.refresh({partialGraph:{edges:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(a){var s=a.key;e.removeEdge(s),e.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){e.clearEdgeState(),e.clearEdgeIndices(),e.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){e.clearEdgeState(),e.clearNodeState(),e.clearEdgeIndices(),e.clearNodeIndices(),e.refresh({schedule:!0})},r.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),r.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),r.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),r.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),r.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),r.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),r.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),r.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),r.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),r.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var e=this.graph;e.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),e.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),e.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),e.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),e.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),e.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),e.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),e.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),e.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),e.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(e,r){var o=mr(this.webGLContexts.edges,this.frameBuffers.edges,e,r,this.pixelRatio,this.pickingDownSizingRatio),a=pr.apply(void 0,on(o)),s=this.itemIDsIndex[a];return s&&s.type==="edge"?s.id:null}},{key:"process",value:function(){var e=this;this.emit("beforeProcess");var r=this.graph,o=this.settings,a=this.getDimensions();if(this.nodeExtent=Xa(this.graph),!this.settings.autoRescale){var s=a.width,l=a.height,u=this.nodeExtent,c=u.x,d=u.y;this.nodeExtent={x:[(c[0]+c[1])/2-s/2,(c[0]+c[1])/2+s/2],y:[(d[0]+d[1])/2-l/2,(d[0]+d[1])/2+l/2]}}this.normalizationFunction=wr(this.customBBox||this.nodeExtent);var f=new nn,h=mt(f.getState(),a,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(a,o.labelGridCellSize);for(var g={},m={},y={},A={},x=1,C=r.nodes(),E=0,S=C.length;E<S;E++){var R=C[E],p=this.nodeDataCache[R],T=r.getNodeAttributes(R);p.x=T.x,p.y=T.y,this.normalizationFunction.applyTo(p),typeof p.label=="string"&&!p.hidden&&this.labelGrid.add(R,p.size,this.framedGraphToViewport(p,{matrix:h})),g[p.type]=(g[p.type]||0)+1}this.labelGrid.organize();for(var w in this.nodePrograms){if(!Ce.call(this.nodePrograms,w))throw new Error('Sigma: could not find a suitable program for node type "'.concat(w,'"!'));this.nodePrograms[w].reallocate(g[w]||0),g[w]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(C=Er(this.nodeZExtent,function(W){return e.nodeDataCache[W].zIndex},C));for(var L=0,k=C.length;L<k;L++){var D=C[L];m[D]=x,A[m[D]]={type:"node",id:D},x++;var _=this.nodeDataCache[D];this.addNodeToProgram(D,m[D],g[_.type]++)}for(var $={},M=r.edges(),b=0,v=M.length;b<v;b++){var N=M[b],F=this.edgeDataCache[N];$[F.type]=($[F.type]||0)+1}this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&(M=Er(this.edgeZExtent,function(W){return e.edgeDataCache[W].zIndex},M));for(var z in this.edgePrograms){if(!Ce.call(this.edgePrograms,z))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(z,'"!'));this.edgePrograms[z].reallocate($[z]||0),$[z]=0}for(var V=0,X=M.length;V<X;V++){var O=M[V];y[O]=x,A[y[O]]={type:"edge",id:O},x++;var j=this.edgeDataCache[O];this.addEdgeToProgram(O,y[O],$[j.type]++)}return this.itemIDsIndex=A,this.nodeIndices=m,this.edgeIndices=y,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(e){var r=this,o=this.settings;if(this.camera.minRatio=o.minCameraRatio,this.camera.maxRatio=o.maxCameraRatio,this.camera.enabledZooming=o.enableCameraZooming,this.camera.enabledPanning=o.enableCameraPanning,this.camera.enabledRotation=o.enableCameraRotation,o.cameraPanBoundaries?this.camera.clean=function(c){return r.cleanCameraState(c,o.cameraPanBoundaries&&Ii(o.cameraPanBoundaries)==="object"?o.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),e){if(e.edgeProgramClasses!==o.edgeProgramClasses){for(var a in o.edgeProgramClasses)o.edgeProgramClasses[a]!==e.edgeProgramClasses[a]&&this.registerEdgeProgram(a,o.edgeProgramClasses[a]);for(var s in e.edgeProgramClasses)o.edgeProgramClasses[s]||this.unregisterEdgeProgram(s)}if(e.nodeProgramClasses!==o.nodeProgramClasses||e.nodeHoverProgramClasses!==o.nodeHoverProgramClasses){for(var l in o.nodeProgramClasses)(o.nodeProgramClasses[l]!==e.nodeProgramClasses[l]||o.nodeHoverProgramClasses[l]!==e.nodeHoverProgramClasses[l])&&this.registerNodeProgram(l,o.nodeProgramClasses[l],o.nodeHoverProgramClasses[l]);for(var u in e.nodeProgramClasses)o.nodeProgramClasses[u]||this.unregisterNodeProgram(u)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=r.tolerance,a=o===void 0?0:o,s=r.boundaries,l=Q({},e),u=s||this.nodeExtent,c=st(u.x,2),d=c[0],f=c[1],h=st(u.y,2),g=h[0],m=h[1],y=[this.graphToViewport({x:d,y:g},{cameraState:e}),this.graphToViewport({x:f,y:g},{cameraState:e}),this.graphToViewport({x:d,y:m},{cameraState:e}),this.graphToViewport({x:f,y:m},{cameraState:e})],A=1/0,x=-1/0,C=1/0,E=-1/0;y.forEach(function($){var M=$.x,b=$.y;A=Math.min(A,M),x=Math.max(x,M),C=Math.min(C,b),E=Math.max(E,b)});var S=x-A,R=E-C,p=this.getDimensions(),T=p.width,w=p.height,L=0,k=0;if(S>=T?x<T-a?L=x-(T-a):A>a&&(L=A-a):x>T+a?L=x-(T+a):A<-a&&(L=A+a),R>=w?E<w-a?k=E-(w-a):C>a&&(k=C-a):E>w+a?k=E-(w+a):C<-a&&(k=C+a),L||k){var D=this.viewportToFramedGraph({x:0,y:0},{cameraState:e}),_=this.viewportToFramedGraph({x:L,y:k},{cameraState:e});L=_.x-D.x,k=_.y-D.y,l.x+=L,l.y+=k}return l}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var e=this.camera.getState(),r=this.labelGrid.getLabelsToDisplay(e.ratio,this.settings.labelDensity);xr(r,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var o=this.canvasContexts.labels,a=0,s=r.length;a<s;a++){var l=r[a],u=this.nodeDataCache[l];if(!this.displayedNodeLabels.has(l)&&!u.hidden){var c=this.framedGraphToViewport(u),d=c.x,f=c.y,h=this.scaleSize(u.size);if(!(!u.forceLabel&&h<this.settings.labelRenderedSizeThreshold)&&!(d<-ln||d>this.width+ln||f<-un||f>this.height+un)){this.displayedNodeLabels.add(l);var g=this.settings.defaultDrawNodeLabel,m=this.nodePrograms[u.type],y=(m==null?void 0:m.drawLabel)||g;y(o,Q(Q({key:l},u),{},{size:h,x:d,y:f}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var e=this.canvasContexts.edgeLabels;e.clearRect(0,0,this.width,this.height);var r=Iu({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});xr(r,this.edgesWithForcedLabels);for(var o=new Set,a=0,s=r.length;a<s;a++){var l=r[a],u=this.graph.extremities(l),c=this.nodeDataCache[u[0]],d=this.nodeDataCache[u[1]],f=this.edgeDataCache[l];if(!o.has(l)&&!(f.hidden||c.hidden||d.hidden)){var h=this.settings.defaultDrawEdgeLabel,g=this.edgePrograms[f.type],m=(g==null?void 0:g.drawLabel)||h;m(e,Q(Q({key:l},f),{},{size:this.scaleSize(f.size)}),Q(Q(Q({key:u[0]},c),this.framedGraphToViewport(c)),{},{size:this.scaleSize(c.size)}),Q(Q(Q({key:u[1]},d),this.framedGraphToViewport(d)),{},{size:this.scaleSize(d.size)}),this.settings),o.add(l)}}return this.displayedEdgeLabels=o,this}},{key:"renderHighlightedNodes",value:function(){var e=this,r=this.canvasContexts.hovers;r.clearRect(0,0,this.width,this.height);var o=function(h){var g=e.nodeDataCache[h],m=e.framedGraphToViewport(g),y=m.x,A=m.y,x=e.scaleSize(g.size),C=e.settings.defaultDrawNodeHover,E=e.nodePrograms[g.type],S=(E==null?void 0:E.drawHover)||C;S(r,Q(Q({key:h},g),{},{size:x,x:y,y:A}),e.settings)},a=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&a.push(this.hoveredNode),this.highlightedNodes.forEach(function(f){f!==e.hoveredNode&&a.push(f)}),a.forEach(function(f){return o(f)});var s={};a.forEach(function(f){var h=e.nodeDataCache[f].type;s[h]=(s[h]||0)+1});for(var l in this.nodeHoverPrograms)this.nodeHoverPrograms[l].reallocate(s[l]||0),s[l]=0;a.forEach(function(f){var h=e.nodeDataCache[f];e.nodeHoverPrograms[h.type].process(0,s[h.type]++,h)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var u=this.getRenderParams();for(var c in this.nodeHoverPrograms){var d=this.nodeHoverPrograms[c];d.render(u)}}},{key:"scheduleHighlightedNodesRender",value:function(){var e=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){e.renderHighlightedNodesFrame=null,e.renderHighlightedNodes(),e.renderEdgeLabels()}))}},{key:"render",value:function(){var e=this;this.emit("beforeRender");var r=function(){return e.emit("afterRender"),e};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(y){return e.resetWebGLTexture(y)}),!this.graph.order)return r();var o=this.mouseCaptor,a=this.camera.isAnimated()||o.isMoving||o.draggedEvents||o.currentWheelDirection,s=this.camera.getState(),l=this.getDimensions(),u=this.getGraphDimensions(),c=this.getStagePadding();this.matrix=mt(s,l,u,c),this.invMatrix=mt(s,l,u,c,!0),this.correctionRatio=qa(this.matrix,s,l),this.graphToViewportRatio=this.getGraphToViewportRatio();var d=this.getRenderParams();for(var f in this.nodePrograms){var h=this.nodePrograms[f];h.render(d)}if(!this.settings.hideEdgesOnMove||!a)for(var g in this.edgePrograms){var m=this.edgePrograms[g];m.render(d)}return this.settings.hideLabelsOnMove&&a||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),r()}},{key:"addNode",value:function(e){var r=Object.assign({},this.graph.getNodeAttributes(e));this.settings.nodeReducer&&(r=this.settings.nodeReducer(e,r));var o=Fu(this.settings,e,r);this.nodeDataCache[e]=o,this.nodesWithForcedLabels.delete(e),o.forceLabel&&!o.hidden&&this.nodesWithForcedLabels.add(e),this.highlightedNodes.delete(e),o.highlighted&&!o.hidden&&this.highlightedNodes.add(e),this.settings.zIndex&&(o.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=o.zIndex),o.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=o.zIndex))}},{key:"updateNode",value:function(e){this.addNode(e);var r=this.nodeDataCache[e];this.normalizationFunction.applyTo(r)}},{key:"removeNode",value:function(e){delete this.nodeDataCache[e],delete this.nodeProgramIndex[e],this.highlightedNodes.delete(e),this.hoveredNode===e&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(e)}},{key:"addEdge",value:function(e){var r=Object.assign({},this.graph.getEdgeAttributes(e));this.settings.edgeReducer&&(r=this.settings.edgeReducer(e,r));var o=Mu(this.settings,e,r);this.edgeDataCache[e]=o,this.edgesWithForcedLabels.delete(e),o.forceLabel&&!o.hidden&&this.edgesWithForcedLabels.add(e),this.settings.zIndex&&(o.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=o.zIndex),o.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=o.zIndex))}},{key:"updateEdge",value:function(e){this.addEdge(e)}},{key:"removeEdge",value:function(e){delete this.edgeDataCache[e],delete this.edgeProgramIndex[e],this.hoveredEdge===e&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(e)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new sn,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0],this.highlightedNodes=new Set}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(e,r,o){var a=this.nodeDataCache[e],s=this.nodePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for node type "'.concat(a.type,'"!'));s.process(r,o,a),this.nodeProgramIndex[e]=o}},{key:"addEdgeToProgram",value:function(e,r,o){var a=this.edgeDataCache[e],s=this.edgePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for edge type "'.concat(a.type,'"!'));var l=this.graph.extremities(e),u=this.nodeDataCache[l[0]],c=this.nodeDataCache[l[1]];s.process(r,o,u,c,a),this.edgeProgramIndex[e]=o}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var e=this.settings,r=e.stagePadding,o=e.autoRescale;return o&&r||0}},{key:"createLayer",value:function(e,r){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[e])throw new Error('Sigma: a layer named "'.concat(e,'" already exists'));var a=Ka(r,{position:"absolute"},{class:"sigma-".concat(e)});return o.style&&Object.assign(a.style,o.style),this.elements[e]=a,"beforeLayer"in o&&o.beforeLayer?this.elements[o.beforeLayer].before(a):"afterLayer"in o&&o.afterLayer?this.elements[o.afterLayer].after(a):this.container.appendChild(a),a}},{key:"createCanvas",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(e,"canvas",r)}},{key:"createCanvasContext",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.createCanvas(e,r),a={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[e]=o.getContext("2d",a),this}},{key:"createWebGLContext",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=(r==null?void 0:r.canvas)||this.createCanvas(e,r);r.hidden&&o.remove();var a=Q({preserveDrawingBuffer:!1,antialias:!1},r),s;s=o.getContext("webgl2",a),s||(s=o.getContext("webgl",a)),s||(s=o.getContext("experimental-webgl",a));var l=s;if(this.webGLContexts[e]=l,l.blendFunc(l.ONE,l.ONE_MINUS_SRC_ALPHA),r.picking){this.pickingLayers.add(e);var u=l.createFramebuffer();if(!u)throw new Error("Sigma: cannot create a new frame buffer for layer ".concat(e));this.frameBuffers[e]=u}return l}},{key:"killLayer",value:function(e){var r=this.elements[e];if(!r)throw new Error("Sigma: cannot kill layer ".concat(e,", which does not exist"));if(this.webGLContexts[e]){var o,a=this.webGLContexts[e];(o=a.getExtension("WEBGL_lose_context"))===null||o===void 0||o.loseContext(),delete this.webGLContexts[e]}else this.canvasContexts[e]&&delete this.canvasContexts[e];return r.remove(),delete this.elements[e],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(e){this.unbindCameraHandlers(),this.camera=e,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(e){e!==this.graph&&(this.hoveredNode&&!e.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!e.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=e,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var e=this.customBBox||this.nodeExtent;return{width:e.x[1]-e.x[0]||1,height:e.y[1]-e.y[0]||1}}},{key:"getNodeDisplayData",value:function(e){var r=this.nodeDataCache[e];return r?Object.assign({},r):void 0}},{key:"getEdgeDisplayData",value:function(e){var r=this.edgeDataCache[e];return r?Object.assign({},r):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return Q({},this.settings)}},{key:"getSetting",value:function(e){return this.settings[e]}},{key:"setSetting",value:function(e,r){var o=Q({},this.settings);return this.settings[e]=r,Ri(this.settings),this.handleSettingsUpdate(o),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(e,r){return this.setSetting(e,r(this.settings[e])),this}},{key:"setSettings",value:function(e){var r=Q({},this.settings);return this.settings=Q(Q({},this.settings),e),Ri(this.settings),this.handleSettingsUpdate(r),this.scheduleRefresh(),this}},{key:"resize",value:function(e){var r=this.width,o=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=_r(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!e&&r===this.width&&o===this.height)return this;for(var a in this.elements){var s=this.elements[a];s.style.width=this.width+"px",s.style.height=this.height+"px"}for(var l in this.canvasContexts)this.elements[l].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[l].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[l].scale(this.pixelRatio,this.pixelRatio);for(var u in this.webGLContexts){this.elements[u].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[u].setAttribute("height",this.height*this.pixelRatio+"px");var c=this.webGLContexts[u];if(c.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(u)){var d=this.textures[u];d&&c.deleteTexture(d)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(e){var r=this,o=(e==null?void 0:e.skipIndexation)!==void 0?e==null?void 0:e.skipIndexation:!1,a=(e==null?void 0:e.schedule)!==void 0?e.schedule:!1,s=!e||!e.partialGraph;if(s)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(E){return r.addNode(E)}),this.graph.forEachEdge(function(E){return r.addEdge(E)});else{for(var l,u,c=((l=e.partialGraph)===null||l===void 0?void 0:l.nodes)||[],d=0,f=(c==null?void 0:c.length)||0;d<f;d++){var h=c[d];if(this.updateNode(h),o){var g=this.nodeProgramIndex[h];if(g===void 0)throw new Error('Sigma: node "'.concat(h,`" can't be repaint`));this.addNodeToProgram(h,this.nodeIndices[h],g)}}for(var m=(e==null||(u=e.partialGraph)===null||u===void 0?void 0:u.edges)||[],y=0,A=m.length;y<A;y++){var x=m[y];if(this.updateEdge(x),o){var C=this.edgeProgramIndex[x];if(C===void 0)throw new Error('Sigma: edge "'.concat(x,`" can't be repaint`));this.addEdgeToProgram(x,this.edgeIndices[x],C)}}}return(s||!o)&&(this.needToProcess=!0),a?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var e=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){e.render()})),this}},{key:"scheduleRefresh",value:function(e){return this.refresh(Q(Q({},e),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(e,r){var o=this.camera.getState(),a=o.ratio,s=o.angle,l=o.x,u=o.y,c=this.settings,d=c.minCameraRatio,f=c.maxCameraRatio;typeof f=="number"&&(r=Math.min(r,f)),typeof d=="number"&&(r=Math.max(r,d));var h=r/a,g={x:this.width/2,y:this.height/2},m=this.viewportToFramedGraph(e),y=this.viewportToFramedGraph(g);return{angle:s,x:(m.x-y.x)*(1-h)+l,y:(m.y-y.y)*(1-h)+u,ratio:r}}},{key:"viewRectangle",value:function(){var e=this.viewportToFramedGraph({x:0,y:0}),r=this.viewportToFramedGraph({x:this.width,y:0}),o=this.viewportToFramedGraph({x:0,y:this.height});return{x1:e.x,y1:e.y,x2:r.x,y2:r.y,height:r.y-o.y}}},{key:"framedGraphToViewport",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!r.cameraState||!!r.viewportDimensions||!!r.graphDimensions,a=r.matrix?r.matrix:o?mt(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getStagePadding()):this.matrix,s=Oi(a,e);return{x:(1+s.x)*this.width/2,y:(1-s.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!r.cameraState||!!r.viewportDimensions||!r.graphDimensions,a=r.matrix?r.matrix:o?mt(r.cameraState||this.camera.getState(),r.viewportDimensions||this.getDimensions(),r.graphDimensions||this.getGraphDimensions(),r.padding||this.getStagePadding(),!0):this.invMatrix,s=Oi(a,{x:e.x/this.width*2-1,y:1-e.y/this.height*2});return isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),s}},{key:"viewportToGraph",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(e,r))}},{key:"graphToViewport",value:function(e){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(e),r)}},{key:"getGraphToViewportRatio",value:function(){var e={x:0,y:0},r={x:1,y:1},o=Math.sqrt(Math.pow(e.x-r.x,2)+Math.pow(e.y-r.y,2)),a=this.graphToViewport(e),s=this.graphToViewport(r),l=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2));return l/o}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(e){return this.customBBox=e,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var e=this.container;e.firstChild;)e.removeChild(e.firstChild);for(var r in this.nodePrograms)this.nodePrograms[r].kill();for(var o in this.nodeHoverPrograms)this.nodeHoverPrograms[o].kill();for(var a in this.edgePrograms)this.edgePrograms[a].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var s in this.elements)this.killLayer(s);this.canvasContexts={},this.webGLContexts={},this.elements={}}},{key:"scaleSize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return e/this.settings.zoomToSizeRatioFunction(r)*(this.getSetting("itemSizesReference")==="positions"?r*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var e={};for(var r in this.elements)this.elements[r]instanceof HTMLCanvasElement&&(e[r]=this.elements[r]);return e}}])}(ir),Uu=$u;function bo(n,t,i,e){const r=(1-n)**2*t.x+2*(1-n)*n*i.x+n**2*e.x,o=(1-n)**2*t.y+2*(1-n)*n*i.y+n**2*e.y;return{x:r,y:o}}function ju(n,t,i){let r=0,o=n;for(let a=0;a<20;a++){const s=bo((a+1)/20,n,t,i);r+=Math.sqrt((o.x-s.x)**2+(o.y-s.y)**2),o=s}return r}function Hu({curvatureAttribute:n,defaultCurvature:t,keepLabelUpright:i=!0}){return(e,r,o,a,s)=>{const l=s.edgeLabelSize,u=r[n]||t,c=s.edgeLabelFont,d=s.edgeLabelWeight;let f=r.color??s.defaultEdgeColor;r.selected&&(f="#f00"),r.highlight&&(f="#F54A4A");let h=r.label;if(!h||r.opacity<1)return;e.font=`${d} ${l}px ${c}`;const g=!i||o.x<a.x;let m=g?o.x:a.x,y=g?o.y:a.y,A=g?a.x:o.x,x=g?a.y:o.y;const C=(m+A)/2,E=(y+x)/2,S=A-m,R=x-y,p=Math.sqrt(S**2+R**2),T=g?1:-1;let w=C+R*u*T,L=E-S*u*T;const k=r.size*.7+5,D={x:L-y,y:-(w-m)},_=Math.sqrt(D.x**2+D.y**2),$={x:x-L,y:-(A-w)},M=Math.sqrt($.x**2+$.y**2);m+=k*D.x/_,y+=k*D.y/_,A+=k*$.x/M,x+=k*$.y/M,w+=k*R/p,L-=k*S/p;const b={x:w,y:L},v={x:m,y},N={x:A,y:x},F=ju(v,b,N);if(F<o.size+a.size)return;let z=e.measureText(h).width;const V=F-o.size-a.size;if(z>V){const j="…";for(h=h+j,z=e.measureText(h).width;z>V&&h.length>1;)h=h.slice(0,-2)+j,z=e.measureText(h).width;if(h.length<4)return}const X={};for(let j=0,W=h.length;j<W;j++){const oe=h[j];X[oe]||(X[oe]=e.measureText(oe).width*(1+u*.35))}let O=.5-z/F/2;for(let j=0,W=h.length;j<W;j++){const oe=h[j],H=bo(O,v,b,N),J=2*(1-O)*(w-m)+2*O*(A-w),ne=2*(1-O)*(L-y)+2*O*(x-L),Y=Math.atan2(ne,J);e.save(),e.translate(H.x,H.y),e.rotate(Y),j===0&&(e.fillStyle=s.defaultNodeColor||"#fff",e.fillRect(-4,0,z+8,l+2)),e.fillStyle=f,e.fillText(oe,0,l-2),e.restore(),O+=X[oe]/F}}}const Vu=`
precision highp float;

varying vec4 v_color;
varying float v_opacity;
varying float v_thickness;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;


float det(vec2 a, vec2 b) {
  return a.x * b.y - b.x * a.y;
}

vec2 getDistanceVector(vec2 b0, vec2 b1, vec2 b2) {
  float a = det(b0, b2), b = 2.0 * det(b1, b0), d = 2.0 * det(b2, b1);
  float f = b * d - a * a;
  vec2 d21 = b2 - b1, d10 = b1 - b0, d20 = b2 - b0;
  vec2 gf = 2.0 * (b * d21 + d * d10 + a * d20);
  gf = vec2(gf.y, -gf.x);
  vec2 pp = -f * gf / dot(gf, gf);
  vec2 d0p = b0 - pp;
  float ap = det(d0p, d20), bp = 2.0 * det(d10, d0p);
  float t = clamp((ap + bp) / (2.0 * a + b + d), 0.0, 1.0);
  return mix(mix(b0, b1, t), mix(b1, b2, t), t);
}

float distToQuadraticBezierCurve(vec2 p, vec2 b0, vec2 b1, vec2 b2) {
  return length(getDistanceVector(b0 - p, b1 - p, b2 - p));
}

const float epsilon = 0.7;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = distToQuadraticBezierCurve(gl_FragCoord.xy, v_cpA, v_cpB, v_cpC);
  float thickness = v_thickness;

  if (dist < thickness + epsilon) {
    #ifdef PICKING_MODE
    gl_FragColor = v_color;
    #else
    float inCurve = 1.0 - smoothstep(thickness - epsilon, thickness + epsilon, dist);
    gl_FragColor = inCurve * vec4(v_color.rgb * v_color.a, v_color.a);
    gl_FragColor = mix(transparent, gl_FragColor, v_opacity);
    #endif
  } else {
    gl_FragColor = transparent;
  }
}
`,Bu=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute float a_direction;
attribute float a_thickness;
attribute float a_opacity;
attribute vec2 a_source;
attribute vec2 a_target;
attribute float a_current;
attribute float a_curvature;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform vec2 u_dimensions;

varying vec4 v_color;
varying float v_opacity;
varying float v_thickness;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;

const float bias = 255.0 / 254.0;
const float epsilon = 0.7;
const float minThickness = 0.3;

vec2 clipspaceToViewport(vec2 pos, vec2 dimensions) {
  return vec2(
    (pos.x + 1.0) * dimensions.x / 2.0,
    (pos.y + 1.0) * dimensions.y / 2.0
  );
}

vec2 viewportToClipspace(vec2 pos, vec2 dimensions) {
  return vec2(
    pos.x / dimensions.x * 2.0 - 1.0,
    pos.y / dimensions.y * 2.0 - 1.0
  );
}

void main() {
  // Selecting the correct position
  // Branchless "position = a_source if a_current == 1.0 else a_target"
  vec2 position = a_source * max(0.0, a_current) + a_target * max(0.0, 1.0 - a_current);
  position = (u_matrix * vec3(position, 1)).xy;

  vec2 source = (u_matrix * vec3(a_source, 1)).xy;
  vec2 target = (u_matrix * vec3(a_target, 1)).xy;

  vec2 viewportPosition = clipspaceToViewport(position, u_dimensions);
  vec2 viewportSource = clipspaceToViewport(source, u_dimensions);
  vec2 viewportTarget = clipspaceToViewport(target, u_dimensions);

  vec2 delta = viewportTarget.xy - viewportSource.xy;
  float len = length(delta);
  vec2 normal = vec2(-delta.y, delta.x) * a_direction;
  vec2 unitNormal = normal / len;
  float boundingBoxThickness = len * a_curvature;
  float curveThickness = max(minThickness, a_thickness / 2.0 / u_sizeRatio * u_pixelRatio);

  v_thickness = curveThickness;

  v_cpA = viewportSource;
  v_cpB = 0.5 * (viewportSource + viewportTarget) + unitNormal * a_direction * boundingBoxThickness;
  v_cpC = viewportTarget;

  vec2 viewportOffsetPosition = (
    viewportPosition +
    unitNormal * (boundingBoxThickness / 2.0 + sign(boundingBoxThickness) * (curveThickness + epsilon)) *
    max(0.0, a_direction) // NOTE: cutting the bounding box in half to avoid overdraw
  );

  position = viewportToClipspace(viewportOffsetPosition, u_dimensions);
  gl_Position = vec4(position, 0, 1);
    
  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  v_opacity = a_opacity;
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:cn,FLOAT:He}=WebGLRenderingContext,Wu=["u_matrix","u_sizeRatio","u_dimensions","u_pixelRatio"];class qu extends dt{constructor(){super(...arguments);ee(this,"drawLabel",Hu({curvatureAttribute:"curvature",defaultCurvature:Lt}))}getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Bu,FRAGMENT_SHADER_SOURCE:Vu,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Wu,ATTRIBUTES:[{name:"a_source",size:2,type:He},{name:"a_target",size:2,type:He},{name:"a_thickness",size:1,type:He},{name:"a_curvature",size:1,type:He},{name:"a_color",size:4,type:cn,normalized:!0},{name:"a_opacity",size:1,type:He},{name:"a_id",size:4,type:cn,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_current",size:1,type:He},{name:"a_direction",size:1,type:He}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[0,-1],[1,1],[1,-1]]}}processVisibleItem(i,e,r,o,a){let s=a.color??this.renderer.getSetting("defaultEdgeColor");a.selected&&(s="#f00"),a.highlight&&(s="#F54A4A");const l=(a.size||1)*(a.selected||a.highlight?6:2.5),u=r.x,c=r.y,d=o.x,f=o.y,h=a.curvature??Lt,g=this.array;g[e++]=u,g[e++]=c,g[e++]=d,g[e++]=f,g[e++]=l,g[e++]=h,g[e++]=ce(s),g[e++]=a.opacity??1,g[e++]=i}setUniforms(i,{gl:e,uniformLocations:r}){const{u_matrix:o,u_pixelRatio:a,u_sizeRatio:s,u_dimensions:l}=r;e.uniformMatrix3fv(o,!1,i.matrix),e.uniform1f(a,i.pixelRatio),e.uniform1f(s,i.sizeRatio),e.uniform2f(l,i.width*i.pixelRatio,i.height*i.pixelRatio)}}function Xu(n,t,i,e,r){const o=r.edgeLabelSize,a=r.edgeLabelFont,s=r.edgeLabelWeight;let l=t.color??r.defaultEdgeColor;t.selected&&(l="#f00"),t.highlight&&(l="#F54A4A");let u=t.label;if(!u||t.opacity<1)return;n.font=`${s} ${o}px ${a}`;const c=i.size,d=e.size;let f=i.x,h=i.y,g=e.x,m=e.y,y=(f+g)/2,A=(h+m)/2,x=g-f,C=m-h,E=Math.sqrt(x*x+C*C);if(E<c+d)return;f+=x*c/E,h+=C*c/E,g-=x*d/E,m-=C*d/E,y=(f+g)/2,A=(h+m)/2,x=g-f,C=m-h,E=Math.sqrt(x*x+C*C);let S=n.measureText(u).width;if(S>E){const p="…";for(u=u+p,S=n.measureText(u).width;S>E&&u.length>1;)u=u.slice(0,-2)+p,S=n.measureText(u).width;if(u.length<4)return}let R;x>0?C>0?R=Math.acos(x/E):R=Math.asin(C/E):C>0?R=Math.acos(x/E)+Math.PI:R=Math.asin(x/E)+Math.PI/2,n.save(),n.translate(y,A),n.rotate(R),n.fillStyle=r.defaultNodeColor||"#fff",n.fillRect(-S/2-4,t.size-o+2,S+8,o+2),n.fillStyle=l,n.fillText(u,-S/2,t.size),n.restore()}const Yu=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_opacity;
varying float v_thickness;

const float feather = 0.001;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  gl_FragColor = mix(transparent, gl_FragColor, v_opacity);
  #endif
}
`,Ku=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_opacity;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_opacity;
varying float v_thickness;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;

void main() {
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  v_opacity = a_opacity;
  #endif
}
`,{UNSIGNED_BYTE:dn,FLOAT:Je}=WebGLRenderingContext,Zu=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio"];class Qu extends dt{constructor(){super(...arguments);ee(this,"drawLabel",Xu)}getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Ku,FRAGMENT_SHADER_SOURCE:Yu,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Zu,ATTRIBUTES:[{name:"a_positionStart",size:2,type:Je},{name:"a_positionEnd",size:2,type:Je},{name:"a_normal",size:2,type:Je},{name:"a_color",size:4,type:dn,normalized:!0},{name:"a_opacity",size:1,type:Je},{name:"a_id",size:4,type:dn,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:Je},{name:"a_normalCoef",size:1,type:Je}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}processVisibleItem(i,e,r,o,a){let s=a.color??this.renderer.getSetting("defaultEdgeColor");a.selected&&(s="#f00"),a.highlight&&(s="#F54A4A");const l=Math.min(a.size||1,.5)*(a.selected||a.highlight?16:8),u=r.x,c=r.y,d=o.x,f=o.y,h=d-u,g=f-c;let m=h*h+g*g,y=0,A=0;m&&(m=1/Math.sqrt(m),y=-g*m*l,A=h*m*l);const x=this.array;x[e++]=u,x[e++]=c,x[e++]=d,x[e++]=f,x[e++]=y,x[e++]=A,x[e++]=ce(s),x[e++]=a.opacity??1,x[e++]=i}setUniforms(i,{gl:e,uniformLocations:r}){const{u_matrix:o,u_zoomRatio:a,u_correctionRatio:s,u_sizeRatio:l}=r;e.uniformMatrix3fv(o,!1,i.matrix),e.uniform1f(a,i.zoomRatio),e.uniform1f(l,i.sizeRatio),e.uniform1f(s,i.correctionRatio)}}const Ju=`
precision highp float;

varying vec4 v_fill;
varying vec4 v_color;
varying vec4 v_texture;
varying vec2 v_diffVector;
varying float v_opacity;
varying float v_radius;

uniform sampler2D u_atlas;
uniform float u_correctionRatio;
uniform float u_cameraAngle;
uniform float u_percentagePadding;
uniform bool u_keepWithinCircle;
uniform bool u_shape;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

const float radius = 0.5;

void main(void) {
  float border = 2.0 * u_correctionRatio;
  float dist = length(v_diffVector);
  vec4 color = v_fill;

  float c = cos(-u_cameraAngle);
  float s = sin(-u_cameraAngle);
  vec2 diffVector = mat2(c, s, -s, c) * (v_diffVector);

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  border = 0.0;
  color = v_color;

  #else
  // First case: No image to display
  if (v_texture.w <= 0.0) {
     color = v_fill;
  }

  // Second case: Image loaded into the texture
  else {
    float paddingRatio = 1.0 + 2.0 * u_percentagePadding;
    float coef = 1.0;
    vec2 coordinateInTexture = diffVector * vec2(paddingRatio, -paddingRatio) / v_radius / 2.0 * coef + vec2(0.5, 0.5);
    vec4 texel = texture2D(u_atlas, (v_texture.xy + coordinateInTexture * v_texture.zw), -1.0);

    // Colorize all visible image pixels:
    color = mix(v_fill, v_color, texel.a);
    
    // Erase pixels "in the padding":
    if (abs(diffVector.x) > v_radius / paddingRatio || abs(diffVector.y) > v_radius / paddingRatio) {
      color = v_fill;
    }
  }
  #endif

  // Crop in a circle when u_keepWithinCircle is truthy:
  if(v_opacity == 0.0) {
    gl_FragColor = transparent;
  }
  else if (dist - v_radius + border > border)
    gl_FragColor = transparent;
  else if (dist - v_radius + border > 0.0) {
    gl_FragColor = mix(v_fill, transparent, (dist - v_radius + border) / border);
  }
  else  {
    gl_FragColor = mix(v_fill, color, v_opacity);
  }
  

}
`,_o={size:{mode:"max",value:512},objectFit:"cover",correctCentering:!1},ec=100,tc=1;async function ic(n){return await new Promise((t,i)=>{const e=new Image;e.addEventListener("load",()=>{t(e)},{once:!0}),e.addEventListener("error",r=>{i(r.error)},{once:!0}),e.setAttribute("crossOrigin",""),e.src=n})}const rc=(n="")=>`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 26 26" width="128px" height="128px"><path fill="#000" d="${n}"></path></svg>`;async function nc(n,{size:t}={}){const i=new DOMParser().parseFromString(rc(n),"image/svg+xml"),e=i.documentElement,r=e.getAttribute("width"),o=e.getAttribute("height");if(!r||!o)throw new Error("loadSVGImage: cannot use `size` if target SVG has no definite dimensions.");typeof t=="number"&&(e.setAttribute("width",""+t),e.setAttribute("height",""+t));const a=new XMLSerializer().serializeToString(i),s=new Blob([a],{type:"image/svg+xml"}),l=URL.createObjectURL(s),u=ic(l);return u.finally(()=>URL.revokeObjectURL(l)),await u}async function oc(n,{size:t}={}){return await nc(n,{size:128})}function ac(n,t,{objectFit:i,size:e,correctCentering:r}){const o=i==="contain"?Math.max(n.width,n.height):Math.min(n.width,n.height),a=e.mode==="auto"?o:e.mode==="force"?e.value:Math.min(e.value,o);let s=(n.width-o)/2,l=(n.height-o)/2;if(r){const u=t.getCorrectionOffset(n,o);s=u.x,l=u.y}return{sourceX:s,sourceY:l,sourceSize:o,destinationSize:a}}function sc(n,t){const r=[];let o=0,a=0;for(const y in t){const A=t[y];A.status==="ready"&&(a=Math.max(a,A.destinationSize),o+=A.destinationSize**2,r.push({key:y,...A}))}r.sort((y,A)=>y.destinationSize>A.destinationSize?-1:1);const s=o/.6,l=Math.min(Math.max(Math.sqrt(s),a),3072),u=[];let c=0,d=0,f=0,h=0;const g={};for(let y=0,A=r.length;y<A;y++){const{key:x,image:C,sourceSize:E,sourceX:S,sourceY:R,destinationSize:p}=r[y],T=p+tc;c+T>l&&(h=Math.max(h,c),c=0,d+=f,f=T),u.push({key:x,image:C,sourceX:S,sourceY:R,sourceSize:E,destinationX:c,destinationY:d,destinationSize:p}),g[x]={x:c,y:d,size:p},c+=T,f=Math.max(f,T)}h=Math.max(h,c);const m=n.canvas;m.width=h,m.height=d+f;for(let y=0,A=u.length;y<A;y++){const{image:x,sourceSize:C,sourceX:E,sourceY:S,destinationSize:R,destinationX:p,destinationY:T}=u[y];n.drawImage(x,E,S,C,C,p,T,R,R)}return g}let lc=class{constructor(){ee(this,"canvas");ee(this,"context");this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",{willReadFrequently:!0})}getCorrectionOffset(t,i){this.canvas.width=i,this.canvas.height=i,this.context.clearRect(0,0,i,i),this.context.drawImage(t,0,0,i,i);const e=this.context.getImageData(0,0,i,i).data,r=new Uint8ClampedArray(e.length/4);for(let c=0;c<e.length;c++)r[c]=e[c*4+3];let o=0,a=0,s=0;for(let c=0;c<i;c++)for(let d=0;d<i;d++){const f=r[c*i+d];s+=f,o+=f*d,a+=f*c}const l=o/s,u=a/s;return{x:l-i/2,y:u-i/2}}};var qe;let Li=(qe=class extends ii.EventEmitter{constructor(i={}){super();ee(this,"options");ee(this,"canvas",document.createElement("canvas"));ee(this,"ctx",this.canvas.getContext("2d",{willReadFrequently:!0}));ee(this,"frameId");ee(this,"corrector",new lc);ee(this,"imageStates",{});ee(this,"texture",this.ctx.getImageData(0,0,1,1));ee(this,"atlas",{});this.options={..._o,...i}}scheduleGenerateTexture(){typeof this.frameId!="number"&&(this.frameId=window.setTimeout(()=>{this.generateTexture(),this.frameId=void 0},ec))}generateTexture(){this.atlas=sc(this.ctx,this.imageStates),this.texture=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.emit(qe.NEW_TEXTURE_EVENT,{atlas:this.atlas,texture:this.texture})}async registerImage(i){if(!this.imageStates[i]){this.imageStates[i]={status:"loading"};try{const{size:e}=this.options,r=await oc(i,{size:e.mode==="force"?e.value:void 0});this.imageStates[i]={status:"ready",image:r,...ac(r,this.corrector,this.options)},this.scheduleGenerateTexture()}catch{this.imageStates[i]={status:"error"}}}}getAtlas(){return this.atlas}getTexture(){return this.texture}},ee(qe,"NEW_TEXTURE_EVENT","newTexture"),qe);const ze={"top-left":"0.0","top-right":"1.0","bottom-left":"2.0","bottom-right":"3.0",top:"4.0",left:"5.0",right:"6.0",bottom:"7.0"},uc=`
attribute vec4 a_id;
attribute vec4 a_fill;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_circle;
attribute float a_placement;
attribute float a_size;
attribute float a_angle;
attribute float a_opacity;
attribute vec4 a_texture;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_fill;
varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_opacity;
varying vec4 v_texture;

const float bias = 255.0 / 254.0;
const float marginRatio = 1.1;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main() {
  float size = (a_size / 4.0) * u_correctionRatio / u_sizeRatio * 4.0;
  float originalSize = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector * marginRatio;
  float divisor = a_circle == 1.0 ? 2.5 : 2.0;
  if(a_placement == ${ze["top-left"]}) {
    position.x -= originalSize / divisor;
    position.y += originalSize / divisor;
  }
  if(a_placement == ${ze["top-right"]}) {
    position.x += originalSize / divisor;
    position.y += originalSize / divisor;
  }
  if(a_placement == ${ze["bottom-left"]}) {
    position.x -= originalSize / divisor;
    position.y -= originalSize / divisor;
  }
  if(a_placement == ${ze["bottom-right"]}) {
    position.x += originalSize / divisor;
    position.y -= originalSize / divisor;
  }
  if(a_placement == ${ze.top}) {
    position.y += originalSize / 2.0;
  }
  if(a_placement == ${ze.bottom}) {
    position.y -= originalSize / 2.0;
  }
  if(a_placement == ${ze.left}) {
    position.x -= originalSize / 2.0;
  }
  if(a_placement == ${ze.right}) {
    position.x += originalSize / 2.0;
  }
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0 / marginRatio;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_fill = mix(transparent, a_fill, a_opacity * bias);
  v_color = vec4(a_color.rgb, a_opacity * bias);
  v_opacity = a_opacity;
  // Pass the texture coordinates:
  v_texture = a_texture;
  #endif
}
`,cc={star:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",exclaim:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",thumbUp:"M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z",thumbDown:"M19,15H23V3H19M15,3H6C5.17,3 4.46,3.5 4.16,4.22L1.14,11.27C1.05,11.5 1,11.74 1,12V14A2,2 0 0,0 3,16H9.31L8.36,20.57C8.34,20.67 8.33,20.77 8.33,20.88C8.33,21.3 8.5,21.67 8.77,21.94L9.83,23L16.41,16.41C16.78,16.05 17,15.55 17,15V5C17,3.89 16.1,3 15,3Z"},dc={"top-left":0,"top-right":1,"bottom-left":2,"bottom-right":3,top:4,left:5,right:6,bottom:7},{UNSIGNED_BYTE:ki,FLOAT:Ve}=WebGLRenderingContext,hc={..._o,drawingMode:"background",keepWithinCircle:!0,drawLabel:void 0,drawHover:void 0,padding:0,colorAttribute:"color"},fc=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_percentagePadding","u_matrix","u_colorizeImages","u_keepWithinCircle","u_atlas"];function Be(n){var c;const{drawHover:t,drawLabel:i,drawingMode:e,keepWithinCircle:r,padding:o,colorAttribute:a,badgePosition:s,...l}={badgePosition:"top-right",...hc,...n??{},drawLabel:void 0,drawHover:void 0},u=new Li(l);return c=class extends Ne{constructor(h,g,m){super(h,g,m);ee(this,"atlas");ee(this,"texture");ee(this,"textureImage");ee(this,"latestRenderParams");ee(this,"textureManagerCallback");this.textureManagerCallback=()=>{this&&(this.bindTexture&&(this.atlas=u.getAtlas(),this.textureImage=u.getTexture(),this.bindTexture(),this.latestRenderParams&&this.render(this.latestRenderParams)),m!=null&&m.refresh&&m.refresh())},u.on(Li.NEW_TEXTURE_EVENT,this.textureManagerCallback),this.atlas=u.getAtlas(),this.textureImage=u.getTexture(),this.texture=h.createTexture(),this.bindTexture()}getDefinition(){return{VERTICES:4,VERTEX_SHADER_SOURCE:uc,FRAGMENT_SHADER_SOURCE:Ju,METHOD:WebGLRenderingContext.TRIANGLE_FAN,UNIFORMS:fc,ATTRIBUTES:[{name:"a_position",size:2,type:Ve},{name:"a_size",size:1,type:Ve},{name:"a_opacity",size:1,type:Ve},{name:"a_circle",size:1,type:Ve},{name:"a_placement",size:1,type:Ve},{name:"a_fill",size:4,type:ki,normalized:!0},{name:"a_color",size:4,type:ki,normalized:!0},{name:"a_id",size:4,type:ki,normalized:!0},{name:"a_texture",size:4,type:Ve}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Ve}],CONSTANT_DATA:[[c.ANGLE_1],[c.ANGLE_2],[c.ANGLE_3],[c.ANGLE_4]]}}kill(){u.off(Li.NEW_TEXTURE_EVENT,this.textureManagerCallback)}bindTexture(){const h=this.normalProgram.gl;h.bindTexture(h.TEXTURE_2D,this.texture),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,this.textureImage),h.generateMipmap(h.TEXTURE_2D)}renderProgram(h,g){if(!g.isPicking){const m=g.gl;m.bindTexture(m.TEXTURE_2D,this.texture)}super.renderProgram(h,g)}processVisibleItem(h,g,m){var R;const y=this.array,A=(R=m.badge)==null?void 0:R.find(p=>p.position===s);let x=ce((A==null?void 0:A.color)??"#00000000"),C=ce((A==null?void 0:A.iconColor)??this.renderer.getSetting("labelColor").color??"#000"),E=A?cc[A.type]??A.path:void 0;const S=E?this.atlas[E]:void 0;if(typeof E=="string"&&!S&&u.registerImage(E),y[g++]=m.x,y[g++]=m.y,y[g++]=m.size,y[g++]=E?m.opacity??1:0,y[g++]=r?1:0,y[g++]=dc[s]??0,y[g++]=x,y[g++]=C,y[g++]=h,S){const{width:p,height:T}=this.textureImage;y[g++]=S.x/p,y[g++]=S.y/T,y[g++]=S.size/p,y[g++]=S.size/T}else y[g++]=0,y[g++]=0,y[g++]=0,y[g++]=0}setUniforms(h,{gl:g,uniformLocations:m}){const{u_sizeRatio:y,u_correctionRatio:A,u_matrix:x,u_atlas:C,u_keepWithinCircle:E,u_cameraAngle:S,u_percentagePadding:R}=m;this.latestRenderParams=h,g.uniform1f(A,h.correctionRatio),g.uniform1f(y,h.sizeRatio),g.uniform1f(S,h.cameraAngle),g.uniform1f(R,o),g.uniformMatrix3fv(x,!1,h.matrix),g.uniform1i(C,0),g.uniform1i(E,r?1:0)}},ee(c,"ANGLE_1",1*Math.PI/4),ee(c,"ANGLE_2",3*Math.PI/4),ee(c,"ANGLE_3",5*Math.PI/4),ee(c,"ANGLE_4",7*Math.PI/4),ee(c,"drawLabel",i),ee(c,"drawHover",t),c}const Eo=n=>[Be({keepWithinCircle:n,badgePosition:"top-right"}),Be({keepWithinCircle:n,badgePosition:"top-left"}),Be({keepWithinCircle:n,badgePosition:"bottom-right"}),Be({keepWithinCircle:n,badgePosition:"bottom-left"}),Be({keepWithinCircle:n,badgePosition:"top"}),Be({keepWithinCircle:n,badgePosition:"left"}),Be({keepWithinCircle:n,badgePosition:"right"})],gc=`
precision highp float;

varying vec4 v_fill;
varying vec4 v_color;
varying vec4 v_texture;
varying vec2 v_diffVector;
varying float v_opacity;
varying float v_radius;
varying float v_colorMode;

uniform sampler2D u_atlas;
uniform float u_correctionRatio;
uniform float u_cameraAngle;
uniform float u_percentagePadding;
uniform bool u_keepWithinCircle;
uniform bool u_shape;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

const float radius = 0.5;

void main(void) {
  float border = 2.0 * u_correctionRatio;
  float dist = length(v_diffVector);
  vec4 color = v_fill;

  float c = cos(-u_cameraAngle);
  float s = sin(-u_cameraAngle);
  vec2 diffVector = mat2(c, s, -s, c) * (v_diffVector);

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  border = 0.0;
  color = v_color;

  #else
  // First case: No image to display
  if (v_texture.w <= 0.0) {
    if (v_colorMode==0.0) {
      color = v_fill;
    }
  }

  // Second case: Image loaded into the texture
  else {
    float paddingRatio = 1.0 + 2.0 * u_percentagePadding;
    float coef = u_keepWithinCircle ? 1.0 : ${Math.SQRT2};
    vec2 coordinateInTexture = diffVector * vec2(paddingRatio, -paddingRatio) / v_radius / 2.0 * coef + vec2(0.5, 0.5);
    vec4 texel = texture2D(u_atlas, (v_texture.xy + coordinateInTexture * v_texture.zw), -1.0);

    // Colorize all visible image pixels:
    if (v_colorMode==1.0) {
      color = mix(v_fill, v_color, texel.a);
    }

    // Colorize background pixels, keep image pixel colors:
    else {
      color = vec4(mix(v_color, texel, texel.a).rgb, max(texel.a, v_color.a));
    }

    // Erase pixels "in the padding":
    if (abs(diffVector.x) > v_radius / paddingRatio || abs(diffVector.y) > v_radius / paddingRatio) {
      color = v_colorMode == 1.0 ? gl_FragColor : v_fill;
    }
  }
  #endif

  // Crop in a circle when u_keepWithinCircle is truthy:
  if (u_keepWithinCircle) {
    if (dist - v_radius + border > border)
      gl_FragColor = transparent;
    else if (dist - v_radius + border > 0.0) {
      gl_FragColor = mix(v_fill, transparent, (dist - v_radius + border) / border);
    }
    else  {
      gl_FragColor = mix(v_fill, color, v_opacity);
    }
  }

  // Crop in a square else:
  else {
    float squareHalfSize = v_radius * ${Math.SQRT1_2*Math.cos(Math.PI/12)};
    if (abs(diffVector.x) > squareHalfSize || abs(diffVector.y) > squareHalfSize) {
      gl_FragColor = transparent;
    } else {
      gl_FragColor = mix(v_fill, color, v_opacity);
    }
  }

}
`,wo={size:{mode:"max",value:512},objectFit:"cover",correctCentering:!1},vc=100,pc=1;async function xo(n){return await new Promise((t,i)=>{const e=new Image;e.addEventListener("load",()=>{t(e)},{once:!0}),e.addEventListener("error",r=>{i(r.error)},{once:!0}),e.setAttribute("crossOrigin",""),e.src=n})}const mc=(n="")=>`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 26 26" width="128px" height="128px"><path fill="#000" d="${n}"></path></svg>`;async function yc(n,{size:t}={}){const i=new DOMParser().parseFromString(mc(n),"image/svg+xml"),e=i.documentElement,r=e.getAttribute("width"),o=e.getAttribute("height");if(!r||!o)throw new Error("loadSVGImage: cannot use `size` if target SVG has no definite dimensions.");typeof t=="number"&&(e.setAttribute("width",""+t),e.setAttribute("height",""+t));const a=new XMLSerializer().serializeToString(i),s=new Blob([a],{type:"image/svg+xml"}),l=URL.createObjectURL(s),u=xo(l);return u.finally(()=>URL.revokeObjectURL(l)),await u}async function bc(n,{size:t}={}){const i=wn(n);let e;return i?e=await yc(n,{size:128}):e=await xo(n),e}function _c(n,t,{objectFit:i,size:e,correctCentering:r}){const o=i==="contain"?Math.max(n.width,n.height):Math.min(n.width,n.height),a=e.mode==="auto"?o:e.mode==="force"?e.value:Math.min(e.value,o);let s=(n.width-o)/2,l=(n.height-o)/2;if(r){const u=t.getCorrectionOffset(n,o);s=u.x,l=u.y}return{sourceX:s,sourceY:l,sourceSize:o,destinationSize:a}}function Ec(n,t){const r=[];let o=0,a=0;for(const y in t){const A=t[y];A.status==="ready"&&(a=Math.max(a,A.destinationSize),o+=A.destinationSize**2,r.push({key:y,...A}))}r.sort((y,A)=>y.destinationSize>A.destinationSize?-1:1);const s=o/.6,l=Math.min(Math.max(Math.sqrt(s),a),3072),u=[];let c=0,d=0,f=0,h=0;const g={};for(let y=0,A=r.length;y<A;y++){const{key:x,image:C,sourceSize:E,sourceX:S,sourceY:R,destinationSize:p}=r[y],T=p+pc;c+T>l&&(h=Math.max(h,c),c=0,d+=f,f=T),u.push({key:x,image:C,sourceX:S,sourceY:R,sourceSize:E,destinationX:c,destinationY:d,destinationSize:p}),g[x]={x:c,y:d,size:p},c+=T,f=Math.max(f,T)}h=Math.max(h,c);const m=n.canvas;m.width=h,m.height=d+f;for(let y=0,A=u.length;y<A;y++){const{image:x,sourceSize:C,sourceX:E,sourceY:S,destinationSize:R,destinationX:p,destinationY:T}=u[y];n.drawImage(x,E,S,C,C,p,T,R,R)}return g}class wc{constructor(){ee(this,"canvas");ee(this,"context");this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",{willReadFrequently:!0})}getCorrectionOffset(t,i){this.canvas.width=i,this.canvas.height=i,this.context.clearRect(0,0,i,i),this.context.drawImage(t,0,0,i,i);const e=this.context.getImageData(0,0,i,i).data,r=new Uint8ClampedArray(e.length/4);for(let c=0;c<e.length;c++)r[c]=e[c*4+3];let o=0,a=0,s=0;for(let c=0;c<i;c++)for(let d=0;d<i;d++){const f=r[c*i+d];s+=f,o+=f*d,a+=f*c}const l=o/s,u=a/s;return{x:l-i/2,y:u-i/2}}}const Qt=class Qt extends ii.EventEmitter{constructor(i={}){super();ee(this,"options");ee(this,"canvas",document.createElement("canvas"));ee(this,"ctx",this.canvas.getContext("2d",{willReadFrequently:!0}));ee(this,"frameId");ee(this,"corrector",new wc);ee(this,"imageStates",{});ee(this,"texture",this.ctx.getImageData(0,0,1,1));ee(this,"atlas",{});this.options={...wo,...i}}scheduleGenerateTexture(){typeof this.frameId!="number"&&(this.frameId=window.setTimeout(()=>{this.generateTexture(),this.frameId=void 0},vc))}generateTexture(){this.atlas=Ec(this.ctx,this.imageStates),this.texture=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.emit(Qt.NEW_TEXTURE_EVENT,{atlas:this.atlas,texture:this.texture})}async registerImage(i){if(!this.imageStates[i]){this.imageStates[i]={status:"loading"};try{const{size:e}=this.options,r=await bc(i,{size:e.mode==="force"?e.value:void 0});this.imageStates[i]={status:"ready",image:r,..._c(r,this.corrector,this.options)},this.scheduleGenerateTexture()}catch{this.imageStates[i]={status:"error"}}}}getAtlas(){return this.atlas}getTexture(){return this.texture}};ee(Qt,"NEW_TEXTURE_EVENT","newTexture");let Ct=Qt;const xc=`
attribute vec4 a_id;
attribute vec4 a_fill;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_colorMode;
attribute float a_opacity;
attribute vec4 a_texture;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_fill;
varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_opacity;
varying vec4 v_texture;
varying float v_colorMode;

const float bias = 255.0 / 254.0;
const float marginRatio = 1.05;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector * marginRatio;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0 / marginRatio;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_fill = vec4(0.0, 0.0, 0.0, 0.0);
  v_color = vec4(a_color.rgb, a_opacity * bias);
  v_opacity = a_opacity;
  v_colorMode = a_colorMode;
  // Pass the texture coordinates:
  v_texture = a_texture;
  #endif
}
`,{UNSIGNED_BYTE:Ni,FLOAT:et}=WebGLRenderingContext,Tc={...wo,drawingMode:"background",keepWithinCircle:!0,drawLabel:void 0,drawHover:void 0,padding:0,colorAttribute:"color"},Sc=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_percentagePadding","u_matrix","u_colorizeImages","u_keepWithinCircle","u_atlas"];function Ac(n){var u;const{drawHover:t,drawLabel:i,drawingMode:e,keepWithinCircle:r,padding:o,colorAttribute:a,...s}={...Tc,...n??{},drawLabel:void 0,drawHover:void 0},l=new Ct(s);return u=class extends Ne{constructor(f,h,g){super(f,h,g);ee(this,"atlas");ee(this,"texture");ee(this,"textureImage");ee(this,"latestRenderParams");ee(this,"textureManagerCallback");this.textureManagerCallback=()=>{this&&(this.bindTexture&&(this.atlas=l.getAtlas(),this.textureImage=l.getTexture(),this.bindTexture(),this.latestRenderParams&&this.render(this.latestRenderParams)),g!=null&&g.refresh&&g.refresh())},l.on(Ct.NEW_TEXTURE_EVENT,this.textureManagerCallback),this.atlas=l.getAtlas(),this.textureImage=l.getTexture(),this.texture=f.createTexture(),this.bindTexture()}getDefinition(){return{VERTICES:4,VERTEX_SHADER_SOURCE:xc,FRAGMENT_SHADER_SOURCE:gc,METHOD:WebGLRenderingContext.TRIANGLE_FAN,UNIFORMS:Sc,ATTRIBUTES:[{name:"a_position",size:2,type:et},{name:"a_size",size:1,type:et},{name:"a_opacity",size:1,type:et},{name:"a_colorMode",size:1,type:et},{name:"a_fill",size:4,type:Ni,normalized:!0},{name:"a_color",size:4,type:Ni,normalized:!0},{name:"a_id",size:4,type:Ni,normalized:!0},{name:"a_texture",size:4,type:et}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:et}],CONSTANT_DATA:[[u.ANGLE_1],[u.ANGLE_2],[u.ANGLE_3],[u.ANGLE_4]]}}kill(){l.off(Ct.NEW_TEXTURE_EVENT,this.textureManagerCallback)}bindTexture(){const f=this.normalProgram.gl;f.bindTexture(f.TEXTURE_2D,this.texture),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,this.textureImage),f.generateMipmap(f.TEXTURE_2D)}renderProgram(f,h){if(!h.isPicking){const g=h.gl;g.bindTexture(g.TEXTURE_2D,this.texture)}super.renderProgram(f,h)}processVisibleItem(f,h,g){var E;const m=this.array,y=ce(g.color??this.renderer.getSetting("defaultNodeColor")),A=ce(g.iconColor??this.renderer.getSetting("labelColor").color),x=g.image??g.path,C=x?this.atlas[x]:void 0;if(typeof x=="string"&&!C&&l.registerImage(x),m[h++]=g.x,m[h++]=g.y,m[h++]=g.size-(g.stroke??0)-((E=g.pie)!=null&&E.length?10:4),m[h++]=g.opacity??1,m[h++]=wn(x)?1:0,m[h++]=y,m[h++]=A,m[h++]=f,C){const{width:S,height:R}=this.textureImage;m[h++]=C.x/S,m[h++]=C.y/R,m[h++]=C.size/S,m[h++]=C.size/R}else m[h++]=0,m[h++]=0,m[h++]=0,m[h++]=0}setUniforms(f,{gl:h,uniformLocations:g}){const{u_sizeRatio:m,u_correctionRatio:y,u_matrix:A,u_atlas:x,u_keepWithinCircle:C,u_cameraAngle:E,u_percentagePadding:S}=g;this.latestRenderParams=f,h.uniform1f(y,f.correctionRatio),h.uniform1f(m,r?f.sizeRatio:f.sizeRatio/Math.SQRT2),h.uniform1f(E,f.cameraAngle),h.uniform1f(S,o),h.uniformMatrix3fv(A,!1,f.matrix),h.uniform1i(x,0),h.uniform1i(C,r?1:0)}},ee(u,"ANGLE_1",1*Math.PI/4),ee(u,"ANGLE_2",3*Math.PI/4),ee(u,"ANGLE_3",5*Math.PI/4),ee(u,"ANGLE_4",7*Math.PI/4),ee(u,"drawLabel",i),ee(u,"drawHover",t),u}const To=n=>Ac({keepWithinCircle:n}),Rc=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
    if (dist > border)
      gl_FragColor = transparent;
    else
      gl_FragColor = v_color;
  #else
    float t = 0.0;
    vec4 color = v_color;
    if (dist > 0.0) {
      t = dist / border;
    }

    gl_FragColor = mix(color, transparent, t);
  #endif
}
`,Cc=`
attribute vec4 a_id;
attribute vec4 a_base;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_opacity;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
    // For picking mode, we use the ID as the color:
    v_color = a_id;
  #else
    // For normal mode, we use the color:
    v_color = mix(a_base, a_color, a_opacity * bias);
  #endif
}
`,{UNSIGNED_BYTE:Di,FLOAT:Ht}=WebGLRenderingContext,Lc=["u_sizeRatio","u_correctionRatio","u_matrix"],Ie=class Ie extends Ne{getDefinition(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Cc,FRAGMENT_SHADER_SOURCE:Rc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Lc,ATTRIBUTES:[{name:"a_position",size:2,type:Ht},{name:"a_size",size:1,type:Ht},{name:"a_opacity",size:1,type:Ht},{name:"a_base",size:4,type:Di,normalized:!0},{name:"a_color",size:4,type:Di,normalized:!0},{name:"a_id",size:4,type:Di,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Ht}],CONSTANT_DATA:[[Ie.ANGLE_1],[Ie.ANGLE_2],[Ie.ANGLE_3]]}}processVisibleItem(t,i,e){var s;const r=this.array,o=ce(this.renderer.getSetting("defaultNodeColor")),a=ce(e.color??this.renderer.getSetting("defaultNodeColor"));r[i++]=e.x,r[i++]=e.y,r[i++]=e.size-(e.stroke??1)-((s=e.pie)!=null&&s.length?6:0),r[i++]=e.opacity??1,r[i++]=o,r[i++]=a,r[i++]=t}setUniforms(t,{gl:i,uniformLocations:e}){const{u_sizeRatio:r,u_correctionRatio:o,u_matrix:a}=e;i.uniform1f(o,t.correctionRatio),i.uniform1f(r,t.sizeRatio),i.uniformMatrix3fv(a,!1,t.matrix)}};ee(Ie,"ANGLE_1",0),ee(Ie,"ANGLE_2",2*Math.PI/3),ee(Ie,"ANGLE_3",4*Math.PI/3);let Bi=Ie;function So(n,t,i){var c,d;const e=t.size,r=i.labelSize,o=i.labelFont,a=i.labelWeight,s=i.defaultNodeColor||"#fff",l=t.labelColor||i.labelColor.color||"#000";if(t.highlight){n.strokeStyle=t.highlightColor??"#44BD87",n.lineWidth=1,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=48,n.shadowColor=t.highlightColor??"#44BD87";const f=2;n.beginPath(),n.arc(t.x,t.y,e+f,0,Math.PI*2),n.closePath(),n.stroke()}if(n.shadowColor="transparent",n.shadowBlur=0,t.selected){n.strokeStyle="#f00",n.lineWidth=2,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0;const f=t.selected?4:2;n.beginPath(),n.arc(t.x,t.y,e+f,0,Math.PI*2),n.closePath(),n.stroke()}if(t.isGroup){const f=(d=(c=n.canvas.parentElement)==null?void 0:c.parentElement)==null?void 0:d.querySelector(".sigma-groupHandles");let h=f.querySelector(`[data-id="${t.id}"]`);h||(h=document.createElement("div"),h.className="sigma-groupHandle",h.dataset.id=t.id,f.appendChild(h)),h.innerText=t.expanded?"−":"+",h.style.transform="translate(-50%, -50%)",h.style.left=`${t.x}px`,h.style.top=`${t.y+e}px`}if(!t.label||t.opacity<1)return;const u=n.measureText(t.label).width;n.fillStyle=s,n.fillRect(t.x-u/2,t.y+e*1.25,u,r+2),n.fillStyle=l,n.font=`${a} ${r}px ${o}`,n.fillText(t.label,t.x-u/2,t.y+r+e*1.25)}function kc(n,t,i){const e=t.size,r=i.labelSize,o=i.labelFont,a=i.labelWeight,s=i.defaultNodeColor||"#fff",l=t.labelColor||i.labelColor.color||"#000";n.font=`${a} ${r}px ${o}`,n.fillStyle=s,n.strokeStyle=l,n.lineWidth=.25;const u=t.selected?4:2;n.beginPath(),n.arc(t.x,t.y,e+u,0,Math.PI*2),n.closePath(),n.lineWidth=1,n.strokeStyle="#F00",t.selected&&(n.lineWidth=3),n.stroke(),n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,n.lineWidth=0,n.strokeStyle="",So(n,t,i)}const Nc=`
precision highp float;

varying vec4 v_color;
varying vec4 v_border;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
    if (dist > border)
      gl_FragColor = transparent;
    else
      gl_FragColor = v_color;
  #else
    float t = 0.0;
    vec4 color = v_color;
     if (dist > border)
      t = 1.0;
    else if (dist > 0.0)
      t = dist / border;

    gl_FragColor = mix(color, transparent, t);
  #endif
}
`,Dc=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec4 a_border;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_opacity;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec4 v_border;
varying vec2 v_diffVector;
varying float v_radius;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
    // For picking mode, we use the ID as the color:
    v_color = a_id;
  #else
    // For normal mode, we use the color:
    v_color = mix(vec4(0.0), a_color, a_opacity * bias);
  #endif
}
`,{UNSIGNED_BYTE:hn,FLOAT:Vt}=WebGLRenderingContext,Gc=["u_sizeRatio","u_correctionRatio","u_matrix"],Fe=class Fe extends Ne{getDefinition(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Dc,FRAGMENT_SHADER_SOURCE:Nc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Gc,ATTRIBUTES:[{name:"a_position",size:2,type:Vt},{name:"a_size",size:1,type:Vt},{name:"a_opacity",size:1,type:Vt},{name:"a_color",size:4,type:hn,normalized:!0},{name:"a_id",size:4,type:hn,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Vt}],CONSTANT_DATA:[[Fe.ANGLE_1],[Fe.ANGLE_2],[Fe.ANGLE_3]]}}processVisibleItem(t,i,e){const r=this.array,o=ce(e.strokeColor??this.renderer.getSetting("defaultEdgeColor"));r[i++]=e.x,r[i++]=e.y,r[i++]=e.size,r[i++]=e.opacity??1,r[i++]=o,r[i++]=t}setUniforms(t,{gl:i,uniformLocations:e}){const{u_sizeRatio:r,u_correctionRatio:o,u_matrix:a}=e;i.uniform1f(o,t.correctionRatio),i.uniform1f(r,t.sizeRatio),i.uniformMatrix3fv(a,!1,t.matrix)}};ee(Fe,"ANGLE_1",0),ee(Fe,"ANGLE_2",2*Math.PI/3),ee(Fe,"ANGLE_3",4*Math.PI/3);let Wi=Fe;const Pc=`
precision highp float;

varying vec4 v_color;
${Array(10).fill(0).map((n,t)=>"varying vec4 v_colors_"+t+";").join(`
`)}
varying vec2 v_diffVector;
varying float v_radius;
varying float v_segmentAngle;
varying float v_opacity;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  float angle = atan(v_diffVector.y / v_diffVector.x);
  if (v_diffVector.x < 0.0 && v_diffVector.y < 0.0) angle += ${Math.PI};
  else if (v_diffVector.x < 0.0) angle += ${Math.PI};
  else if (v_diffVector.y < 0.0) angle += ${2*Math.PI};

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
    if (dist > border)
      gl_FragColor = transparent;
    else
      gl_FragColor = v_color;
  #else
    float t = 0.0;
    vec4 color = transparent;
    if(v_segmentAngle > 0.0) {
      float segment = angle / v_segmentAngle;
      ${Array(10).fill(0).map((n,t)=>"if(segment >= "+t+".0) { color = v_colors_"+t+"; }").join(`
`)}
    }
    color = mix(transparent, color, v_opacity);
    if (dist > border)
      gl_FragColor = transparent;
    else if (dist > 0.0) {
      t = dist / border;
      gl_FragColor = mix(color, transparent, t);
    }
    else {
      gl_FragColor = color;
    }
  #endif
}
`,zc=`
attribute vec4 a_id;
${Array(10).fill(0).map((n,t)=>"attribute vec4 a_colors_"+t+";").join(`
`)}
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_segments;
attribute float a_opacity;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
${Array(10).fill(0).map((n,t)=>"varying vec4 v_colors_"+t+";").join(`
`)}
varying vec2 v_diffVector;
varying float v_radius;
varying float v_segmentAngle;
varying float v_opacity;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  v_opacity = a_opacity;
  // For normal mode, we use the color:
  ${Array(10).fill(0).map((n,t)=>"v_colors_"+t+" = a_colors_"+t+";").join(`
`)}
  v_segmentAngle = 0.0;
  if(a_segments > 0.0) {
    v_segmentAngle = ${Math.PI*2} / a_segments;
  }
  #endif
}
`,{UNSIGNED_BYTE:fn,FLOAT:Tt}=WebGLRenderingContext,Oc=["u_sizeRatio","u_correctionRatio","u_matrix"],Me=class Me extends Ne{getDefinition(){return{VERTICES:3,VERTEX_SHADER_SOURCE:zc,FRAGMENT_SHADER_SOURCE:Pc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Oc,ATTRIBUTES:[{name:"a_position",size:2,type:Tt},{name:"a_size",size:1,type:Tt},{name:"a_opacity",size:1,type:Tt},{name:"a_segments",size:1,type:Tt},...Array(10).fill(0).map((t,i)=>({name:"a_colors_"+i,size:4,type:fn,normalized:!0})),{name:"a_id",size:4,type:fn,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Tt}],CONSTANT_DATA:[[Me.ANGLE_1],[Me.ANGLE_2],[Me.ANGLE_3]]}}processVisibleItem(t,i,e){var o,a;const r=this.array;r[i++]=e.x,r[i++]=e.y,r[i++]=e.size-(e.stroke??1),r[i++]=(o=e.pie)!=null&&o.length?e.opacity??1:0,r[i++]=Math.min(10,((a=e.pie)==null?void 0:a.length)??0),Array(10).fill(0).forEach((s,l)=>{var u;r[i++]=ce(((u=e.pie)==null?void 0:u[l])??"#0000")}),r[i++]=t}setUniforms(t,{gl:i,uniformLocations:e}){const{u_sizeRatio:r,u_correctionRatio:o,u_matrix:a}=e;i.uniform1f(o,t.correctionRatio),i.uniform1f(r,t.sizeRatio),i.uniformMatrix3fv(a,!1,t.matrix)}};ee(Me,"ANGLE_1",0),ee(Me,"ANGLE_2",2*Math.PI/3),ee(Me,"ANGLE_3",4*Math.PI/3);let qi=Me;const Ic=$n([Wi,qi,Bi,To(!0),...Eo(!0)],So,kc),Fc=`
precision highp float;

varying vec4 v_color;

void main(void) {
  #ifdef PICKING_MODE
    gl_FragColor = v_color;
  #else
    gl_FragColor = v_color;
  #endif
}
`,Mc=`
attribute vec4 a_id;
attribute vec4 a_base;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_opacity;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_cameraAngle;
uniform float u_correctionRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;
const float sqrt_8 = sqrt(8.0);

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * sqrt_8;
  float angle = a_angle + u_cameraAngle; 
  vec2 diffVector = size * vec2(cos(angle), sin(angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  #ifdef PICKING_MODE
    v_color = a_id;
  #else
    v_color = mix(a_color, a_base, a_opacity * bias);
  #endif
}
`,{UNSIGNED_BYTE:Gi,FLOAT:Bt}=WebGLRenderingContext,$c=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_matrix"],tt=Math.PI;class Uc extends Ne{getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Mc,FRAGMENT_SHADER_SOURCE:Fc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:$c,ATTRIBUTES:[{name:"a_position",size:2,type:Bt},{name:"a_size",size:1,type:Bt},{name:"a_opacity",size:1,type:Bt},{name:"a_base",size:4,type:Gi,normalized:!0},{name:"a_color",size:4,type:Gi,normalized:!0},{name:"a_id",size:4,type:Gi,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Bt}],CONSTANT_DATA:[[tt/4],[3*tt/4],[-tt/4],[3*tt/4],[-tt/4],[-3*tt/4]]}}processVisibleItem(t,i,e){var s;const r=this.array,o=ce(this.renderer.getSetting("defaultNodeColor")),a=ce(e.color??this.renderer.getSetting("defaultNodeColor"));r[i++]=e.x,r[i++]=e.y,r[i++]=e.size-(e.stroke??.5)-((s=e.pie)!=null&&s.length?6:0),r[i++]=e.opacity??1,r[i++]=o,r[i++]=a,r[i++]=t}setUniforms(t,{gl:i,uniformLocations:e}){const{u_sizeRatio:r,u_correctionRatio:o,u_cameraAngle:a,u_matrix:s}=e;i.uniform1f(r,t.sizeRatio),i.uniform1f(a,t.cameraAngle),i.uniform1f(o,t.correctionRatio),i.uniformMatrix3fv(s,!1,t.matrix)}}function Ao(n,t,i){var c,d;const e=t.size,r=i.labelSize,o=i.labelFont,a=i.labelWeight,s=i.defaultNodeColor||"#fff",l=t.labelColor||i.labelColor.color||"#000";if(t.highlight){n.strokeStyle=t.highlightColor??"#44BD87",n.lineWidth=1,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=48,n.shadowColor=t.color??"#44BD87";const h=e+2;n.strokeRect(t.x-h,t.y-h,h*2,h*2)}if(n.shadowColor="transparent",n.shadowBlur=0,t.selected){n.strokeStyle="#f00",n.lineWidth=2,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0;const f=t.selected?4:2,h=e+f;n.strokeRect(t.x-h,t.y-h,h*2,h*2)}if(t.isGroup){const f=(d=(c=n.canvas.parentElement)==null?void 0:c.parentElement)==null?void 0:d.querySelector(".sigma-groupHandles");let h=f.querySelector(`[data-id="${t.id}"]`);h||(h=document.createElement("div"),h.className="sigma-groupHandle",h.dataset.id=t.id,f.appendChild(h)),h.innerText=t.expanded?"−":"+",h.style.transform="translate(-50%, -50%)",h.style.left=`${t.x}px`,h.style.top=`${t.y+e}px`}if(!t.label||t.opacity<1)return;const u=n.measureText(t.label).width;n.fillStyle=s,n.fillRect(t.x-u/2,t.y+e*1.25,u,r+2),n.fillStyle=l,n.font=`${a} ${r}px ${o}`,n.fillText(t.label,t.x-u/2,t.y+r+e*1.25)}function jc(n,t,i){const e=t.size,r=i.labelSize,o=i.labelFont,a=i.labelWeight,s=i.defaultNodeColor||"#fff",l=t.labelColor||i.labelColor.color||"#000";n.font=`${a} ${r}px ${o}`,n.fillStyle=s,n.strokeStyle=l,n.lineWidth=.25;const u=t.selected?4:2,c=e+u;n.lineWidth=1,n.strokeStyle="#F00",t.selected&&(n.lineWidth=3),n.strokeRect(t.x-c,t.y-c,c*2,c*2),n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,n.lineWidth=0,n.strokeStyle="",Ao(n,t,i)}const Hc=`
precision highp float;

varying vec4 v_color;

void main(void) {
  #ifdef PICKING_MODE
    gl_FragColor = v_color;
  #else
    gl_FragColor = v_color;
  #endif
}
`,Vc=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_opacity;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_cameraAngle;
uniform float u_correctionRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;
const float sqrt_8 = sqrt(8.0);

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * sqrt_8;
  float angle = a_angle + u_cameraAngle; 
  vec2 diffVector = size * vec2(cos(angle), sin(angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  #ifdef PICKING_MODE
    v_color = a_id;
  #else
    v_color = mix(vec4(0.0), a_color, a_opacity * bias);
  #endif
}
`,{UNSIGNED_BYTE:gn,FLOAT:Wt}=WebGLRenderingContext,Bc=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_matrix"],it=Math.PI;class Wc extends Ne{getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Vc,FRAGMENT_SHADER_SOURCE:Hc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Bc,ATTRIBUTES:[{name:"a_position",size:2,type:Wt},{name:"a_size",size:1,type:Wt},{name:"a_opacity",size:1,type:Wt},{name:"a_color",size:4,type:gn,normalized:!0},{name:"a_id",size:4,type:gn,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Wt}],CONSTANT_DATA:[[it/4],[3*it/4],[-it/4],[3*it/4],[-it/4],[-3*it/4]]}}processVisibleItem(t,i,e){const r=this.array,o=ce(e.strokeColor??this.renderer.getSetting("defaultEdgeColor"));r[i++]=e.x,r[i++]=e.y,r[i++]=e.size,r[i++]=e.opacity??1,r[i++]=o,r[i++]=t}setUniforms(t,{gl:i,uniformLocations:e}){const{u_sizeRatio:r,u_correctionRatio:o,u_cameraAngle:a,u_matrix:s}=e;i.uniform1f(r,t.sizeRatio),i.uniform1f(a,t.cameraAngle),i.uniform1f(o,t.correctionRatio),i.uniformMatrix3fv(s,!1,t.matrix)}}const qc=`
precision highp float;

varying vec4 v_color;
${Array(10).fill(0).map((n,t)=>"varying vec4 v_colors_"+t+";").join(`
`)}
varying vec2 v_diffVector;
varying float v_segmentAngle;
varying float v_opacity;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;

  float angle = atan(v_diffVector.y / v_diffVector.x);
  if (v_diffVector.x < 0.0 && v_diffVector.y < 0.0) angle += ${Math.PI};
  else if (v_diffVector.x < 0.0) angle += ${Math.PI};
  else if (v_diffVector.y < 0.0) angle += ${2*Math.PI};

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
    gl_FragColor = v_color;
  #else
    float t = 0.0;
    vec4 color = transparent;
    if(v_segmentAngle > 0.0) {
      float segment = angle / v_segmentAngle;
      ${Array(10).fill(0).map((n,t)=>"if(segment >= "+t+".0) { color = v_colors_"+t+"; }").join(`
`)}
    }
    
    gl_FragColor = mix(transparent, color, v_opacity);
  #endif
}
`,Xc=`
attribute vec4 a_id;
${Array(10).fill(0).map((n,t)=>"attribute vec4 a_colors_"+t+";").join(`
`)}
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_segments;
attribute float a_opacity;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_cameraAngle;
uniform float u_correctionRatio;

varying vec4 v_color;
${Array(10).fill(0).map((n,t)=>"varying vec4 v_colors_"+t+";").join(`
`)}
varying vec2 v_diffVector;
varying float v_segmentAngle;
varying float v_opacity;

const float bias = 255.0 / 254.0;
const float sqrt_8 = sqrt(8.0);

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * sqrt_8;
  float angle = a_angle + u_cameraAngle; 
  vec2 diffVector = size * vec2(cos(angle), sin(angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  v_opacity = a_opacity;
  // For normal mode, we use the color:
  ${Array(10).fill(0).map((n,t)=>"v_colors_"+t+" = a_colors_"+t+";").join(`
`)}
  v_segmentAngle = 0.0;
  if(a_segments > 0.0) {
    v_segmentAngle = ${Math.PI*2} / a_segments;
  }
  #endif
}
`,{UNSIGNED_BYTE:vn,FLOAT:St}=WebGLRenderingContext,Yc=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_matrix"],rt=Math.PI;class Kc extends Ne{getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Xc,FRAGMENT_SHADER_SOURCE:qc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Yc,ATTRIBUTES:[{name:"a_position",size:2,type:St},{name:"a_size",size:1,type:St},{name:"a_opacity",size:1,type:St},{name:"a_segments",size:1,type:St},...Array(10).fill(0).map((t,i)=>({name:"a_colors_"+i,size:4,type:vn,normalized:!0})),{name:"a_id",size:4,type:vn,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:St}],CONSTANT_DATA:[[rt/4],[3*rt/4],[-rt/4],[3*rt/4],[-rt/4],[-3*rt/4]]}}processVisibleItem(t,i,e){var o,a;const r=this.array;r[i++]=e.x,r[i++]=e.y,r[i++]=e.size-(e.stroke??.5),r[i++]=(o=e.pie)!=null&&o.length?e.opacity??1:0,r[i++]=Math.min(10,((a=e.pie)==null?void 0:a.length)??0),Array(10).fill(0).forEach((s,l)=>{var u;r[i++]=ce(((u=e.pie)==null?void 0:u[l])??"#0000")}),r[i++]=t}setUniforms(t,{gl:i,uniformLocations:e}){const{u_sizeRatio:r,u_correctionRatio:o,u_cameraAngle:a,u_matrix:s}=e;i.uniform1f(r,t.sizeRatio),i.uniform1f(a,t.cameraAngle),i.uniform1f(o,t.correctionRatio),i.uniformMatrix3fv(s,!1,t.matrix)}}const Zc=$n([Wc,Kc,Uc,To(!1),...Eo(!1)],Ao,jc),Qc=n=>{const t=(s,l)=>{try{const u=l.neighbors(s);l.forEachNode(c=>{l.setNodeAttribute(c,"opacity",c!==s&&!u.includes(c)?.1:1)}),l.forEachEdge(c=>{l.setEdgeAttribute(c,"opacity",l.hasExtremity(c,s)?1:.1)})}catch{}},i=s=>{s.forEachNode(l=>{s.setNodeAttribute(l,"opacity",1)}),s.forEachEdge(l=>{s.setEdgeAttribute(l,"opacity",1)})},e=(s,l)=>{try{const u=l.source(s),c=l.target(s);l.setEdgeAttribute(s,"zIndex",2),l.setNodeAttribute(u,"zIndex",2),l.setNodeAttribute(c,"zIndex",2),l.setEdgeAttribute(s,"highlight",!0),l.setNodeAttribute(u,"highlight",!0),l.setNodeAttribute(c,"highlight",!0),l.forEachNode(d=>{l.setNodeAttribute(d,"opacity",d!==u&&d!==c?.1:1)}),l.forEachEdge(d=>{l.setEdgeAttribute(d,"opacity",d!==s?.1:1)})}catch{}},r=(s,l)=>{const u=l.source(s),c=l.target(s);l.setEdgeAttribute(s,"zIndex",0),l.setNodeAttribute(u,"zIndex",0),l.setNodeAttribute(c,"zIndex",0),l.setEdgeAttribute(s,"highlight",!1),l.setNodeAttribute(u,"highlight",!1),l.setNodeAttribute(c,"highlight",!1),l.forEachNode(d=>{l.setNodeAttribute(d,"opacity",1),l.setNodeAttribute(d,"highlight",!1)}),l.forEachEdge(d=>{l.setEdgeAttribute(d,"opacity",1),l.setEdgeAttribute(d,"highlight",!1)})},o=at(s=>{t(s.node,n.getGraph())}),a=at(s=>{e(s.edge,n.getGraph())},100);n.on("enterNode",o),n.on("leaveNode",s=>{o.cancel(),i(n.getGraph())}),n.on("enterEdge",a),n.on("leaveEdge",s=>{a.cancel(),r(s.edge,n.getGraph())})},Jc=n=>{let t=!1,i=!1,e={x:0,y:0},r;const o=c=>d=>{if(!t||!r)return;i=!0;const f=c.viewportToGraph(d),h={x:f.x-e.x,y:f.y-e.y},g=c.getGraph();Object.entries(r).forEach(([m,y])=>{g.setNodeAttribute(m,"x",y.x+h.x),g.setNodeAttribute(m,"y",y.y+h.y)}),d.preventSigmaDefault(),d.original.preventDefault(),d.original.stopPropagation()},a=c=>{r&&Object.entries(r).forEach(([d,f])=>{var g;const h=c.getNodeAttributes(d);if(h.isGroup){const m={x:h.x-f.x,y:h.y-f.y};(g=h.nodes)==null||g.forEach(y=>{try{const{x:A,y:x}=c.getNodeAttributes(y);c.setNodeAttribute(y,"x",A+m.x),c.setNodeAttribute(y,"y",x+m.y)}catch{}})}}),t=!1,r=void 0},s=c=>{c.on("downNode",d=>{if("button"in d.event.original&&d.event.original.button===0){const f=c.getGraph();t=!0,r={};const{x:h=0,y:g=0}=f.getNodeAttributes(d.node);r[d.node]={x:h,y:g},e={x:h,y:g},f.forEachNode((m,y)=>{y.selected&&(r[m]={x:y.x,y:y.y})})}}),c.getMouseCaptor().on("mousemovebody",o(c)),c.getMouseCaptor().on("mouseup",d=>{t&&(a(c.getGraph()),d.original.preventDefault(),d.preventSigmaDefault())}),c.getMouseCaptor().on("mousedown",()=>{c.getCustomBBox()||c.setCustomBBox(c.getBBox())})},l=c=>{c.forEachNode((d,f)=>f.selected&&c.setNodeAttribute(d,"selected",!1)),c.forEachEdge((d,f)=>f.selected&&c.setEdgeAttribute(d,"selected",!1))};(c=>{c.on("downNode",d=>{if("button"in d.event.original&&d.event.original.button===2){const f=c.getGraph().getNodeAttribute(d.node,"selected");!f&&l(c.getGraph()),!f&&c.getGraph().setNodeAttribute(d.node,"selected",!0)}}),c.on("downEdge",d=>{if("button"in d.event.original&&d.event.original.button===2){const f=c.getGraph().getEdgeAttribute(d.edge,"selected");!f&&l(c.getGraph()),!f&&c.getGraph().setEdgeAttribute(d.edge,"selected",!0)}}),c.on("clickNode",d=>{if(!i&&"button"in d.event.original&&d.event.original.button===0){const f=c.getGraph().getNodeAttribute(d.node,"selected");!d.event.original.shiftKey&&l(c.getGraph()),c.getGraph().setNodeAttribute(d.node,"selected",!f)}i=!1}),c.on("downStage",d=>{l(c.getGraph())})})(n),s(n)},ed=(n,t,i)=>{const[e,r]=B.useState(null),[o,a]=B.useState(null),s=ea(),[l,u]=B.useState();return B.useEffect(()=>{if(e){const c=new Uu(n,e,{allowInvalidContainer:!0,enableEdgeEvents:!0,renderEdgeLabels:!0,renderLabels:!0,labelSize:14,defaultEdgeType:"line",defaultNodeType:"circle",edgeProgramClasses:{line:Qu,curved:qu},maxCameraRatio:10,minCameraRatio:.01,nodeProgramClasses:{rect:Zc,circle:Ic},nodeReducer(d,f){const h=(t==null?void 0:t(f))||f;return(h.size??0)<16&&(h.size=16),h.label=h.label||"",h.id=d,h},edgeReducer(d,f){return(i==null?void 0:i(f))||f}});return Jc(c),Qc(c),window.sigma=c,u(c),()=>{c.kill()}}},[n,e,o]),B.useEffect(()=>{l==null||l.setSettings({defaultNodeColor:s?"#000":"#fff",defaultEdgeColor:s?"#fff":"#000",labelColor:{color:s?"#fff":"#000",attribute:"labelColor"}})},[s,l]),{instance:l,containerRef:r,componentsRef:a}},Ro=B.createContext({}),Co=()=>B.useContext(Ro),Lo=({ref:n,data:t,children:i,nodeReducer:e,edgeReducer:r,onSelectChange:o})=>{const{graph:a,selected:s}=Eu(t),l=ed(a,e,r),u=rs(l.instance),c=()=>{a.size!==0&&l.instance&&Ar(l.instance,a.nodes(),{animate:!0})};return B.useEffect(()=>{const d=()=>{l.instance&&Ar(l.instance,a.nodes(),{animate:!0})};return a.on("layoutDone",d),o&&a.on("nodesSelected",o),()=>{a.off("layoutDone",d),o&&a.off("nodesSelected",o)}},[a,l,o]),B.useImperativeHandle(n,()=>({graph:a,sigma:l}),[a,l]),P.jsx(Ro.Provider,{value:{sigma:l,graph:a,selected:s,dragSelector:u,resetViewport:c},children:i})};Lo.__docgenInfo={description:"",methods:[],displayName:"GraphProvider",props:{ref:{required:!1,tsType:{name:"RefObject",elements:[{name:"union",raw:"GraphRef<N, E> | null",elements:[{name:"GraphRef",elements:[{name:"N"},{name:"E"}],raw:"GraphRef<N, E>"},{name:"null"}]}],raw:"RefObject<GraphRef<N, E> | null>"},description:""},data:{required:!0,tsType:{name:"union",raw:"RawGraph<N, E> | Graph<N, E>",elements:[{name:"RawGraph",elements:[{name:"N"},{name:"E"}],raw:"RawGraph<N, E>"},{name:"Graph",elements:[{name:"N"},{name:"E"}],raw:"Graph<N, E>"}]},description:""},nodeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(node: NodeAttributes<N>) => NodeAttributes<N>",signature:{arguments:[{type:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"},name:"node"}],return:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"}}},description:""},edgeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(edge: EdgeAttributes<E>) => EdgeAttributes<E>",signature:{arguments:[{type:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"},name:"edge"}],return:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"}}},description:""},onSelectChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(selected: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"selected"}],return:{name:"void"}}},description:""}}};const Oe={focus:"M17 12C17 7.55 11.62 5.31 8.46 8.46C5.31 11.61 7.55 17 12 17C14.76 17 17 14.76 17 12M12 15C9.33 15 8 11.77 9.88 9.88C11.77 8 15 9.33 15 12C15 13.66 13.66 15 12 15M5 15H3V19C3 20.1 3.9 21 5 21H9V19H5M5 5H9V3H5C3.9 3 3 3.9 3 5V9H5M19 3H15V5H19V9H21V5C21 3.9 20.1 3 19 3M19 19H15V21H19C20.1 21 21 20.1 21 19V15H19",zoomIn:"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z",zoomOut:"M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z",lasso:"M22 9C22 5.13 17.5 2 12 2C6.5 2 2 5.13 2 9C2 9.00843 2.00002 9.01685 2.00006 9.02527C2.00952 10.8953 3.06771 12.5956 4.78 13.85C4.78103 13.847 4.78207 13.844 4.7831 13.841C5.18858 14.1369 5.63069 14.408 6.10419 14.6507C6.03614 14.9227 6 15.2072 6 15.5C6 16.76 6.67 17.87 7.67 18.5C7.46 19.11 6.97 20.96 8.3 22.05C9.91 23.38 11.66 22.97 12.56 22.69C12.8116 22.6126 13.0655 22.5076 13.3395 22.3944C14.0563 22.0981 14.9105 21.7451 16.22 21.68C17.6764 21.5995 18.9321 21.8104 19.5651 21.9167C19.7188 21.9425 19.8358 21.9622 19.91 21.97C19.91 21.97 20.86 21.97 20.97 21.04C21.08 20.1 20.03 19.97 20.03 19.97C20.03 19.97 18.43 19.7 16.39 19.71C14.9823 19.7145 13.7447 20.1595 12.703 20.5341C11.4434 20.987 10.4704 21.3368 9.83 20.68C9.18 20 9.39 19.36 9.6 19C11.3416 18.9542 12.7471 17.6481 12.9693 15.9673C13.4921 15.9319 14.0034 15.8699 14.5 15.78C18.6753 15.0244 21.7995 12.4293 21.9907 9.30406C21.9969 9.20324 22 9.10187 22 9ZM20 9C20 10.2554 19.2572 11.4047 18.032 12.2843C16.6998 13.2393 14.7966 13.8752 12.6542 13.9835C12.0881 12.8109 10.887 12 9.5 12C8.57261 12 7.72834 12.3625 7.10143 12.9533C6.61638 12.7181 6.17578 12.4489 5.78883 12.1513L5.79 12.15C4.6875 11.3034 4.02105 10.2243 4.00049 9.05571C4.00016 9.03717 4 9.01859 4 9C4 6.24 7.58 4 12 4C16.42 4 20 6.24 20 9ZM10.9988 15.5603C10.9933 15.6993 10.9689 15.8333 10.9281 15.96C10.7345 16.5641 10.1694 17 9.5 17C8.67 17 8 16.33 8 15.5C8 15.4718 8.00078 15.4437 8.00231 15.4159C8.04595 14.6266 8.69981 14 9.5 14C10.3284 14 11 14.6716 11 15.5C11 15.5202 10.9996 15.5403 10.9988 15.5603Z",select:"M13,17H17V13H19V17H23V19H19V23H17V19H13V17M11,17V19H9V17H11M7,17V19H5V17H7M19,9V11H17V9H19M19,5V7H17V5H19M15,5V7H13V5H15M11,5V7H9V5H11M7,5V7H5V5H7M7,13V15H5V13H7M7,9V11H5V9H7Z",cancel:"M3,16.74L7.76,12L3,7.26L7.26,3L12,7.76L16.74,3L21,7.26L16.24,12L21,16.74L16.74,21L12,16.24L7.26,21L3,16.74M12,13.41L16.74,18.16L18.16,16.74L13.41,12L18.16,7.26L16.74,5.84L12,10.59L7.26,5.84L5.84,7.26L10.59,12L5.84,16.74L7.26,18.16L12,13.41Z",delete:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z",clear:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"},ko=()=>{const{dragSelector:n,graph:t,selected:i,resetViewport:e}=Co();return P.jsxs("div",{className:"flex flex-nowrap outline absolute top-0 start-0 p-0 z-1 bg-base",children:[P.jsxs(At,{variant:"link",children:[P.jsx(he,{"aria-label":"Home",icon:Oe.focus,onClick:e}),P.jsx(he,{"aria-label":"Zoomin",icon:Oe.zoomIn}),P.jsx(he,{"aria-label":"Zoomout",icon:Oe.zoomOut})]}),P.jsxs(At,{variant:"link",children:[n.selectionMode!=="lasso"&&P.jsx(he,{"aria-label":"lasso",icon:Oe.lasso,disabled:!!n.selectionMode,onClick:()=>n.startLassoSelection()}),n.selectionMode&&P.jsx(he,{color:"danger","aria-label":"cancel",icon:Oe.cancel,onClick:()=>n.cancelSelection()}),n.selectionMode!=="rectangle"&&P.jsx(he,{"aria-label":"rectselect",icon:Oe.select,disabled:!!n.selectionMode,onClick:()=>n.startRectangleSelection()})]}),P.jsxs(At,{variant:"link",children:[P.jsx(he,{"aria-label":"circular",icon:"M20.8 8.8c-0.43 0-0.84 0.086-1.216 0.241l-4.742-4.377c0.227-0.439 0.358-0.936 0.358-1.464 0-1.764-1.436-3.2-3.2-3.2s-3.2 1.436-3.2 3.2c0 0.528 0.13 1.025 0.358 1.464l-4.742 4.377c-0.375-0.155-0.785-0.241-1.216-0.241-1.764 0-3.2 1.436-3.2 3.2s1.436 3.2 3.2 3.2c0.43 0 0.84-0.087 1.216-0.242l4.742 4.378c-0.227 0.439-0.358 0.936-0.358 1.464-0 1.764 1.436 3.2 3.2 3.2s3.2-1.436 3.2-3.2c0-0.528-0.131-1.025-0.358-1.464l4.742-4.378c0.375 0.155 0.785 0.242 1.216 0.242 1.764 0 3.2-1.436 3.2-3.2s-1.436-3.2-3.2-3.2zM18.86 14.539l-4.477 4.133c-0.586-0.656-1.436-1.072-2.383-1.072s-1.796 0.416-2.383 1.072l-4.477-4.133c0.764-0.585 1.26-1.504 1.26-2.539s-0.496-1.954-1.26-2.539l4.477-4.133c0.586 0.656 1.436 1.072 2.383 1.072s1.796-0.416 2.383-1.072l4.477 4.133c-0.764 0.585-1.26 1.504-1.26 2.539s0.496 1.954 1.26 2.539z",onClick:()=>t.circularLayout()}),P.jsx(he,{"aria-label":"force",icon:"M21.763 15.051c-0.434 0-0.835 0.139-1.165 0.372l-3.733-2.24c0.006-0.055 0.017-0.109 0.017-0.166 0-0.756-0.52-1.388-1.22-1.569v-3.76c0.927-0.189 1.627-1.011 1.627-1.993 0-0.293-0.065-0.571-0.178-0.823l2.175-1.864c0.248 0.153 0.538 0.247 0.851 0.247 0.897 0 1.627-0.73 1.627-1.627s-0.73-1.627-1.627-1.627-1.627 0.73-1.627 1.627c0 0.289 0.082 0.556 0.214 0.792l-2.089 1.791c-0.363-0.337-0.846-0.548-1.379-0.548-0.629 0-1.185 0.293-1.559 0.744l-2.317-1.986c0.133-0.235 0.214-0.503 0.214-0.792 0-0.897-0.73-1.627-1.627-1.627s-1.627 0.73-1.627 1.627c0 0.897 0.73 1.627 1.627 1.627 0.313 0 0.602-0.093 0.851-0.247l2.49 2.134c-0.050 0.177-0.086 0.36-0.086 0.553 0 0.982 0.7 1.804 1.627 1.993v3.76c-0.365 0.095-0.68 0.312-0.898 0.607l-3.609-0.984c-0.155-0.969-0.99-1.715-2.002-1.715-0.408 0-0.788 0.124-1.107 0.332l-3.307-3.674c0.218-0.324 0.346-0.713 0.346-1.132 0-1.121-0.912-2.034-2.034-2.034s-2.034 0.912-2.034 2.034 0.912 2.034 2.034 2.034c0.408 0 0.788-0.124 1.107-0.332l3.307 3.674c-0.218 0.324-0.346 0.713-0.346 1.132 0 0.051 0.011 0.098 0.015 0.148l-2.996 1.497c-0.289-0.261-0.668-0.425-1.087-0.425-0.897 0-1.627 0.73-1.627 1.627s0.73 1.627 1.627 1.627 1.627-0.73 1.627-1.627c0-0.181-0.037-0.353-0.092-0.516l2.775-1.388c0.281 0.53 0.78 0.926 1.384 1.049v3.353c-0.7 0.182-1.22 0.813-1.22 1.569 0 0.191 0.039 0.371 0.1 0.541l-2.503 2.146c-0.248-0.153-0.538-0.247-0.851-0.247-0.897 0-1.627 0.73-1.627 1.627s0.73 1.627 1.627 1.627c0.897 0 1.627-0.73 1.627-1.627 0-0.289-0.082-0.556-0.214-0.792l2.401-2.058c0.287 0.251 0.657 0.409 1.068 0.409s0.781-0.157 1.068-0.409l2.401 2.058c-0.133 0.235-0.214 0.503-0.214 0.792 0 0.897 0.73 1.627 1.627 1.627s1.627-0.73 1.627-1.627c0-0.897-0.73-1.627-1.627-1.627-0.313 0-0.602 0.093-0.851 0.247l-2.503-2.146c0.061-0.17 0.1-0.351 0.1-0.541 0-0.756-0.52-1.388-1.22-1.569v-3.353c0.759-0.155 1.359-0.737 1.553-1.48l3.348 0.913c-0.008 0.067-0.020 0.132-0.020 0.201 0 0.897 0.73 1.627 1.627 1.627 0.545 0 1.026-0.272 1.322-0.685l3.455 2.073c-0.188 0.308-0.302 0.666-0.302 1.053 0 1.121 0.912 2.034 2.034 2.034s2.034-0.912 2.034-2.034-0.912-2.034-2.034-2.034z",onClick:()=>t.forceLayout()})]}),P.jsxs(At,{variant:"link",children:[P.jsx(he,{"aria-label":"delete",color:"danger",icon:Oe.delete,disabled:!i.length,onClick:()=>t.dropNodes(i)}),P.jsx(he,{"aria-label":"clear",color:"danger",icon:Oe.clear,onClick:()=>t.clear()})]})]})};ko.__docgenInfo={description:"",methods:[],displayName:"Tools"};const td=()=>{const{sigma:n,graph:t}=Co(),i=B.useRef(null);return B.useEffect(()=>{const e=({key:r})=>{var a;const o=(a=i.current)==null?void 0:a.querySelector(`[data-id="${r}"]`);o==null||o.remove()};return t.on("nodeDropped",e),()=>{t.off("nodeDropped",e)}},[t]),P.jsxs("div",{className:"area-content relative bg-base graph-viewer",children:[P.jsx("div",{dir:"ltr",ref:n.containerRef,className:"absolute inset-0"}),P.jsx("div",{ref:i,dir:"ltr",onClick:e=>{const r=e.target.dataset.id;r&&t.toggleExpanded(r)},className:"absolute inset-0 overflow-hidden pointer-events-none sigma-groupHandles"})]})},nr=n=>P.jsx(Lo,{...n,children:P.jsxs(Jo,{className:"relative",children:[P.jsx(ko,{}),P.jsx(td,{})]})});nr.__docgenInfo={description:"",methods:[],displayName:"SigmaGraph",props:{ref:{required:!1,tsType:{name:"RefObject",elements:[{name:"union",raw:"GraphRef<N, E> | null",elements:[{name:"GraphRef",elements:[{name:"N"},{name:"E"}],raw:"GraphRef<N, E>"},{name:"null"}]}],raw:"RefObject<GraphRef<N, E> | null>"},description:""},data:{required:!0,tsType:{name:"union",raw:"RawGraph<N, E> | Graph<N, E>",elements:[{name:"RawGraph",elements:[{name:"N"},{name:"E"}],raw:"RawGraph<N, E>"},{name:"Graph",elements:[{name:"N"},{name:"E"}],raw:"Graph<N, E>"}]},description:""},nodeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(node: NodeAttributes<N>) => NodeAttributes<N>",signature:{arguments:[{type:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"},name:"node"}],return:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"}}},description:""},edgeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(edge: EdgeAttributes<E>) => EdgeAttributes<E>",signature:{arguments:[{type:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"},name:"edge"}],return:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"}}},description:""},onSelectChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(selected: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"selected"}],return:{name:"void"}}},description:""}}};const Id={component:nr,title:"@graph/_Playground_",parameters:{layout:"fullscreen",controls:{exclude:"children"}}},id=ue.helpers.uniqueArray(()=>ue.string.hexadecimal({length:9}),ue.number.int({min:18,max:45})),rd=[Oo,Io,Fo,Mo,$o],Xi={nodes:[{key:"root",attributes:{x:-1,y:-1,stroke:2,strokeColor:ue.color.rgb(),iconColor:ue.color.rgb(),path:Po}}],edges:[]};id.forEach(n=>{Xi.nodes.push({key:n,attributes:{label:ue.word.sample(),x:ue.number.int({min:-1,max:1}),y:ue.number.int({min:-1,max:1}),stroke:2,strokeColor:ue.color.rgb(),iconColor:ue.color.rgb(),path:ue.helpers.arrayElement(rd),badge:[{position:ue.helpers.arrayElement(["top","left","right","top-left","top-right","bottom-left","bottom-right"]),type:ue.helpers.arrayElement(["exclaim","star","thumbUp","thumbDown"]),iconColor:"#fff",color:ue.color.rgb()}]}}),new Array(ue.number.int({min:1,max:4})).fill(0).forEach(()=>{Xi.edges.push({key:"root::"+ue.string.hexadecimal({length:9}),source:"root",target:n,attributes:{color:ue.color.rgb(),size:ue.number.float({min:.25,max:1})}})})});const qt={render:n=>{const t=B.useRef(null),[i,e]=B.useState([]);return P.jsx("div",{className:"min-h-[600px]",children:P.jsxs(Yo,{children:[P.jsx(nr,{ref:t,data:Xi,onSelectChange:e}),P.jsx(ta,{align:"end",children:P.jsxs(Xo,{children:[P.jsx(he,{disabled:i.length===0,onClick:()=>{var r;(r=t.current)==null||r.graph.groupNodes(ue.string.hexadecimal(),i,{label:ue.word.sample(),color:ue.color.rgb(),iconColor:ue.color.rgb(),path:zo,x:.1,y:.1})},children:"Group"}),P.jsx("hr",{}),i.map(r=>{var o;return P.jsx("div",{children:P.jsx(xa,{json:((o=t.current)==null?void 0:o.graph.getNodeAttributes(r))??{}})},r)})]})})]})})},args:{}};var pn,mn,yn;qt.parameters={...qt.parameters,docs:{...(pn=qt.parameters)==null?void 0:pn.docs,source:{originalSource:`{
  render: args => {
    const graphRef = useRef<GraphRef>(null);
    const [selection, setSelection] = useState<string[]>([]);
    return <div className="min-h-[600px]">
        <Viewport>
          <SigmaGraph ref={graphRef} data={rawGraph} onSelectChange={setSelection} />
          <Aside align="end">
            <Content>
              <Button disabled={selection.length === 0} onClick={() => {
              graphRef.current?.graph.groupNodes(faker.string.hexadecimal(), selection, {
                label: faker.word.sample(),
                color: faker.color.rgb(),
                iconColor: faker.color.rgb(),
                path: mdiFolder,
                x: 0.1,
                y: 0.1
              });
            }}>
                Group
              </Button>
              <hr />
              {selection.map(key => <div key={key}>
                  <JsonViewer json={graphRef.current?.graph.getNodeAttributes(key) ?? {}} />
                </div>)}
            </Content>
          </Aside>
        </Viewport>
      </div>;
  },
  args: {}
}`,...(yn=(mn=qt.parameters)==null?void 0:mn.docs)==null?void 0:yn.source}}};const Fd=["Playground"];export{qt as Playground,Fd as __namedExportsOrder,Id as default};
