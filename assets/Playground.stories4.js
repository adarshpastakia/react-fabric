var xa=Object.defineProperty;var Ca=(n,r,t)=>r in n?xa(n,r,{enumerable:!0,configurable:!0,writable:!0,value:t}):n[r]=t;var ue=(n,r,t)=>Ca(n,typeof r!="symbol"?r+"":r,t);import{r as I,l as Be,j,m as de,_ as fn,aA as to,aO as ir,aQ as ro,Y as Zr,bk as Xt,aP as kn,aS as xt,bn as Aa,c2 as Ln,bB as gn,aM as no,bE as io,bF as oo,bI as ka,bH as La,bJ as Da,bD as ao,bL as mr,G as Ga}from"./iframe-6XIGnDH8.js";import{f as fe}from"./index4.js";import{c as Pa,d as Na,e as Oa,f as Ia,g as za,h as Fa,i as $a}from"./mdi.js";import{u as Ma,C as pe,_ as lr,b as Ua,c as ja}from"./index2.js";import{L as Ha,B as ye,S as so}from"./Button.js";import{I as Qe}from"./Tooltip.js";import{u as Wa}from"./usePropToggle.js";import{u as Ba}from"./useResize.js";import{E as Va}from"./ErrorBoundary.js";import{C as qa}from"./Content.js";import{V as Xa}from"./Viewport.js";import{E as Ya}from"./EmptyContent.js";import{M as Ka,m as vn,u as uo}from"./memoize-one.esm.js";import{C as Dn}from"./Copy.js";import{T as Za}from"./Text.js";import"./Google.js";import"./ColorPicker.js";import{u as lo}from"./useDebounce.js";import{B as Ft}from"./ButtonGroup2.js";import{d as yt}from"./debounce.js";import{S as Ja}from"./Section.js";import{u as Qa}from"./useIsDark.js";import{D as Gn}from"./Divider.js";import{M as es,a as ut}from"./Menu.js";import"./createClass.js";import"./Global.js";import"./useResizeObserver.js";import"./types.js";import"./zh-CN.js";import"./endOfDay.js";import"./index5.js";import"./index3.js";import"./cloneElement.js";import"./nodeCheck.js";function Pn(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function Nn(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Pn(Object(t),!0).forEach(function(e){lr(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Pn(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}var ts=function(r){var t=r.children,e=r.title,i=r.icon,o=r.iconBg,a=r.iconColor,s=r.rtlFlip,u=r.className,l=r.bodyClassName,c=r.headerClassName,d=r.resizeable,f=r.flyout,h=r.onFlyout,m=r.collapsed,v=r.collapsable,b=r.onCollapse,x=r.actions,T=r.loading,E=r.align,_=E===void 0?"start":E,A=r.width,L=A===void 0?"20rem":A,y=r.minWidth,C=y===void 0?"2rem":y,S=r.maxWidth,D=S===void 0?"30vw":S,G=r["data-testid"],O=r["data-test-value"],R=I.useRef(null),H=I.useState(L),$=Be(H,2),w=$[0],p=$[1],g=I.useState(!1),z=Be(g,2),M=z[0],P=z[1],k=Wa(m,b),F=Be(k,2),B=F[0],Y=F[1];I.useEffect(function(){p(L)},[L]);var ee=I.useRef(function(Z){var ne=Z.x;R.current!=null&&p(R.current.offsetWidth+ne)}),q=Ba(ee.current,{isReverse:_==="end"}),W=I.useCallback(function(){B&&(f?(P(!M),!M&&(h==null||h())):Y())},[M,f,B,h,Y]);Ma(function(){if(M){var Z=function(te){te.target.closest('[data-ref="asideBody"]')==null&&te.target.closest('[data-ref="asidePlaceholder"]')==null&&P(!1)};return document.addEventListener("mouseup",Z),function(){return document.removeEventListener("mouseup",Z)}}},[M],"Aside peek");var oe=I.useMemo(function(){return{width:w,minWidth:C,maxWidth:D}},[w,C,D]);return j.jsxs("aside",{className:de("fabric-aside",u,"overflow-hidden grid"),"data-align":_,"data-flyout":M,"data-loading":T,"data-collapsed":B,style:B?void 0:oe,"data-testid":G,"data-test-value":O,children:[j.jsxs("header",{className:de("fabric-asideHeader",c,"grid area-head items-center"),"data-ref":"asideHeader",children:[e&&j.jsx("div",{className:de("fabric-asideTitle","truncate py-0.5 px-1 select-none pointer-events-none"),children:e}),v&&j.jsx(Qe,{"aria-label":B?"expand":"collapse",className:de("fabric-asideCollapse","p-2 select-none"),icon:pe.chevronLeft,rtlFlip:!0,onClick:Y,"data-ref":"asideToggle"}),i&&j.jsx(Qe,{icon:i,bg:o,color:a,rtlFlip:s,className:de("fabric-asideIcon","p-1 text-lg select-none pointer-events-none")}),x&&j.jsx("div",{className:"fabric-asideActions",children:x})]}),T&&j.jsx(Ha,{}),B&&j.jsx("div",{role:"none",onClick:W,"data-ref":"asidePlaceholder",className:"fabric-asidePlaceholder"}),j.jsx("section",{ref:R,"data-ref":"asideBody",className:de("fabric-asideBody",l,"overflow-hidden grid"),style:B?oe:void 0,children:j.jsx(Va,{children:t})}),d&&j.jsx("div",Nn(Nn({},q),{},{className:de("fabric-asideResizer","before:absolute before:inset-0 before:w-1 before:top-1/2 before:-translate-y-1/2 before:transition-all before:delay-150")}))]})},rs={noRecords:"لا تسجيلات"},ns={noItems:"لا توجد عناصر",error:"خطأ في تحميل العناصر",loading:"تحميل العناصر…"},is={empty:"لا توجد سجلات متاحة"},os={empty:"لا توجد خصائص بيانات",true:"نعم",false:"رقم"},as={empty:"لا توجد عناصر قائمة"},ss={empty:"لا توجد رسوم بيانية"},us={find:"تجد…",copy:"قيمة النسخ",filter:"منقي…",showShortcuts:"اختصارات لوحة المفاتيح…",collapseAll:"انهيار جميع",expandAll:"توسيع الكل",checkAll:"تحقق من الكل",uncheckAll:"الغاءالكل",addFilter:"أضف عامل تصفية",addFilterNot:"إضافة لا تصفية"},ls={tree:{noItems:"لا توجد عناصر شجرة متوفرة"}},cs={label:rs,tree:ns,datagrid:is,json:os,checkList:as,histogram:ss,action:us,data:ls},ds={noRecords:"No Records"},hs={noItems:"No items",error:"Error loading items",loading:"Loading items..."},fs={empty:"No records available"},gs={empty:"No data properties",true:"Yes",false:"No"},vs={empty:"No list items"},ps={empty:"No histograms"},ms={find:"Find...",copy:"Copy Value",filter:"Filter...",showShortcuts:"Keyboard shortcuts...",collapseAll:"Collapse All",expandAll:"Expand All",checkAll:"Check All",uncheckAll:"Uncheck All",addFilter:"Add Filter",addFilterNot:"Add not Filter"},ys={tree:{noItems:"No tree items available"}},bs={label:ds,tree:hs,datagrid:fs,json:gs,checkList:vs,histogram:ps,action:ms,data:ys};Ua("data",{en:bs,ar:cs});var _s=["className","json","copy","propertyScheme","filters","inline","labelWidth","formatter","labeler","onFilter","emptyMessage","showPropertyTree"];function On(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function pt(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?On(Object(t),!0).forEach(function(e){lr(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):On(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}var ws=function n(r){var t=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[],e=arguments.length>2&&arguments[2]!==void 0?arguments[2]:"",i=[];return Object.entries(r).forEach(function(o){var a=Be(o,2),s=a[0],u=a[1];if(ro(u)&&Zr(u[0]))i.push.apply(i,Xt(n(u,[].concat(Xt(t),[s]),s)));else{var l={field:e?"".concat(e,".").concat(s):s,value:u,path:[].concat(Xt(t),[s]).join(".")};Zr(u)&&!ir(u)&&!("_score_"in u)&&(l.children=n(u,[].concat(Xt(t),[s]))),i.push(l)}}),i.flat(99)},Es=function n(r){var t=r.value,e=r.path,i=r.field,o=r.children,a=r.copy,s=r.filters,u=r.labeler,l=r.formatter,c=r.propertyScheme,d=r.showPropertyTree,f=r.onFilter,h=r.inline,m=r.labelWidth,v=m===void 0?"30%":m,b=r.level,x=b===void 0?0:b,T=to("data"),E=T.t,_=I.useState(!0),A=Be(_,2),L=A[0],y=A[1],C=I.useMemo(function(){return!!o},[o]),S=I.useMemo(function(){var $,w;return($=(w=t==null?void 0:t._label_)!==null&&w!==void 0?w:t)!==null&&$!==void 0?$:""},[t]),D=I.useMemo(function(){var $,w,p,g,z,M,P,k;if(o)return null;if(kn(t))return j.jsx("span",{className:"text-muted",children:"null"});if(ir(t))return j.jsx("span",{className:"text-muted",children:"empty"});var F=S;if(l){var B=l==null?void 0:l(e,S);kn(B)||(F=B)}return ro(S)&&(F="[".concat(S.join(", "),"]")),c!=null&&($=c.date)!==null&&$!==void 0&&$.includes(e),c!=null&&(w=c.time)!==null&&w!==void 0&&w.includes(e)&&(F=xt.date(S,"pp")),c!=null&&(p=c.number)!==null&&p!==void 0&&p.phone(e)&&(F=xt.phone(S)),c!=null&&(g=c.bytes)!==null&&g!==void 0&&g.includes(e)&&(F=xt.bytes(S)),c!=null&&(z=c.percent)!==null&&z!==void 0&&z.includes(e)&&(F=xt.percent(S)),c!=null&&(M=c.number)!==null&&M!==void 0&&M.includes(e)&&(F=xt.number(S)),(c!=null&&(P=c.boolean)!==null&&P!==void 0&&P.includes(e)||Aa(S))&&(F=E(S?"json.true":"json.false")),((k=F)===null||k===void 0?void 0:k.length)>128?F=j.jsx(Za,{clamp:3,children:F}):F=j.jsx("div",{className:"break-words",children:F}),j.jsxs(I.Fragment,{children:[F,Zr(t)&&t._score_>0&&j.jsx(Ka,{className:"text-xs",value:t._score_})]})},[t,e,l,c,S]),G=I.useMemo(function(){return e.replace(/\.\d*\./,".")},[e]),O=I.useMemo(function(){var $,w;return!ir(t)&&(Ln(a)||(a==null||($=a.includes)===null||$===void 0?void 0:$.call(a,e))||(a==null||(w=a.includes)===null||w===void 0?void 0:w.call(a,G)))},[a,t,e,G]),R=I.useMemo(function(){var $,w;return Ln(s)||(s==null||($=s.includes)===null||$===void 0?void 0:$.call(s,e))||(s==null||(w=s.includes)===null||w===void 0?void 0:w.call(s,G))},[s,e,G]),H=I.useMemo(function(){var $;return j.jsxs("div",{className:de("text-dimmed text-sm px-2 flex-1 group",h?"truncate":"break-words"),children:[!C&&R&&j.jsxs("div",{className:"hidden pe-1 group-hover:inline-block",children:[j.jsx(ye,{color:"danger",size:"xs",variant:"link",icon:pe.funnelMinus,"aria-label":"Filter Negative",onClick:function(){return f==null?void 0:f(G,S,!0)}},"negative"),j.jsx(ye,{color:"primary",size:"xs",variant:"link",icon:pe.funnelPlus,"aria-label":"Filter",onClick:function(){return f==null?void 0:f(G,S)}},"positive")]}),($=u==null?void 0:u(e))!==null&&$!==void 0?$:i]})},[i,u,G,S,C,R]);return j.jsxs(I.Fragment,{children:[d&&j.jsxs("div",{className:de("py-2",h&&"flex flex-nowrap items-center"),style:{paddingInlineStart:x*8},children:[j.jsxs("div",{role:"none",className:de("flex overflow-hidden items-center",h&&"flex-content"),style:{flexBasis:v},onClick:function(){return C&&y(!L)},children:[C&&j.jsx(Qe,{rtlFlip:!0,icon:L?pe.chevronDown:pe.chevronRight}),H]}),D&&j.jsxs("div",{className:de("px-2 flex flex-nowrap overflow-hidden",h&&"flex-1"),children:[O&&j.jsx(Dn,{size:"xs",text:S}),j.jsx("div",{className:"flex-1",children:D})]})]}),!d&&!o&&j.jsxs("div",{className:de("py-2",h&&"flex flex-nowrap items-center"),children:[j.jsx("div",{role:"none",className:de("flex overflow-hidden items-center",h&&"flex-content"),style:{flexBasis:v},children:H}),j.jsxs("div",{className:de("px-2 flex flex-nowrap overflow-hidden",h&&"flex-1"),children:[O&&j.jsx(Dn,{size:"xs",text:t}),j.jsx("div",{className:"flex-1",children:D})]})]}),L&&(o==null?void 0:o.map(function($){return j.jsx(n,pt(pt({},$),{},{level:x+1,copy:a,inline:h,showPropertyTree:d,propertyScheme:c,filters:s,labelWidth:v,formatter:l,labeler:u,onFilter:f}),$.path)}))]})},Ts=function(r){var t=r.className,e=r.json,i=r.copy,o=r.propertyScheme,a=r.filters,s=r.inline,u=r.labelWidth,l=r.formatter,c=r.labeler,d=r.onFilter,f=r.emptyMessage,h=r.showPropertyTree,m=h===void 0?!0:h,v=fn(r,_s),b=to("data"),x=b.t,T=I.useMemo(function(){return ws(e)},[e]);return j.jsx("div",pt(pt({},v),{},{className:de(t,"bg-alternate"),children:ir(e)?j.jsx(Ya,{size:"sm",message:f??x("json.empty")}):T.map(function(E){return j.jsx(Es,pt(pt({},E),{},{copy:i,inline:s,showPropertyTree:m,propertyScheme:o,filters:a,labelWidth:u,formatter:l,labeler:c,onFilter:d}),E.path)})}))},Rs=I.memo(function(n){var r=n.page,t=n.ranges,e=n.totalPages,i=n.minimal,o=n.onPageChange,a=Be(t,3),s=a[0],u=a[1],l=a[2],c=I.useMemo(function(){return j.jsxs(I.Fragment,{children:[s==null?void 0:s.map(function(d){return j.jsx("button",{onClick:function(){return o(d)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r===d&&"bg-primary-500 text-white pointer-events-none"),children:d+1},d)}),u&&j.jsx("span",{className:"leading-none inline-block w-8 text-center text-dimmed",children:"..."}),u==null?void 0:u.map(function(d){return j.jsx("button",{onClick:function(){return o(d)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r===d&&"bg-primary-500 text-white pointer-events-none"),children:d+1},d)}),l&&j.jsx("span",{className:"leading-none inline-block w-8 text-center text-dimmed",children:"..."}),l==null?void 0:l.map(function(d){return j.jsx("button",{onClick:function(){return o(d)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r===d&&"bg-primary-500 text-white pointer-events-none"),children:d+1},d)})]})},[s,u,l,r]);return j.jsxs("div",{className:"inline-flex items-center",children:[j.jsx("button",{onClick:function(){return o(0)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r===0&&"pointer-events-none text-tint-300"),children:j.jsx(Qe,{icon:pe.chevronsLeft,rtlFlip:!0})}),j.jsx("button",{onClick:function(){return o(r-1)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r===0&&"pointer-events-none text-tint-300"),children:j.jsx(Qe,{icon:pe.chevronLeft,rtlFlip:!0})}),!i&&c,i&&j.jsxs("label",{className:"leading-none inline-block px-1 text-center text-sm select-none fixed-numbers",children:[r+1,"/",e]}),j.jsx("button",{onClick:function(){return o(r+1)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r+1>=e&&"pointer-events-none text-tint-300"),children:j.jsx(Qe,{icon:pe.chevronRight,rtlFlip:!0})}),j.jsx("button",{onClick:function(){return o(e-1)},className:de("leading-none text-sm hover:bg-primary-200 w-8 h-6 rounded-full",r+1>=e&&"pointer-events-none text-tint-300"),children:j.jsx(Qe,{icon:pe.chevronsRight,rtlFlip:!0})})]})});Rs.displayName="Pagination";vn(function(n){return n});var co=function(r){var t=r.vertical,e=t===void 0?!0:t,i=r.scrollActive,o=r.onStart,a=r.onEnd,s=r.onPrevious,u=r.onNext;return j.jsxs(Ft,{vertical:e,variant:"link",className:"outline",children:[j.jsx(ye,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll to top",icon:e?pe.chevronsUp:pe.chevronsLeft,disabled:(i&2)===0,onClick:o}),j.jsx(ye,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll up",icon:e?pe.chevronUp:pe.chevronLeft,disabled:(i&2)===0,onClick:s}),j.jsx(ye,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll down",icon:e?pe.chevronDown:pe.chevronRight,disabled:i%2===0,onClick:u}),j.jsx(ye,{rtlFlip:!0,size:"sm",variant:"link","aria-label":"scroll to bottom",icon:e?pe.chevronsDown:pe.chevronsRight,disabled:i%2===0,onClick:a})]})},Ss=["items","children","columns","fullWidth","maxWidth","minWidth","total","padding","defaultHeight","defaultWidth","hideScroller","initialScroll","loading","onLoadMore","onScroll","galleryRef"];function In(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function zn(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?In(Object(t),!0).forEach(function(e){lr(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):In(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}var xs=vn(function(n){return n}),ho=function(r){var t,e=r.items,i=r.children,o=r.columns,a=r.fullWidth,s=r.maxWidth,u=r.minWidth,l=r.total,c=l===void 0?0:l,d=r.padding,f=d===void 0?"md":d,h=r.defaultHeight,m=h===void 0?48:h,v=r.defaultWidth,b=v===void 0?48:v,x=r.hideScroller,T=r.initialScroll,E=r.loading,_=r.onLoadMore,A=r.onScroll,L=r.galleryRef,y=fn(r,Ss),C=I.useDeferredValue(e.length),S=I.useMemo(function(){return _?8:0},[_]),D=xs(e.map(function(q,W){return{index:W,item:q,isLast:W+1===e.length}})),G=I.useRef(null),O=I.useState(1),R=Be(O,2),H=R[0],$=R[1],w=I.useMemo(function(){return new Array(H).fill(0).map(function(q,W){return W})},[H]);ja(function(){if(G.current){var q=G.current,W=function(){var ne,te,ce,J=parseInt((ne=getComputedStyle((te=q.firstElementChild)===null||te===void 0?void 0:te.firstElementChild).padding)!==null&&ne!==void 0?ne:8);$(o??Math.max(1,Math.floor((((ce=q==null?void 0:q.offsetWidth)!==null&&ce!==void 0?ce:800)-32-(isNaN(J)?8:J)*2)/b)))},oe=new ResizeObserver(W);return W(),oe.observe(q),function(){oe.unobserve(q),oe.disconnect()}}},[G.current,o,b],"virtualGallery recalculate view count");var p=uo({count:Math.ceil(C/H),getScrollElement:function(){return G.current},estimateSize:function(){return m},overscan:2}),g=p.getVirtualItems(),z=I.useRef(0);I.useEffect(function(){var q,W;z.current=(q=(W=g[2])===null||W===void 0?void 0:W.index)!==null&&q!==void 0?q:0,G.current&&g[0]&&G.current.scrollTop<g[0].size&&(z.current=0)},[g]);var M=I.useCallback(function(){var q,W=(q=G.current)!==null&&q!==void 0?q:{},oe=W.scrollTop,Z=oe===void 0?0:oe,ne=W.scrollHeight,te=ne===void 0?0:ne,ce=W.offsetHeight,J=ce===void 0?0:ce;return te===J?0:Z===0?1:Z>=te-J-S*2?2:3},[]),P=I.useState(0),k=Be(P,2),F=k[0],B=k[1],Y=lo(function(q){return A==null?void 0:A(z.current*q)},[A]),ee=I.useCallback(function(){B(M()),Y(H)},[H,_]);return I.useEffect(function(){B(M())},[C,M]),I.useEffect(function(){if(_){var q,W,oe=(q=g[0])===null||q===void 0?void 0:q.index,Z=g==null||(W=g.slice(-1).pop())===null||W===void 0?void 0:W.index,ne=oe*H,te=(Z??0)*H+H,ce=oe!==void 0&&e[ne]===null,J=Z!==void 0&&te>=C-1&&C<c,X=yt(_);return ce?X(ne):!E&&J&&X(te+1),function(){return X.cancel()}}},[_,g]),I.useLayoutEffect(function(){setTimeout(function(){T&&p.scrollToIndex(Math.floor(T/H),{align:"start"})},100)},[H]),I.useImperativeHandle(L,function(){return{scrollToItem:function(W){p.scrollToIndex(Math.floor(W/H),{align:"auto"})},hilight:function(W){var oe;(oe=G.current)===null||oe===void 0||(oe=oe.querySelector(".hilight"))===null||oe===void 0||oe.classList.remove("hilight","ring-1"),p.scrollToIndex(Math.floor(W/H),{align:"auto"}),setTimeout(function(){var Z;(Z=G.current)===null||Z===void 0||(Z=Z.querySelector('[data-index="'.concat(W,'"]')))===null||Z===void 0||Z.classList.add("hilight","ring-1")},100)},unhilight:function(){var W;(W=G.current)===null||W===void 0||(W=W.querySelector(".hilight"))===null||W===void 0||W.classList.remove("hilight","ring-1")}}},[p,H]),j.jsx("div",zn(zn({ref:G,onScroll:ee,className:de("area-content bg-base overflow-auto")},y),{},{children:j.jsxs("div",{className:de("flex flex-nowrap justify-center gap-2 min-h-full"),children:[j.jsx("div",{className:de("box-content",a&&"flex-1",f==="sm"&&"p-1",f==="md"&&"p-2",f==="lg"&&"p-4"),style:{minWidth:u,maxWidth:s},children:j.jsxs("div",{style:{height:p.getTotalSize()+S},children:[j.jsx("div",{style:{height:(t=g[0])===null||t===void 0?void 0:t.start}}),g.map(function(q){var W=q.key,oe=q.index;return j.jsx("div",{className:"flex","data-index":oe,ref:p.measureElement,children:w.map(function(Z){return j.jsx("div",{"data-index":oe*H+Z,className:de("grid rounded-capped"),children:D[oe*H+Z]&&i(D[oe*H+Z])},"".concat(W,":").concat(Z))})},W)}),_&&j.jsx("div",{className:"h-16",children:E&&j.jsx(so,{})})]})}),!x&&j.jsx("div",{className:de("self-end sticky bottom-2"),children:j.jsx(co,{vertical:!0,scrollActive:F,onStart:function(){return p.scrollToIndex(0)},onPrevious:function(){return G.current&&p.scrollBy(-G.current.offsetHeight)},onNext:function(){return G.current&&p.scrollBy(G.current.offsetHeight)},onEnd:function(){return p.scrollToIndex(C-1)}})})]})}))};ho.displayName="VirtualGallery";var Cs=I.memo;Cs(ho);var As=["items","total","children","fullWidth","maxWidth","minWidth","padding","orientation","defaultHeight","defaultWidth","hideScroller","initialScroll","loading","onLoadMore","onScroll","listRef"];function Fn(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function $n(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Fn(Object(t),!0).forEach(function(e){lr(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Fn(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}var ks=vn(function(n){return n}),fo=function(r){var t,e,i=r.items,o=r.total,a=o===void 0?0:o,s=r.children,u=r.fullWidth,l=r.maxWidth,c=r.minWidth,d=r.padding,f=d===void 0?"md":d,h=r.orientation,m=h===void 0?"vertical":h,v=r.defaultHeight,b=v===void 0?48:v,x=r.defaultWidth,T=x===void 0?48:x,E=r.hideScroller,_=r.initialScroll,A=r.loading,L=r.onLoadMore,y=r.onScroll,C=r.listRef,S=fn(r,As),D=I.useDeferredValue(i.length),G=I.useMemo(function(){return L?8:0},[L]),O=ks(i.map(function(B,Y){return{index:Y,item:B,isLast:Y+1===i.length}})),R=I.useRef(null),H=uo({count:D,overscan:2,horizontal:m==="horizontal",getScrollElement:function(){return R.current},estimateSize:function(){return m==="horizontal"?T:b}}),$=H.getVirtualItems(),w=I.useRef(0);I.useEffect(function(){var B,Y;w.current=(B=(Y=$[2])===null||Y===void 0?void 0:Y.index)!==null&&B!==void 0?B:0,R.current&&$[0]&&R.current.scrollTop<$[0].size&&(w.current=0)},[$]);var p=I.useCallback(function(){var B,Y=(B=R.current)!==null&&B!==void 0?B:{},ee=Y.scrollTop,q=ee===void 0?0:ee,W=Y.scrollLeft,oe=W===void 0?0:W,Z=Y.scrollWidth,ne=Z===void 0?0:Z,te=Y.scrollHeight,ce=te===void 0?0:te,J=Y.offsetWidth,X=J===void 0?0:J,N=Y.offsetHeight,le=N===void 0?0:N;if(m==="vertical"){if(ce===le)return 0;if(q===0)return 1;if(q>=ce-le-G*2)return 2}if(m==="horizontal"){if(ne===X)return 0;if(Math.abs(oe)===0)return 1;if(Math.abs(oe)>=ne-X-G*2)return 2}return 3},[m]),g=I.useState(0),z=Be(g,2),M=z[0],P=z[1],k=lo(function(){return y==null?void 0:y(w.current)},[y]),F=I.useCallback(function(){P(p()),k()},[m,L]);return I.useEffect(function(){P(p())},[O,p]),I.useEffect(function(){if(L){var B,Y,ee=(B=$[0])===null||B===void 0?void 0:B.index,q=$==null||(Y=$.slice(-1).pop())===null||Y===void 0?void 0:Y.index,W=ee!==void 0&&i[ee]===null,oe=q!==void 0&&q===D-1&&D<a,Z=yt(L);return W?Z(ee):!A&&oe&&Z(q+1),function(){return Z.cancel()}}},[L,$]),I.useLayoutEffect(function(){setTimeout(function(){_&&H.scrollToIndex(_,{align:"start"})},100)},[]),I.useImperativeHandle(C,function(){return{scrollToItem:function(Y){H.scrollToIndex(Y,{align:"auto"})},hilight:function(Y){var ee;(ee=R.current)===null||ee===void 0||(ee=ee.querySelector(".hilight"))===null||ee===void 0||ee.classList.remove("hilight","ring-1"),H.scrollToIndex(Math.floor(Y),{align:"auto"}),setTimeout(function(){var q;(q=R.current)===null||q===void 0||(q=q.querySelector('[data-index="'.concat(Y,'"]')))===null||q===void 0||q.classList.add("hilight","ring-1")},100)},unhilight:function(){var Y;(Y=R.current)===null||Y===void 0||(Y=Y.querySelector(".hilight"))===null||Y===void 0||Y.classList.remove("hilight","ring-1")}}},[H]),j.jsx("div",$n($n({ref:R,onScroll:F,className:de("area-content bg-base overflow-auto")},S),{},{children:j.jsxs("div",{className:de("flex flex-nowrap gap-2 justify-center min-h-full min-w-full",m==="horizontal"&&"flex-col"),children:[j.jsxs("div",{className:de("box-content inline-flex flex-nowrap",m==="vertical"&&"flex-col",m==="horizontal"&&"flex-row",u&&"flex-1",f==="sm"&&"p-1",f==="md"&&"p-2",f==="lg"&&"p-4"),style:{minWidth:c,maxWidth:l},children:[j.jsxs("div",{style:m==="vertical"?{height:H.getTotalSize()+G}:{width:H.getTotalSize()+G},children:[j.jsx("div",{style:m==="vertical"?{height:(t=$[0])===null||t===void 0?void 0:t.start}:{width:(e=$[0])===null||e===void 0?void 0:e.start,display:"inline-block"}}),$.map(function(B){var Y=B.key,ee=B.index;return j.jsx("div",{"data-index":ee,ref:H.measureElement,className:de("rounded-capped",m==="horizontal"?"inline-grid":"grid"),children:s(O[ee])},Y)})]}),A&&j.jsx("div",{className:m==="horizontal"?"min-w-16":"",children:j.jsx(so,{})})]}),!E&&j.jsx("div",{className:de(m==="vertical"&&"self-end sticky bottom-2",m==="horizontal"&&"self-end sticky end-2"),children:j.jsx(co,{vertical:m==="vertical",scrollActive:M,onStart:function(){return H.scrollToIndex(0)},onPrevious:function(){return R.current&&H.scrollBy(-(m==="vertical"?R.current.offsetHeight:R.current.offsetWidth))},onNext:function(){return R.current&&H.scrollBy(m==="vertical"?R.current.offsetHeight:R.current.offsetWidth)},onEnd:function(){return H.scrollToIndex(D-1)}})})]})}))};fo.displayName="VirtualList";var Ls=I.memo;Ls(fo);var yr,Mn;function at(){return Mn||(Mn=1,yr=function(r){return r!==null&&typeof r=="object"&&typeof r.addUndirectedEdgeWithKey=="function"&&typeof r.dropNode=="function"&&typeof r.multi=="boolean"}),yr}var Ds=at();const Gs=gn(Ds);function Ps(n){if(Array.isArray(n))return n}function Ns(n,r){var t=n==null?null:typeof Symbol<"u"&&n[Symbol.iterator]||n["@@iterator"];if(t!=null){var e,i,o,a,s=[],u=!0,l=!1;try{if(o=(t=t.call(n)).next,r===0){if(Object(t)!==t)return;u=!1}else for(;!(u=(e=o.call(t)).done)&&(s.push(e.value),s.length!==r);u=!0);}catch(c){l=!0,i=c}finally{try{if(!u&&t.return!=null&&(a=t.return(),Object(a)!==a))return}finally{if(l)throw i}}return s}}function Jr(n,r){(r==null||r>n.length)&&(r=n.length);for(var t=0,e=Array(r);t<r;t++)e[t]=n[t];return e}function go(n,r){if(n){if(typeof n=="string")return Jr(n,r);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?Jr(n,r):void 0}}function Os(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function bt(n,r){return Ps(n)||Ns(n,r)||go(n,r)||Os()}var br={black:"#000000",silver:"#C0C0C0",gray:"#808080",grey:"#808080",white:"#FFFFFF",maroon:"#800000",red:"#FF0000",purple:"#800080",fuchsia:"#FF00FF",green:"#008000",lime:"#00FF00",olive:"#808000",yellow:"#FFFF00",navy:"#000080",blue:"#0000FF",teal:"#008080",aqua:"#00FFFF",darkblue:"#00008B",mediumblue:"#0000CD",darkgreen:"#006400",darkcyan:"#008B8B",deepskyblue:"#00BFFF",darkturquoise:"#00CED1",mediumspringgreen:"#00FA9A",springgreen:"#00FF7F",cyan:"#00FFFF",midnightblue:"#191970",dodgerblue:"#1E90FF",lightseagreen:"#20B2AA",forestgreen:"#228B22",seagreen:"#2E8B57",darkslategray:"#2F4F4F",darkslategrey:"#2F4F4F",limegreen:"#32CD32",mediumseagreen:"#3CB371",turquoise:"#40E0D0",royalblue:"#4169E1",steelblue:"#4682B4",darkslateblue:"#483D8B",mediumturquoise:"#48D1CC",indigo:"#4B0082",darkolivegreen:"#556B2F",cadetblue:"#5F9EA0",cornflowerblue:"#6495ED",rebeccapurple:"#663399",mediumaquamarine:"#66CDAA",dimgray:"#696969",dimgrey:"#696969",slateblue:"#6A5ACD",olivedrab:"#6B8E23",slategray:"#708090",slategrey:"#708090",lightslategray:"#778899",lightslategrey:"#778899",mediumslateblue:"#7B68EE",lawngreen:"#7CFC00",chartreuse:"#7FFF00",aquamarine:"#7FFFD4",skyblue:"#87CEEB",lightskyblue:"#87CEFA",blueviolet:"#8A2BE2",darkred:"#8B0000",darkmagenta:"#8B008B",saddlebrown:"#8B4513",darkseagreen:"#8FBC8F",lightgreen:"#90EE90",mediumpurple:"#9370DB",darkviolet:"#9400D3",palegreen:"#98FB98",darkorchid:"#9932CC",yellowgreen:"#9ACD32",sienna:"#A0522D",brown:"#A52A2A",darkgray:"#A9A9A9",darkgrey:"#A9A9A9",lightblue:"#ADD8E6",greenyellow:"#ADFF2F",paleturquoise:"#AFEEEE",lightsteelblue:"#B0C4DE",powderblue:"#B0E0E6",firebrick:"#B22222",darkgoldenrod:"#B8860B",mediumorchid:"#BA55D3",rosybrown:"#BC8F8F",darkkhaki:"#BDB76B",mediumvioletred:"#C71585",indianred:"#CD5C5C",peru:"#CD853F",chocolate:"#D2691E",tan:"#D2B48C",lightgray:"#D3D3D3",lightgrey:"#D3D3D3",thistle:"#D8BFD8",orchid:"#DA70D6",goldenrod:"#DAA520",palevioletred:"#DB7093",crimson:"#DC143C",gainsboro:"#DCDCDC",plum:"#DDA0DD",burlywood:"#DEB887",lightcyan:"#E0FFFF",lavender:"#E6E6FA",darksalmon:"#E9967A",violet:"#EE82EE",palegoldenrod:"#EEE8AA",lightcoral:"#F08080",khaki:"#F0E68C",aliceblue:"#F0F8FF",honeydew:"#F0FFF0",azure:"#F0FFFF",sandybrown:"#F4A460",wheat:"#F5DEB3",beige:"#F5F5DC",whitesmoke:"#F5F5F5",mintcream:"#F5FFFA",ghostwhite:"#F8F8FF",salmon:"#FA8072",antiquewhite:"#FAEBD7",linen:"#FAF0E6",lightgoldenrodyellow:"#FAFAD2",oldlace:"#FDF5E6",magenta:"#FF00FF",deeppink:"#FF1493",orangered:"#FF4500",tomato:"#FF6347",hotpink:"#FF69B4",coral:"#FF7F50",darkorange:"#FF8C00",lightsalmon:"#FFA07A",orange:"#FFA500",lightpink:"#FFB6C1",pink:"#FFC0CB",gold:"#FFD700",peachpuff:"#FFDAB9",navajowhite:"#FFDEAD",moccasin:"#FFE4B5",bisque:"#FFE4C4",mistyrose:"#FFE4E1",blanchedalmond:"#FFEBCD",papayawhip:"#FFEFD5",lavenderblush:"#FFF0F5",seashell:"#FFF5EE",cornsilk:"#FFF8DC",lemonchiffon:"#FFFACD",floralwhite:"#FFFAF0",snow:"#FFFAFA",lightyellow:"#FFFFE0",ivory:"#FFFFF0"},vo=new Int8Array(4),_r=new Int32Array(vo.buffer,0,1),Is=new Float32Array(vo.buffer,0,1),zs=/^\s*rgba?\s*\(/,Fs=/^\s*rgba?\s*\(\s*([0-9]*)\s*,\s*([0-9]*)\s*,\s*([0-9]*)(?:\s*,\s*(.*)?)?\)\s*$/;function $s(n){var r=0,t=0,e=0,i=1;if(n[0]==="#")n.length===4?(r=parseInt(n.charAt(1)+n.charAt(1),16),t=parseInt(n.charAt(2)+n.charAt(2),16),e=parseInt(n.charAt(3)+n.charAt(3),16)):(r=parseInt(n.charAt(1)+n.charAt(2),16),t=parseInt(n.charAt(3)+n.charAt(4),16),e=parseInt(n.charAt(5)+n.charAt(6),16)),n.length===9&&(i=parseInt(n.charAt(7)+n.charAt(8),16)/255);else if(zs.test(n)){var o=n.match(Fs);o&&(r=+o[1],t=+o[2],e=+o[3],o[4]&&(i=+o[4]))}return{r,g:t,b:e,a:i}}var mt={};for(var Yt in br)mt[Yt]=ge(br[Yt]),mt[br[Yt]]=mt[Yt];function po(n,r,t,e,i){return _r[0]=e<<24|t<<16|r<<8|n,_r[0]=_r[0]&4278190079,Is[0]}function ge(n){if(n=n.toLowerCase(),typeof mt[n]<"u")return mt[n];var r=$s(n),t=r.r,e=r.g,i=r.b,o=r.a;o=o*255|0;var a=po(t,e,i,o);return mt[n]=a,a}var wr={};function mo(n){if(typeof wr[n]<"u")return wr[n];var r=(n&16711680)>>>16,t=(n&65280)>>>8,e=n&255,i=255,o=po(r,t,e,i);return wr[n]=o,o}function Un(n,r,t,e){return t+(r<<8)+(n<<16)}function jn(n,r,t,e,i,o){var a=Math.floor(t/o*i),s=Math.floor(n.drawingBufferHeight/o-e/o*i),u=new Uint8Array(4);n.bindFramebuffer(n.FRAMEBUFFER,r),n.readPixels(a,s,1,1,n.RGBA,n.UNSIGNED_BYTE,u);var l=bt(u,4),c=l[0],d=l[1],f=l[2],h=l[3];return[c,d,f,h]}var Ms=function(r){return r},Us=function(r){return r*r},js=function(r){return r*(2-r)},Hs=function(r){return(r*=2)<1?.5*r*r:-.5*(--r*(r-2)-1)},Ws=function(r){return r*r*r},Bs=function(r){return--r*r*r+1},Vs=function(r){return(r*=2)<1?.5*r*r*r:.5*((r-=2)*r*r+2)},yo={linear:Ms,quadraticIn:Us,quadraticOut:js,quadraticInOut:Hs,cubicIn:Ws,cubicOut:Bs,cubicInOut:Vs},bo={easing:"quadraticInOut",duration:150};function Hn(n,r,t,e){var i=Object.assign({},bo,t),o=typeof i.easing=="function"?i.easing:yo[i.easing],a=Date.now(),s={};for(var u in r){var l=r[u];s[u]={};for(var c in l)s[u][c]=n.getNodeAttribute(u,c)}var d=null,f=function(){d=null;var m=(Date.now()-a)/i.duration;if(m>=1){for(var v in r){var b=r[v];for(var x in b)n.setNodeAttribute(v,x,b[x])}typeof e=="function"&&e();return}m=o(m);for(var T in r){var E=r[T],_=s[T];for(var A in E)n.setNodeAttribute(T,A,E[A]*m+_[A]*(1-m))}d=requestAnimationFrame(f)};return f(),function(){d&&cancelAnimationFrame(d)}}function Ne(){return Float32Array.of(1,0,0,0,1,0,0,0,1)}function Kt(n,r,t){return n[0]=r,n[4]=typeof t=="number"?t:r,n}function Wn(n,r){var t=Math.sin(r),e=Math.cos(r);return n[0]=e,n[1]=t,n[3]=-t,n[4]=e,n}function Bn(n,r,t){return n[6]=r,n[7]=t,n}function Ye(n,r){var t=n[0],e=n[1],i=n[2],o=n[3],a=n[4],s=n[5],u=n[6],l=n[7],c=n[8],d=r[0],f=r[1],h=r[2],m=r[3],v=r[4],b=r[5],x=r[6],T=r[7],E=r[8];return n[0]=d*t+f*o+h*u,n[1]=d*e+f*a+h*l,n[2]=d*i+f*s+h*c,n[3]=m*t+v*o+b*u,n[4]=m*e+v*a+b*l,n[5]=m*i+v*s+b*c,n[6]=x*t+T*o+E*u,n[7]=x*e+T*a+E*l,n[8]=x*i+T*s+E*c,n}function Qr(n,r){var t=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1,e=n[0],i=n[1],o=n[3],a=n[4],s=n[6],u=n[7],l=r.x,c=r.y;return{x:l*e+c*o+s*t,y:l*i+c*a+u*t}}function _o(n,r){var t=n.height/n.width,e=r.height/r.width;return t<1&&e>1||t>1&&e<1?1:Math.min(Math.max(e,1/e),Math.max(1/t,t))}function Ct(n,r,t,e,i){var o=n.angle,a=n.ratio,s=n.x,u=n.y,l=r.width,c=r.height,d=Ne(),f=Math.min(l,c)-2*e,h=_o(r,t);return i?(Ye(d,Bn(Ne(),s,u)),Ye(d,Kt(Ne(),a)),Ye(d,Wn(Ne(),o)),Ye(d,Kt(Ne(),l/f/2/h,c/f/2/h))):(Ye(d,Kt(Ne(),2*(f/l)*h,2*(f/c)*h)),Ye(d,Wn(Ne(),-o)),Ye(d,Kt(Ne(),1/a)),Ye(d,Bn(Ne(),-s,-u))),d}function qs(n,r,t){var e=Qr(n,{x:Math.cos(r.angle),y:Math.sin(r.angle)},0),i=e.x,o=e.y;return 1/Math.sqrt(Math.pow(i,2)+Math.pow(o,2))/t.width}function Xs(n){if(!n.order)return{x:[0,1],y:[0,1]};var r=1/0,t=-1/0,e=1/0,i=-1/0;return n.forEachNode(function(o,a){var s=a.x,u=a.y;s<r&&(r=s),s>t&&(t=s),u<e&&(e=u),u>i&&(i=u)}),{x:[r,t],y:[e,i]}}function Ys(n){if(!Gs(n))throw new Error("Sigma: invalid graph instance.");n.forEachNode(function(r,t){if(!Number.isFinite(t.x)||!Number.isFinite(t.y))throw new Error("Sigma: Coordinates of node ".concat(r," are invalid. A node must have a numeric 'x' and 'y' attribute."))})}function Ks(n,r,t){var e=document.createElement(n);if(r)for(var i in r)e.style[i]=r[i];if(t)for(var o in t)e.setAttribute(o,t[o]);return e}function Vn(){return typeof window.devicePixelRatio<"u"?window.devicePixelRatio:1}function qn(n,r,t){return t.sort(function(e,i){var o=r(e)||0,a=r(i)||0;return o<a?-1:o>a?1:0})}function Xn(n){var r=bt(n.x,2),t=r[0],e=r[1],i=bt(n.y,2),o=i[0],a=i[1],s=Math.max(e-t,a-o),u=(e+t)/2,l=(a+o)/2;(s===0||Math.abs(s)===1/0||isNaN(s))&&(s=1),isNaN(u)&&(u=0),isNaN(l)&&(l=0);var c=function(f){return{x:.5+(f.x-u)/s,y:.5+(f.y-l)/s}};return c.applyTo=function(d){d.x=.5+(d.x-u)/s,d.y=.5+(d.y-l)/s},c.inverse=function(d){return{x:u+s*(d.x-.5),y:l+s*(d.y-.5)}},c.ratio=s,c}function en(n){"@babel/helpers - typeof";return en=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(r){return typeof r}:function(r){return r&&typeof Symbol=="function"&&r.constructor===Symbol&&r!==Symbol.prototype?"symbol":typeof r},en(n)}function Yn(n,r){var t=r.size;if(t!==0){var e=n.length;n.length+=t;var i=0;r.forEach(function(o){n[e+i]=o,i++})}}function Er(n){n=n||{};for(var r=0,t=arguments.length<=1?0:arguments.length-1;r<t;r++){var e=r+1<1||arguments.length<=r+1?void 0:arguments[r+1];e&&Object.assign(n,e)}return n}function tn(){tn=function(){return r};var n,r={},t=Object.prototype,e=t.hasOwnProperty,i=Object.defineProperty||function(w,p,g){w[p]=g.value},o=typeof Symbol=="function"?Symbol:{},a=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",u=o.toStringTag||"@@toStringTag";function l(w,p,g){return Object.defineProperty(w,p,{value:g,enumerable:!0,configurable:!0,writable:!0}),w[p]}try{l({},"")}catch{l=function(p,g,z){return p[g]=z}}function c(w,p,g,z){var M=p&&p.prototype instanceof x?p:x,P=Object.create(M.prototype),k=new H(z||[]);return i(P,"_invoke",{value:D(w,g,k)}),P}function d(w,p,g){try{return{type:"normal",arg:w.call(p,g)}}catch(z){return{type:"throw",arg:z}}}r.wrap=c;var f="suspendedStart",h="suspendedYield",m="executing",v="completed",b={};function x(){}function T(){}function E(){}var _={};l(_,a,function(){return this});var A=Object.getPrototypeOf,L=A&&A(A($([])));L&&L!==t&&e.call(L,a)&&(_=L);var y=E.prototype=x.prototype=Object.create(_);function C(w){["next","throw","return"].forEach(function(p){l(w,p,function(g){return this._invoke(p,g)})})}function S(w,p){function g(M,P,k,F){var B=d(w[M],w,P);if(B.type!=="throw"){var Y=B.arg,ee=Y.value;return ee&&typeof ee=="object"&&e.call(ee,"__await")?p.resolve(ee.__await).then(function(q){g("next",q,k,F)},function(q){g("throw",q,k,F)}):p.resolve(ee).then(function(q){Y.value=q,k(Y)},function(q){return g("throw",q,k,F)})}F(B.arg)}var z;i(this,"_invoke",{value:function(M,P){function k(){return new p(function(F,B){g(M,P,F,B)})}return z=z?z.then(k,k):k()}})}function D(w,p,g){var z=f;return function(M,P){if(z===m)throw Error("Generator is already running");if(z===v){if(M==="throw")throw P;return{value:n,done:!0}}for(g.method=M,g.arg=P;;){var k=g.delegate;if(k){var F=G(k,g);if(F){if(F===b)continue;return F}}if(g.method==="next")g.sent=g._sent=g.arg;else if(g.method==="throw"){if(z===f)throw z=v,g.arg;g.dispatchException(g.arg)}else g.method==="return"&&g.abrupt("return",g.arg);z=m;var B=d(w,p,g);if(B.type==="normal"){if(z=g.done?v:h,B.arg===b)continue;return{value:B.arg,done:g.done}}B.type==="throw"&&(z=v,g.method="throw",g.arg=B.arg)}}}function G(w,p){var g=p.method,z=w.iterator[g];if(z===n)return p.delegate=null,g==="throw"&&w.iterator.return&&(p.method="return",p.arg=n,G(w,p),p.method==="throw")||g!=="return"&&(p.method="throw",p.arg=new TypeError("The iterator does not provide a '"+g+"' method")),b;var M=d(z,w.iterator,p.arg);if(M.type==="throw")return p.method="throw",p.arg=M.arg,p.delegate=null,b;var P=M.arg;return P?P.done?(p[w.resultName]=P.value,p.next=w.nextLoc,p.method!=="return"&&(p.method="next",p.arg=n),p.delegate=null,b):P:(p.method="throw",p.arg=new TypeError("iterator result is not an object"),p.delegate=null,b)}function O(w){var p={tryLoc:w[0]};1 in w&&(p.catchLoc=w[1]),2 in w&&(p.finallyLoc=w[2],p.afterLoc=w[3]),this.tryEntries.push(p)}function R(w){var p=w.completion||{};p.type="normal",delete p.arg,w.completion=p}function H(w){this.tryEntries=[{tryLoc:"root"}],w.forEach(O,this),this.reset(!0)}function $(w){if(w||w===""){var p=w[a];if(p)return p.call(w);if(typeof w.next=="function")return w;if(!isNaN(w.length)){var g=-1,z=function M(){for(;++g<w.length;)if(e.call(w,g))return M.value=w[g],M.done=!1,M;return M.value=n,M.done=!0,M};return z.next=z}}throw new TypeError(typeof w+" is not iterable")}return T.prototype=E,i(y,"constructor",{value:E,configurable:!0}),i(E,"constructor",{value:T,configurable:!0}),T.displayName=l(E,u,"GeneratorFunction"),r.isGeneratorFunction=function(w){var p=typeof w=="function"&&w.constructor;return!!p&&(p===T||(p.displayName||p.name)==="GeneratorFunction")},r.mark=function(w){return Object.setPrototypeOf?Object.setPrototypeOf(w,E):(w.__proto__=E,l(w,u,"GeneratorFunction")),w.prototype=Object.create(y),w},r.awrap=function(w){return{__await:w}},C(S.prototype),l(S.prototype,s,function(){return this}),r.AsyncIterator=S,r.async=function(w,p,g,z,M){M===void 0&&(M=Promise);var P=new S(c(w,p,g,z),M);return r.isGeneratorFunction(p)?P:P.next().then(function(k){return k.done?k.value:P.next()})},C(y),l(y,u,"Generator"),l(y,a,function(){return this}),l(y,"toString",function(){return"[object Generator]"}),r.keys=function(w){var p=Object(w),g=[];for(var z in p)g.push(z);return g.reverse(),function M(){for(;g.length;){var P=g.pop();if(P in p)return M.value=P,M.done=!1,M}return M.done=!0,M}},r.values=$,H.prototype={constructor:H,reset:function(w){if(this.prev=0,this.next=0,this.sent=this._sent=n,this.done=!1,this.delegate=null,this.method="next",this.arg=n,this.tryEntries.forEach(R),!w)for(var p in this)p.charAt(0)==="t"&&e.call(this,p)&&!isNaN(+p.slice(1))&&(this[p]=n)},stop:function(){this.done=!0;var w=this.tryEntries[0].completion;if(w.type==="throw")throw w.arg;return this.rval},dispatchException:function(w){if(this.done)throw w;var p=this;function g(B,Y){return P.type="throw",P.arg=w,p.next=B,Y&&(p.method="next",p.arg=n),!!Y}for(var z=this.tryEntries.length-1;z>=0;--z){var M=this.tryEntries[z],P=M.completion;if(M.tryLoc==="root")return g("end");if(M.tryLoc<=this.prev){var k=e.call(M,"catchLoc"),F=e.call(M,"finallyLoc");if(k&&F){if(this.prev<M.catchLoc)return g(M.catchLoc,!0);if(this.prev<M.finallyLoc)return g(M.finallyLoc)}else if(k){if(this.prev<M.catchLoc)return g(M.catchLoc,!0)}else{if(!F)throw Error("try statement without catch or finally");if(this.prev<M.finallyLoc)return g(M.finallyLoc)}}}},abrupt:function(w,p){for(var g=this.tryEntries.length-1;g>=0;--g){var z=this.tryEntries[g];if(z.tryLoc<=this.prev&&e.call(z,"finallyLoc")&&this.prev<z.finallyLoc){var M=z;break}}M&&(w==="break"||w==="continue")&&M.tryLoc<=p&&p<=M.finallyLoc&&(M=null);var P=M?M.completion:{};return P.type=w,P.arg=p,M?(this.method="next",this.next=M.finallyLoc,b):this.complete(P)},complete:function(w,p){if(w.type==="throw")throw w.arg;return w.type==="break"||w.type==="continue"?this.next=w.arg:w.type==="return"?(this.rval=this.arg=w.arg,this.method="return",this.next="end"):w.type==="normal"&&p&&(this.next=p),b},finish:function(w){for(var p=this.tryEntries.length-1;p>=0;--p){var g=this.tryEntries[p];if(g.finallyLoc===w)return this.complete(g.completion,g.afterLoc),R(g),b}},catch:function(w){for(var p=this.tryEntries.length-1;p>=0;--p){var g=this.tryEntries[p];if(g.tryLoc===w){var z=g.completion;if(z.type==="throw"){var M=z.arg;R(g)}return M}}throw Error("illegal catch attempt")},delegateYield:function(w,p,g){return this.delegate={iterator:$(w),resultName:p,nextLoc:g},this.method==="next"&&(this.arg=n),b}},r}function Kn(n,r,t,e,i,o,a){try{var s=n[o](a),u=s.value}catch(l){return void t(l)}s.done?r(u):Promise.resolve(u).then(e,i)}function Zs(n){return function(){var r=this,t=arguments;return new Promise(function(e,i){var o=n.apply(r,t);function a(u){Kn(o,e,i,a,s,"next",u)}function s(u){Kn(o,e,i,a,s,"throw",u)}a(void 0)})}}function Js(n,r){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var e=t.call(n,r);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}function Qs(n){var r=Js(n,"string");return typeof r=="symbol"?r:r+""}function eu(n,r,t){return(r=Qs(r))in n?Object.defineProperty(n,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[r]=t,n}function Zn(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function or(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?Zn(Object(t),!0).forEach(function(e){eu(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):Zn(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}var tu={animate:!0};function ru(n,r){if(!r.length)throw new Error("getCameraStateToFitViewportToNodes: There should be at least one node.");var t=1/0,e=-1/0,i=1/0,o=-1/0,a=1/0,s=-1/0,u=1/0,l=-1/0,c=n.getGraph();r.forEach(function(D){var G=n.getNodeDisplayData(D);if(!G)throw new Error("getCameraStateToFitViewportToNodes: Node ".concat(D," not found in sigma's graph."));var O=c.getNodeAttributes(D),R=O.x,H=O.y,$=G.x,w=G.y;t=Math.min(t,R),e=Math.max(e,R),i=Math.min(i,H),o=Math.max(o,H),a=Math.min(a,$),s=Math.max(s,$),u=Math.min(u,w),l=Math.max(l,w)});var d=n.getCustomBBox()||n.getBBox(),f=d.x,h=d.y,m=f[1]-f[0]||1,v=h[1]-h[0]||1,b=(a+s)/2,x=(u+l)/2,T=e-t||m,E=o-i||v,_=n.getDimensions(),A=_.width,L=_.height,y=_o({width:A,height:L},{width:m,height:v}),C=(E/T<L/A?T:E)/Math.max(m,v)*y,S=n.getCamera();return or(or({},S.getState()),{},{angle:0,x:b,y:x,ratio:C})}function Jn(n,r){return rn.apply(this,arguments)}function rn(){return rn=Zs(tn().mark(function n(r,t){var e,i,o,a,s,u=arguments;return tn().wrap(function(c){for(;;)switch(c.prev=c.next){case 0:if(e=u.length>2&&u[2]!==void 0?u[2]:{},i=or(or({},tu),e),o=i.animate,a=r.getCamera(),s=ru(r,t),!o){c.next=9;break}return c.next=7,a.animate(s);case 7:c.next=10;break;case 9:a.setState(s);case 10:case"end":return c.stop()}},n)})),rn.apply(this,arguments)}const nu=n=>{const r=I.useRef(!1),t=I.useRef([]),e=I.useRef(void 0),i=I.useRef(null),[o,a]=I.useState(!1),s=I.useRef(!1);I.useEffect(()=>{s.current=o},[o]);const u=b=>{if(r.current=!0,e.current){i.current=e.current.getContext("2d"),i.current&&(i.current.setLineDash([2,4]),i.current.lineWidth=2,i.current.strokeStyle="#3a766c40",i.current.fillStyle="#3a766c10",i.current.lineJoin="round",i.current.lineCap="round");const x=e.current.getBoundingClientRect();t.current=[{x:b.clientX-x.left,y:b.clientY-x.top}]}b.stopImmediatePropagation(),b.stopPropagation(),b.preventDefault()},l=b=>{if(r&&e.current){const x=e.current.getBoundingClientRect();if(i.current){if(s.current==="rectangle"){i.current.clearRect(0,0,e.current.width,e.current.height);const{x:T,y:E}=t.current[0];i.current.beginPath(),i.current.rect(Math.min(T,b.clientX),Math.min(E,b.clientY),Math.abs(b.clientX-x.left-T),Math.abs(b.clientY-x.top-E)),i.current.stroke(),i.current.fill()}if(s.current==="lasso"){t.current.push({x:b.clientX-x.left,y:b.clientY-x.top}),i.current.clearRect(0,0,i.current.canvas.width,i.current.canvas.height);let T=t.current[0],E=t.current[1];const _=t.current.length,A=function(L,y){return{x:L.x+(y.x-L.x)/2,y:L.y+(y.y-L.y)/2}};i.current.beginPath(),i.current.moveTo(T.x,T.y);for(let L=1;L<_;L++){const y=A(T,E);i.current.quadraticCurveTo(T.x,T.y,y.x,y.y),T=t.current[L],E=t.current[L+1]}i.current.lineTo(T.x,T.y),i.current.stroke(),i.current.fill()}}}},c=b=>{if(!n||!r)return;Array.from(n.getGraph().nodes()).forEach(T=>{var C,S;if(!n)return;const{x:E=0,y:_=0,hidden:A}=n.getNodeDisplayData(T),{x:L,y}=n.framedGraphToViewport({x:E,y:_});b.shiftKey?(C=i.current)!=null&&C.isPointInPath(L,y)&&!A&&n.getGraph().setNodeAttribute(T,"selected",!0):!A&&n.getGraph().setNodeAttribute(T,"selected",(S=i.current)==null?void 0:S.isPointInPath(L,y))}),f()},d=()=>{if(!n)return;e.current=document.createElement("canvas");const b=n.getContainer().getBoundingClientRect();e.current.width=b.width,e.current.height=b.height,e.current.style.setProperty("inset","0"),e.current.style.setProperty("position","absolute"),n.getContainer().appendChild(e.current),e.current.style.cursor="crosshair",e.current.addEventListener("mousedown",u,{capture:!0}),document.addEventListener("mousemove",l),document.addEventListener("mouseup",c)},f=()=>{var b;i.current&&(i.current.clearRect(0,0,i.current.canvas.width,i.current.canvas.height),i.current=null),e.current&&((b=e.current)==null||b.remove()),document.removeEventListener("mousemove",l),document.removeEventListener("mouseup",c),r.current=!1,a(!1)};return{selectionMode:o,startRectangleSelection:()=>{a("rectangle"),d()},startLassoSelection:()=>{a("lasso"),d()},cancelSelection:()=>{f()}}};function iu(n,r){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var e=t.call(n,r);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(n)}function $t(n){var r=iu(n,"string");return typeof r=="symbol"?r:r+""}function _e(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function Qn(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,$t(e.key),e)}}function we(n,r,t){return r&&Qn(n.prototype,r),t&&Qn(n,t),Object.defineProperty(n,"prototype",{writable:!1}),n}function _t(n){return _t=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},_t(n)}function wo(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(wo=function(){return!!n})()}function ou(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function au(n,r){if(r&&(typeof r=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ou(n)}function Le(n,r,t){return r=_t(r),au(n,wo()?Reflect.construct(r,t||[],_t(n).constructor):r.apply(n,t))}function nn(n,r){return nn=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},nn(n,r)}function De(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&nn(n,r)}function V(n,r,t){return(r=$t(r))in n?Object.defineProperty(n,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[r]=t,n}function ei(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function re(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?ei(Object(t),!0).forEach(function(e){V(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):ei(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function su(n,r){for(;!{}.hasOwnProperty.call(n,r)&&(n=_t(n))!==null;);return n}function on(){return on=typeof Reflect<"u"&&Reflect.get?Reflect.get.bind():function(n,r,t){var e=su(n,r);if(e){var i=Object.getOwnPropertyDescriptor(e,r);return i.get?i.get.call(arguments.length<3?n:t):i.value}},on.apply(null,arguments)}function Eo(n,r,t,e){var i=on(_t(n.prototype),r,t);return typeof i=="function"?function(o){return i.apply(t,o)}:i}function uu(n){return n.normalized?1:n.size}function Tr(n){var r=0;return n.forEach(function(t){return r+=uu(t)}),r}function To(n,r,t){var e=n==="VERTEX"?r.VERTEX_SHADER:r.FRAGMENT_SHADER,i=r.createShader(e);if(i===null)throw new Error("loadShader: error while creating the shader");r.shaderSource(i,t),r.compileShader(i);var o=r.getShaderParameter(i,r.COMPILE_STATUS);if(!o){var a=r.getShaderInfoLog(i);throw r.deleteShader(i),new Error(`loadShader: error while compiling the shader:
`.concat(a,`
`).concat(t))}return i}function lu(n,r){return To("VERTEX",n,r)}function cu(n,r){return To("FRAGMENT",n,r)}function du(n,r){var t=n.createProgram();if(t===null)throw new Error("loadProgram: error while creating the program.");var e,i;for(e=0,i=r.length;e<i;e++)n.attachShader(t,r[e]);n.linkProgram(t);var o=n.getProgramParameter(t,n.LINK_STATUS);if(!o)throw n.deleteProgram(t),new Error("loadProgram: error while linking the program.");return t}function ti(n){var r=n.gl,t=n.buffer,e=n.program,i=n.vertexShader,o=n.fragmentShader;r.deleteShader(i),r.deleteShader(o),r.deleteProgram(e),r.deleteBuffer(t)}var ri=`#define PICKING_MODE
`,hu=V(V(V(V(V(V(V(V({},WebGL2RenderingContext.BOOL,1),WebGL2RenderingContext.BYTE,1),WebGL2RenderingContext.UNSIGNED_BYTE,1),WebGL2RenderingContext.SHORT,2),WebGL2RenderingContext.UNSIGNED_SHORT,2),WebGL2RenderingContext.INT,4),WebGL2RenderingContext.UNSIGNED_INT,4),WebGL2RenderingContext.FLOAT,4),Ro=function(){function n(r,t,e){_e(this,n),V(this,"array",new Float32Array),V(this,"constantArray",new Float32Array),V(this,"capacity",0),V(this,"verticesCount",0);var i=this.getDefinition();if(this.VERTICES=i.VERTICES,this.VERTEX_SHADER_SOURCE=i.VERTEX_SHADER_SOURCE,this.FRAGMENT_SHADER_SOURCE=i.FRAGMENT_SHADER_SOURCE,this.UNIFORMS=i.UNIFORMS,this.ATTRIBUTES=i.ATTRIBUTES,this.METHOD=i.METHOD,this.CONSTANT_ATTRIBUTES="CONSTANT_ATTRIBUTES"in i?i.CONSTANT_ATTRIBUTES:[],this.CONSTANT_DATA="CONSTANT_DATA"in i?i.CONSTANT_DATA:[],this.isInstanced="CONSTANT_ATTRIBUTES"in i,this.ATTRIBUTES_ITEMS_COUNT=Tr(this.ATTRIBUTES),this.STRIDE=this.VERTICES*this.ATTRIBUTES_ITEMS_COUNT,this.renderer=e,this.normalProgram=this.getProgramInfo("normal",r,i.VERTEX_SHADER_SOURCE,i.FRAGMENT_SHADER_SOURCE,null),this.pickProgram=t?this.getProgramInfo("pick",r,ri+i.VERTEX_SHADER_SOURCE,ri+i.FRAGMENT_SHADER_SOURCE,t):null,this.isInstanced){var o=Tr(this.CONSTANT_ATTRIBUTES);if(this.CONSTANT_DATA.length!==this.VERTICES)throw new Error("Program: error while getting constant data (expected ".concat(this.VERTICES," items, received ").concat(this.CONSTANT_DATA.length," instead)"));this.constantArray=new Float32Array(this.CONSTANT_DATA.length*o);for(var a=0;a<this.CONSTANT_DATA.length;a++){var s=this.CONSTANT_DATA[a];if(s.length!==o)throw new Error("Program: error while getting constant data (one vector has ".concat(s.length," items instead of ").concat(o,")"));for(var u=0;u<s.length;u++)this.constantArray[a*o+u]=s[u]}this.STRIDE=this.ATTRIBUTES_ITEMS_COUNT}}return we(n,[{key:"kill",value:function(){ti(this.normalProgram),this.pickProgram&&(ti(this.pickProgram),this.pickProgram=null)}},{key:"getProgramInfo",value:function(t,e,i,o,a){var s=this.getDefinition(),u=e.createBuffer();if(u===null)throw new Error("Program: error while creating the WebGL buffer.");var l=lu(e,i),c=cu(e,o),d=du(e,[l,c]),f={};s.UNIFORMS.forEach(function(v){var b=e.getUniformLocation(d,v);b&&(f[v]=b)});var h={};s.ATTRIBUTES.forEach(function(v){h[v.name]=e.getAttribLocation(d,v.name)});var m;if("CONSTANT_ATTRIBUTES"in s&&(s.CONSTANT_ATTRIBUTES.forEach(function(v){h[v.name]=e.getAttribLocation(d,v.name)}),m=e.createBuffer(),m===null))throw new Error("Program: error while creating the WebGL constant buffer.");return{name:t,program:d,gl:e,frameBuffer:a,buffer:u,constantBuffer:m||{},uniformLocations:f,attributeLocations:h,isPicking:t==="pick",vertexShader:l,fragmentShader:c}}},{key:"bindProgram",value:function(t){var e=this,i=0,o=t.gl,a=t.buffer;this.isInstanced?(o.bindBuffer(o.ARRAY_BUFFER,t.constantBuffer),i=0,this.CONSTANT_ATTRIBUTES.forEach(function(s){return i+=e.bindAttribute(s,t,i,!1)}),o.bufferData(o.ARRAY_BUFFER,this.constantArray,o.STATIC_DRAW),o.bindBuffer(o.ARRAY_BUFFER,t.buffer),i=0,this.ATTRIBUTES.forEach(function(s){return i+=e.bindAttribute(s,t,i,!0)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)):(o.bindBuffer(o.ARRAY_BUFFER,a),i=0,this.ATTRIBUTES.forEach(function(s){return i+=e.bindAttribute(s,t,i)}),o.bufferData(o.ARRAY_BUFFER,this.array,o.DYNAMIC_DRAW)),o.bindBuffer(o.ARRAY_BUFFER,null)}},{key:"unbindProgram",value:function(t){var e=this;this.isInstanced?(this.CONSTANT_ATTRIBUTES.forEach(function(i){return e.unbindAttribute(i,t,!1)}),this.ATTRIBUTES.forEach(function(i){return e.unbindAttribute(i,t,!0)})):this.ATTRIBUTES.forEach(function(i){return e.unbindAttribute(i,t)})}},{key:"bindAttribute",value:function(t,e,i,o){var a=hu[t.type];if(typeof a!="number")throw new Error('Program.bind: yet unsupported attribute type "'.concat(t.type,'"'));var s=e.attributeLocations[t.name],u=e.gl;if(s!==-1){u.enableVertexAttribArray(s);var l=this.isInstanced?(o?this.ATTRIBUTES_ITEMS_COUNT:Tr(this.CONSTANT_ATTRIBUTES))*Float32Array.BYTES_PER_ELEMENT:this.ATTRIBUTES_ITEMS_COUNT*Float32Array.BYTES_PER_ELEMENT;if(u.vertexAttribPointer(s,t.size,t.type,t.normalized||!1,l,i),this.isInstanced&&o)if(u instanceof WebGL2RenderingContext)u.vertexAttribDivisor(s,1);else{var c=u.getExtension("ANGLE_instanced_arrays");c&&c.vertexAttribDivisorANGLE(s,1)}}return t.size*a}},{key:"unbindAttribute",value:function(t,e,i){var o=e.attributeLocations[t.name],a=e.gl;if(o!==-1&&(a.disableVertexAttribArray(o),this.isInstanced&&i))if(a instanceof WebGL2RenderingContext)a.vertexAttribDivisor(o,0);else{var s=a.getExtension("ANGLE_instanced_arrays");s&&s.vertexAttribDivisorANGLE(o,0)}}},{key:"reallocate",value:function(t){t!==this.capacity&&(this.capacity=t,this.verticesCount=this.VERTICES*t,this.array=new Float32Array(this.isInstanced?this.capacity*this.ATTRIBUTES_ITEMS_COUNT:this.verticesCount*this.ATTRIBUTES_ITEMS_COUNT))}},{key:"hasNothingToRender",value:function(){return this.verticesCount===0}},{key:"renderProgram",value:function(t,e){var i=e.gl,o=e.program;i.enable(i.BLEND),i.useProgram(o),this.setUniforms(t,e),this.drawWebGL(this.METHOD,e)}},{key:"render",value:function(t){this.hasNothingToRender()||(this.pickProgram&&(this.pickProgram.gl.viewport(0,0,t.width*t.pixelRatio/t.downSizingRatio,t.height*t.pixelRatio/t.downSizingRatio),this.bindProgram(this.pickProgram),this.renderProgram(re(re({},t),{},{pixelRatio:t.pixelRatio/t.downSizingRatio}),this.pickProgram),this.unbindProgram(this.pickProgram)),this.normalProgram.gl.viewport(0,0,t.width*t.pixelRatio,t.height*t.pixelRatio),this.bindProgram(this.normalProgram),this.renderProgram(t,this.normalProgram),this.unbindProgram(this.normalProgram))}},{key:"drawWebGL",value:function(t,e){var i=e.gl,o=e.frameBuffer;if(i.bindFramebuffer(i.FRAMEBUFFER,o),!this.isInstanced)i.drawArrays(t,0,this.verticesCount);else if(i instanceof WebGL2RenderingContext)i.drawArraysInstanced(t,0,this.VERTICES,this.capacity);else{var a=i.getExtension("ANGLE_instanced_arrays");a&&a.drawArraysInstancedANGLE(t,0,this.VERTICES,this.capacity)}}}])}(),jt=function(n){function r(){return _e(this,r),Le(this,r,arguments)}return De(r,n),we(r,[{key:"kill",value:function(){Eo(r,"kill",this)([])}},{key:"process",value:function(e,i,o){var a=i*this.STRIDE;if(o.hidden){for(var s=a+this.STRIDE;a<s;a++)this.array[a]=0;return}return this.processVisibleItem(mo(e),a,o)}}])}(Ro);function So(n,r,t){return function(){function e(i,o,a){_e(this,e),V(this,"drawLabel",r),V(this,"drawHover",t),this.programs=n.map(function(s){return new s(i,o,a)})}return we(e,[{key:"reallocate",value:function(o){this.programs.forEach(function(a){return a.reallocate(o)})}},{key:"process",value:function(o,a,s){this.programs.forEach(function(u){return u.process(o,a,s)})}},{key:"render",value:function(o){this.programs.forEach(function(a){return a.render(o)})}},{key:"kill",value:function(){this.programs.forEach(function(o){return o.kill()})}}])}()}var st=function(n){function r(){var t;_e(this,r);for(var e=arguments.length,i=new Array(e),o=0;o<e;o++)i[o]=arguments[o];return t=Le(this,r,[].concat(i)),V(t,"drawLabel",void 0),t}return De(r,n),we(r,[{key:"kill",value:function(){Eo(r,"kill",this)([])}},{key:"process",value:function(e,i,o,a,s){var u=i*this.STRIDE;if(s.hidden||o.hidden||a.hidden){for(var l=u+this.STRIDE;u<l;u++)this.array[u]=0;return}return this.processVisibleItem(mo(e),u,o,a,s)}}])}(Ro);function pn(n,r){return function(){function t(e,i,o){_e(this,t),V(this,"drawLabel",r),this.programs=n.map(function(a){return new a(e,i,o)})}return we(t,[{key:"reallocate",value:function(i){this.programs.forEach(function(o){return o.reallocate(i)})}},{key:"process",value:function(i,o,a,s,u){this.programs.forEach(function(l){return l.process(i,o,a,s,u)})}},{key:"render",value:function(i){this.programs.forEach(function(o){return o.render(i)})}},{key:"kill",value:function(){this.programs.forEach(function(i){return i.kill()})}}])}()}function fu(n,r,t,e,i){var o=i.edgeLabelSize,a=i.edgeLabelFont,s=i.edgeLabelWeight,u=i.edgeLabelColor.attribute?r[i.edgeLabelColor.attribute]||i.edgeLabelColor.color||"#000":i.edgeLabelColor.color,l=r.label;if(l){n.fillStyle=u,n.font="".concat(s," ").concat(o,"px ").concat(a);var c=t.size,d=e.size,f=t.x,h=t.y,m=e.x,v=e.y,b=(f+m)/2,x=(h+v)/2,T=m-f,E=v-h,_=Math.sqrt(T*T+E*E);if(!(_<c+d)){f+=T*c/_,h+=E*c/_,m-=T*d/_,v-=E*d/_,b=(f+m)/2,x=(h+v)/2,T=m-f,E=v-h,_=Math.sqrt(T*T+E*E);var A=n.measureText(l).width;if(A>_){var L="…";for(l=l+L,A=n.measureText(l).width;A>_&&l.length>1;)l=l.slice(0,-2)+L,A=n.measureText(l).width;if(l.length<4)return}var y;T>0?E>0?y=Math.acos(T/_):y=Math.asin(E/_):E>0?y=Math.acos(T/_)+Math.PI:y=Math.asin(T/_)+Math.PI/2,n.save(),n.translate(b,x),n.rotate(y),n.fillText(l,-A/2,r.size/2+o),n.restore()}}}function xo(n,r,t){if(r.label){var e=t.labelSize,i=t.labelFont,o=t.labelWeight,a=t.labelColor.attribute?r[t.labelColor.attribute]||t.labelColor.color||"#000":t.labelColor.color;n.fillStyle=a,n.font="".concat(o," ").concat(e,"px ").concat(i),n.fillText(r.label,r.x+r.size+3,r.y+e/3)}}function gu(n,r,t){var e=t.labelSize,i=t.labelFont,o=t.labelWeight;n.font="".concat(o," ").concat(e,"px ").concat(i),n.fillStyle="#FFF",n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=8,n.shadowColor="#000";var a=2;if(typeof r.label=="string"){var s=n.measureText(r.label).width,u=Math.round(s+5),l=Math.round(e+2*a),c=Math.max(r.size,e/2)+a,d=Math.asin(l/2/c),f=Math.sqrt(Math.abs(Math.pow(c,2)-Math.pow(l/2,2)));n.beginPath(),n.moveTo(r.x+f,r.y+l/2),n.lineTo(r.x+c+u,r.y+l/2),n.lineTo(r.x+c+u,r.y-l/2),n.lineTo(r.x+f,r.y-l/2),n.arc(r.x,r.y,c,d,-d),n.closePath(),n.fill()}else n.beginPath(),n.arc(r.x,r.y,r.size+a,0,Math.PI*2),n.closePath(),n.fill();n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,xo(n,r,t)}var vu=`
precision highp float;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;

uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  if (dist > border)
    gl_FragColor = transparent;
  else
    gl_FragColor = v_color;

  #else
  float t = 0.0;
  if (dist > border)
    t = 1.0;
  else if (dist > 0.0)
    t = dist / border;

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,pu=vu,mu=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,yu=mu,Co=WebGLRenderingContext,ni=Co.UNSIGNED_BYTE,Rr=Co.FLOAT,bu=["u_sizeRatio","u_correctionRatio","u_matrix"],cr=function(n){function r(){return _e(this,r),Le(this,r,arguments)}return De(r,n),we(r,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:yu,FRAGMENT_SHADER_SOURCE:pu,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:bu,ATTRIBUTES:[{name:"a_position",size:2,type:Rr},{name:"a_size",size:1,type:Rr},{name:"a_color",size:4,type:ni,normalized:!0},{name:"a_id",size:4,type:ni,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:Rr}],CONSTANT_DATA:[[r.ANGLE_1],[r.ANGLE_2],[r.ANGLE_3]]}}},{key:"processVisibleItem",value:function(e,i,o){var a=this.array,s=ge(o.color);a[i++]=o.x,a[i++]=o.y,a[i++]=o.size,a[i++]=s,a[i++]=e}},{key:"setUniforms",value:function(e,i){var o=i.gl,a=i.uniformLocations,s=a.u_sizeRatio,u=a.u_correctionRatio,l=a.u_matrix;o.uniform1f(u,e.correctionRatio),o.uniform1f(s,e.sizeRatio),o.uniformMatrix3fv(l,!1,e.matrix)}}])}(jt);V(cr,"ANGLE_1",0);V(cr,"ANGLE_2",2*Math.PI/3);V(cr,"ANGLE_3",4*Math.PI/3);var _u=`
precision mediump float;

varying vec4 v_color;

void main(void) {
  gl_FragColor = v_color;
}
`,wu=_u,Eu=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Tu=Eu,Ao=WebGLRenderingContext,ii=Ao.UNSIGNED_BYTE,Zt=Ao.FLOAT,Ru=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],dr={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function ko(n){var r=re(re({},dr),{});return function(t){function e(){return _e(this,e),Le(this,e,arguments)}return De(e,t),we(e,[{key:"getDefinition",value:function(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Tu,FRAGMENT_SHADER_SOURCE:wu,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ru,ATTRIBUTES:[{name:"a_position",size:2,type:Zt},{name:"a_normal",size:2,type:Zt},{name:"a_radius",size:1,type:Zt},{name:"a_color",size:4,type:ii,normalized:!0},{name:"a_id",size:4,type:ii,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:Zt}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,l){if(r.extremity==="source"){var c=[u,s];s=c[0],u=c[1]}var d=l.size||1,f=u.size||1,h=s.x,m=s.y,v=u.x,b=u.y,x=ge(l.color),T=v-h,E=b-m,_=T*T+E*E,A=0,L=0;_&&(_=1/Math.sqrt(_),A=-E*_*d,L=T*_*d);var y=this.array;y[a++]=v,y[a++]=b,y[a++]=-A,y[a++]=-L,y[a++]=f,y[a++]=x,y[a++]=o}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,l=u.u_matrix,c=u.u_sizeRatio,d=u.u_correctionRatio,f=u.u_minEdgeThickness,h=u.u_lengthToThicknessRatio,m=u.u_widenessToThicknessRatio;s.uniformMatrix3fv(l,!1,o.matrix),s.uniform1f(c,o.sizeRatio),s.uniform1f(d,o.correctionRatio),s.uniform1f(f,o.minEdgeThickness),s.uniform1f(h,r.lengthToThicknessRatio),s.uniform1f(m,r.widenessToThicknessRatio)}}])}(st)}ko();var Su=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  #endif
}
`,Lo=Su,xu=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_radius;
attribute float a_radiusCoef;

uniform mat3 u_matrix;
uniform float u_zoomRatio;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float radius = a_radius * a_radiusCoef;
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // These first computations are taken from edge.vert.glsl. Please read it to
  // get better comments on what's happening:
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow head:
  float direction = sign(radius);
  float webGLNodeRadius = direction * radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;

  vec2 compensationVector = vec2(-direction * unitNormal.y, direction * unitNormal.x) * (webGLNodeRadius + webGLArrowHeadLength);

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + compensationVector, 1)).xy, 0, 1);

  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Cu=xu,Do=WebGLRenderingContext,oi=Do.UNSIGNED_BYTE,rt=Do.FLOAT,Au=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"],ku={lengthToThicknessRatio:dr.lengthToThicknessRatio};function Go(n){var r=re(re({},ku),{});return function(t){function e(){return _e(this,e),Le(this,e,arguments)}return De(e,t),we(e,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Cu,FRAGMENT_SHADER_SOURCE:Lo,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Au,ATTRIBUTES:[{name:"a_positionStart",size:2,type:rt},{name:"a_positionEnd",size:2,type:rt},{name:"a_normal",size:2,type:rt},{name:"a_color",size:4,type:oi,normalized:!0},{name:"a_id",size:4,type:oi,normalized:!0},{name:"a_radius",size:1,type:rt}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:rt},{name:"a_normalCoef",size:1,type:rt},{name:"a_radiusCoef",size:1,type:rt}],CONSTANT_DATA:[[0,1,0],[0,-1,0],[1,1,1],[1,1,1],[0,-1,0],[1,-1,-1]]}}},{key:"processVisibleItem",value:function(o,a,s,u,l){var c=l.size||1,d=s.x,f=s.y,h=u.x,m=u.y,v=ge(l.color),b=h-d,x=m-f,T=u.size||1,E=b*b+x*x,_=0,A=0;E&&(E=1/Math.sqrt(E),_=-x*E*c,A=b*E*c);var L=this.array;L[a++]=d,L[a++]=f,L[a++]=h,L[a++]=m,L[a++]=_,L[a++]=A,L[a++]=v,L[a++]=o,L[a++]=T}},{key:"setUniforms",value:function(o,a){var s=a.gl,u=a.uniformLocations,l=u.u_matrix,c=u.u_zoomRatio,d=u.u_feather,f=u.u_pixelRatio,h=u.u_correctionRatio,m=u.u_sizeRatio,v=u.u_minEdgeThickness,b=u.u_lengthToThicknessRatio;s.uniformMatrix3fv(l,!1,o.matrix),s.uniform1f(c,o.zoomRatio),s.uniform1f(m,o.sizeRatio),s.uniform1f(h,o.correctionRatio),s.uniform1f(f,o.pixelRatio),s.uniform1f(d,o.antiAliasingFeather),s.uniform1f(v,o.minEdgeThickness),s.uniform1f(b,r.lengthToThicknessRatio)}}])}(st)}Go();function Lu(n){return pn([Go(),ko()])}var Du=Lu(),Gu=Du,Pu=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_thickness;
varying float v_feather;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`,Nu=Pu,Po=WebGLRenderingContext,ai=Po.UNSIGNED_BYTE,At=Po.FLOAT,Ou=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness"],Iu=function(n){function r(){return _e(this,r),Le(this,r,arguments)}return De(r,n),we(r,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Nu,FRAGMENT_SHADER_SOURCE:Lo,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ou,ATTRIBUTES:[{name:"a_positionStart",size:2,type:At},{name:"a_positionEnd",size:2,type:At},{name:"a_normal",size:2,type:At},{name:"a_color",size:4,type:ai,normalized:!0},{name:"a_id",size:4,type:ai,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:At},{name:"a_normalCoef",size:1,type:At}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[1,1],[0,-1],[1,-1]]}}},{key:"processVisibleItem",value:function(e,i,o,a,s){var u=s.size||1,l=o.x,c=o.y,d=a.x,f=a.y,h=ge(s.color),m=d-l,v=f-c,b=m*m+v*v,x=0,T=0;b&&(b=1/Math.sqrt(b),x=-v*b*u,T=m*b*u);var E=this.array;E[i++]=l,E[i++]=c,E[i++]=d,E[i++]=f,E[i++]=x,E[i++]=T,E[i++]=h,E[i++]=e}},{key:"setUniforms",value:function(e,i){var o=i.gl,a=i.uniformLocations,s=a.u_matrix,u=a.u_zoomRatio,l=a.u_feather,c=a.u_pixelRatio,d=a.u_correctionRatio,f=a.u_sizeRatio,h=a.u_minEdgeThickness;o.uniformMatrix3fv(s,!1,e.matrix),o.uniform1f(u,e.zoomRatio),o.uniform1f(f,e.sizeRatio),o.uniform1f(d,e.correctionRatio),o.uniform1f(c,e.pixelRatio),o.uniform1f(l,e.antiAliasingFeather),o.uniform1f(h,e.minEdgeThickness)}}])}(st);function zu(n,r){if(typeof n!="object"||!n)return n;var t=n[Symbol.toPrimitive];if(t!==void 0){var e=t.call(n,r);if(typeof e!="object")return e;throw new TypeError("@@toPrimitive must return a primitive value.")}return(r==="string"?String:Number)(n)}function No(n){var r=zu(n,"string");return typeof r=="symbol"?r:r+""}function Oo(n,r,t){return(r=No(r))in n?Object.defineProperty(n,r,{value:t,enumerable:!0,configurable:!0,writable:!0}):n[r]=t,n}function si(n,r){var t=Object.keys(n);if(Object.getOwnPropertySymbols){var e=Object.getOwnPropertySymbols(n);r&&(e=e.filter(function(i){return Object.getOwnPropertyDescriptor(n,i).enumerable})),t.push.apply(t,e)}return t}function wt(n){for(var r=1;r<arguments.length;r++){var t=arguments[r]!=null?arguments[r]:{};r%2?si(Object(t),!0).forEach(function(e){Oo(n,e,t[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(t)):si(Object(t)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(t,e))})}return n}function Fu(n,r){if(!(n instanceof r))throw new TypeError("Cannot call a class as a function")}function $u(n,r){for(var t=0;t<r.length;t++){var e=r[t];e.enumerable=e.enumerable||!1,e.configurable=!0,"value"in e&&(e.writable=!0),Object.defineProperty(n,No(e.key),e)}}function Mu(n,r,t){return r&&$u(n.prototype,r),Object.defineProperty(n,"prototype",{writable:!1}),n}function ar(n){return ar=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(r){return r.__proto__||Object.getPrototypeOf(r)},ar(n)}function Io(){try{var n=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(Io=function(){return!!n})()}function zo(n){if(n===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return n}function Uu(n,r){if(r&&(typeof r=="object"||typeof r=="function"))return r;if(r!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return zo(n)}function ju(n,r,t){return r=ar(r),Uu(n,Io()?Reflect.construct(r,t||[],ar(n).constructor):r.apply(n,t))}function an(n,r){return an=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},an(n,r)}function Hu(n,r){if(typeof r!="function"&&r!==null)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(r&&r.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),r&&an(n,r)}function sn(n,r){(r==null||r>n.length)&&(r=n.length);for(var t=0,e=Array(r);t<r;t++)e[t]=n[t];return e}function Wu(n){if(Array.isArray(n))return sn(n)}function Bu(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Vu(n,r){if(n){if(typeof n=="string")return sn(n,r);var t={}.toString.call(n).slice(8,-1);return t==="Object"&&n.constructor&&(t=n.constructor.name),t==="Map"||t==="Set"?Array.from(n):t==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?sn(n,r):void 0}}function qu(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Sr(n){return Wu(n)||Bu(n)||Vu(n)||qu()}function Fo(n,r,t,e){var i=Math.pow(1-n,2)*r.x+2*(1-n)*n*t.x+Math.pow(n,2)*e.x,o=Math.pow(1-n,2)*r.y+2*(1-n)*n*t.y+Math.pow(n,2)*e.y;return{x:i,y:o}}function Xu(n,r,t){for(var e=20,i=0,o=n,a=0;a<e;a++){var s=Fo((a+1)/e,n,r,t);i+=Math.sqrt(Math.pow(o.x-s.x,2)+Math.pow(o.y-s.y,2)),o=s}return i}function Yu(n){var r=n.curvatureAttribute,t=n.defaultCurvature,e=n.keepLabelUpright,i=e===void 0?!0:e;return function(o,a,s,u,l){var c=l.edgeLabelSize,d=a[r]||t,f=l.edgeLabelFont,h=l.edgeLabelWeight,m=l.edgeLabelColor.attribute?a[l.edgeLabelColor.attribute]||l.edgeLabelColor.color||"#000":l.edgeLabelColor.color,v=a.label;if(v){o.fillStyle=m,o.font="".concat(h," ").concat(c,"px ").concat(f);var b=!i||s.x<u.x,x=b?s.x:u.x,T=b?s.y:u.y,E=b?u.x:s.x,_=b?u.y:s.y,A=(x+E)/2,L=(T+_)/2,y=E-x,C=_-T,S=Math.sqrt(Math.pow(y,2)+Math.pow(C,2)),D=b?1:-1,G=A+C*d*D,O=L-y*d*D,R=a.size*.7+5,H={x:O-T,y:-(G-x)},$=Math.sqrt(Math.pow(H.x,2)+Math.pow(H.y,2)),w={x:_-O,y:-(E-G)},p=Math.sqrt(Math.pow(w.x,2)+Math.pow(w.y,2));x+=R*H.x/$,T+=R*H.y/$,E+=R*w.x/p,_+=R*w.y/p,G+=R*C/S,O-=R*y/S;var g={x:G,y:O},z={x,y:T},M={x:E,y:_},P=Xu(z,g,M);if(!(P<s.size+u.size)){var k=o.measureText(v).width,F=P-s.size-u.size;if(k>F){var B="…";for(v=v+B,k=o.measureText(v).width;k>F&&v.length>1;)v=v.slice(0,-2)+B,k=o.measureText(v).width;if(v.length<4)return}for(var Y={},ee=0,q=v.length;ee<q;ee++){var W=v[ee];Y[W]||(Y[W]=o.measureText(W).width*(1+d*.35))}for(var oe=.5-k/P/2,Z=0,ne=v.length;Z<ne;Z++){var te=v[Z],ce=Fo(oe,z,g,M),J=2*(1-oe)*(G-x)+2*oe*(E-G),X=2*(1-oe)*(O-T)+2*oe*(_-O),N=Math.atan2(X,J);o.save(),o.translate(ce.x,ce.y),o.rotate(N),o.fillText(te,0,0),o.restore(),oe+=Y[te]/P}}}}}function Ku(n){var r=n.arrowHead,t=(r==null?void 0:r.extremity)==="target"||(r==null?void 0:r.extremity)==="both",e=(r==null?void 0:r.extremity)==="source"||(r==null?void 0:r.extremity)==="both",i=`
precision highp float;

varying vec4 v_color;
varying float v_thickness;
varying float v_feather;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;
`.concat(t?`
varying float v_targetSize;
varying vec2 v_targetPoint;`:"",`
`).concat(e?`
varying float v_sourceSize;
varying vec2 v_sourcePoint;`:"",`
`).concat(r?`
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;`:"",`

float det(vec2 a, vec2 b) {
  return a.x * b.y - b.x * a.y;
}

vec2 getDistanceVector(vec2 b0, vec2 b1, vec2 b2) {
  float a = det(b0, b2), b = 2.0 * det(b1, b0), d = 2.0 * det(b2, b1);
  float f = b * d - a * a;
  vec2 d21 = b2 - b1, d10 = b1 - b0, d20 = b2 - b0;
  vec2 gf = 2.0 * (b * d21 + d * d10 + a * d20);
  gf = vec2(gf.y, -gf.x);
  vec2 pp = -f * gf / dot(gf, gf);
  vec2 d0p = b0 - pp;
  float ap = det(d0p, d20), bp = 2.0 * det(d10, d0p);
  float t = clamp((ap + bp) / (2.0 * a + b + d), 0.0, 1.0);
  return mix(mix(b0, b1, t), mix(b1, b2, t), t);
}

float distToQuadraticBezierCurve(vec2 p, vec2 b0, vec2 b1, vec2 b2) {
  return length(getDistanceVector(b0 - p, b1 - p, b2 - p));
}

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = distToQuadraticBezierCurve(gl_FragCoord.xy, v_cpA, v_cpB, v_cpC);
  float thickness = v_thickness;
`).concat(t?`
  float distToTarget = length(gl_FragCoord.xy - v_targetPoint);
  float targetArrowLength = v_targetSize + thickness * u_lengthToThicknessRatio;
  if (distToTarget < targetArrowLength) {
    thickness = (distToTarget - v_targetSize) / (targetArrowLength - v_targetSize) * u_widenessToThicknessRatio * thickness;
  }`:"",`
`).concat(e?`
  float distToSource = length(gl_FragCoord.xy - v_sourcePoint);
  float sourceArrowLength = v_sourceSize + thickness * u_lengthToThicknessRatio;
  if (distToSource < sourceArrowLength) {
    thickness = (distToSource - v_sourceSize) / (sourceArrowLength - v_sourceSize) * u_widenessToThicknessRatio * thickness;
  }`:"",`

  float halfThickness = thickness / 2.0;
  if (dist < halfThickness) {
    #ifdef PICKING_MODE
    gl_FragColor = v_color;
    #else
    float t = smoothstep(
      halfThickness - v_feather,
      halfThickness,
      dist
    );

    gl_FragColor = mix(v_color, transparent, t);
    #endif
  } else {
    gl_FragColor = transparent;
  }
}
`);return i}function Zu(n){var r=n.arrowHead,t=(r==null?void 0:r.extremity)==="target"||(r==null?void 0:r.extremity)==="both",e=(r==null?void 0:r.extremity)==="source"||(r==null?void 0:r.extremity)==="both",i=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute float a_direction;
attribute float a_thickness;
attribute vec2 a_source;
attribute vec2 a_target;
attribute float a_current;
attribute float a_curvature;
`.concat(t?`attribute float a_targetSize;
`:"",`
`).concat(e?`attribute float a_sourceSize;
`:"",`

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform vec2 u_dimensions;
uniform float u_minEdgeThickness;
uniform float u_feather;

varying vec4 v_color;
varying float v_thickness;
varying float v_feather;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;
`).concat(t?`
varying float v_targetSize;
varying vec2 v_targetPoint;`:"",`
`).concat(e?`
varying float v_sourceSize;
varying vec2 v_sourcePoint;`:"",`
`).concat(r?`
uniform float u_widenessToThicknessRatio;`:"",`

const float bias = 255.0 / 254.0;
const float epsilon = 0.7;

vec2 clipspaceToViewport(vec2 pos, vec2 dimensions) {
  return vec2(
    (pos.x + 1.0) * dimensions.x / 2.0,
    (pos.y + 1.0) * dimensions.y / 2.0
  );
}

vec2 viewportToClipspace(vec2 pos, vec2 dimensions) {
  return vec2(
    pos.x / dimensions.x * 2.0 - 1.0,
    pos.y / dimensions.y * 2.0 - 1.0
  );
}

void main() {
  float minThickness = u_minEdgeThickness;

  // Selecting the correct position
  // Branchless "position = a_source if a_current == 1.0 else a_target"
  vec2 position = a_source * max(0.0, a_current) + a_target * max(0.0, 1.0 - a_current);
  position = (u_matrix * vec3(position, 1)).xy;

  vec2 source = (u_matrix * vec3(a_source, 1)).xy;
  vec2 target = (u_matrix * vec3(a_target, 1)).xy;

  vec2 viewportPosition = clipspaceToViewport(position, u_dimensions);
  vec2 viewportSource = clipspaceToViewport(source, u_dimensions);
  vec2 viewportTarget = clipspaceToViewport(target, u_dimensions);

  vec2 delta = viewportTarget.xy - viewportSource.xy;
  float len = length(delta);
  vec2 normal = vec2(-delta.y, delta.x) * a_direction;
  vec2 unitNormal = normal / len;
  float boundingBoxThickness = len * a_curvature;

  float curveThickness = max(minThickness, a_thickness / u_sizeRatio);
  v_thickness = curveThickness * u_pixelRatio;
  v_feather = u_feather;

  v_cpA = viewportSource;
  v_cpB = 0.5 * (viewportSource + viewportTarget) + unitNormal * a_direction * boundingBoxThickness;
  v_cpC = viewportTarget;

  vec2 viewportOffsetPosition = (
    viewportPosition +
    unitNormal * (boundingBoxThickness / 2.0 + sign(boundingBoxThickness) * (`).concat(r?"curveThickness * u_widenessToThicknessRatio":"curveThickness",` + epsilon)) *
    max(0.0, a_direction) // NOTE: cutting the bounding box in half to avoid overdraw
  );

  position = viewportToClipspace(viewportOffsetPosition, u_dimensions);
  gl_Position = vec4(position, 0, 1);
    
`).concat(t?`
  v_targetSize = a_targetSize * u_pixelRatio / u_sizeRatio;
  v_targetPoint = viewportTarget;
`:"",`
`).concat(e?`
  v_sourceSize = a_sourceSize * u_pixelRatio / u_sizeRatio;
  v_sourcePoint = viewportSource;
`:"",`

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  #endif

  v_color.a *= bias;
}
`);return i}var Ht=.25,Ju={arrowHead:null,curvatureAttribute:"curvature",defaultCurvature:Ht},Qu={edgeIndexAttribute:"parallelIndex",edgeMinIndexAttribute:"parallelMinIndex",edgeMaxIndexAttribute:"parallelMaxIndex"};function el(n,r){var t=wt(wt({},Qu),r||{}),e={},i={},o={},a=0;n.forEachNode(function(L){e[L]=++a+""}),n.forEachEdge(function(L,y,C,S){var D=e[C],G=e[S],O=[D,G].join("-");i[L]=O,o[O]=[D,G].sort().join("-")});var s={},u={};n.forEachEdge(function(L){var y=i[L],C=o[y];s[y]=s[y]||[],s[y].push(L),u[C]=u[C]||[],u[C].push(L)});for(var l in s){var c=s[l],d=c.length,f=u[o[l]].length;if(d===1&&f===1){var h=c[0];n.setEdgeAttribute(h,t.edgeIndexAttribute,null),n.setEdgeAttribute(h,t.edgeMaxIndexAttribute,null)}else if(d===1){var m=c[0];n.setEdgeAttribute(m,t.edgeIndexAttribute,1),n.setEdgeAttribute(m,t.edgeMaxIndexAttribute,1)}else if(d===f)for(var v=(d-1)/2,b=-v,x=0;x<d;x++){var T=c[x],E=-(d-1)/2+x;n.setEdgeAttribute(T,t.edgeIndexAttribute,E),n.setEdgeAttribute(T,t.edgeMinIndexAttribute,b),n.setEdgeAttribute(T,t.edgeMaxIndexAttribute,v)}else for(var _=0;_<d;_++){var A=c[_];n.setEdgeAttribute(A,t.edgeIndexAttribute,_+1),n.setEdgeAttribute(A,t.edgeMaxIndexAttribute,d)}}}var $o=WebGLRenderingContext,ui=$o.UNSIGNED_BYTE,Ke=$o.FLOAT;function mn(n){var r=wt(wt({},Ju),n||{}),t=r,e=t.arrowHead,i=t.curvatureAttribute,o=t.drawLabel,a=(e==null?void 0:e.extremity)==="target"||(e==null?void 0:e.extremity)==="both",s=(e==null?void 0:e.extremity)==="source"||(e==null?void 0:e.extremity)==="both",u=["u_matrix","u_sizeRatio","u_dimensions","u_pixelRatio","u_feather","u_minEdgeThickness"].concat(Sr(e?["u_lengthToThicknessRatio","u_widenessToThicknessRatio"]:[]));return function(l){Hu(c,l);function c(){var d;Fu(this,c);for(var f=arguments.length,h=new Array(f),m=0;m<f;m++)h[m]=arguments[m];return d=ju(this,c,[].concat(h)),Oo(zo(d),"drawLabel",o||Yu(r)),d}return Mu(c,[{key:"getDefinition",value:function(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Zu(r),FRAGMENT_SHADER_SOURCE:Ku(r),METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:u,ATTRIBUTES:[{name:"a_source",size:2,type:Ke},{name:"a_target",size:2,type:Ke}].concat(Sr(a?[{name:"a_targetSize",size:1,type:Ke}]:[]),Sr(s?[{name:"a_sourceSize",size:1,type:Ke}]:[]),[{name:"a_thickness",size:1,type:Ke},{name:"a_curvature",size:1,type:Ke},{name:"a_color",size:4,type:ui,normalized:!0},{name:"a_id",size:4,type:ui,normalized:!0}]),CONSTANT_ATTRIBUTES:[{name:"a_current",size:1,type:Ke},{name:"a_direction",size:1,type:Ke}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[0,-1],[1,1],[1,-1]]}}},{key:"processVisibleItem",value:function(f,h,m,v,b){var x,T=b.size||1,E=m.x,_=m.y,A=v.x,L=v.y,y=ge(b.color),C=(x=b[i])!==null&&x!==void 0?x:Ht,S=this.array;S[h++]=E,S[h++]=_,S[h++]=A,S[h++]=L,a&&(S[h++]=v.size),s&&(S[h++]=m.size),S[h++]=T,S[h++]=C,S[h++]=y,S[h++]=f}},{key:"setUniforms",value:function(f,h){var m=h.gl,v=h.uniformLocations,b=v.u_matrix,x=v.u_pixelRatio,T=v.u_feather,E=v.u_sizeRatio,_=v.u_dimensions,A=v.u_minEdgeThickness;if(m.uniformMatrix3fv(b,!1,f.matrix),m.uniform1f(x,f.pixelRatio),m.uniform1f(E,f.sizeRatio),m.uniform1f(T,f.antiAliasingFeather),m.uniform2f(_,f.width*f.pixelRatio,f.height*f.pixelRatio),m.uniform1f(A,f.minEdgeThickness),e){var L=v.u_lengthToThicknessRatio,y=v.u_widenessToThicknessRatio;m.uniform1f(L,e.lengthToThicknessRatio),m.uniform1f(y,e.widenessToThicknessRatio)}}}]),c}(st)}mn();mn({arrowHead:dr});mn({arrowHead:wt(wt({},dr),{},{extremity:"both"})});var Jt={exports:{}},li;function tl(){if(li)return Jt.exports;li=1;var n=typeof Reflect=="object"?Reflect:null,r=n&&typeof n.apply=="function"?n.apply:function(A,L,y){return Function.prototype.apply.call(A,L,y)},t;n&&typeof n.ownKeys=="function"?t=n.ownKeys:Object.getOwnPropertySymbols?t=function(A){return Object.getOwnPropertyNames(A).concat(Object.getOwnPropertySymbols(A))}:t=function(A){return Object.getOwnPropertyNames(A)};function e(_){console&&console.warn&&console.warn(_)}var i=Number.isNaN||function(A){return A!==A};function o(){o.init.call(this)}Jt.exports=o,Jt.exports.once=x,o.EventEmitter=o,o.prototype._events=void 0,o.prototype._eventsCount=0,o.prototype._maxListeners=void 0;var a=10;function s(_){if(typeof _!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof _)}Object.defineProperty(o,"defaultMaxListeners",{enumerable:!0,get:function(){return a},set:function(_){if(typeof _!="number"||_<0||i(_))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+_+".");a=_}}),o.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0},o.prototype.setMaxListeners=function(A){if(typeof A!="number"||A<0||i(A))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+A+".");return this._maxListeners=A,this};function u(_){return _._maxListeners===void 0?o.defaultMaxListeners:_._maxListeners}o.prototype.getMaxListeners=function(){return u(this)},o.prototype.emit=function(A){for(var L=[],y=1;y<arguments.length;y++)L.push(arguments[y]);var C=A==="error",S=this._events;if(S!==void 0)C=C&&S.error===void 0;else if(!C)return!1;if(C){var D;if(L.length>0&&(D=L[0]),D instanceof Error)throw D;var G=new Error("Unhandled error."+(D?" ("+D.message+")":""));throw G.context=D,G}var O=S[A];if(O===void 0)return!1;if(typeof O=="function")r(O,this,L);else for(var R=O.length,H=m(O,R),y=0;y<R;++y)r(H[y],this,L);return!0};function l(_,A,L,y){var C,S,D;if(s(L),S=_._events,S===void 0?(S=_._events=Object.create(null),_._eventsCount=0):(S.newListener!==void 0&&(_.emit("newListener",A,L.listener?L.listener:L),S=_._events),D=S[A]),D===void 0)D=S[A]=L,++_._eventsCount;else if(typeof D=="function"?D=S[A]=y?[L,D]:[D,L]:y?D.unshift(L):D.push(L),C=u(_),C>0&&D.length>C&&!D.warned){D.warned=!0;var G=new Error("Possible EventEmitter memory leak detected. "+D.length+" "+String(A)+" listeners added. Use emitter.setMaxListeners() to increase limit");G.name="MaxListenersExceededWarning",G.emitter=_,G.type=A,G.count=D.length,e(G)}return _}o.prototype.addListener=function(A,L){return l(this,A,L,!1)},o.prototype.on=o.prototype.addListener,o.prototype.prependListener=function(A,L){return l(this,A,L,!0)};function c(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function d(_,A,L){var y={fired:!1,wrapFn:void 0,target:_,type:A,listener:L},C=c.bind(y);return C.listener=L,y.wrapFn=C,C}o.prototype.once=function(A,L){return s(L),this.on(A,d(this,A,L)),this},o.prototype.prependOnceListener=function(A,L){return s(L),this.prependListener(A,d(this,A,L)),this},o.prototype.removeListener=function(A,L){var y,C,S,D,G;if(s(L),C=this._events,C===void 0)return this;if(y=C[A],y===void 0)return this;if(y===L||y.listener===L)--this._eventsCount===0?this._events=Object.create(null):(delete C[A],C.removeListener&&this.emit("removeListener",A,y.listener||L));else if(typeof y!="function"){for(S=-1,D=y.length-1;D>=0;D--)if(y[D]===L||y[D].listener===L){G=y[D].listener,S=D;break}if(S<0)return this;S===0?y.shift():v(y,S),y.length===1&&(C[A]=y[0]),C.removeListener!==void 0&&this.emit("removeListener",A,G||L)}return this},o.prototype.off=o.prototype.removeListener,o.prototype.removeAllListeners=function(A){var L,y,C;if(y=this._events,y===void 0)return this;if(y.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):y[A]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete y[A]),this;if(arguments.length===0){var S=Object.keys(y),D;for(C=0;C<S.length;++C)D=S[C],D!=="removeListener"&&this.removeAllListeners(D);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(L=y[A],typeof L=="function")this.removeListener(A,L);else if(L!==void 0)for(C=L.length-1;C>=0;C--)this.removeListener(A,L[C]);return this};function f(_,A,L){var y=_._events;if(y===void 0)return[];var C=y[A];return C===void 0?[]:typeof C=="function"?L?[C.listener||C]:[C]:L?b(C):m(C,C.length)}o.prototype.listeners=function(A){return f(this,A,!0)},o.prototype.rawListeners=function(A){return f(this,A,!1)},o.listenerCount=function(_,A){return typeof _.listenerCount=="function"?_.listenerCount(A):h.call(_,A)},o.prototype.listenerCount=h;function h(_){var A=this._events;if(A!==void 0){var L=A[_];if(typeof L=="function")return 1;if(L!==void 0)return L.length}return 0}o.prototype.eventNames=function(){return this._eventsCount>0?t(this._events):[]};function m(_,A){for(var L=new Array(A),y=0;y<A;++y)L[y]=_[y];return L}function v(_,A){for(;A+1<_.length;A++)_[A]=_[A+1];_.pop()}function b(_){for(var A=new Array(_.length),L=0;L<A.length;++L)A[L]=_[L].listener||_[L];return A}function x(_,A){return new Promise(function(L,y){function C(D){_.removeListener(A,S),y(D)}function S(){typeof _.removeListener=="function"&&_.removeListener("error",C),L([].slice.call(arguments))}E(_,A,S,{once:!0}),A!=="error"&&T(_,C,{once:!0})})}function T(_,A,L){typeof _.on=="function"&&E(_,"error",A,L)}function E(_,A,L,y){if(typeof _.on=="function")y.once?_.once(A,L):_.on(A,L);else if(typeof _.addEventListener=="function")_.addEventListener(A,function C(S){y.once&&_.removeEventListener(A,C),L(S)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof _)}return Jt.exports}var hr=tl();function rl(){const n=arguments[0];for(let r=1,t=arguments.length;r<t;r++)if(arguments[r])for(const e in arguments[r])n[e]=arguments[r][e];return n}let ve=rl;typeof Object.assign=="function"&&(ve=Object.assign);function ke(n,r,t,e){const i=n._nodes.get(r);let o=null;return i&&(e==="mixed"?o=i.out&&i.out[t]||i.undirected&&i.undirected[t]:e==="directed"?o=i.out&&i.out[t]:o=i.undirected&&i.undirected[t]),o}function be(n){return typeof n=="object"&&n!==null}function Mo(n){let r;for(r in n)return!1;return!0}function Ce(n,r,t){Object.defineProperty(n,r,{enumerable:!1,configurable:!1,writable:!0,value:t})}function Pe(n,r,t){const e={enumerable:!0,configurable:!0};typeof t=="function"?e.get=t:(e.value=t,e.writable=!1),Object.defineProperty(n,r,e)}function ci(n){return!(!be(n)||n.attributes&&!Array.isArray(n.attributes))}function nl(){let n=Math.floor(Math.random()*256)&255;return()=>n++}function Ve(){const n=arguments;let r=null,t=-1;return{[Symbol.iterator](){return this},next(){let e=null;do{if(r===null){if(t++,t>=n.length)return{done:!0};r=n[t][Symbol.iterator]()}if(e=r.next(),e.done){r=null;continue}break}while(!0);return e}}}function Et(){return{[Symbol.iterator](){return this},next(){return{done:!0}}}}class yn extends Error{constructor(r){super(),this.name="GraphError",this.message=r}}class Q extends yn{constructor(r){super(r),this.name="InvalidArgumentsGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,Q.prototype.constructor)}}class K extends yn{constructor(r){super(r),this.name="NotFoundGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,K.prototype.constructor)}}class se extends yn{constructor(r){super(r),this.name="UsageGraphError",typeof Error.captureStackTrace=="function"&&Error.captureStackTrace(this,se.prototype.constructor)}}function Uo(n,r){this.key=n,this.attributes=r,this.clear()}Uo.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.undirectedDegree=0,this.undirectedLoops=0,this.directedLoops=0,this.in={},this.out={},this.undirected={}};function jo(n,r){this.key=n,this.attributes=r,this.clear()}jo.prototype.clear=function(){this.inDegree=0,this.outDegree=0,this.directedLoops=0,this.in={},this.out={}};function Ho(n,r){this.key=n,this.attributes=r,this.clear()}Ho.prototype.clear=function(){this.undirectedDegree=0,this.undirectedLoops=0,this.undirected={}};function Tt(n,r,t,e,i){this.key=r,this.attributes=i,this.undirected=n,this.source=t,this.target=e}Tt.prototype.attach=function(){let n="out",r="in";this.undirected&&(n=r="undirected");const t=this.source.key,e=this.target.key;this.source[n][e]=this,!(this.undirected&&t===e)&&(this.target[r][t]=this)};Tt.prototype.attachMulti=function(){let n="out",r="in";const t=this.source.key,e=this.target.key;this.undirected&&(n=r="undirected");const i=this.source[n],o=i[e];if(typeof o>"u"){i[e]=this,this.undirected&&t===e||(this.target[r][t]=this);return}o.previous=this,this.next=o,i[e]=this,this.target[r][t]=this};Tt.prototype.detach=function(){const n=this.source.key,r=this.target.key;let t="out",e="in";this.undirected&&(t=e="undirected"),delete this.source[t][r],delete this.target[e][n]};Tt.prototype.detachMulti=function(){const n=this.source.key,r=this.target.key;let t="out",e="in";this.undirected&&(t=e="undirected"),this.previous===void 0?this.next===void 0?(delete this.source[t][r],delete this.target[e][n]):(this.next.previous=void 0,this.source[t][r]=this.next,this.target[e][n]=this.next):(this.previous.next=this.next,this.next!==void 0&&(this.next.previous=this.previous))};const Wo=0,Bo=1,il=2,Vo=3;function qe(n,r,t,e,i,o,a){let s,u,l,c;if(e=""+e,t===Wo){if(s=n._nodes.get(e),!s)throw new K(`Graph.${r}: could not find the "${e}" node in the graph.`);l=i,c=o}else if(t===Vo){if(i=""+i,u=n._edges.get(i),!u)throw new K(`Graph.${r}: could not find the "${i}" edge in the graph.`);const d=u.source.key,f=u.target.key;if(e===d)s=u.target;else if(e===f)s=u.source;else throw new K(`Graph.${r}: the "${e}" node is not attached to the "${i}" edge (${d}, ${f}).`);l=o,c=a}else{if(u=n._edges.get(e),!u)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`);t===Bo?s=u.source:s=u.target,l=i,c=o}return[s,l,c]}function ol(n,r,t){n.prototype[r]=function(e,i,o){const[a,s]=qe(this,r,t,e,i,o);return a.attributes[s]}}function al(n,r,t){n.prototype[r]=function(e,i){const[o]=qe(this,r,t,e,i);return o.attributes}}function sl(n,r,t){n.prototype[r]=function(e,i,o){const[a,s]=qe(this,r,t,e,i,o);return a.attributes.hasOwnProperty(s)}}function ul(n,r,t){n.prototype[r]=function(e,i,o,a){const[s,u,l]=qe(this,r,t,e,i,o,a);return s.attributes[u]=l,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function ll(n,r,t){n.prototype[r]=function(e,i,o,a){const[s,u,l]=qe(this,r,t,e,i,o,a);if(typeof l!="function")throw new Q(`Graph.${r}: updater should be a function.`);const c=s.attributes,d=l(c[u]);return c[u]=d,this.emit("nodeAttributesUpdated",{key:s.key,type:"set",attributes:s.attributes,name:u}),this}}function cl(n,r,t){n.prototype[r]=function(e,i,o){const[a,s]=qe(this,r,t,e,i,o);return delete a.attributes[s],this.emit("nodeAttributesUpdated",{key:a.key,type:"remove",attributes:a.attributes,name:s}),this}}function dl(n,r,t){n.prototype[r]=function(e,i,o){const[a,s]=qe(this,r,t,e,i,o);if(!be(s))throw new Q(`Graph.${r}: provided attributes are not a plain object.`);return a.attributes=s,this.emit("nodeAttributesUpdated",{key:a.key,type:"replace",attributes:a.attributes}),this}}function hl(n,r,t){n.prototype[r]=function(e,i,o){const[a,s]=qe(this,r,t,e,i,o);if(!be(s))throw new Q(`Graph.${r}: provided attributes are not a plain object.`);return ve(a.attributes,s),this.emit("nodeAttributesUpdated",{key:a.key,type:"merge",attributes:a.attributes,data:s}),this}}function fl(n,r,t){n.prototype[r]=function(e,i,o){const[a,s]=qe(this,r,t,e,i,o);if(typeof s!="function")throw new Q(`Graph.${r}: provided updater is not a function.`);return a.attributes=s(a.attributes),this.emit("nodeAttributesUpdated",{key:a.key,type:"update",attributes:a.attributes}),this}}const gl=[{name:n=>`get${n}Attribute`,attacher:ol},{name:n=>`get${n}Attributes`,attacher:al},{name:n=>`has${n}Attribute`,attacher:sl},{name:n=>`set${n}Attribute`,attacher:ul},{name:n=>`update${n}Attribute`,attacher:ll},{name:n=>`remove${n}Attribute`,attacher:cl},{name:n=>`replace${n}Attributes`,attacher:dl},{name:n=>`merge${n}Attributes`,attacher:hl},{name:n=>`update${n}Attributes`,attacher:fl}];function vl(n){gl.forEach(function({name:r,attacher:t}){t(n,r("Node"),Wo),t(n,r("Source"),Bo),t(n,r("Target"),il),t(n,r("Opposite"),Vo)})}function pl(n,r,t){n.prototype[r]=function(e,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+i;if(i=arguments[2],o=ke(this,a,s,t),!o)throw new K(`Graph.${r}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}return o.attributes[i]}}function ml(n,r,t){n.prototype[r]=function(e){let i;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>1){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const o=""+e,a=""+arguments[1];if(i=ke(this,o,a,t),!i)throw new K(`Graph.${r}: could not find an edge for the given path ("${o}" - "${a}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,i=this._edges.get(e),!i)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}return i.attributes}}function yl(n,r,t){n.prototype[r]=function(e,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+i;if(i=arguments[2],o=ke(this,a,s,t),!o)throw new K(`Graph.${r}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}return o.attributes.hasOwnProperty(i)}}function bl(n,r,t){n.prototype[r]=function(e,i,o){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+e,u=""+i;if(i=arguments[2],o=arguments[3],a=ke(this,s,u,t),!a)throw new K(`Graph.${r}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,a=this._edges.get(e),!a)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}return a.attributes[i]=o,this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function _l(n,r,t){n.prototype[r]=function(e,i,o){let a;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>3){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const s=""+e,u=""+i;if(i=arguments[2],o=arguments[3],a=ke(this,s,u,t),!a)throw new K(`Graph.${r}: could not find an edge for the given path ("${s}" - "${u}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,a=this._edges.get(e),!a)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}if(typeof o!="function")throw new Q(`Graph.${r}: updater should be a function.`);return a.attributes[i]=o(a.attributes[i]),this.emit("edgeAttributesUpdated",{key:a.key,type:"set",attributes:a.attributes,name:i}),this}}function wl(n,r,t){n.prototype[r]=function(e,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+i;if(i=arguments[2],o=ke(this,a,s,t),!o)throw new K(`Graph.${r}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}return delete o.attributes[i],this.emit("edgeAttributesUpdated",{key:o.key,type:"remove",attributes:o.attributes,name:i}),this}}function El(n,r,t){n.prototype[r]=function(e,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+i;if(i=arguments[2],o=ke(this,a,s,t),!o)throw new K(`Graph.${r}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}if(!be(i))throw new Q(`Graph.${r}: provided attributes are not a plain object.`);return o.attributes=i,this.emit("edgeAttributesUpdated",{key:o.key,type:"replace",attributes:o.attributes}),this}}function Tl(n,r,t){n.prototype[r]=function(e,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+i;if(i=arguments[2],o=ke(this,a,s,t),!o)throw new K(`Graph.${r}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}if(!be(i))throw new Q(`Graph.${r}: provided attributes are not a plain object.`);return ve(o.attributes,i),this.emit("edgeAttributesUpdated",{key:o.key,type:"merge",attributes:o.attributes,data:i}),this}}function Rl(n,r,t){n.prototype[r]=function(e,i){let o;if(this.type!=="mixed"&&t!=="mixed"&&t!==this.type)throw new se(`Graph.${r}: cannot find this type of edges in your ${this.type} graph.`);if(arguments.length>2){if(this.multi)throw new se(`Graph.${r}: cannot use a {source,target} combo when asking about an edge's attributes in a MultiGraph since we cannot infer the one you want information about.`);const a=""+e,s=""+i;if(i=arguments[2],o=ke(this,a,s,t),!o)throw new K(`Graph.${r}: could not find an edge for the given path ("${a}" - "${s}").`)}else{if(t!=="mixed")throw new se(`Graph.${r}: calling this method with only a key (vs. a source and target) does not make sense since an edge with this key could have the other type.`);if(e=""+e,o=this._edges.get(e),!o)throw new K(`Graph.${r}: could not find the "${e}" edge in the graph.`)}if(typeof i!="function")throw new Q(`Graph.${r}: provided updater is not a function.`);return o.attributes=i(o.attributes),this.emit("edgeAttributesUpdated",{key:o.key,type:"update",attributes:o.attributes}),this}}const Sl=[{name:n=>`get${n}Attribute`,attacher:pl},{name:n=>`get${n}Attributes`,attacher:ml},{name:n=>`has${n}Attribute`,attacher:yl},{name:n=>`set${n}Attribute`,attacher:bl},{name:n=>`update${n}Attribute`,attacher:_l},{name:n=>`remove${n}Attribute`,attacher:wl},{name:n=>`replace${n}Attributes`,attacher:El},{name:n=>`merge${n}Attributes`,attacher:Tl},{name:n=>`update${n}Attributes`,attacher:Rl}];function xl(n){Sl.forEach(function({name:r,attacher:t}){t(n,r("Edge"),"mixed"),t(n,r("DirectedEdge"),"directed"),t(n,r("UndirectedEdge"),"undirected")})}const Cl=[{name:"edges",type:"mixed"},{name:"inEdges",type:"directed",direction:"in"},{name:"outEdges",type:"directed",direction:"out"},{name:"inboundEdges",type:"mixed",direction:"in"},{name:"outboundEdges",type:"mixed",direction:"out"},{name:"directedEdges",type:"directed"},{name:"undirectedEdges",type:"undirected"}];function Al(n,r,t,e){let i=!1;for(const o in r){if(o===e)continue;const a=r[o];if(i=t(a.key,a.attributes,a.source.key,a.target.key,a.source.attributes,a.target.attributes,a.undirected),n&&i)return a.key}}function kl(n,r,t,e){let i,o,a,s=!1;for(const u in r)if(u!==e){i=r[u];do{if(o=i.source,a=i.target,s=t(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected),n&&s)return i.key;i=i.next}while(i!==void 0)}}function xr(n,r){const t=Object.keys(n),e=t.length;let i,o=0;return{[Symbol.iterator](){return this},next(){do if(i)i=i.next;else{if(o>=e)return{done:!0};const a=t[o++];if(a===r){i=void 0;continue}i=n[a]}while(!i);return{done:!1,value:{edge:i.key,attributes:i.attributes,source:i.source.key,target:i.target.key,sourceAttributes:i.source.attributes,targetAttributes:i.target.attributes,undirected:i.undirected}}}}}function Ll(n,r,t,e){const i=r[t];if(!i)return;const o=i.source,a=i.target;if(e(i.key,i.attributes,o.key,a.key,o.attributes,a.attributes,i.undirected)&&n)return i.key}function Dl(n,r,t,e){let i=r[t];if(!i)return;let o=!1;do{if(o=e(i.key,i.attributes,i.source.key,i.target.key,i.source.attributes,i.target.attributes,i.undirected),n&&o)return i.key;i=i.next}while(i!==void 0)}function Cr(n,r){let t=n[r];if(t.next!==void 0)return{[Symbol.iterator](){return this},next(){if(!t)return{done:!0};const i={edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected};return t=t.next,{done:!1,value:i}}};let e=!1;return{[Symbol.iterator](){return this},next(){return e===!0?{done:!0}:(e=!0,{done:!1,value:{edge:t.key,attributes:t.attributes,source:t.source.key,target:t.target.key,sourceAttributes:t.source.attributes,targetAttributes:t.target.attributes,undirected:t.undirected}})}}}function Gl(n,r){if(n.size===0)return[];if(r==="mixed"||r===n.type)return Array.from(n._edges.keys());const t=r==="undirected"?n.undirectedSize:n.directedSize,e=new Array(t),i=r==="undirected",o=n._edges.values();let a=0,s,u;for(;s=o.next(),s.done!==!0;)u=s.value,u.undirected===i&&(e[a++]=u.key);return e}function qo(n,r,t,e){if(r.size===0)return;const i=t!=="mixed"&&t!==r.type,o=t==="undirected";let a,s,u=!1;const l=r._edges.values();for(;a=l.next(),a.done!==!0;){if(s=a.value,i&&s.undirected!==o)continue;const{key:c,attributes:d,source:f,target:h}=s;if(u=e(c,d,f.key,h.key,f.attributes,h.attributes,s.undirected),n&&u)return c}}function Pl(n,r){if(n.size===0)return Et();const t=r!=="mixed"&&r!==n.type,e=r==="undirected",i=n._edges.values();return{[Symbol.iterator](){return this},next(){let o,a;for(;;){if(o=i.next(),o.done)return o;if(a=o.value,!(t&&a.undirected!==e))break}return{value:{edge:a.key,attributes:a.attributes,source:a.source.key,target:a.target.key,sourceAttributes:a.source.attributes,targetAttributes:a.target.attributes,undirected:a.undirected},done:!1}}}}function bn(n,r,t,e,i,o){const a=r?kl:Al;let s;if(t!=="undirected"&&(e!=="out"&&(s=a(n,i.in,o),n&&s)||e!=="in"&&(s=a(n,i.out,o,e?void 0:i.key),n&&s))||t!=="directed"&&(s=a(n,i.undirected,o),n&&s))return s}function Nl(n,r,t,e){const i=[];return bn(!1,n,r,t,e,function(o){i.push(o)}),i}function Ol(n,r,t){let e=Et();return n!=="undirected"&&(r!=="out"&&typeof t.in<"u"&&(e=Ve(e,xr(t.in))),r!=="in"&&typeof t.out<"u"&&(e=Ve(e,xr(t.out,r?void 0:t.key)))),n!=="directed"&&typeof t.undirected<"u"&&(e=Ve(e,xr(t.undirected))),e}function _n(n,r,t,e,i,o,a){const s=t?Dl:Ll;let u;if(r!=="undirected"&&(typeof i.in<"u"&&e!=="out"&&(u=s(n,i.in,o,a),n&&u)||typeof i.out<"u"&&e!=="in"&&(e||i.key!==o)&&(u=s(n,i.out,o,a),n&&u))||r!=="directed"&&typeof i.undirected<"u"&&(u=s(n,i.undirected,o,a),n&&u))return u}function Il(n,r,t,e,i){const o=[];return _n(!1,n,r,t,e,i,function(a){o.push(a)}),o}function zl(n,r,t,e){let i=Et();return n!=="undirected"&&(typeof t.in<"u"&&r!=="out"&&e in t.in&&(i=Ve(i,Cr(t.in,e))),typeof t.out<"u"&&r!=="in"&&e in t.out&&(r||t.key!==e)&&(i=Ve(i,Cr(t.out,e)))),n!=="directed"&&typeof t.undirected<"u"&&e in t.undirected&&(i=Ve(i,Cr(t.undirected,e))),i}function Fl(n,r){const{name:t,type:e,direction:i}=r;n.prototype[t]=function(o,a){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return[];if(!arguments.length)return Gl(this,e);if(arguments.length===1){o=""+o;const s=this._nodes.get(o);if(typeof s>"u")throw new K(`Graph.${t}: could not find the "${o}" node in the graph.`);return Nl(this.multi,e==="mixed"?this.type:e,i,s)}if(arguments.length===2){o=""+o,a=""+a;const s=this._nodes.get(o);if(!s)throw new K(`Graph.${t}:  could not find the "${o}" source node in the graph.`);if(!this._nodes.has(a))throw new K(`Graph.${t}:  could not find the "${a}" target node in the graph.`);return Il(e,this.multi,i,s,a)}throw new Q(`Graph.${t}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function $l(n,r){const{name:t,type:e,direction:i}=r,o="forEach"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[o]=function(l,c,d){if(!(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)){if(arguments.length===1)return d=l,qo(!1,this,e,d);if(arguments.length===2){l=""+l,d=c;const f=this._nodes.get(l);if(typeof f>"u")throw new K(`Graph.${o}: could not find the "${l}" node in the graph.`);return bn(!1,this.multi,e==="mixed"?this.type:e,i,f,d)}if(arguments.length===3){l=""+l,c=""+c;const f=this._nodes.get(l);if(!f)throw new K(`Graph.${o}:  could not find the "${l}" source node in the graph.`);if(!this._nodes.has(c))throw new K(`Graph.${o}:  could not find the "${c}" target node in the graph.`);return _n(!1,e,this.multi,i,f,c,d)}throw new Q(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)}};const a="map"+t[0].toUpperCase()+t.slice(1);n.prototype[a]=function(){const l=Array.prototype.slice.call(arguments),c=l.pop();let d;if(l.length===0){let f=0;e!=="directed"&&(f+=this.undirectedSize),e!=="undirected"&&(f+=this.directedSize),d=new Array(f);let h=0;l.push((m,v,b,x,T,E,_)=>{d[h++]=c(m,v,b,x,T,E,_)})}else d=[],l.push((f,h,m,v,b,x,T)=>{d.push(c(f,h,m,v,b,x,T))});return this[o].apply(this,l),d};const s="filter"+t[0].toUpperCase()+t.slice(1);n.prototype[s]=function(){const l=Array.prototype.slice.call(arguments),c=l.pop(),d=[];return l.push((f,h,m,v,b,x,T)=>{c(f,h,m,v,b,x,T)&&d.push(f)}),this[o].apply(this,l),d};const u="reduce"+t[0].toUpperCase()+t.slice(1);n.prototype[u]=function(){let l=Array.prototype.slice.call(arguments);if(l.length<2||l.length>4)throw new Q(`Graph.${u}: invalid number of arguments (expecting 2, 3 or 4 and got ${l.length}).`);if(typeof l[l.length-1]=="function"&&typeof l[l.length-2]!="function")throw new Q(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let c,d;l.length===2?(c=l[0],d=l[1],l=[]):l.length===3?(c=l[1],d=l[2],l=[l[0]]):l.length===4&&(c=l[2],d=l[3],l=[l[0],l[1]]);let f=d;return l.push((h,m,v,b,x,T,E)=>{f=c(f,h,m,v,b,x,T,E)}),this[o].apply(this,l),f}}function Ml(n,r){const{name:t,type:e,direction:i}=r,o="find"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[o]=function(u,l,c){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return!1;if(arguments.length===1)return c=u,qo(!0,this,e,c);if(arguments.length===2){u=""+u,c=l;const d=this._nodes.get(u);if(typeof d>"u")throw new K(`Graph.${o}: could not find the "${u}" node in the graph.`);return bn(!0,this.multi,e==="mixed"?this.type:e,i,d,c)}if(arguments.length===3){u=""+u,l=""+l;const d=this._nodes.get(u);if(!d)throw new K(`Graph.${o}:  could not find the "${u}" source node in the graph.`);if(!this._nodes.has(l))throw new K(`Graph.${o}:  could not find the "${l}" target node in the graph.`);return _n(!0,e,this.multi,i,d,l,c)}throw new Q(`Graph.${o}: too many arguments (expecting 1, 2 or 3 and got ${arguments.length}).`)};const a="some"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[a]=function(){const u=Array.prototype.slice.call(arguments),l=u.pop();return u.push((d,f,h,m,v,b,x)=>l(d,f,h,m,v,b,x)),!!this[o].apply(this,u)};const s="every"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[s]=function(){const u=Array.prototype.slice.call(arguments),l=u.pop();return u.push((d,f,h,m,v,b,x)=>!l(d,f,h,m,v,b,x)),!this[o].apply(this,u)}}function Ul(n,r){const{name:t,type:e,direction:i}=r,o=t.slice(0,-1)+"Entries";n.prototype[o]=function(a,s){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return Et();if(!arguments.length)return Pl(this,e);if(arguments.length===1){a=""+a;const u=this._nodes.get(a);if(!u)throw new K(`Graph.${o}: could not find the "${a}" node in the graph.`);return Ol(e,i,u)}if(arguments.length===2){a=""+a,s=""+s;const u=this._nodes.get(a);if(!u)throw new K(`Graph.${o}:  could not find the "${a}" source node in the graph.`);if(!this._nodes.has(s))throw new K(`Graph.${o}:  could not find the "${s}" target node in the graph.`);return zl(e,i,u,s)}throw new Q(`Graph.${o}: too many arguments (expecting 0, 1 or 2 and got ${arguments.length}).`)}}function jl(n){Cl.forEach(r=>{Fl(n,r),$l(n,r),Ml(n,r),Ul(n,r)})}const Hl=[{name:"neighbors",type:"mixed"},{name:"inNeighbors",type:"directed",direction:"in"},{name:"outNeighbors",type:"directed",direction:"out"},{name:"inboundNeighbors",type:"mixed",direction:"in"},{name:"outboundNeighbors",type:"mixed",direction:"out"},{name:"directedNeighbors",type:"directed"},{name:"undirectedNeighbors",type:"undirected"}];function fr(){this.A=null,this.B=null}fr.prototype.wrap=function(n){this.A===null?this.A=n:this.B===null&&(this.B=n)};fr.prototype.has=function(n){return this.A!==null&&n in this.A||this.B!==null&&n in this.B};function kt(n,r,t,e,i){for(const o in e){const a=e[o],s=a.source,u=a.target,l=s===t?u:s;if(r&&r.has(l.key))continue;const c=i(l.key,l.attributes);if(n&&c)return l.key}}function wn(n,r,t,e,i){if(r!=="mixed"){if(r==="undirected")return kt(n,null,e,e.undirected,i);if(typeof t=="string")return kt(n,null,e,e[t],i)}const o=new fr;let a;if(r!=="undirected"){if(t!=="out"){if(a=kt(n,null,e,e.in,i),n&&a)return a;o.wrap(e.in)}if(t!=="in"){if(a=kt(n,o,e,e.out,i),n&&a)return a;o.wrap(e.out)}}if(r!=="directed"&&(a=kt(n,o,e,e.undirected,i),n&&a))return a}function Wl(n,r,t){if(n!=="mixed"){if(n==="undirected")return Object.keys(t.undirected);if(typeof r=="string")return Object.keys(t[r])}const e=[];return wn(!1,n,r,t,function(i){e.push(i)}),e}function Lt(n,r,t){const e=Object.keys(t),i=e.length;let o=0;return{[Symbol.iterator](){return this},next(){let a=null;do{if(o>=i)return n&&n.wrap(t),{done:!0};const s=t[e[o++]],u=s.source,l=s.target;if(a=u===r?l:u,n&&n.has(a.key)){a=null;continue}}while(a===null);return{done:!1,value:{neighbor:a.key,attributes:a.attributes}}}}}function Bl(n,r,t){if(n!=="mixed"){if(n==="undirected")return Lt(null,t,t.undirected);if(typeof r=="string")return Lt(null,t,t[r])}let e=Et();const i=new fr;return n!=="undirected"&&(r!=="out"&&(e=Ve(e,Lt(i,t,t.in))),r!=="in"&&(e=Ve(e,Lt(i,t,t.out)))),n!=="directed"&&(e=Ve(e,Lt(i,t,t.undirected))),e}function Vl(n,r){const{name:t,type:e,direction:i}=r;n.prototype[t]=function(o){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return[];o=""+o;const a=this._nodes.get(o);if(typeof a>"u")throw new K(`Graph.${t}: could not find the "${o}" node in the graph.`);return Wl(e==="mixed"?this.type:e,i,a)}}function ql(n,r){const{name:t,type:e,direction:i}=r,o="forEach"+t[0].toUpperCase()+t.slice(1,-1);n.prototype[o]=function(l,c){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return;l=""+l;const d=this._nodes.get(l);if(typeof d>"u")throw new K(`Graph.${o}: could not find the "${l}" node in the graph.`);wn(!1,e==="mixed"?this.type:e,i,d,c)};const a="map"+t[0].toUpperCase()+t.slice(1);n.prototype[a]=function(l,c){const d=[];return this[o](l,(f,h)=>{d.push(c(f,h))}),d};const s="filter"+t[0].toUpperCase()+t.slice(1);n.prototype[s]=function(l,c){const d=[];return this[o](l,(f,h)=>{c(f,h)&&d.push(f)}),d};const u="reduce"+t[0].toUpperCase()+t.slice(1);n.prototype[u]=function(l,c,d){if(arguments.length<3)throw new Q(`Graph.${u}: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.`);let f=d;return this[o](l,(h,m)=>{f=c(f,h,m)}),f}}function Xl(n,r){const{name:t,type:e,direction:i}=r,o=t[0].toUpperCase()+t.slice(1,-1),a="find"+o;n.prototype[a]=function(l,c){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return;l=""+l;const d=this._nodes.get(l);if(typeof d>"u")throw new K(`Graph.${a}: could not find the "${l}" node in the graph.`);return wn(!0,e==="mixed"?this.type:e,i,d,c)};const s="some"+o;n.prototype[s]=function(l,c){return!!this[a](l,c)};const u="every"+o;n.prototype[u]=function(l,c){return!this[a](l,(f,h)=>!c(f,h))}}function Yl(n,r){const{name:t,type:e,direction:i}=r,o=t.slice(0,-1)+"Entries";n.prototype[o]=function(a){if(e!=="mixed"&&this.type!=="mixed"&&e!==this.type)return Et();a=""+a;const s=this._nodes.get(a);if(typeof s>"u")throw new K(`Graph.${o}: could not find the "${a}" node in the graph.`);return Bl(e==="mixed"?this.type:e,i,s)}}function Kl(n){Hl.forEach(r=>{Vl(n,r),ql(n,r),Xl(n,r),Yl(n,r)})}function Qt(n,r,t,e,i){const o=e._nodes.values(),a=e.type;let s,u,l,c,d,f;for(;s=o.next(),s.done!==!0;){let h=!1;if(u=s.value,a!=="undirected"){c=u.out;for(l in c){d=c[l];do f=d.target,h=!0,i(u.key,f.key,u.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}if(a!=="directed"){c=u.undirected;for(l in c)if(!(r&&u.key>l)){d=c[l];do f=d.target,f.key!==l&&(f=d.source),h=!0,i(u.key,f.key,u.attributes,f.attributes,d.key,d.attributes,d.undirected),d=d.next;while(d)}}t&&!h&&i(u.key,null,u.attributes,null,null,null,null)}}function Zl(n,r){const t={key:n};return Mo(r.attributes)||(t.attributes=ve({},r.attributes)),t}function Jl(n,r,t){const e={key:r,source:t.source.key,target:t.target.key};return Mo(t.attributes)||(e.attributes=ve({},t.attributes)),n==="mixed"&&t.undirected&&(e.undirected=!0),e}function Ql(n){if(!be(n))throw new Q('Graph.import: invalid serialized node. A serialized node should be a plain object with at least a "key" property.');if(!("key"in n))throw new Q("Graph.import: serialized node is missing its key.");if("attributes"in n&&(!be(n.attributes)||n.attributes===null))throw new Q("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.")}function ec(n){if(!be(n))throw new Q('Graph.import: invalid serialized edge. A serialized edge should be a plain object with at least a "source" & "target" property.');if(!("source"in n))throw new Q("Graph.import: serialized edge is missing its source.");if(!("target"in n))throw new Q("Graph.import: serialized edge is missing its target.");if("attributes"in n&&(!be(n.attributes)||n.attributes===null))throw new Q("Graph.import: invalid attributes. Attributes should be a plain object, null or omitted.");if("undirected"in n&&typeof n.undirected!="boolean")throw new Q("Graph.import: invalid undirectedness information. Undirected should be boolean or omitted.")}const tc=nl(),rc=new Set(["directed","undirected","mixed"]),di=new Set(["domain","_events","_eventsCount","_maxListeners"]),nc=[{name:n=>`${n}Edge`,generateKey:!0},{name:n=>`${n}DirectedEdge`,generateKey:!0,type:"directed"},{name:n=>`${n}UndirectedEdge`,generateKey:!0,type:"undirected"},{name:n=>`${n}EdgeWithKey`},{name:n=>`${n}DirectedEdgeWithKey`,type:"directed"},{name:n=>`${n}UndirectedEdgeWithKey`,type:"undirected"}],ic={allowSelfLoops:!0,multi:!1,type:"mixed"};function oc(n,r,t){if(t&&!be(t))throw new Q(`Graph.addNode: invalid attributes. Expecting an object but got "${t}"`);if(r=""+r,t=t||{},n._nodes.has(r))throw new se(`Graph.addNode: the "${r}" node already exist in the graph.`);const e=new n.NodeDataClass(r,t);return n._nodes.set(r,e),n.emit("nodeAdded",{key:r,attributes:t}),e}function hi(n,r,t){const e=new n.NodeDataClass(r,t);return n._nodes.set(r,e),n.emit("nodeAdded",{key:r,attributes:t}),e}function Xo(n,r,t,e,i,o,a,s){if(!e&&n.type==="undirected")throw new se(`Graph.${r}: you cannot add a directed edge to an undirected graph. Use the #.addEdge or #.addUndirectedEdge instead.`);if(e&&n.type==="directed")throw new se(`Graph.${r}: you cannot add an undirected edge to a directed graph. Use the #.addEdge or #.addDirectedEdge instead.`);if(s&&!be(s))throw new Q(`Graph.${r}: invalid attributes. Expecting an object but got "${s}"`);if(o=""+o,a=""+a,s=s||{},!n.allowSelfLoops&&o===a)throw new se(`Graph.${r}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);const u=n._nodes.get(o),l=n._nodes.get(a);if(!u)throw new K(`Graph.${r}: source node "${o}" not found.`);if(!l)throw new K(`Graph.${r}: target node "${a}" not found.`);const c={key:null,undirected:e,source:o,target:a,attributes:s};if(t)i=n._edgeKeyGenerator();else if(i=""+i,n._edges.has(i))throw new se(`Graph.${r}: the "${i}" edge already exists in the graph.`);if(!n.multi&&(e?typeof u.undirected[a]<"u":typeof u.out[a]<"u"))throw new se(`Graph.${r}: an edge linking "${o}" to "${a}" already exists. If you really want to add multiple edges linking those nodes, you should create a multi graph by using the 'multi' option.`);const d=new Tt(e,i,u,l,s);n._edges.set(i,d);const f=o===a;return e?(u.undirectedDegree++,l.undirectedDegree++,f&&(u.undirectedLoops++,n._undirectedSelfLoopCount++)):(u.outDegree++,l.inDegree++,f&&(u.directedLoops++,n._directedSelfLoopCount++)),n.multi?d.attachMulti():d.attach(),e?n._undirectedSize++:n._directedSize++,c.key=i,n.emit("edgeAdded",c),i}function ac(n,r,t,e,i,o,a,s,u){if(!e&&n.type==="undirected")throw new se(`Graph.${r}: you cannot merge/update a directed edge to an undirected graph. Use the #.mergeEdge/#.updateEdge or #.addUndirectedEdge instead.`);if(e&&n.type==="directed")throw new se(`Graph.${r}: you cannot merge/update an undirected edge to a directed graph. Use the #.mergeEdge/#.updateEdge or #.addDirectedEdge instead.`);if(s){if(u){if(typeof s!="function")throw new Q(`Graph.${r}: invalid updater function. Expecting a function but got "${s}"`)}else if(!be(s))throw new Q(`Graph.${r}: invalid attributes. Expecting an object but got "${s}"`)}o=""+o,a=""+a;let l;if(u&&(l=s,s=void 0),!n.allowSelfLoops&&o===a)throw new se(`Graph.${r}: source & target are the same ("${o}"), thus creating a loop explicitly forbidden by this graph 'allowSelfLoops' option set to false.`);let c=n._nodes.get(o),d=n._nodes.get(a),f,h;if(!t&&(f=n._edges.get(i),f)){if((f.source.key!==o||f.target.key!==a)&&(!e||f.source.key!==a||f.target.key!==o))throw new se(`Graph.${r}: inconsistency detected when attempting to merge the "${i}" edge with "${o}" source & "${a}" target vs. ("${f.source.key}", "${f.target.key}").`);h=f}if(!h&&!n.multi&&c&&(h=e?c.undirected[a]:c.out[a]),h){const T=[h.key,!1,!1,!1];if(u?!l:!s)return T;if(u){const E=h.attributes;h.attributes=l(E),n.emit("edgeAttributesUpdated",{type:"replace",key:h.key,attributes:h.attributes})}else ve(h.attributes,s),n.emit("edgeAttributesUpdated",{type:"merge",key:h.key,attributes:h.attributes,data:s});return T}s=s||{},u&&l&&(s=l(s));const m={key:null,undirected:e,source:o,target:a,attributes:s};if(t)i=n._edgeKeyGenerator();else if(i=""+i,n._edges.has(i))throw new se(`Graph.${r}: the "${i}" edge already exists in the graph.`);let v=!1,b=!1;c||(c=hi(n,o,{}),v=!0,o===a&&(d=c,b=!0)),d||(d=hi(n,a,{}),b=!0),f=new Tt(e,i,c,d,s),n._edges.set(i,f);const x=o===a;return e?(c.undirectedDegree++,d.undirectedDegree++,x&&(c.undirectedLoops++,n._undirectedSelfLoopCount++)):(c.outDegree++,d.inDegree++,x&&(c.directedLoops++,n._directedSelfLoopCount++)),n.multi?f.attachMulti():f.attach(),e?n._undirectedSize++:n._directedSize++,m.key=i,n.emit("edgeAdded",m),[i,!0,v,b]}function lt(n,r){n._edges.delete(r.key);const{source:t,target:e,attributes:i}=r,o=r.undirected,a=t===e;o?(t.undirectedDegree--,e.undirectedDegree--,a&&(t.undirectedLoops--,n._undirectedSelfLoopCount--)):(t.outDegree--,e.inDegree--,a&&(t.directedLoops--,n._directedSelfLoopCount--)),n.multi?r.detachMulti():r.detach(),o?n._undirectedSize--:n._directedSize--,n.emit("edgeDropped",{key:r.key,attributes:i,source:t.key,target:e.key,undirected:o})}let he=class un extends hr.EventEmitter{constructor(r){if(super(),r=ve({},ic,r),typeof r.multi!="boolean")throw new Q(`Graph.constructor: invalid 'multi' option. Expecting a boolean but got "${r.multi}".`);if(!rc.has(r.type))throw new Q(`Graph.constructor: invalid 'type' option. Should be one of "mixed", "directed" or "undirected" but got "${r.type}".`);if(typeof r.allowSelfLoops!="boolean")throw new Q(`Graph.constructor: invalid 'allowSelfLoops' option. Expecting a boolean but got "${r.allowSelfLoops}".`);const t=r.type==="mixed"?Uo:r.type==="directed"?jo:Ho;Ce(this,"NodeDataClass",t);const e="geid_"+tc()+"_";let i=0;const o=()=>{let a;do a=e+i++;while(this._edges.has(a));return a};Ce(this,"_attributes",{}),Ce(this,"_nodes",new Map),Ce(this,"_edges",new Map),Ce(this,"_directedSize",0),Ce(this,"_undirectedSize",0),Ce(this,"_directedSelfLoopCount",0),Ce(this,"_undirectedSelfLoopCount",0),Ce(this,"_edgeKeyGenerator",o),Ce(this,"_options",r),di.forEach(a=>Ce(this,a,this[a])),Pe(this,"order",()=>this._nodes.size),Pe(this,"size",()=>this._edges.size),Pe(this,"directedSize",()=>this._directedSize),Pe(this,"undirectedSize",()=>this._undirectedSize),Pe(this,"selfLoopCount",()=>this._directedSelfLoopCount+this._undirectedSelfLoopCount),Pe(this,"directedSelfLoopCount",()=>this._directedSelfLoopCount),Pe(this,"undirectedSelfLoopCount",()=>this._undirectedSelfLoopCount),Pe(this,"multi",this._options.multi),Pe(this,"type",this._options.type),Pe(this,"allowSelfLoops",this._options.allowSelfLoops),Pe(this,"implementation",()=>"graphology")}_resetInstanceCounters(){this._directedSize=0,this._undirectedSize=0,this._directedSelfLoopCount=0,this._undirectedSelfLoopCount=0}hasNode(r){return this._nodes.has(""+r)}hasDirectedEdge(r,t){if(this.type==="undirected")return!1;if(arguments.length===1){const e=""+r,i=this._edges.get(e);return!!i&&!i.undirected}else if(arguments.length===2){r=""+r,t=""+t;const e=this._nodes.get(r);return e?e.out.hasOwnProperty(t):!1}throw new Q(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasUndirectedEdge(r,t){if(this.type==="directed")return!1;if(arguments.length===1){const e=""+r,i=this._edges.get(e);return!!i&&i.undirected}else if(arguments.length===2){r=""+r,t=""+t;const e=this._nodes.get(r);return e?e.undirected.hasOwnProperty(t):!1}throw new Q(`Graph.hasDirectedEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}hasEdge(r,t){if(arguments.length===1){const e=""+r;return this._edges.has(e)}else if(arguments.length===2){r=""+r,t=""+t;const e=this._nodes.get(r);return e?typeof e.out<"u"&&e.out.hasOwnProperty(t)||typeof e.undirected<"u"&&e.undirected.hasOwnProperty(t):!1}throw new Q(`Graph.hasEdge: invalid arity (${arguments.length}, instead of 1 or 2). You can either ask for an edge id or for the existence of an edge between a source & a target.`)}directedEdge(r,t){if(this.type==="undirected")return;if(r=""+r,t=""+t,this.multi)throw new se("Graph.directedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.directedEdges instead.");const e=this._nodes.get(r);if(!e)throw new K(`Graph.directedEdge: could not find the "${r}" source node in the graph.`);if(!this._nodes.has(t))throw new K(`Graph.directedEdge: could not find the "${t}" target node in the graph.`);const i=e.out&&e.out[t]||void 0;if(i)return i.key}undirectedEdge(r,t){if(this.type==="directed")return;if(r=""+r,t=""+t,this.multi)throw new se("Graph.undirectedEdge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.undirectedEdges instead.");const e=this._nodes.get(r);if(!e)throw new K(`Graph.undirectedEdge: could not find the "${r}" source node in the graph.`);if(!this._nodes.has(t))throw new K(`Graph.undirectedEdge: could not find the "${t}" target node in the graph.`);const i=e.undirected&&e.undirected[t]||void 0;if(i)return i.key}edge(r,t){if(this.multi)throw new se("Graph.edge: this method is irrelevant with multigraphs since there might be multiple edges between source & target. See #.edges instead.");r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.edge: could not find the "${r}" source node in the graph.`);if(!this._nodes.has(t))throw new K(`Graph.edge: could not find the "${t}" target node in the graph.`);const i=e.out&&e.out[t]||e.undirected&&e.undirected[t]||void 0;if(i)return i.key}areDirectedNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areDirectedNeighbors: could not find the "${r}" node in the graph.`);return this.type==="undirected"?!1:t in e.in||t in e.out}areOutNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areOutNeighbors: could not find the "${r}" node in the graph.`);return this.type==="undirected"?!1:t in e.out}areInNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areInNeighbors: could not find the "${r}" node in the graph.`);return this.type==="undirected"?!1:t in e.in}areUndirectedNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areUndirectedNeighbors: could not find the "${r}" node in the graph.`);return this.type==="directed"?!1:t in e.undirected}areNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areNeighbors: could not find the "${r}" node in the graph.`);return this.type!=="undirected"&&(t in e.in||t in e.out)||this.type!=="directed"&&t in e.undirected}areInboundNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areInboundNeighbors: could not find the "${r}" node in the graph.`);return this.type!=="undirected"&&t in e.in||this.type!=="directed"&&t in e.undirected}areOutboundNeighbors(r,t){r=""+r,t=""+t;const e=this._nodes.get(r);if(!e)throw new K(`Graph.areOutboundNeighbors: could not find the "${r}" node in the graph.`);return this.type!=="undirected"&&t in e.out||this.type!=="directed"&&t in e.undirected}inDegree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.inDegree: could not find the "${r}" node in the graph.`);return this.type==="undirected"?0:t.inDegree}outDegree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.outDegree: could not find the "${r}" node in the graph.`);return this.type==="undirected"?0:t.outDegree}directedDegree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.directedDegree: could not find the "${r}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree}undirectedDegree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.undirectedDegree: could not find the "${r}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree}inboundDegree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.inboundDegree: could not find the "${r}" node in the graph.`);let e=0;return this.type!=="directed"&&(e+=t.undirectedDegree),this.type!=="undirected"&&(e+=t.inDegree),e}outboundDegree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.outboundDegree: could not find the "${r}" node in the graph.`);let e=0;return this.type!=="directed"&&(e+=t.undirectedDegree),this.type!=="undirected"&&(e+=t.outDegree),e}degree(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.degree: could not find the "${r}" node in the graph.`);let e=0;return this.type!=="directed"&&(e+=t.undirectedDegree),this.type!=="undirected"&&(e+=t.inDegree+t.outDegree),e}inDegreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.inDegreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);return this.type==="undirected"?0:t.inDegree-t.directedLoops}outDegreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.outDegreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);return this.type==="undirected"?0:t.outDegree-t.directedLoops}directedDegreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.directedDegreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);return this.type==="undirected"?0:t.inDegree+t.outDegree-t.directedLoops*2}undirectedDegreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.undirectedDegreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);return this.type==="directed"?0:t.undirectedDegree-t.undirectedLoops*2}inboundDegreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.inboundDegreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);let e=0,i=0;return this.type!=="directed"&&(e+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(e+=t.inDegree,i+=t.directedLoops),e-i}outboundDegreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.outboundDegreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);let e=0,i=0;return this.type!=="directed"&&(e+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(e+=t.outDegree,i+=t.directedLoops),e-i}degreeWithoutSelfLoops(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.degreeWithoutSelfLoops: could not find the "${r}" node in the graph.`);let e=0,i=0;return this.type!=="directed"&&(e+=t.undirectedDegree,i+=t.undirectedLoops*2),this.type!=="undirected"&&(e+=t.inDegree+t.outDegree,i+=t.directedLoops*2),e-i}source(r){r=""+r;const t=this._edges.get(r);if(!t)throw new K(`Graph.source: could not find the "${r}" edge in the graph.`);return t.source.key}target(r){r=""+r;const t=this._edges.get(r);if(!t)throw new K(`Graph.target: could not find the "${r}" edge in the graph.`);return t.target.key}extremities(r){r=""+r;const t=this._edges.get(r);if(!t)throw new K(`Graph.extremities: could not find the "${r}" edge in the graph.`);return[t.source.key,t.target.key]}opposite(r,t){r=""+r,t=""+t;const e=this._edges.get(t);if(!e)throw new K(`Graph.opposite: could not find the "${t}" edge in the graph.`);const i=e.source.key,o=e.target.key;if(r===i)return o;if(r===o)return i;throw new K(`Graph.opposite: the "${r}" node is not attached to the "${t}" edge (${i}, ${o}).`)}hasExtremity(r,t){r=""+r,t=""+t;const e=this._edges.get(r);if(!e)throw new K(`Graph.hasExtremity: could not find the "${r}" edge in the graph.`);return e.source.key===t||e.target.key===t}isUndirected(r){r=""+r;const t=this._edges.get(r);if(!t)throw new K(`Graph.isUndirected: could not find the "${r}" edge in the graph.`);return t.undirected}isDirected(r){r=""+r;const t=this._edges.get(r);if(!t)throw new K(`Graph.isDirected: could not find the "${r}" edge in the graph.`);return!t.undirected}isSelfLoop(r){r=""+r;const t=this._edges.get(r);if(!t)throw new K(`Graph.isSelfLoop: could not find the "${r}" edge in the graph.`);return t.source===t.target}addNode(r,t){return oc(this,r,t).key}mergeNode(r,t){if(t&&!be(t))throw new Q(`Graph.mergeNode: invalid attributes. Expecting an object but got "${t}"`);r=""+r,t=t||{};let e=this._nodes.get(r);return e?(t&&(ve(e.attributes,t),this.emit("nodeAttributesUpdated",{type:"merge",key:r,attributes:e.attributes,data:t})),[r,!1]):(e=new this.NodeDataClass(r,t),this._nodes.set(r,e),this.emit("nodeAdded",{key:r,attributes:t}),[r,!0])}updateNode(r,t){if(t&&typeof t!="function")throw new Q(`Graph.updateNode: invalid updater function. Expecting a function but got "${t}"`);r=""+r;let e=this._nodes.get(r);if(e){if(t){const o=e.attributes;e.attributes=t(o),this.emit("nodeAttributesUpdated",{type:"replace",key:r,attributes:e.attributes})}return[r,!1]}const i=t?t({}):{};return e=new this.NodeDataClass(r,i),this._nodes.set(r,e),this.emit("nodeAdded",{key:r,attributes:i}),[r,!0]}dropNode(r){r=""+r;const t=this._nodes.get(r);if(!t)throw new K(`Graph.dropNode: could not find the "${r}" node in the graph.`);let e;if(this.type!=="undirected"){for(const i in t.out){e=t.out[i];do lt(this,e),e=e.next;while(e)}for(const i in t.in){e=t.in[i];do lt(this,e),e=e.next;while(e)}}if(this.type!=="directed")for(const i in t.undirected){e=t.undirected[i];do lt(this,e),e=e.next;while(e)}this._nodes.delete(r),this.emit("nodeDropped",{key:r,attributes:t.attributes})}dropEdge(r){let t;if(arguments.length>1){const e=""+arguments[0],i=""+arguments[1];if(t=ke(this,e,i,this.type),!t)throw new K(`Graph.dropEdge: could not find the "${e}" -> "${i}" edge in the graph.`)}else if(r=""+r,t=this._edges.get(r),!t)throw new K(`Graph.dropEdge: could not find the "${r}" edge in the graph.`);return lt(this,t),this}dropDirectedEdge(r,t){if(arguments.length<2)throw new se("Graph.dropDirectedEdge: it does not make sense to try and drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new se("Graph.dropDirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");r=""+r,t=""+t;const e=ke(this,r,t,"directed");if(!e)throw new K(`Graph.dropDirectedEdge: could not find a "${r}" -> "${t}" edge in the graph.`);return lt(this,e),this}dropUndirectedEdge(r,t){if(arguments.length<2)throw new se("Graph.dropUndirectedEdge: it does not make sense to drop a directed edge by key. What if the edge with this key is undirected? Use #.dropEdge for this purpose instead.");if(this.multi)throw new se("Graph.dropUndirectedEdge: cannot use a {source,target} combo when dropping an edge in a MultiGraph since we cannot infer the one you want to delete as there could be multiple ones.");const e=ke(this,r,t,"undirected");if(!e)throw new K(`Graph.dropUndirectedEdge: could not find a "${r}" -> "${t}" edge in the graph.`);return lt(this,e),this}clear(){this._edges.clear(),this._nodes.clear(),this._resetInstanceCounters(),this.emit("cleared")}clearEdges(){const r=this._nodes.values();let t;for(;t=r.next(),t.done!==!0;)t.value.clear();this._edges.clear(),this._resetInstanceCounters(),this.emit("edgesCleared")}getAttribute(r){return this._attributes[r]}getAttributes(){return this._attributes}hasAttribute(r){return this._attributes.hasOwnProperty(r)}setAttribute(r,t){return this._attributes[r]=t,this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:r}),this}updateAttribute(r,t){if(typeof t!="function")throw new Q("Graph.updateAttribute: updater should be a function.");const e=this._attributes[r];return this._attributes[r]=t(e),this.emit("attributesUpdated",{type:"set",attributes:this._attributes,name:r}),this}removeAttribute(r){return delete this._attributes[r],this.emit("attributesUpdated",{type:"remove",attributes:this._attributes,name:r}),this}replaceAttributes(r){if(!be(r))throw new Q("Graph.replaceAttributes: provided attributes are not a plain object.");return this._attributes=r,this.emit("attributesUpdated",{type:"replace",attributes:this._attributes}),this}mergeAttributes(r){if(!be(r))throw new Q("Graph.mergeAttributes: provided attributes are not a plain object.");return ve(this._attributes,r),this.emit("attributesUpdated",{type:"merge",attributes:this._attributes,data:r}),this}updateAttributes(r){if(typeof r!="function")throw new Q("Graph.updateAttributes: provided updater is not a function.");return this._attributes=r(this._attributes),this.emit("attributesUpdated",{type:"update",attributes:this._attributes}),this}updateEachNodeAttributes(r,t){if(typeof r!="function")throw new Q("Graph.updateEachNodeAttributes: expecting an updater function.");if(t&&!ci(t))throw new Q("Graph.updateEachNodeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const e=this._nodes.values();let i,o;for(;i=e.next(),i.done!==!0;)o=i.value,o.attributes=r(o.key,o.attributes);this.emit("eachNodeAttributesUpdated",{hints:t||null})}updateEachEdgeAttributes(r,t){if(typeof r!="function")throw new Q("Graph.updateEachEdgeAttributes: expecting an updater function.");if(t&&!ci(t))throw new Q("Graph.updateEachEdgeAttributes: invalid hints. Expecting an object having the following shape: {attributes?: [string]}");const e=this._edges.values();let i,o,a,s;for(;i=e.next(),i.done!==!0;)o=i.value,a=o.source,s=o.target,o.attributes=r(o.key,o.attributes,a.key,s.key,a.attributes,s.attributes,o.undirected);this.emit("eachEdgeAttributesUpdated",{hints:t||null})}forEachAdjacencyEntry(r){if(typeof r!="function")throw new Q("Graph.forEachAdjacencyEntry: expecting a callback.");Qt(!1,!1,!1,this,r)}forEachAdjacencyEntryWithOrphans(r){if(typeof r!="function")throw new Q("Graph.forEachAdjacencyEntryWithOrphans: expecting a callback.");Qt(!1,!1,!0,this,r)}forEachAssymetricAdjacencyEntry(r){if(typeof r!="function")throw new Q("Graph.forEachAssymetricAdjacencyEntry: expecting a callback.");Qt(!1,!0,!1,this,r)}forEachAssymetricAdjacencyEntryWithOrphans(r){if(typeof r!="function")throw new Q("Graph.forEachAssymetricAdjacencyEntryWithOrphans: expecting a callback.");Qt(!1,!0,!0,this,r)}nodes(){return Array.from(this._nodes.keys())}forEachNode(r){if(typeof r!="function")throw new Q("Graph.forEachNode: expecting a callback.");const t=this._nodes.values();let e,i;for(;e=t.next(),e.done!==!0;)i=e.value,r(i.key,i.attributes)}findNode(r){if(typeof r!="function")throw new Q("Graph.findNode: expecting a callback.");const t=this._nodes.values();let e,i;for(;e=t.next(),e.done!==!0;)if(i=e.value,r(i.key,i.attributes))return i.key}mapNodes(r){if(typeof r!="function")throw new Q("Graph.mapNode: expecting a callback.");const t=this._nodes.values();let e,i;const o=new Array(this.order);let a=0;for(;e=t.next(),e.done!==!0;)i=e.value,o[a++]=r(i.key,i.attributes);return o}someNode(r){if(typeof r!="function")throw new Q("Graph.someNode: expecting a callback.");const t=this._nodes.values();let e,i;for(;e=t.next(),e.done!==!0;)if(i=e.value,r(i.key,i.attributes))return!0;return!1}everyNode(r){if(typeof r!="function")throw new Q("Graph.everyNode: expecting a callback.");const t=this._nodes.values();let e,i;for(;e=t.next(),e.done!==!0;)if(i=e.value,!r(i.key,i.attributes))return!1;return!0}filterNodes(r){if(typeof r!="function")throw new Q("Graph.filterNodes: expecting a callback.");const t=this._nodes.values();let e,i;const o=[];for(;e=t.next(),e.done!==!0;)i=e.value,r(i.key,i.attributes)&&o.push(i.key);return o}reduceNodes(r,t){if(typeof r!="function")throw new Q("Graph.reduceNodes: expecting a callback.");if(arguments.length<2)throw new Q("Graph.reduceNodes: missing initial value. You must provide it because the callback takes more than one argument and we cannot infer the initial value from the first iteration, as you could with a simple array.");let e=t;const i=this._nodes.values();let o,a;for(;o=i.next(),o.done!==!0;)a=o.value,e=r(e,a.key,a.attributes);return e}nodeEntries(){const r=this._nodes.values();return{[Symbol.iterator](){return this},next(){const t=r.next();if(t.done)return t;const e=t.value;return{value:{node:e.key,attributes:e.attributes},done:!1}}}}export(){const r=new Array(this._nodes.size);let t=0;this._nodes.forEach((i,o)=>{r[t++]=Zl(o,i)});const e=new Array(this._edges.size);return t=0,this._edges.forEach((i,o)=>{e[t++]=Jl(this.type,o,i)}),{options:{type:this.type,multi:this.multi,allowSelfLoops:this.allowSelfLoops},attributes:this.getAttributes(),nodes:r,edges:e}}import(r,t=!1){if(r instanceof un)return r.forEachNode((u,l)=>{t?this.mergeNode(u,l):this.addNode(u,l)}),r.forEachEdge((u,l,c,d,f,h,m)=>{t?m?this.mergeUndirectedEdgeWithKey(u,c,d,l):this.mergeDirectedEdgeWithKey(u,c,d,l):m?this.addUndirectedEdgeWithKey(u,c,d,l):this.addDirectedEdgeWithKey(u,c,d,l)}),this;if(!be(r))throw new Q("Graph.import: invalid argument. Expecting a serialized graph or, alternatively, a Graph instance.");if(r.attributes){if(!be(r.attributes))throw new Q("Graph.import: invalid attributes. Expecting a plain object.");t?this.mergeAttributes(r.attributes):this.replaceAttributes(r.attributes)}let e,i,o,a,s;if(r.nodes){if(o=r.nodes,!Array.isArray(o))throw new Q("Graph.import: invalid nodes. Expecting an array.");for(e=0,i=o.length;e<i;e++){a=o[e],Ql(a);const{key:u,attributes:l}=a;t?this.mergeNode(u,l):this.addNode(u,l)}}if(r.edges){let u=!1;if(this.type==="undirected"&&(u=!0),o=r.edges,!Array.isArray(o))throw new Q("Graph.import: invalid edges. Expecting an array.");for(e=0,i=o.length;e<i;e++){s=o[e],ec(s);const{source:l,target:c,attributes:d,undirected:f=u}=s;let h;"key"in s?(h=t?f?this.mergeUndirectedEdgeWithKey:this.mergeDirectedEdgeWithKey:f?this.addUndirectedEdgeWithKey:this.addDirectedEdgeWithKey,h.call(this,s.key,l,c,d)):(h=t?f?this.mergeUndirectedEdge:this.mergeDirectedEdge:f?this.addUndirectedEdge:this.addDirectedEdge,h.call(this,l,c,d))}}return this}nullCopy(r){const t=new un(ve({},this._options,r));return t.replaceAttributes(ve({},this.getAttributes())),t}emptyCopy(r){const t=this.nullCopy(r);return this._nodes.forEach((e,i)=>{const o=ve({},e.attributes);e=new t.NodeDataClass(i,o),t._nodes.set(i,e)}),t}copy(r){if(r=r||{},typeof r.type=="string"&&r.type!==this.type&&r.type!=="mixed")throw new se(`Graph.copy: cannot create an incompatible copy from "${this.type}" type to "${r.type}" because this would mean losing information about the current graph.`);if(typeof r.multi=="boolean"&&r.multi!==this.multi&&r.multi!==!0)throw new se("Graph.copy: cannot create an incompatible copy by downgrading a multi graph to a simple one because this would mean losing information about the current graph.");if(typeof r.allowSelfLoops=="boolean"&&r.allowSelfLoops!==this.allowSelfLoops&&r.allowSelfLoops!==!0)throw new se("Graph.copy: cannot create an incompatible copy from a graph allowing self loops to one that does not because this would mean losing information about the current graph.");const t=this.emptyCopy(r),e=this._edges.values();let i,o;for(;i=e.next(),i.done!==!0;)o=i.value,Xo(t,"copy",!1,o.undirected,o.key,o.source.key,o.target.key,ve({},o.attributes));return t}toJSON(){return this.export()}toString(){return"[object Graph]"}inspect(){const r={};this._nodes.forEach((o,a)=>{r[a]=o.attributes});const t={},e={};this._edges.forEach((o,a)=>{const s=o.undirected?"--":"->";let u="",l=o.source.key,c=o.target.key,d;o.undirected&&l>c&&(d=l,l=c,c=d);const f=`(${l})${s}(${c})`;a.startsWith("geid_")?this.multi&&(typeof e[f]>"u"?e[f]=0:e[f]++,u+=`${e[f]}. `):u+=`[${a}]: `,u+=f,t[u]=o.attributes});const i={};for(const o in this)this.hasOwnProperty(o)&&!di.has(o)&&typeof this[o]!="function"&&typeof o!="symbol"&&(i[o]=this[o]);return i.attributes=this._attributes,i.nodes=r,i.edges=t,Ce(i,"constructor",this.constructor),i}};typeof Symbol<"u"&&(he.prototype[Symbol.for("nodejs.util.inspect.custom")]=he.prototype.inspect);nc.forEach(n=>{["add","merge","update"].forEach(r=>{const t=n.name(r),e=r==="add"?Xo:ac;n.generateKey?he.prototype[t]=function(i,o,a){return e(this,t,!0,(n.type||this.type)==="undirected",null,i,o,a,r==="update")}:he.prototype[t]=function(i,o,a,s){return e(this,t,!1,(n.type||this.type)==="undirected",i,o,a,s,r==="update")}})});vl(he);xl(he);jl(he);Kl(he);class Yo extends he{constructor(r){const t=ve({type:"directed"},r);if("multi"in t&&t.multi!==!1)throw new Q("DirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="directed")throw new Q('DirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Ko extends he{constructor(r){const t=ve({type:"undirected"},r);if("multi"in t&&t.multi!==!1)throw new Q("UndirectedGraph.from: inconsistent indication that the graph should be multi in given options!");if(t.type!=="undirected")throw new Q('UndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Zo extends he{constructor(r){const t=ve({multi:!0},r);if("multi"in t&&t.multi!==!0)throw new Q("MultiGraph.from: inconsistent indication that the graph should be simple in given options!");super(t)}}class Jo extends he{constructor(r){const t=ve({type:"directed",multi:!0},r);if("multi"in t&&t.multi!==!0)throw new Q("MultiDirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="directed")throw new Q('MultiDirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}class Qo extends he{constructor(r){const t=ve({type:"undirected",multi:!0},r);if("multi"in t&&t.multi!==!0)throw new Q("MultiUndirectedGraph.from: inconsistent indication that the graph should be simple in given options!");if(t.type!=="undirected")throw new Q('MultiUndirectedGraph.from: inconsistent "'+t.type+'" type in given options!');super(t)}}function Rt(n){n.from=function(r,t){const e=ve({},r.options,t),i=new n(e);return i.import(r),i}}Rt(he);Rt(Yo);Rt(Ko);Rt(Zo);Rt(Jo);Rt(Qo);he.Graph=he;he.DirectedGraph=Yo;he.UndirectedGraph=Ko;he.MultiGraph=Zo;he.MultiDirectedGraph=Jo;he.MultiUndirectedGraph=Qo;he.InvalidArgumentsGraphError=Q;he.NotFoundGraphError=K;he.UsageGraphError=se;var ct={},Ar,fi;function gr(){if(fi)return Ar;fi=1;function n(t){return!t||typeof t!="object"||typeof t=="function"||Array.isArray(t)||t instanceof Set||t instanceof Map||t instanceof RegExp||t instanceof Date}function r(t,e){t=t||{};var i={};for(var o in e){var a=t[o],s=e[o];if(!n(s)){i[o]=r(a,s);continue}a===void 0?i[o]=s:i[o]=a}return i}return Ar=r,Ar}var kr,gi;function sc(){if(gi)return kr;gi=1;function n(t){return function(e,i){return e+Math.floor(t()*(i-e+1))}}var r=n(Math.random);return r.createRandom=n,kr=r,kr}var Lr,vi;function uc(){if(vi)return Lr;vi=1;var n=sc().createRandom;function r(e){var i=n(e);return function(o){for(var a=o.length,s=a-1,u=-1;++u<a;){var l=i(u,s),c=o[l];o[l]=o[u],o[u]=c}}}var t=r(Math.random);return t.createShuffleInPlace=r,Lr=t,Lr}var Dr,pi;function lc(){if(pi)return Dr;pi=1;var n=gr(),r=at(),t=uc(),e={attributes:{x:"x",y:"y"},center:0,hierarchyAttributes:[],rng:Math.random,scale:1};function i(y,C,S,D,G){this.wrappedCircle=G||null,this.children={},this.countChildren=0,this.id=y||null,this.next=null,this.previous=null,this.x=C||null,this.y=S||null,G?this.r=1010101:this.r=D||999}i.prototype.hasChildren=function(){return this.countChildren>0},i.prototype.addChild=function(y,C){this.children[y]=C,++this.countChildren},i.prototype.getChild=function(y){if(!this.children.hasOwnProperty(y)){var C=new i;this.children[y]=C,++this.countChildren}return this.children[y]},i.prototype.applyPositionToChildren=function(){if(this.hasChildren()){var y=this;for(var C in y.children){var S=y.children[C];S.x+=y.x,S.y+=y.y,S.applyPositionToChildren()}}};function o(y,C,S){for(var D in C.children){var G=C.children[D];G.hasChildren()?o(y,G,S):S[G.id]={x:G.x,y:G.y}}}function a(y,C){var S=y.r-C.r,D=C.x-y.x,G=C.y-y.y;return S<0||S*S<D*D+G*G}function s(y,C){var S=y.r-C.r+1e-6,D=C.x-y.x,G=C.y-y.y;return S>0&&S*S>D*D+G*G}function u(y,C){for(var S=0;S<C.length;++S)if(!s(y,C[S]))return!1;return!0}function l(y){return new i(null,y.x,y.y,y.r)}function c(y,C){var S=y.x,D=y.y,G=y.r,O=C.x,R=C.y,H=C.r,$=O-S,w=R-D,p=H-G,g=Math.sqrt($*$+w*w);return new i(null,(S+O+$/g*p)/2,(D+R+w/g*p)/2,(g+G+H)/2)}function d(y,C,S){var D=y.x,G=y.y,O=y.r,R=C.x,H=C.y,$=C.r,w=S.x,p=S.y,g=S.r,z=D-R,M=D-w,P=G-H,k=G-p,F=$-O,B=g-O,Y=D*D+G*G-O*O,ee=Y-R*R-H*H+$*$,q=Y-w*w-p*p+g*g,W=M*P-z*k,oe=(P*q-k*ee)/(W*2)-D,Z=(k*F-P*B)/W,ne=(M*ee-z*q)/(W*2)-G,te=(z*B-M*F)/W,ce=Z*Z+te*te-1,J=2*(O+oe*Z+ne*te),X=oe*oe+ne*ne-O*O,N=-(ce?(J+Math.sqrt(J*J-4*ce*X))/(2*ce):X/J);return new i(null,D+oe+Z*N,G+ne+te*N,N)}function f(y){switch(y.length){case 1:return l(y[0]);case 2:return c(y[0],y[1]);case 3:return d(y[0],y[1],y[2]);default:throw new Error("graphology-layout/circlepack: Invalid basis length "+y.length)}}function h(y,C){var S,D;if(u(C,y))return[C];for(S=0;S<y.length;++S)if(a(C,y[S])&&u(c(y[S],C),y))return[y[S],C];for(S=0;S<y.length-1;++S)for(D=S+1;D<y.length;++D)if(a(c(y[S],y[D]),C)&&a(c(y[S],C),y[D])&&a(c(y[D],C),y[S])&&u(d(y[S],y[D],C),y))return[y[S],y[D],C];throw new Error("graphology-layout/circlepack: extendBasis failure !")}function m(y){var C=y.wrappedCircle,S=y.next.wrappedCircle,D=C.r+S.r,G=(C.x*S.r+S.x*C.r)/D,O=(C.y*S.r+S.y*C.r)/D;return G*G+O*O}function v(y,C){var S=0,D=y.slice(),G=y.length,O=[],R,H;for(C(D);S<G;)R=D[S],H&&s(H,R)?++S:(O=h(O,R),H=f(O),S=0);return H}function b(y,C,S){var D=y.x-C.x,G,O,R=y.y-C.y,H,$,w=D*D+R*R;w?(O=C.r+S.r,O*=O,$=y.r+S.r,$*=$,O>$?(G=(w+$-O)/(2*w),H=Math.sqrt(Math.max(0,$/w-G*G)),S.x=y.x-G*D-H*R,S.y=y.y-G*R+H*D):(G=(w+O-$)/(2*w),H=Math.sqrt(Math.max(0,O/w-G*G)),S.x=C.x+G*D-H*R,S.y=C.y+G*R+H*D)):(S.x=C.x+S.r,S.y=C.y)}function x(y,C){var S=y.r+C.r-1e-6,D=C.x-y.x,G=C.y-y.y;return S>0&&S*S>D*D+G*G}function T(y,C){var S=y.length;if(S===0)return 0;var D,G,O,R,H,$,w,p,g,z;if(D=y[0],D.x=0,D.y=0,S<=1)return D.r;if(G=y[1],D.x=-G.r,G.x=D.r,G.y=0,S<=2)return D.r+G.r;O=y[2],b(G,D,O),D=new i(null,null,null,null,D),G=new i(null,null,null,null,G),O=new i(null,null,null,null,O),D.next=O.previous=G,G.next=D.previous=O,O.next=G.previous=D;e:for($=3;$<S;++$){O=y[$],b(D.wrappedCircle,G.wrappedCircle,O),O=new i(null,null,null,null,O),w=G.next,p=D.previous,g=G.wrappedCircle.r,z=D.wrappedCircle.r;do if(g<=z){if(x(w.wrappedCircle,O.wrappedCircle)){G=w,D.next=G,G.previous=D,--$;continue e}g+=w.wrappedCircle.r,w=w.next}else{if(x(p.wrappedCircle,O.wrappedCircle)){D=p,D.next=G,G.previous=D,--$;continue e}z+=p.wrappedCircle.r,p=p.previous}while(w!==p.next);for(O.previous=D,O.next=G,D.next=G.previous=G=O,R=m(D);(O=O.next)!==G;)(H=m(O))<R&&(D=O,R=H);G=D.next}D=[G.wrappedCircle],O=G;for(var M=1e4;(O=O.next)!==G&&--M!==0;)D.push(O.wrappedCircle);for(O=v(D,C),$=0;$<S;++$)D=y[$],D.x-=O.x,D.y-=O.y;return O.r}function E(y,C){var S=0;if(y.hasChildren()){for(var D in y.children){var G=y.children[D];G.hasChildren()&&(G.r=E(G,C))}S=T(Object.values(y.children),C)}return S}function _(y,C){E(y,C);for(var S in y.children){var D=y.children[S];D.applyPositionToChildren()}}function A(y,C,S){if(!r(C))throw new Error("graphology-layout/circlepack: the given graph is not a valid graphology instance.");S=n(S,e);var D={},G={},O=C.nodes(),R=S.center,H=S.hierarchyAttributes,$=t.createShuffleInPlace(S.rng),w=S.scale,p=new i;C.forEachNode(function(F,B){var Y=B.size?B.size:1,ee=new i(F,null,null,Y),q=p;H.forEach(function(W){var oe=B[W];q=q.getChild(oe)}),q.addChild(F,ee)}),_(p,$),o(C,p,D);var g=O.length,z,M,P;for(P=0;P<g;P++){var k=O[P];z=R+w*D[k].x,M=R+w*D[k].y,G[k]={x:z,y:M},y&&(C.setNodeAttribute(k,S.attributes.x,z),C.setNodeAttribute(k,S.attributes.y,M))}return G}var L=A.bind(null,!1);return L.assign=A.bind(null,!0),Dr=L,Dr}var Gr,mi;function cc(){if(mi)return Gr;mi=1;var n=gr(),r=at(),t={dimensions:["x","y"],center:.5,scale:1};function e(o,a,s){if(!r(a))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");s=n(s,t);var u=s.dimensions;if(!Array.isArray(u)||u.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");var l=s.center,c=s.scale,d=Math.PI*2,f=(l-.5)*c,h=a.order,m=u[0],v=u[1];function b(E,_){return _[m]=c*Math.cos(E*d/h)+f,_[v]=c*Math.sin(E*d/h)+f,_}var x=0;if(!o){var T={};return a.forEachNode(function(E){T[E]=b(x++,{})}),T}a.updateEachNodeAttributes(function(E,_){return b(x++,_),_},{attributes:u})}var i=e.bind(null,!1);return i.assign=e.bind(null,!0),Gr=i,Gr}var Pr,yi;function dc(){if(yi)return Pr;yi=1;var n=gr(),r=at(),t={dimensions:["x","y"],center:.5,rng:Math.random,scale:1};function e(o,a,s){if(!r(a))throw new Error("graphology-layout/random: the given graph is not a valid graphology instance.");s=n(s,t);var u=s.dimensions;if(!Array.isArray(u)||u.length<1)throw new Error("graphology-layout/random: given dimensions are invalid.");var l=u.length,c=s.center,d=s.rng,f=s.scale,h=(c-.5)*f;function m(b){for(var x=0;x<l;x++)b[u[x]]=d()*f+h;return b}if(!o){var v={};return a.forEachNode(function(b){v[b]=m({})}),v}a.updateEachNodeAttributes(function(b,x){return m(x),x},{attributes:u})}var i=e.bind(null,!1);return i.assign=e.bind(null,!0),Pr=i,Pr}var Nr,bi;function hc(){if(bi)return Nr;bi=1;var n=gr(),r=at(),t=Math.PI/180,e={dimensions:["x","y"],centeredOnZero:!1,degrees:!1};function i(a,s,u,l){if(!r(s))throw new Error("graphology-layout/rotation: the given graph is not a valid graphology instance.");l=n(l,e),l.degrees&&(u*=t);var c=l.dimensions;if(!Array.isArray(c)||c.length!==2)throw new Error("graphology-layout/random: given dimensions are invalid.");if(s.order===0)return a?void 0:{};var d=c[0],f=c[1],h=0,m=0;if(!l.centeredOnZero){var v=1/0,b=-1/0,x=1/0,T=-1/0;s.forEachNode(function(y,C){var S=C[d],D=C[f];S<v&&(v=S),S>b&&(b=S),D<x&&(x=D),D>T&&(T=D)}),h=(v+b)/2,m=(x+T)/2}var E=Math.cos(u),_=Math.sin(u);function A(y){var C=y[d],S=y[f];return y[d]=h+(C-h)*E-(S-m)*_,y[f]=m+(C-h)*_+(S-m)*E,y}if(!a){var L={};return s.forEachNode(function(y,C){var S={};S[d]=C[d],S[f]=C[f],L[y]=A(S)}),L}s.updateEachNodeAttributes(function(y,C){return A(C),C},{attributes:c})}var o=i.bind(null,!1);return o.assign=i.bind(null,!0),Nr=o,Nr}var _i;function fc(){return _i||(_i=1,ct.circlepack=lc(),ct.circular=cc(),ct.random=dc(),ct.rotation=hc()),ct}var wi=fc(),Dt={},Ei;function ea(){if(Ei)return Dt;Ei=1;function n(e){return typeof e!="number"||isNaN(e)?1:e}function r(e,i){var o={},a=function(l){return typeof l>"u"?i:l};typeof i=="function"&&(a=i);var s=function(l){return a(l[e])},u=function(){return a(void 0)};return typeof e=="string"?(o.fromAttributes=s,o.fromGraph=function(l,c){return s(l.getNodeAttributes(c))},o.fromEntry=function(l,c){return s(c)}):typeof e=="function"?(o.fromAttributes=function(){throw new Error("graphology-utils/getters/createNodeValueGetter: irrelevant usage.")},o.fromGraph=function(l,c){return a(e(c,l.getNodeAttributes(c)))},o.fromEntry=function(l,c){return a(e(l,c))}):(o.fromAttributes=u,o.fromGraph=u,o.fromEntry=u),o}function t(e,i){var o={},a=function(l){return typeof l>"u"?i:l};typeof i=="function"&&(a=i);var s=function(l){return a(l[e])},u=function(){return a(void 0)};return typeof e=="string"?(o.fromAttributes=s,o.fromGraph=function(l,c){return s(l.getEdgeAttributes(c))},o.fromEntry=function(l,c){return s(c)},o.fromPartialEntry=o.fromEntry,o.fromMinimalEntry=o.fromEntry):typeof e=="function"?(o.fromAttributes=function(){throw new Error("graphology-utils/getters/createEdgeValueGetter: irrelevant usage.")},o.fromGraph=function(l,c){var d=l.extremities(c);return a(e(c,l.getEdgeAttributes(c),d[0],d[1],l.getNodeAttributes(d[0]),l.getNodeAttributes(d[1]),l.isUndirected(c)))},o.fromEntry=function(l,c,d,f,h,m,v){return a(e(l,c,d,f,h,m,v))},o.fromPartialEntry=function(l,c,d,f){return a(e(l,c,d,f))},o.fromMinimalEntry=function(l,c){return a(e(l,c))}):(o.fromAttributes=u,o.fromGraph=u,o.fromEntry=u,o.fromMinimalEntry=u),o}return Dt.createNodeValueGetter=r,Dt.createEdgeValueGetter=t,Dt.createEdgeWeightGetter=function(e){return t(e,n)},Dt}var Or,Ti;function gc(){if(Ti)return Or;Ti=1;var n=0,r=1,t=2,e=3,i=4,o=5,a=6,s=7,u=8,l=9,c=0,d=1,f=2,h=0,m=1,v=2,b=3,x=4,T=5,E=6,_=7,A=8,L=3,y=10,C=3,S=9,D=10;return Or=function(O,R,H){var $,w,p,g,z,M,P,k,F,B,Y=R.length,ee=H.length,q=O.adjustSizes,W=O.barnesHutTheta*O.barnesHutTheta,oe,Z,ne,te,ce,J,X,N=[];for(p=0;p<Y;p+=y)R[p+i]=R[p+t],R[p+o]=R[p+e],R[p+t]=0,R[p+e]=0;if(O.outboundAttractionDistribution){for(oe=0,p=0;p<Y;p+=y)oe+=R[p+a];oe/=Y/y}if(O.barnesHutOptimize){var le=1/0,Ee=-1/0,ae=1/0,ie=-1/0,U,Te,ze;for(p=0;p<Y;p+=y)le=Math.min(le,R[p+n]),Ee=Math.max(Ee,R[p+n]),ae=Math.min(ae,R[p+r]),ie=Math.max(ie,R[p+r]);var Re=Ee-le,Ge=ie-ae;for(Re>Ge?(ae-=(Re-Ge)/2,ie=ae+Re):(le-=(Ge-Re)/2,Ee=le+Ge),N[0+h]=-1,N[0+m]=(le+Ee)/2,N[0+v]=(ae+ie)/2,N[0+b]=Math.max(Ee-le,ie-ae),N[0+x]=-1,N[0+T]=-1,N[0+E]=0,N[0+_]=0,N[0+A]=0,$=1,p=0;p<Y;p+=y)for(w=0,ze=L;;)if(N[w+T]>=0){R[p+n]<N[w+m]?R[p+r]<N[w+v]?U=N[w+T]:U=N[w+T]+S:R[p+r]<N[w+v]?U=N[w+T]+S*2:U=N[w+T]+S*3,N[w+_]=(N[w+_]*N[w+E]+R[p+n]*R[p+a])/(N[w+E]+R[p+a]),N[w+A]=(N[w+A]*N[w+E]+R[p+r]*R[p+a])/(N[w+E]+R[p+a]),N[w+E]+=R[p+a],w=U;continue}else if(N[w+h]<0){N[w+h]=p;break}else{if(N[w+T]=$*S,k=N[w+b]/2,F=N[w+T],N[F+h]=-1,N[F+m]=N[w+m]-k,N[F+v]=N[w+v]-k,N[F+b]=k,N[F+x]=F+S,N[F+T]=-1,N[F+E]=0,N[F+_]=0,N[F+A]=0,F+=S,N[F+h]=-1,N[F+m]=N[w+m]-k,N[F+v]=N[w+v]+k,N[F+b]=k,N[F+x]=F+S,N[F+T]=-1,N[F+E]=0,N[F+_]=0,N[F+A]=0,F+=S,N[F+h]=-1,N[F+m]=N[w+m]+k,N[F+v]=N[w+v]-k,N[F+b]=k,N[F+x]=F+S,N[F+T]=-1,N[F+E]=0,N[F+_]=0,N[F+A]=0,F+=S,N[F+h]=-1,N[F+m]=N[w+m]+k,N[F+v]=N[w+v]+k,N[F+b]=k,N[F+x]=N[w+x],N[F+T]=-1,N[F+E]=0,N[F+_]=0,N[F+A]=0,$+=4,R[N[w+h]+n]<N[w+m]?R[N[w+h]+r]<N[w+v]?U=N[w+T]:U=N[w+T]+S:R[N[w+h]+r]<N[w+v]?U=N[w+T]+S*2:U=N[w+T]+S*3,N[w+E]=R[N[w+h]+a],N[w+_]=R[N[w+h]+n],N[w+A]=R[N[w+h]+r],N[U+h]=N[w+h],N[w+h]=-1,R[p+n]<N[w+m]?R[p+r]<N[w+v]?Te=N[w+T]:Te=N[w+T]+S:R[p+r]<N[w+v]?Te=N[w+T]+S*2:Te=N[w+T]+S*3,U===Te)if(ze--){w=U;continue}else{ze=L;break}N[Te+h]=p;break}}if(O.barnesHutOptimize)for(Z=O.scalingRatio,p=0;p<Y;p+=y)for(w=0;;)if(N[w+T]>=0)if(J=Math.pow(R[p+n]-N[w+_],2)+Math.pow(R[p+r]-N[w+A],2),B=N[w+b],4*B*B/J<W){if(ne=R[p+n]-N[w+_],te=R[p+r]-N[w+A],q===!0?J>0?(X=Z*R[p+a]*N[w+E]/J,R[p+t]+=ne*X,R[p+e]+=te*X):J<0&&(X=-Z*R[p+a]*N[w+E]/Math.sqrt(J),R[p+t]+=ne*X,R[p+e]+=te*X):J>0&&(X=Z*R[p+a]*N[w+E]/J,R[p+t]+=ne*X,R[p+e]+=te*X),w=N[w+x],w<0)break;continue}else{w=N[w+T];continue}else{if(M=N[w+h],M>=0&&M!==p&&(ne=R[p+n]-R[M+n],te=R[p+r]-R[M+r],J=ne*ne+te*te,q===!0?J>0?(X=Z*R[p+a]*R[M+a]/J,R[p+t]+=ne*X,R[p+e]+=te*X):J<0&&(X=-Z*R[p+a]*R[M+a]/Math.sqrt(J),R[p+t]+=ne*X,R[p+e]+=te*X):J>0&&(X=Z*R[p+a]*R[M+a]/J,R[p+t]+=ne*X,R[p+e]+=te*X)),w=N[w+x],w<0)break;continue}else for(Z=O.scalingRatio,g=0;g<Y;g+=y)for(z=0;z<g;z+=y)ne=R[g+n]-R[z+n],te=R[g+r]-R[z+r],q===!0?(J=Math.sqrt(ne*ne+te*te)-R[g+u]-R[z+u],J>0?(X=Z*R[g+a]*R[z+a]/J/J,R[g+t]+=ne*X,R[g+e]+=te*X,R[z+t]-=ne*X,R[z+e]-=te*X):J<0&&(X=100*Z*R[g+a]*R[z+a],R[g+t]+=ne*X,R[g+e]+=te*X,R[z+t]-=ne*X,R[z+e]-=te*X)):(J=Math.sqrt(ne*ne+te*te),J>0&&(X=Z*R[g+a]*R[z+a]/J/J,R[g+t]+=ne*X,R[g+e]+=te*X,R[z+t]-=ne*X,R[z+e]-=te*X));for(F=O.gravity/O.scalingRatio,Z=O.scalingRatio,p=0;p<Y;p+=y)X=0,ne=R[p+n],te=R[p+r],J=Math.sqrt(Math.pow(ne,2)+Math.pow(te,2)),O.strongGravityMode?J>0&&(X=Z*R[p+a]*F):J>0&&(X=Z*R[p+a]*F/J),R[p+t]-=ne*X,R[p+e]-=te*X;for(Z=1*(O.outboundAttractionDistribution?oe:1),P=0;P<ee;P+=C)g=H[P+c],z=H[P+d],k=H[P+f],ce=Math.pow(k,O.edgeWeightInfluence),ne=R[g+n]-R[z+n],te=R[g+r]-R[z+r],q===!0?(J=Math.sqrt(ne*ne+te*te)-R[g+u]-R[z+u],O.linLogMode?O.outboundAttractionDistribution?J>0&&(X=-Z*ce*Math.log(1+J)/J/R[g+a]):J>0&&(X=-Z*ce*Math.log(1+J)/J):O.outboundAttractionDistribution?J>0&&(X=-Z*ce/R[g+a]):J>0&&(X=-Z*ce)):(J=Math.sqrt(Math.pow(ne,2)+Math.pow(te,2)),O.linLogMode?O.outboundAttractionDistribution?J>0&&(X=-Z*ce*Math.log(1+J)/J/R[g+a]):J>0&&(X=-Z*ce*Math.log(1+J)/J):O.outboundAttractionDistribution?(J=1,X=-Z*ce/R[g+a]):(J=1,X=-Z*ce)),J>0&&(R[g+t]+=ne*X,R[g+e]+=te*X,R[z+t]-=ne*X,R[z+e]-=te*X);var me,Se,Xe,xe,$e,Me;if(q===!0)for(p=0;p<Y;p+=y)R[p+l]!==1&&(me=Math.sqrt(Math.pow(R[p+t],2)+Math.pow(R[p+e],2)),me>D&&(R[p+t]=R[p+t]*D/me,R[p+e]=R[p+e]*D/me),Se=R[p+a]*Math.sqrt((R[p+i]-R[p+t])*(R[p+i]-R[p+t])+(R[p+o]-R[p+e])*(R[p+o]-R[p+e])),Xe=Math.sqrt((R[p+i]+R[p+t])*(R[p+i]+R[p+t])+(R[p+o]+R[p+e])*(R[p+o]+R[p+e]))/2,xe=.1*Math.log(1+Xe)/(1+Math.sqrt(Se)),$e=R[p+n]+R[p+t]*(xe/O.slowDown),R[p+n]=$e,Me=R[p+r]+R[p+e]*(xe/O.slowDown),R[p+r]=Me);else for(p=0;p<Y;p+=y)R[p+l]!==1&&(Se=R[p+a]*Math.sqrt((R[p+i]-R[p+t])*(R[p+i]-R[p+t])+(R[p+o]-R[p+e])*(R[p+o]-R[p+e])),Xe=Math.sqrt((R[p+i]+R[p+t])*(R[p+i]+R[p+t])+(R[p+o]+R[p+e])*(R[p+o]+R[p+e]))/2,xe=R[p+s]*Math.log(1+Xe)/(1+Math.sqrt(Se)),R[p+s]=Math.min(1,Math.sqrt(xe*(Math.pow(R[p+t],2)+Math.pow(R[p+e],2))/(1+Math.sqrt(Se)))),$e=R[p+n]+R[p+t]*(xe/O.slowDown),R[p+n]=$e,Me=R[p+r]+R[p+e]*(xe/O.slowDown),R[p+r]=Me);return{}},Or}var Ue={},Ri;function ta(){if(Ri)return Ue;Ri=1;var n=10,r=3;return Ue.assign=function(t){t=t||{};var e=Array.prototype.slice.call(arguments).slice(1),i,o,a;for(i=0,a=e.length;i<a;i++)if(e[i])for(o in e[i])t[o]=e[i][o];return t},Ue.validateSettings=function(t){return"linLogMode"in t&&typeof t.linLogMode!="boolean"?{message:"the `linLogMode` setting should be a boolean."}:"outboundAttractionDistribution"in t&&typeof t.outboundAttractionDistribution!="boolean"?{message:"the `outboundAttractionDistribution` setting should be a boolean."}:"adjustSizes"in t&&typeof t.adjustSizes!="boolean"?{message:"the `adjustSizes` setting should be a boolean."}:"edgeWeightInfluence"in t&&typeof t.edgeWeightInfluence!="number"?{message:"the `edgeWeightInfluence` setting should be a number."}:"scalingRatio"in t&&!(typeof t.scalingRatio=="number"&&t.scalingRatio>=0)?{message:"the `scalingRatio` setting should be a number >= 0."}:"strongGravityMode"in t&&typeof t.strongGravityMode!="boolean"?{message:"the `strongGravityMode` setting should be a boolean."}:"gravity"in t&&!(typeof t.gravity=="number"&&t.gravity>=0)?{message:"the `gravity` setting should be a number >= 0."}:"slowDown"in t&&!(typeof t.slowDown=="number"||t.slowDown>=0)?{message:"the `slowDown` setting should be a number >= 0."}:"barnesHutOptimize"in t&&typeof t.barnesHutOptimize!="boolean"?{message:"the `barnesHutOptimize` setting should be a boolean."}:"barnesHutTheta"in t&&!(typeof t.barnesHutTheta=="number"&&t.barnesHutTheta>=0)?{message:"the `barnesHutTheta` setting should be a number >= 0."}:null},Ue.graphToByteArrays=function(t,e){var i=t.order,o=t.size,a={},s,u=new Float32Array(i*n),l=new Float32Array(o*r);return s=0,t.forEachNode(function(c,d){a[c]=s,u[s]=d.x,u[s+1]=d.y,u[s+2]=0,u[s+3]=0,u[s+4]=0,u[s+5]=0,u[s+6]=1,u[s+7]=1,u[s+8]=d.size||1,u[s+9]=d.fixed?1:0,s+=n}),s=0,t.forEachEdge(function(c,d,f,h,m,v,b){var x=a[f],T=a[h],E=e(c,d,f,h,m,v,b);u[x+6]+=E,u[T+6]+=E,l[s]=x,l[s+1]=T,l[s+2]=E,s+=r}),{nodes:u,edges:l}},Ue.assignLayoutChanges=function(t,e,i){var o=0;t.updateEachNodeAttributes(function(a,s){return s.x=e[o],s.y=e[o+1],o+=n,i?i(a,s):s})},Ue.readGraphPositions=function(t,e){var i=0;t.forEachNode(function(o,a){e[i]=a.x,e[i+1]=a.y,i+=n})},Ue.collectLayoutChanges=function(t,e,i){for(var o=t.nodes(),a={},s=0,u=0,l=e.length;s<l;s+=n){if(i){var c=Object.assign({},t.getNodeAttributes(o[u]));c.x=e[s],c.y=e[s+1],c=i(o[u],c),a[o[u]]={x:c.x,y:c.y}}else a[o[u]]={x:e[s],y:e[s+1]};u++}return a},Ue.createWorker=function(e){var i=window.URL||window.webkitURL,o=e.toString(),a=i.createObjectURL(new Blob(["("+o+").call(this);"],{type:"text/javascript"})),s=new Worker(a);return i.revokeObjectURL(a),s},Ue}var Ir,Si;function ra(){return Si||(Si=1,Ir={linLogMode:!1,outboundAttractionDistribution:!1,adjustSizes:!1,edgeWeightInfluence:1,scalingRatio:1,strongGravityMode:!1,gravity:1,slowDown:1,barnesHutOptimize:!1,barnesHutTheta:.5}),Ir}var zr,xi;function vc(){if(xi)return zr;xi=1;var n=at(),r=ea().createEdgeWeightGetter,t=gc(),e=ta(),i=ra();function o(u,l,c){if(!n(l))throw new Error("graphology-layout-forceatlas2: the given graph is not a valid graphology instance.");typeof c=="number"&&(c={iterations:c});var d=c.iterations;if(typeof d!="number")throw new Error("graphology-layout-forceatlas2: invalid number of iterations.");if(d<=0)throw new Error("graphology-layout-forceatlas2: you should provide a positive number of iterations.");var f=r("getEdgeWeight"in c?c.getEdgeWeight:"weight").fromEntry,h=typeof c.outputReducer=="function"?c.outputReducer:null,m=e.assign({},i,c.settings),v=e.validateSettings(m);if(v)throw new Error("graphology-layout-forceatlas2: "+v.message);var b=e.graphToByteArrays(l,f),x;for(x=0;x<d;x++)t(m,b.nodes,b.edges);if(u){e.assignLayoutChanges(l,b.nodes,h);return}return e.collectLayoutChanges(l,b.nodes)}function a(u){var l=typeof u=="number"?u:u.order;return{barnesHutOptimize:l>2e3,strongGravityMode:!0,gravity:.05,scalingRatio:10,slowDown:1+Math.log(l)}}var s=o.bind(null,!1);return s.assign=o.bind(null,!0),s.inferSettings=a,zr=s,zr}var pc=vc();const mc=gn(pc);var Fr,Ci;function yc(){return Ci||(Ci=1,Fr=function(){var r,t,e={};(function(){var o=0,a=1,s=2,u=3,l=4,c=5,d=6,f=7,h=8,m=9,v=0,b=1,x=2,T=0,E=1,_=2,A=3,L=4,y=5,C=6,S=7,D=8,G=3,O=10,R=3,H=9,$=10;e.exports=function(p,g,z){var M,P,k,F,B,Y,ee,q,W,oe,Z=g.length,ne=z.length,te=p.adjustSizes,ce=p.barnesHutTheta*p.barnesHutTheta,J,X,N,le,Ee,ae,ie,U=[];for(k=0;k<Z;k+=O)g[k+l]=g[k+s],g[k+c]=g[k+u],g[k+s]=0,g[k+u]=0;if(p.outboundAttractionDistribution){for(J=0,k=0;k<Z;k+=O)J+=g[k+d];J/=Z/O}if(p.barnesHutOptimize){var Te=1/0,ze=-1/0,Re=1/0,Ge=-1/0,me,Se,Xe;for(k=0;k<Z;k+=O)Te=Math.min(Te,g[k+o]),ze=Math.max(ze,g[k+o]),Re=Math.min(Re,g[k+a]),Ge=Math.max(Ge,g[k+a]);var xe=ze-Te,$e=Ge-Re;for(xe>$e?(Re-=(xe-$e)/2,Ge=Re+xe):(Te-=($e-xe)/2,ze=Te+$e),U[0+T]=-1,U[0+E]=(Te+ze)/2,U[0+_]=(Re+Ge)/2,U[0+A]=Math.max(ze-Te,Ge-Re),U[0+L]=-1,U[0+y]=-1,U[0+C]=0,U[0+S]=0,U[0+D]=0,M=1,k=0;k<Z;k+=O)for(P=0,Xe=G;;)if(U[P+y]>=0){g[k+o]<U[P+E]?g[k+a]<U[P+_]?me=U[P+y]:me=U[P+y]+H:g[k+a]<U[P+_]?me=U[P+y]+H*2:me=U[P+y]+H*3,U[P+S]=(U[P+S]*U[P+C]+g[k+o]*g[k+d])/(U[P+C]+g[k+d]),U[P+D]=(U[P+D]*U[P+C]+g[k+a]*g[k+d])/(U[P+C]+g[k+d]),U[P+C]+=g[k+d],P=me;continue}else if(U[P+T]<0){U[P+T]=k;break}else{if(U[P+y]=M*H,q=U[P+A]/2,W=U[P+y],U[W+T]=-1,U[W+E]=U[P+E]-q,U[W+_]=U[P+_]-q,U[W+A]=q,U[W+L]=W+H,U[W+y]=-1,U[W+C]=0,U[W+S]=0,U[W+D]=0,W+=H,U[W+T]=-1,U[W+E]=U[P+E]-q,U[W+_]=U[P+_]+q,U[W+A]=q,U[W+L]=W+H,U[W+y]=-1,U[W+C]=0,U[W+S]=0,U[W+D]=0,W+=H,U[W+T]=-1,U[W+E]=U[P+E]+q,U[W+_]=U[P+_]-q,U[W+A]=q,U[W+L]=W+H,U[W+y]=-1,U[W+C]=0,U[W+S]=0,U[W+D]=0,W+=H,U[W+T]=-1,U[W+E]=U[P+E]+q,U[W+_]=U[P+_]+q,U[W+A]=q,U[W+L]=U[P+L],U[W+y]=-1,U[W+C]=0,U[W+S]=0,U[W+D]=0,M+=4,g[U[P+T]+o]<U[P+E]?g[U[P+T]+a]<U[P+_]?me=U[P+y]:me=U[P+y]+H:g[U[P+T]+a]<U[P+_]?me=U[P+y]+H*2:me=U[P+y]+H*3,U[P+C]=g[U[P+T]+d],U[P+S]=g[U[P+T]+o],U[P+D]=g[U[P+T]+a],U[me+T]=U[P+T],U[P+T]=-1,g[k+o]<U[P+E]?g[k+a]<U[P+_]?Se=U[P+y]:Se=U[P+y]+H:g[k+a]<U[P+_]?Se=U[P+y]+H*2:Se=U[P+y]+H*3,me===Se)if(Xe--){P=me;continue}else{Xe=G;break}U[Se+T]=k;break}}if(p.barnesHutOptimize)for(X=p.scalingRatio,k=0;k<Z;k+=O)for(P=0;;)if(U[P+y]>=0)if(ae=Math.pow(g[k+o]-U[P+S],2)+Math.pow(g[k+a]-U[P+D],2),oe=U[P+A],4*oe*oe/ae<ce){if(N=g[k+o]-U[P+S],le=g[k+a]-U[P+D],te===!0?ae>0?(ie=X*g[k+d]*U[P+C]/ae,g[k+s]+=N*ie,g[k+u]+=le*ie):ae<0&&(ie=-X*g[k+d]*U[P+C]/Math.sqrt(ae),g[k+s]+=N*ie,g[k+u]+=le*ie):ae>0&&(ie=X*g[k+d]*U[P+C]/ae,g[k+s]+=N*ie,g[k+u]+=le*ie),P=U[P+L],P<0)break;continue}else{P=U[P+y];continue}else{if(Y=U[P+T],Y>=0&&Y!==k&&(N=g[k+o]-g[Y+o],le=g[k+a]-g[Y+a],ae=N*N+le*le,te===!0?ae>0?(ie=X*g[k+d]*g[Y+d]/ae,g[k+s]+=N*ie,g[k+u]+=le*ie):ae<0&&(ie=-X*g[k+d]*g[Y+d]/Math.sqrt(ae),g[k+s]+=N*ie,g[k+u]+=le*ie):ae>0&&(ie=X*g[k+d]*g[Y+d]/ae,g[k+s]+=N*ie,g[k+u]+=le*ie)),P=U[P+L],P<0)break;continue}else for(X=p.scalingRatio,F=0;F<Z;F+=O)for(B=0;B<F;B+=O)N=g[F+o]-g[B+o],le=g[F+a]-g[B+a],te===!0?(ae=Math.sqrt(N*N+le*le)-g[F+h]-g[B+h],ae>0?(ie=X*g[F+d]*g[B+d]/ae/ae,g[F+s]+=N*ie,g[F+u]+=le*ie,g[B+s]-=N*ie,g[B+u]-=le*ie):ae<0&&(ie=100*X*g[F+d]*g[B+d],g[F+s]+=N*ie,g[F+u]+=le*ie,g[B+s]-=N*ie,g[B+u]-=le*ie)):(ae=Math.sqrt(N*N+le*le),ae>0&&(ie=X*g[F+d]*g[B+d]/ae/ae,g[F+s]+=N*ie,g[F+u]+=le*ie,g[B+s]-=N*ie,g[B+u]-=le*ie));for(W=p.gravity/p.scalingRatio,X=p.scalingRatio,k=0;k<Z;k+=O)ie=0,N=g[k+o],le=g[k+a],ae=Math.sqrt(Math.pow(N,2)+Math.pow(le,2)),p.strongGravityMode?ae>0&&(ie=X*g[k+d]*W):ae>0&&(ie=X*g[k+d]*W/ae),g[k+s]-=N*ie,g[k+u]-=le*ie;for(X=1*(p.outboundAttractionDistribution?J:1),ee=0;ee<ne;ee+=R)F=z[ee+v],B=z[ee+b],q=z[ee+x],Ee=Math.pow(q,p.edgeWeightInfluence),N=g[F+o]-g[B+o],le=g[F+a]-g[B+a],te===!0?(ae=Math.sqrt(N*N+le*le)-g[F+h]-g[B+h],p.linLogMode?p.outboundAttractionDistribution?ae>0&&(ie=-X*Ee*Math.log(1+ae)/ae/g[F+d]):ae>0&&(ie=-X*Ee*Math.log(1+ae)/ae):p.outboundAttractionDistribution?ae>0&&(ie=-X*Ee/g[F+d]):ae>0&&(ie=-X*Ee)):(ae=Math.sqrt(Math.pow(N,2)+Math.pow(le,2)),p.linLogMode?p.outboundAttractionDistribution?ae>0&&(ie=-X*Ee*Math.log(1+ae)/ae/g[F+d]):ae>0&&(ie=-X*Ee*Math.log(1+ae)/ae):p.outboundAttractionDistribution?(ae=1,ie=-X*Ee/g[F+d]):(ae=1,ie=-X*Ee)),ae>0&&(g[F+s]+=N*ie,g[F+u]+=le*ie,g[B+s]-=N*ie,g[B+u]-=le*ie);var Me,St,Bt,tt,Vt,qt;if(te===!0)for(k=0;k<Z;k+=O)g[k+m]!==1&&(Me=Math.sqrt(Math.pow(g[k+s],2)+Math.pow(g[k+u],2)),Me>$&&(g[k+s]=g[k+s]*$/Me,g[k+u]=g[k+u]*$/Me),St=g[k+d]*Math.sqrt((g[k+l]-g[k+s])*(g[k+l]-g[k+s])+(g[k+c]-g[k+u])*(g[k+c]-g[k+u])),Bt=Math.sqrt((g[k+l]+g[k+s])*(g[k+l]+g[k+s])+(g[k+c]+g[k+u])*(g[k+c]+g[k+u]))/2,tt=.1*Math.log(1+Bt)/(1+Math.sqrt(St)),Vt=g[k+o]+g[k+s]*(tt/p.slowDown),g[k+o]=Vt,qt=g[k+a]+g[k+u]*(tt/p.slowDown),g[k+a]=qt);else for(k=0;k<Z;k+=O)g[k+m]!==1&&(St=g[k+d]*Math.sqrt((g[k+l]-g[k+s])*(g[k+l]-g[k+s])+(g[k+c]-g[k+u])*(g[k+c]-g[k+u])),Bt=Math.sqrt((g[k+l]+g[k+s])*(g[k+l]+g[k+s])+(g[k+c]+g[k+u])*(g[k+c]+g[k+u]))/2,tt=g[k+f]*Math.log(1+Bt)/(1+Math.sqrt(St)),g[k+f]=Math.min(1,Math.sqrt(tt*(Math.pow(g[k+s],2)+Math.pow(g[k+u],2))/(1+Math.sqrt(St)))),Vt=g[k+o]+g[k+s]*(tt/p.slowDown),g[k+o]=Vt,qt=g[k+a]+g[k+u]*(tt/p.slowDown),g[k+a]=qt);return{}}})();var i=e.exports;self.addEventListener("message",function(o){var a=o.data;r=new Float32Array(a.nodes),a.edges&&(t=new Float32Array(a.edges)),i(a.settings,r,t),self.postMessage({nodes:r.buffer},[r.buffer])})}),Fr}var $r,Ai;function bc(){if(Ai)return $r;Ai=1;var n=yc(),r=at(),t=ea().createEdgeWeightGetter,e=ta(),i=ra();function o(a,s){if(s=s||{},!r(a))throw new Error("graphology-layout-forceatlas2/worker: the given graph is not a valid graphology instance.");var u=t("getEdgeWeight"in s?s.getEdgeWeight:"weight").fromEntry,l=e.assign({},i,s.settings),c=e.validateSettings(l);if(c)throw new Error("graphology-layout-forceatlas2/worker: "+c.message);this.worker=null,this.graph=a,this.settings=l,this.getEdgeWeight=u,this.matrices=null,this.running=!1,this.killed=!1,this.outputReducer=typeof s.outputReducer=="function"?s.outputReducer:null,this.handleMessage=this.handleMessage.bind(this);var d=void 0,f=this;this.handleGraphUpdate=function(){f.worker&&f.worker.terminate(),d&&clearTimeout(d),d=setTimeout(function(){d=void 0,f.spawnWorker()},0)},a.on("nodeAdded",this.handleGraphUpdate),a.on("edgeAdded",this.handleGraphUpdate),a.on("nodeDropped",this.handleGraphUpdate),a.on("edgeDropped",this.handleGraphUpdate),this.spawnWorker()}return o.prototype.isRunning=function(){return this.running},o.prototype.spawnWorker=function(){this.worker&&this.worker.terminate(),this.worker=e.createWorker(n),this.worker.addEventListener("message",this.handleMessage),this.running&&(this.running=!1,this.start())},o.prototype.handleMessage=function(a){if(this.running){var s=new Float32Array(a.data.nodes);e.assignLayoutChanges(this.graph,s,this.outputReducer),this.outputReducer&&e.readGraphPositions(this.graph,s),this.matrices.nodes=s,this.askForIterations()}},o.prototype.askForIterations=function(a){var s=this.matrices,u={settings:this.settings,nodes:s.nodes.buffer},l=[s.nodes.buffer];return a&&(u.edges=s.edges.buffer,l.push(s.edges.buffer)),this.worker.postMessage(u,l),this},o.prototype.start=function(){if(this.killed)throw new Error("graphology-layout-forceatlas2/worker.start: layout was killed.");return this.running?this:(this.matrices=e.graphToByteArrays(this.graph,this.getEdgeWeight),this.running=!0,this.askForIterations(!0),this)},o.prototype.stop=function(){return this.running=!1,this},o.prototype.kill=function(){if(this.killed)return this;this.running=!1,this.killed=!0,this.matrices=null,this.worker.terminate(),this.graph.removeListener("nodeAdded",this.handleGraphUpdate),this.graph.removeListener("edgeAdded",this.handleGraphUpdate),this.graph.removeListener("nodeDropped",this.handleGraphUpdate),this.graph.removeListener("edgeDropped",this.handleGraphUpdate)},$r=o,$r}var _c=bc();const wc=gn(_c);let ki=class na extends he{constructor(t){super(t);ue(this,"_timer");ue(this,"_worker");const e=yt(()=>this.checkParallelEdges());this.on("edgeAdded",e),this.on("edgeDropped",e);const i=yt(()=>{this.emit("nodesSelected",this.filterNodes((a,s)=>s.selected))}),o=({name:a})=>{a==="selected"&&i()};this.on("nodeDropped",i),this.on("nodeAttributesUpdated",o)}on(t,e){return super.on(t,e)}off(t,e){return super.off(t,e)}emit(t,...e){return super.emit(t,...e)}mergeNodes(t,e,i,o){if(!e.length)return;let a={},s=[];const u=[];return e.forEach(l=>{const c=this.getNodeAttributes(l);c&&u.push(c);const d=this.edges(l);d.length&&d.forEach(f=>{const h=this.source(f),m=this.target(f),v=this.getEdgeAttributes(f);v&&s.push({key:f,source:h===l?t:h,target:m===l?t:m,attributes:v})})}),typeof i=="function"?a=i(u):typeof i=="object"&&Object.assign(a,i),typeof o=="function"&&(s=o(s)),this.dropNodes(e),this.import({nodes:[{key:t,attributes:a}],edges:s},!0),this}groupNodes(t,e,i,o){if(!e.length)return;let a={nodeList:e,isGroup:!0,expanded:!1},s=[];const u=[],l=[];return e.forEach(c=>{const d=this.getNodeAttributes(c);d&&l.push(d);const f=this.edges(c);if(f.length){const h=f.map(m=>{const v=this.source(m),b=this.target(m),x=this.getEdgeAttributes(m);return x&&(u.push({key:m,source:v===c?c:t,target:b===c?c:t,attributes:x}),s.push({key:`${t}-${m}`,source:v===c?t:v,target:b===c?t:b,attributes:x})),this.dropEdge(m),{key:m,source:v,target:b,attributes:x}});this.setNodeAttribute(c,"hidden",!0),this.setNodeAttribute(c,"selected",!1),this.setNodeAttribute(c,"originalEdges",h)}}),typeof i=="function"?a=Object.assign(a,i(l)):typeof i=="object"&&Object.assign(a,i),typeof o=="function"&&(s=o(s)),this.import({nodes:[{key:t,attributes:a}],edges:s.concat(u)},!0),this}ungroupNode(t){const e=this.getNodeAttributes(t);return!e||!e.isGroup?void 0:((e.nodeList||[]).forEach(o=>{const a=this.getNodeAttribute(o,"originalEdges");a&&Array.isArray(a)&&a.forEach(s=>{this.addEdgeWithKey(s.key,s.source,s.target,s.attributes)}),this.setNodeAttribute(o,"hidden",!1),this.removeNodeAttribute(o,"originalEdges")}),this.dropNode(t),this)}toggleExpanded(t,e){const i=e??!this.getNodeAttribute(t,"expanded"),o=this.getNodeAttribute(t,"nodeList");return this.setNodeAttribute(t,"expanded",i),o==null||o.forEach(a=>{this.setNodeAttribute(a,"hidden",!i)}),this}import(t,e){const i=[];t instanceof na?i.push(...t.nodes()):i.push(...t.nodes.map(a=>a.key)),super.import(t,e),this.emit("nodesLoaded",i);const o=wi.random(this);return Hn(this,o,{duration:200},()=>{this.emit("layoutDone")}),this}circularLayout(){if(this.size===0)return this;const t=wi.circular(this);return Hn(this,t,{duration:200},()=>{this.emit("layoutDone")}),this}forceLayout(t={}){var i,o;if(this.size===0)return this;const e=mc.inferSettings(this);return(i=this._worker)!=null&&i.isRunning()&&clearTimeout(this._timer),(o=this._worker)==null||o.kill(),this._worker=new wc(this,{settings:{...e,...t}}),this.emit("layoutRunning",!0),this._worker.start(),this._timer=setTimeout(()=>{var a,s;(a=this._worker)==null||a.stop(),(s=this._worker)==null||s.kill(),this.emit("layoutRunning",!1),this.emit("layoutDone")},this.nodes().length*window.__GRAPH_LAYOUT_DURATION_MULTIPLIER__),this}dropNodes(t){t.length&&t.forEach(e=>this.dropNode(e))}getCurvature(t,e=0){if(e<=0)throw new Error("Invalid maxIndex");if(t<0)return-this.getCurvature(-t,e);const i=.25;return i*(1-Math.exp(-e/i))*Ht*t/e}checkParallelEdges(){el(this,{edgeIndexAttribute:"parallelIndex",edgeMinIndexAttribute:"parallelMinIndex",edgeMaxIndexAttribute:"parallelMaxIndex"}),this.forEachEdge((t,{parallelIndex:e,parallelMinIndex:i,parallelMaxIndex:o})=>{typeof i=="number"?this.mergeEdgeAttributes(t,{type:e?"curved":"line",curvature:this.getCurvature(e??1,o??1)}):typeof e=="number"?this.mergeEdgeAttributes(t,{type:"curved",curvature:this.getCurvature(e??1,o??1)}):this.setEdgeAttribute(t,"type","line")})}};const Ec=n=>{const[r,t]=I.useState(new ki({multi:!0})),[e,i]=I.useState([]);return I.useEffect(()=>{if(n instanceof ki){t(n);return}r.clear(),n&&r.import(n,!1)},[n]),I.useEffect(()=>{const o=a=>{i(a)};return r.on("nodesSelected",o),()=>{r.off("nodesSelected",o)}},[r]),{graph:r,selected:e}};var En=function(n){function r(){var t;return _e(this,r),t=Le(this,r),t.rawEmitter=t,t}return De(r,n),we(r)}(hr.EventEmitter),Tn={hideEdgesOnMove:!1,hideLabelsOnMove:!1,renderLabels:!0,renderEdgeLabels:!1,enableEdgeEvents:!1,defaultNodeColor:"#999",defaultNodeType:"circle",defaultEdgeColor:"#ccc",defaultEdgeType:"line",labelFont:"Arial",labelSize:14,labelWeight:"normal",labelColor:{color:"#000"},edgeLabelFont:"Arial",edgeLabelSize:14,edgeLabelWeight:"normal",edgeLabelColor:{attribute:"color"},stagePadding:30,defaultDrawEdgeLabel:fu,defaultDrawNodeLabel:xo,defaultDrawNodeHover:gu,minEdgeThickness:1.7,antiAliasingFeather:1,dragTimeout:100,draggedEventsTolerance:3,inertiaDuration:200,inertiaRatio:3,zoomDuration:250,zoomingRatio:1.7,doubleClickTimeout:300,doubleClickZoomingRatio:2.2,doubleClickZoomingDuration:200,tapMoveTolerance:10,zoomToSizeRatioFunction:Math.sqrt,itemSizesReference:"screen",autoRescale:!0,autoCenter:!0,labelDensity:1,labelGridCellSize:100,labelRenderedSizeThreshold:6,nodeReducer:null,edgeReducer:null,zIndex:!1,minCameraRatio:null,maxCameraRatio:null,enableCameraZooming:!0,enableCameraPanning:!0,enableCameraRotation:!0,cameraPanBoundaries:null,allowInvalidContainer:!1,nodeProgramClasses:{},nodeHoverProgramClasses:{},edgeProgramClasses:{}},Tc={circle:cr},Rc={arrow:Gu,line:Iu};function Mr(n){if(typeof n.labelDensity!="number"||n.labelDensity<0)throw new Error("Settings: invalid `labelDensity`. Expecting a positive number.");var r=n.minCameraRatio,t=n.maxCameraRatio;if(typeof r=="number"&&typeof t=="number"&&t<r)throw new Error("Settings: invalid camera ratio boundaries. Expecting `maxCameraRatio` to be greater than `minCameraRatio`.")}function Sc(n){var r=Er({},Tn,n);return r.nodeProgramClasses=Er({},Tc,r.nodeProgramClasses),r.edgeProgramClasses=Er({},Rc,r.edgeProgramClasses),r}var er=1.5,Li=function(n){function r(){var t;return _e(this,r),t=Le(this,r),V(t,"x",.5),V(t,"y",.5),V(t,"angle",0),V(t,"ratio",1),V(t,"minRatio",null),V(t,"maxRatio",null),V(t,"enabledZooming",!0),V(t,"enabledPanning",!0),V(t,"enabledRotation",!0),V(t,"clean",null),V(t,"nextFrame",null),V(t,"previousState",null),V(t,"enabled",!0),t.previousState=t.getState(),t}return De(r,n),we(r,[{key:"enable",value:function(){return this.enabled=!0,this}},{key:"disable",value:function(){return this.enabled=!1,this}},{key:"getState",value:function(){return{x:this.x,y:this.y,angle:this.angle,ratio:this.ratio}}},{key:"hasState",value:function(e){return this.x===e.x&&this.y===e.y&&this.ratio===e.ratio&&this.angle===e.angle}},{key:"getPreviousState",value:function(){var e=this.previousState;return e?{x:e.x,y:e.y,angle:e.angle,ratio:e.ratio}:null}},{key:"getBoundedRatio",value:function(e){var i=e;return typeof this.minRatio=="number"&&(i=Math.max(i,this.minRatio)),typeof this.maxRatio=="number"&&(i=Math.min(i,this.maxRatio)),i}},{key:"validateState",value:function(e){var i={};return this.enabledPanning&&typeof e.x=="number"&&(i.x=e.x),this.enabledPanning&&typeof e.y=="number"&&(i.y=e.y),this.enabledZooming&&typeof e.ratio=="number"&&(i.ratio=this.getBoundedRatio(e.ratio)),this.enabledRotation&&typeof e.angle=="number"&&(i.angle=e.angle),this.clean?this.clean(re(re({},this.getState()),i)):i}},{key:"isAnimated",value:function(){return!!this.nextFrame}},{key:"setState",value:function(e){if(!this.enabled)return this;this.previousState=this.getState();var i=this.validateState(e);return typeof i.x=="number"&&(this.x=i.x),typeof i.y=="number"&&(this.y=i.y),typeof i.ratio=="number"&&(this.ratio=i.ratio),typeof i.angle=="number"&&(this.angle=i.angle),this.hasState(this.previousState)||this.emit("updated",this.getState()),this}},{key:"updateState",value:function(e){return this.setState(e(this.getState())),this}},{key:"animate",value:function(e){var i=this,o=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},a=arguments.length>2?arguments[2]:void 0;if(!a)return new Promise(function(h){return i.animate(e,o,h)});if(this.enabled){var s=re(re({},bo),o),u=this.validateState(e),l=typeof s.easing=="function"?s.easing:yo[s.easing],c=Date.now(),d=this.getState(),f=function(){var m=(Date.now()-c)/s.duration;if(m>=1){i.nextFrame=null,i.setState(u),i.animationCallback&&(i.animationCallback.call(null),i.animationCallback=void 0);return}var v=l(m),b={};typeof u.x=="number"&&(b.x=d.x+(u.x-d.x)*v),typeof u.y=="number"&&(b.y=d.y+(u.y-d.y)*v),i.enabledRotation&&typeof u.angle=="number"&&(b.angle=d.angle+(u.angle-d.angle)*v),typeof u.ratio=="number"&&(b.ratio=d.ratio+(u.ratio-d.ratio)*v),i.setState(b),i.nextFrame=requestAnimationFrame(f)};this.nextFrame?(cancelAnimationFrame(this.nextFrame),this.animationCallback&&this.animationCallback.call(null),this.nextFrame=requestAnimationFrame(f)):f(),this.animationCallback=a}}},{key:"animatedZoom",value:function(e){return e?typeof e=="number"?this.animate({ratio:this.ratio/e}):this.animate({ratio:this.ratio/(e.factor||er)},e):this.animate({ratio:this.ratio/er})}},{key:"animatedUnzoom",value:function(e){return e?typeof e=="number"?this.animate({ratio:this.ratio*e}):this.animate({ratio:this.ratio*(e.factor||er)},e):this.animate({ratio:this.ratio*er})}},{key:"animatedReset",value:function(e){return this.animate({x:.5,y:.5,ratio:1,angle:0},e)}},{key:"copy",value:function(){return r.from(this.getState())}}],[{key:"from",value:function(e){var i=new r;return i.setState(e)}}])}(En);function Ie(n,r){var t=r.getBoundingClientRect();return{x:n.clientX-t.left,y:n.clientY-t.top}}function He(n,r){var t=re(re({},Ie(n,r)),{},{sigmaDefaultPrevented:!1,preventSigmaDefault:function(){t.sigmaDefaultPrevented=!0},original:n});return t}function Gt(n){var r="x"in n?n:re(re({},n.touches[0]||n.previousTouches[0]),{},{original:n.original,sigmaDefaultPrevented:n.sigmaDefaultPrevented,preventSigmaDefault:function(){n.sigmaDefaultPrevented=!0,r.sigmaDefaultPrevented=!0}});return r}function xc(n,r){return re(re({},He(n,r)),{},{delta:ia(n)})}var Cc=2;function rr(n){for(var r=[],t=0,e=Math.min(n.length,Cc);t<e;t++)r.push(n[t]);return r}function Pt(n,r,t){var e={touches:rr(n.touches).map(function(i){return Ie(i,t)}),previousTouches:r.map(function(i){return Ie(i,t)}),sigmaDefaultPrevented:!1,preventSigmaDefault:function(){e.sigmaDefaultPrevented=!0},original:n};return e}function ia(n){if(typeof n.deltaY<"u")return n.deltaY*-3/360;if(typeof n.detail<"u")return n.detail/-9;throw new Error("Captor: could not extract delta from event.")}var oa=function(n){function r(t,e){var i;return _e(this,r),i=Le(this,r),i.container=t,i.renderer=e,i}return De(r,n),we(r)}(En),Ac=["doubleClickTimeout","doubleClickZoomingDuration","doubleClickZoomingRatio","dragTimeout","draggedEventsTolerance","inertiaDuration","inertiaRatio","zoomDuration","zoomingRatio"],kc=Ac.reduce(function(n,r){return re(re({},n),{},V({},r,Tn[r]))},{}),Lc=function(n){function r(t,e){var i;return _e(this,r),i=Le(this,r,[t,e]),V(i,"enabled",!0),V(i,"draggedEvents",0),V(i,"downStartTime",null),V(i,"lastMouseX",null),V(i,"lastMouseY",null),V(i,"isMouseDown",!1),V(i,"isMoving",!1),V(i,"movingTimeout",null),V(i,"startCameraState",null),V(i,"clicks",0),V(i,"doubleClickTimeout",null),V(i,"currentWheelDirection",0),V(i,"settings",kc),i.handleClick=i.handleClick.bind(i),i.handleRightClick=i.handleRightClick.bind(i),i.handleDown=i.handleDown.bind(i),i.handleUp=i.handleUp.bind(i),i.handleMove=i.handleMove.bind(i),i.handleWheel=i.handleWheel.bind(i),i.handleLeave=i.handleLeave.bind(i),i.handleEnter=i.handleEnter.bind(i),t.addEventListener("click",i.handleClick,{capture:!1}),t.addEventListener("contextmenu",i.handleRightClick,{capture:!1}),t.addEventListener("mousedown",i.handleDown,{capture:!1}),t.addEventListener("wheel",i.handleWheel,{capture:!1}),t.addEventListener("mouseleave",i.handleLeave,{capture:!1}),t.addEventListener("mouseenter",i.handleEnter,{capture:!1}),document.addEventListener("mousemove",i.handleMove,{capture:!1}),document.addEventListener("mouseup",i.handleUp,{capture:!1}),i}return De(r,n),we(r,[{key:"kill",value:function(){var e=this.container;e.removeEventListener("click",this.handleClick),e.removeEventListener("contextmenu",this.handleRightClick),e.removeEventListener("mousedown",this.handleDown),e.removeEventListener("wheel",this.handleWheel),e.removeEventListener("mouseleave",this.handleLeave),e.removeEventListener("mouseenter",this.handleEnter),document.removeEventListener("mousemove",this.handleMove),document.removeEventListener("mouseup",this.handleUp)}},{key:"handleClick",value:function(e){var i=this;if(this.enabled){if(this.clicks++,this.clicks===2)return this.clicks=0,typeof this.doubleClickTimeout=="number"&&(clearTimeout(this.doubleClickTimeout),this.doubleClickTimeout=null),this.handleDoubleClick(e);setTimeout(function(){i.clicks=0,i.doubleClickTimeout=null},this.settings.doubleClickTimeout),this.draggedEvents<this.settings.draggedEventsTolerance&&this.emit("click",He(e,this.container))}}},{key:"handleRightClick",value:function(e){this.enabled&&this.emit("rightClick",He(e,this.container))}},{key:"handleDoubleClick",value:function(e){if(this.enabled){e.preventDefault(),e.stopPropagation();var i=He(e,this.container);if(this.emit("doubleClick",i),!i.sigmaDefaultPrevented){var o=this.renderer.getCamera(),a=o.getBoundedRatio(o.getState().ratio/this.settings.doubleClickZoomingRatio);o.animate(this.renderer.getViewportZoomedState(Ie(e,this.container),a),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}}},{key:"handleDown",value:function(e){if(this.enabled){if(e.button===0){this.startCameraState=this.renderer.getCamera().getState();var i=Ie(e,this.container),o=i.x,a=i.y;this.lastMouseX=o,this.lastMouseY=a,this.draggedEvents=0,this.downStartTime=Date.now(),this.isMouseDown=!0}this.emit("mousedown",He(e,this.container))}}},{key:"handleUp",value:function(e){var i=this;if(!(!this.enabled||!this.isMouseDown)){var o=this.renderer.getCamera();this.isMouseDown=!1,typeof this.movingTimeout=="number"&&(clearTimeout(this.movingTimeout),this.movingTimeout=null);var a=Ie(e,this.container),s=a.x,u=a.y,l=o.getState(),c=o.getPreviousState()||{x:0,y:0};this.isMoving?o.animate({x:l.x+this.settings.inertiaRatio*(l.x-c.x),y:l.y+this.settings.inertiaRatio*(l.y-c.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"}):(this.lastMouseX!==s||this.lastMouseY!==u)&&o.setState({x:l.x,y:l.y}),this.isMoving=!1,setTimeout(function(){var d=i.draggedEvents>0;i.draggedEvents=0,d&&i.renderer.getSetting("hideEdgesOnMove")&&i.renderer.refresh()},0),this.emit("mouseup",He(e,this.container))}}},{key:"handleMove",value:function(e){var i=this;if(this.enabled){var o=He(e,this.container);if(this.emit("mousemovebody",o),(e.target===this.container||e.composedPath()[0]===this.container)&&this.emit("mousemove",o),!o.sigmaDefaultPrevented&&this.isMouseDown){this.isMoving=!0,this.draggedEvents++,typeof this.movingTimeout=="number"&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){i.movingTimeout=null,i.isMoving=!1},this.settings.dragTimeout);var a=this.renderer.getCamera(),s=Ie(e,this.container),u=s.x,l=s.y,c=this.renderer.viewportToFramedGraph({x:this.lastMouseX,y:this.lastMouseY}),d=this.renderer.viewportToFramedGraph({x:u,y:l}),f=c.x-d.x,h=c.y-d.y,m=a.getState(),v=m.x+f,b=m.y+h;a.setState({x:v,y:b}),this.lastMouseX=u,this.lastMouseY=l,e.preventDefault(),e.stopPropagation()}}}},{key:"handleLeave",value:function(e){this.emit("mouseleave",He(e,this.container))}},{key:"handleEnter",value:function(e){this.emit("mouseenter",He(e,this.container))}},{key:"handleWheel",value:function(e){var i=this,o=this.renderer.getCamera();if(!(!this.enabled||!o.enabledZooming)){var a=ia(e);if(a){var s=xc(e,this.container);if(this.emit("wheel",s),s.sigmaDefaultPrevented){e.preventDefault(),e.stopPropagation();return}var u=o.getState().ratio,l=a>0?1/this.settings.zoomingRatio:this.settings.zoomingRatio,c=o.getBoundedRatio(u*l),d=a>0?1:-1,f=Date.now();u!==c&&(e.preventDefault(),e.stopPropagation(),!(this.currentWheelDirection===d&&this.lastWheelTriggerTime&&f-this.lastWheelTriggerTime<this.settings.zoomDuration/5)&&(o.animate(this.renderer.getViewportZoomedState(Ie(e,this.container),c),{easing:"quadraticOut",duration:this.settings.zoomDuration},function(){i.currentWheelDirection=0}),this.currentWheelDirection=d,this.lastWheelTriggerTime=f))}}}},{key:"setSettings",value:function(e){this.settings=e}}])}(oa),Dc=["dragTimeout","inertiaDuration","inertiaRatio","doubleClickTimeout","doubleClickZoomingRatio","doubleClickZoomingDuration","tapMoveTolerance"],Gc=Dc.reduce(function(n,r){return re(re({},n),{},V({},r,Tn[r]))},{}),Pc=function(n){function r(t,e){var i;return _e(this,r),i=Le(this,r,[t,e]),V(i,"enabled",!0),V(i,"isMoving",!1),V(i,"hasMoved",!1),V(i,"touchMode",0),V(i,"startTouchesPositions",[]),V(i,"lastTouches",[]),V(i,"lastTap",null),V(i,"settings",Gc),i.handleStart=i.handleStart.bind(i),i.handleLeave=i.handleLeave.bind(i),i.handleMove=i.handleMove.bind(i),t.addEventListener("touchstart",i.handleStart,{capture:!1}),t.addEventListener("touchcancel",i.handleLeave,{capture:!1}),document.addEventListener("touchend",i.handleLeave,{capture:!1,passive:!1}),document.addEventListener("touchmove",i.handleMove,{capture:!1,passive:!1}),i}return De(r,n),we(r,[{key:"kill",value:function(){var e=this.container;e.removeEventListener("touchstart",this.handleStart),e.removeEventListener("touchcancel",this.handleLeave),document.removeEventListener("touchend",this.handleLeave),document.removeEventListener("touchmove",this.handleMove)}},{key:"getDimensions",value:function(){return{width:this.container.offsetWidth,height:this.container.offsetHeight}}},{key:"handleStart",value:function(e){var i=this;if(this.enabled){e.preventDefault();var o=rr(e.touches);if(this.touchMode=o.length,this.startCameraState=this.renderer.getCamera().getState(),this.startTouchesPositions=o.map(function(h){return Ie(h,i.container)}),this.touchMode===2){var a=bt(this.startTouchesPositions,2),s=a[0],u=s.x,l=s.y,c=a[1],d=c.x,f=c.y;this.startTouchesAngle=Math.atan2(f-l,d-u),this.startTouchesDistance=Math.sqrt(Math.pow(d-u,2)+Math.pow(f-l,2))}this.emit("touchdown",Pt(e,this.lastTouches,this.container)),this.lastTouches=o,this.lastTouchesPositions=this.startTouchesPositions}}},{key:"handleLeave",value:function(e){if(!(!this.enabled||!this.startTouchesPositions.length)){switch(e.cancelable&&e.preventDefault(),this.movingTimeout&&(this.isMoving=!1,clearTimeout(this.movingTimeout)),this.touchMode){case 2:if(e.touches.length===1){this.handleStart(e),e.preventDefault();break}case 1:if(this.isMoving){var i=this.renderer.getCamera(),o=i.getState(),a=i.getPreviousState()||{x:0,y:0};i.animate({x:o.x+this.settings.inertiaRatio*(o.x-a.x),y:o.y+this.settings.inertiaRatio*(o.y-a.y)},{duration:this.settings.inertiaDuration,easing:"quadraticOut"})}this.hasMoved=!1,this.isMoving=!1,this.touchMode=0;break}if(this.emit("touchup",Pt(e,this.lastTouches,this.container)),!e.touches.length){var s=Ie(this.lastTouches[0],this.container),u=this.startTouchesPositions[0],l=Math.pow(s.x-u.x,2)+Math.pow(s.y-u.y,2);if(!e.touches.length&&l<Math.pow(this.settings.tapMoveTolerance,2))if(this.lastTap&&Date.now()-this.lastTap.time<this.settings.doubleClickTimeout){var c=Pt(e,this.lastTouches,this.container);if(this.emit("doubletap",c),this.lastTap=null,!c.sigmaDefaultPrevented){var d=this.renderer.getCamera(),f=d.getBoundedRatio(d.getState().ratio/this.settings.doubleClickZoomingRatio);d.animate(this.renderer.getViewportZoomedState(s,f),{easing:"quadraticInOut",duration:this.settings.doubleClickZoomingDuration})}}else{var h=Pt(e,this.lastTouches,this.container);this.emit("tap",h),this.lastTap={time:Date.now(),position:h.touches[0]||h.previousTouches[0]}}}this.lastTouches=rr(e.touches),this.startTouchesPositions=[]}}},{key:"handleMove",value:function(e){var i=this;if(!(!this.enabled||!this.startTouchesPositions.length)){e.preventDefault();var o=rr(e.touches),a=o.map(function(P){return Ie(P,i.container)}),s=this.lastTouches;this.lastTouches=o,this.lastTouchesPositions=a;var u=Pt(e,s,this.container);if(this.emit("touchmove",u),!u.sigmaDefaultPrevented&&(this.hasMoved||(this.hasMoved=a.some(function(P,k){var F=i.startTouchesPositions[k];return F&&(P.x!==F.x||P.y!==F.y)})),!!this.hasMoved)){this.isMoving=!0,this.movingTimeout&&clearTimeout(this.movingTimeout),this.movingTimeout=window.setTimeout(function(){i.isMoving=!1},this.settings.dragTimeout);var l=this.renderer.getCamera(),c=this.startCameraState,d=this.renderer.getSetting("stagePadding");switch(this.touchMode){case 1:{var f=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0]),h=f.x,m=f.y,v=this.renderer.viewportToFramedGraph(a[0]),b=v.x,x=v.y;l.setState({x:c.x+h-b,y:c.y+m-x});break}case 2:{var T={x:.5,y:.5,angle:0,ratio:1},E=a[0],_=E.x,A=E.y,L=a[1],y=L.x,C=L.y,S=Math.atan2(C-A,y-_)-this.startTouchesAngle,D=Math.hypot(C-A,y-_)/this.startTouchesDistance,G=l.getBoundedRatio(c.ratio/D);T.ratio=G,T.angle=c.angle+S;var O=this.getDimensions(),R=this.renderer.viewportToFramedGraph((this.startTouchesPositions||[])[0],{cameraState:c}),H=Math.min(O.width,O.height)-2*d,$=H/O.width,w=H/O.height,p=G/H,g=_-H/2/$,z=A-H/2/w,M=[g*Math.cos(-T.angle)-z*Math.sin(-T.angle),z*Math.cos(-T.angle)+g*Math.sin(-T.angle)];g=M[0],z=M[1],T.x=R.x-g*p,T.y=R.y+z*p,l.setState(T);break}}}}}},{key:"setSettings",value:function(e){this.settings=e}}])}(oa);function Nc(n){if(Array.isArray(n))return Jr(n)}function Oc(n){if(typeof Symbol<"u"&&n[Symbol.iterator]!=null||n["@@iterator"]!=null)return Array.from(n)}function Ic(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function Di(n){return Nc(n)||Oc(n)||go(n)||Ic()}function zc(n,r){if(n==null)return{};var t={};for(var e in n)if({}.hasOwnProperty.call(n,e)){if(r.indexOf(e)!==-1)continue;t[e]=n[e]}return t}function Ur(n,r){if(n==null)return{};var t,e,i=zc(n,r);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(n);for(e=0;e<o.length;e++)t=o[e],r.indexOf(t)===-1&&{}.propertyIsEnumerable.call(n,t)&&(i[t]=n[t])}return i}var Gi=function(){function n(r,t){_e(this,n),this.key=r,this.size=t}return we(n,null,[{key:"compare",value:function(t,e){return t.size>e.size?-1:t.size<e.size||t.key>e.key?1:-1}}])}(),Pi=function(){function n(){_e(this,n),V(this,"width",0),V(this,"height",0),V(this,"cellSize",0),V(this,"columns",0),V(this,"rows",0),V(this,"cells",{})}return we(n,[{key:"resizeAndClear",value:function(t,e){this.width=t.width,this.height=t.height,this.cellSize=e,this.columns=Math.ceil(t.width/e),this.rows=Math.ceil(t.height/e),this.cells={}}},{key:"getIndex",value:function(t){var e=Math.floor(t.x/this.cellSize),i=Math.floor(t.y/this.cellSize);return i*this.columns+e}},{key:"add",value:function(t,e,i){var o=new Gi(t,e),a=this.getIndex(i),s=this.cells[a];s||(s=[],this.cells[a]=s),s.push(o)}},{key:"organize",value:function(){for(var t in this.cells){var e=this.cells[t];e.sort(Gi.compare)}}},{key:"getLabelsToDisplay",value:function(t,e){var i=this.cellSize*this.cellSize,o=i/t/t,a=o*e/i,s=Math.ceil(a),u=[];for(var l in this.cells)for(var c=this.cells[l],d=0;d<Math.min(s,c.length);d++)u.push(c[d].key);return u}}])}();function Fc(n){var r=n.graph,t=n.hoveredNode,e=n.highlightedNodes,i=n.displayedNodeLabels,o=[];return r.forEachEdge(function(a,s,u,l){(u===t||l===t||e.has(u)||e.has(l)||i.has(u)&&i.has(l))&&o.push(a)}),o}var Ni=150,Oi=50,We=Object.prototype.hasOwnProperty;function $c(n,r,t){if(!We.call(t,"x")||!We.call(t,"y"))throw new Error('Sigma: could not find a valid position (x, y) for node "'.concat(r,'". All your nodes must have a number "x" and "y". Maybe your forgot to apply a layout or your "nodeReducer" is not returning the correct data?'));return t.color||(t.color=n.defaultNodeColor),!t.label&&t.label!==""&&(t.label=null),t.label!==void 0&&t.label!==null?t.label=""+t.label:t.label=null,t.size||(t.size=2),We.call(t,"hidden")||(t.hidden=!1),We.call(t,"highlighted")||(t.highlighted=!1),We.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=n.defaultNodeType),t.zIndex||(t.zIndex=0),t}function Mc(n,r,t){return t.color||(t.color=n.defaultEdgeColor),t.label||(t.label=""),t.size||(t.size=.5),We.call(t,"hidden")||(t.hidden=!1),We.call(t,"forceLabel")||(t.forceLabel=!1),(!t.type||t.type==="")&&(t.type=n.defaultEdgeType),t.zIndex||(t.zIndex=0),t}var Uc=function(n){function r(t,e){var i,o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(_e(this,r),i=Le(this,r),V(i,"elements",{}),V(i,"canvasContexts",{}),V(i,"webGLContexts",{}),V(i,"pickingLayers",new Set),V(i,"textures",{}),V(i,"frameBuffers",{}),V(i,"activeListeners",{}),V(i,"labelGrid",new Pi),V(i,"nodeDataCache",{}),V(i,"edgeDataCache",{}),V(i,"nodeProgramIndex",{}),V(i,"edgeProgramIndex",{}),V(i,"nodesWithForcedLabels",new Set),V(i,"edgesWithForcedLabels",new Set),V(i,"nodeExtent",{x:[0,1],y:[0,1]}),V(i,"nodeZExtent",[1/0,-1/0]),V(i,"edgeZExtent",[1/0,-1/0]),V(i,"matrix",Ne()),V(i,"invMatrix",Ne()),V(i,"correctionRatio",1),V(i,"customBBox",null),V(i,"normalizationFunction",Xn({x:[0,1],y:[0,1]})),V(i,"graphToViewportRatio",1),V(i,"itemIDsIndex",{}),V(i,"nodeIndices",{}),V(i,"edgeIndices",{}),V(i,"width",0),V(i,"height",0),V(i,"pixelRatio",Vn()),V(i,"pickingDownSizingRatio",2*i.pixelRatio),V(i,"displayedNodeLabels",new Set),V(i,"displayedEdgeLabels",new Set),V(i,"highlightedNodes",new Set),V(i,"hoveredNode",null),V(i,"hoveredEdge",null),V(i,"renderFrame",null),V(i,"renderHighlightedNodesFrame",null),V(i,"needToProcess",!1),V(i,"checkEdgesEventsFrame",null),V(i,"nodePrograms",{}),V(i,"nodeHoverPrograms",{}),V(i,"edgePrograms",{}),i.settings=Sc(o),Mr(i.settings),Ys(t),!(e instanceof HTMLElement))throw new Error("Sigma: container should be an html element.");i.graph=t,i.container=e,i.createWebGLContext("edges",{picking:o.enableEdgeEvents}),i.createCanvasContext("edgeLabels"),i.createWebGLContext("nodes",{picking:!0}),i.createCanvasContext("labels"),i.createCanvasContext("hovers"),i.createWebGLContext("hoverNodes"),i.createCanvasContext("mouse",{style:{touchAction:"none",userSelect:"none"}}),i.resize();for(var a in i.settings.nodeProgramClasses)i.registerNodeProgram(a,i.settings.nodeProgramClasses[a],i.settings.nodeHoverProgramClasses[a]);for(var s in i.settings.edgeProgramClasses)i.registerEdgeProgram(s,i.settings.edgeProgramClasses[s]);return i.camera=new Li,i.bindCameraHandlers(),i.mouseCaptor=new Lc(i.elements.mouse,i),i.mouseCaptor.setSettings(i.settings),i.touchCaptor=new Pc(i.elements.mouse,i),i.touchCaptor.setSettings(i.settings),i.bindEventHandlers(),i.bindGraphHandlers(),i.handleSettingsUpdate(),i.refresh(),i}return De(r,n),we(r,[{key:"registerNodeProgram",value:function(e,i,o){return this.nodePrograms[e]&&this.nodePrograms[e].kill(),this.nodeHoverPrograms[e]&&this.nodeHoverPrograms[e].kill(),this.nodePrograms[e]=new i(this.webGLContexts.nodes,this.frameBuffers.nodes,this),this.nodeHoverPrograms[e]=new(o||i)(this.webGLContexts.hoverNodes,null,this),this}},{key:"registerEdgeProgram",value:function(e,i){return this.edgePrograms[e]&&this.edgePrograms[e].kill(),this.edgePrograms[e]=new i(this.webGLContexts.edges,this.frameBuffers.edges,this),this}},{key:"unregisterNodeProgram",value:function(e){if(this.nodePrograms[e]){var i=this.nodePrograms,o=i[e],a=Ur(i,[e].map($t));o.kill(),this.nodePrograms=a}if(this.nodeHoverPrograms[e]){var s=this.nodeHoverPrograms,u=s[e],l=Ur(s,[e].map($t));u.kill(),this.nodePrograms=l}return this}},{key:"unregisterEdgeProgram",value:function(e){if(this.edgePrograms[e]){var i=this.edgePrograms,o=i[e],a=Ur(i,[e].map($t));o.kill(),this.edgePrograms=a}return this}},{key:"resetWebGLTexture",value:function(e){var i=this.webGLContexts[e],o=this.frameBuffers[e],a=this.textures[e];a&&i.deleteTexture(a);var s=i.createTexture();return i.bindFramebuffer(i.FRAMEBUFFER,o),i.bindTexture(i.TEXTURE_2D,s),i.texImage2D(i.TEXTURE_2D,0,i.RGBA,this.width,this.height,0,i.RGBA,i.UNSIGNED_BYTE,null),i.framebufferTexture2D(i.FRAMEBUFFER,i.COLOR_ATTACHMENT0,i.TEXTURE_2D,s,0),this.textures[e]=s,this}},{key:"bindCameraHandlers",value:function(){var e=this;return this.activeListeners.camera=function(){e.scheduleRender()},this.camera.on("updated",this.activeListeners.camera),this}},{key:"unbindCameraHandlers",value:function(){return this.camera.removeListener("updated",this.activeListeners.camera),this}},{key:"getNodeAtPosition",value:function(e){var i=e.x,o=e.y,a=jn(this.webGLContexts.nodes,this.frameBuffers.nodes,i,o,this.pixelRatio,this.pickingDownSizingRatio),s=Un.apply(void 0,Di(a)),u=this.itemIDsIndex[s];return u&&u.type==="node"?u.id:null}},{key:"bindEventHandlers",value:function(){var e=this;this.activeListeners.handleResize=function(){e.scheduleRefresh()},window.addEventListener("resize",this.activeListeners.handleResize),this.activeListeners.handleMove=function(o){var a=Gt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}},u=e.getNodeAtPosition(a);if(u&&e.hoveredNode!==u&&!e.nodeDataCache[u].hidden){e.hoveredNode&&e.emit("leaveNode",re(re({},s),{},{node:e.hoveredNode})),e.hoveredNode=u,e.emit("enterNode",re(re({},s),{},{node:u})),e.scheduleHighlightedNodesRender();return}if(e.hoveredNode&&e.getNodeAtPosition(a)!==e.hoveredNode){var l=e.hoveredNode;e.hoveredNode=null,e.emit("leaveNode",re(re({},s),{},{node:l})),e.scheduleHighlightedNodesRender();return}if(e.settings.enableEdgeEvents){var c=e.hoveredNode?null:e.getEdgeAtPoint(s.event.x,s.event.y);c!==e.hoveredEdge&&(e.hoveredEdge&&e.emit("leaveEdge",re(re({},s),{},{edge:e.hoveredEdge})),c&&e.emit("enterEdge",re(re({},s),{},{edge:c})),e.hoveredEdge=c)}},this.activeListeners.handleMoveBody=function(o){var a=Gt(o);e.emit("moveBody",{event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}})},this.activeListeners.handleLeave=function(o){var a=Gt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};e.hoveredNode&&(e.emit("leaveNode",re(re({},s),{},{node:e.hoveredNode})),e.scheduleHighlightedNodesRender()),e.settings.enableEdgeEvents&&e.hoveredEdge&&(e.emit("leaveEdge",re(re({},s),{},{edge:e.hoveredEdge})),e.scheduleHighlightedNodesRender()),e.emit("leaveStage",re({},s))},this.activeListeners.handleEnter=function(o){var a=Gt(o),s={event:a,preventSigmaDefault:function(){a.preventSigmaDefault()}};e.emit("enterStage",re({},s))};var i=function(a){return function(s){var u=Gt(s),l={event:u,preventSigmaDefault:function(){u.preventSigmaDefault()}},c=e.getNodeAtPosition(u);if(c)return e.emit("".concat(a,"Node"),re(re({},l),{},{node:c}));if(e.settings.enableEdgeEvents){var d=e.getEdgeAtPoint(u.x,u.y);if(d)return e.emit("".concat(a,"Edge"),re(re({},l),{},{edge:d}))}return e.emit("".concat(a,"Stage"),l)}};return this.activeListeners.handleClick=i("click"),this.activeListeners.handleRightClick=i("rightClick"),this.activeListeners.handleDoubleClick=i("doubleClick"),this.activeListeners.handleWheel=i("wheel"),this.activeListeners.handleDown=i("down"),this.activeListeners.handleUp=i("up"),this.mouseCaptor.on("mousemove",this.activeListeners.handleMove),this.mouseCaptor.on("mousemovebody",this.activeListeners.handleMoveBody),this.mouseCaptor.on("click",this.activeListeners.handleClick),this.mouseCaptor.on("rightClick",this.activeListeners.handleRightClick),this.mouseCaptor.on("doubleClick",this.activeListeners.handleDoubleClick),this.mouseCaptor.on("wheel",this.activeListeners.handleWheel),this.mouseCaptor.on("mousedown",this.activeListeners.handleDown),this.mouseCaptor.on("mouseup",this.activeListeners.handleUp),this.mouseCaptor.on("mouseleave",this.activeListeners.handleLeave),this.mouseCaptor.on("mouseenter",this.activeListeners.handleEnter),this.touchCaptor.on("touchdown",this.activeListeners.handleDown),this.touchCaptor.on("touchdown",this.activeListeners.handleMove),this.touchCaptor.on("touchup",this.activeListeners.handleUp),this.touchCaptor.on("touchmove",this.activeListeners.handleMove),this.touchCaptor.on("tap",this.activeListeners.handleClick),this.touchCaptor.on("doubletap",this.activeListeners.handleDoubleClick),this.touchCaptor.on("touchmove",this.activeListeners.handleMoveBody),this}},{key:"bindGraphHandlers",value:function(){var e=this,i=this.graph,o=new Set(["x","y","zIndex","type"]);return this.activeListeners.eachNodeAttributesUpdatedGraphUpdate=function(a){var s,u=(s=a.hints)===null||s===void 0?void 0:s.attributes;e.graph.forEachNode(function(c){return e.updateNode(c)});var l=!u||u.some(function(c){return o.has(c)});e.refresh({partialGraph:{nodes:i.nodes()},skipIndexation:!l,schedule:!0})},this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate=function(a){var s,u=(s=a.hints)===null||s===void 0?void 0:s.attributes;e.graph.forEachEdge(function(c){return e.updateEdge(c)});var l=u&&["zIndex","type"].some(function(c){return u==null?void 0:u.includes(c)});e.refresh({partialGraph:{edges:i.edges()},skipIndexation:!l,schedule:!0})},this.activeListeners.addNodeGraphUpdate=function(a){var s=a.key;e.addNode(s),e.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.updateNodeGraphUpdate=function(a){var s=a.key;e.refresh({partialGraph:{nodes:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropNodeGraphUpdate=function(a){var s=a.key;e.removeNode(s),e.refresh({schedule:!0})},this.activeListeners.addEdgeGraphUpdate=function(a){var s=a.key;e.addEdge(s),e.refresh({partialGraph:{edges:[s]},schedule:!0})},this.activeListeners.updateEdgeGraphUpdate=function(a){var s=a.key;e.refresh({partialGraph:{edges:[s]},skipIndexation:!1,schedule:!0})},this.activeListeners.dropEdgeGraphUpdate=function(a){var s=a.key;e.removeEdge(s),e.refresh({schedule:!0})},this.activeListeners.clearEdgesGraphUpdate=function(){e.clearEdgeState(),e.clearEdgeIndices(),e.refresh({schedule:!0})},this.activeListeners.clearGraphUpdate=function(){e.clearEdgeState(),e.clearNodeState(),e.clearEdgeIndices(),e.clearNodeIndices(),e.refresh({schedule:!0})},i.on("nodeAdded",this.activeListeners.addNodeGraphUpdate),i.on("nodeDropped",this.activeListeners.dropNodeGraphUpdate),i.on("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),i.on("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),i.on("edgeAdded",this.activeListeners.addEdgeGraphUpdate),i.on("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),i.on("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),i.on("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),i.on("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),i.on("cleared",this.activeListeners.clearGraphUpdate),this}},{key:"unbindGraphHandlers",value:function(){var e=this.graph;e.removeListener("nodeAdded",this.activeListeners.addNodeGraphUpdate),e.removeListener("nodeDropped",this.activeListeners.dropNodeGraphUpdate),e.removeListener("nodeAttributesUpdated",this.activeListeners.updateNodeGraphUpdate),e.removeListener("eachNodeAttributesUpdated",this.activeListeners.eachNodeAttributesUpdatedGraphUpdate),e.removeListener("edgeAdded",this.activeListeners.addEdgeGraphUpdate),e.removeListener("edgeDropped",this.activeListeners.dropEdgeGraphUpdate),e.removeListener("edgeAttributesUpdated",this.activeListeners.updateEdgeGraphUpdate),e.removeListener("eachEdgeAttributesUpdated",this.activeListeners.eachEdgeAttributesUpdatedGraphUpdate),e.removeListener("edgesCleared",this.activeListeners.clearEdgesGraphUpdate),e.removeListener("cleared",this.activeListeners.clearGraphUpdate)}},{key:"getEdgeAtPoint",value:function(e,i){var o=jn(this.webGLContexts.edges,this.frameBuffers.edges,e,i,this.pixelRatio,this.pickingDownSizingRatio),a=Un.apply(void 0,Di(o)),s=this.itemIDsIndex[a];return s&&s.type==="edge"?s.id:null}},{key:"process",value:function(){var e=this;this.emit("beforeProcess");var i=this.graph,o=this.settings,a=this.getDimensions();if(this.nodeExtent=Xs(this.graph),!this.settings.autoRescale){var s=a.width,u=a.height,l=this.nodeExtent,c=l.x,d=l.y;this.nodeExtent={x:[(c[0]+c[1])/2-s/2,(c[0]+c[1])/2+s/2],y:[(d[0]+d[1])/2-u/2,(d[0]+d[1])/2+u/2]}}this.normalizationFunction=Xn(this.customBBox||this.nodeExtent);var f=new Li,h=Ct(f.getState(),a,this.getGraphDimensions(),this.getStagePadding());this.labelGrid.resizeAndClear(a,o.labelGridCellSize);for(var m={},v={},b={},x={},T=1,E=i.nodes(),_=0,A=E.length;_<A;_++){var L=E[_],y=this.nodeDataCache[L],C=i.getNodeAttributes(L);y.x=C.x,y.y=C.y,this.normalizationFunction.applyTo(y),typeof y.label=="string"&&!y.hidden&&this.labelGrid.add(L,y.size,this.framedGraphToViewport(y,{matrix:h})),m[y.type]=(m[y.type]||0)+1}this.labelGrid.organize();for(var S in this.nodePrograms){if(!We.call(this.nodePrograms,S))throw new Error('Sigma: could not find a suitable program for node type "'.concat(S,'"!'));this.nodePrograms[S].reallocate(m[S]||0),m[S]=0}this.settings.zIndex&&this.nodeZExtent[0]!==this.nodeZExtent[1]&&(E=qn(this.nodeZExtent,function(Y){return e.nodeDataCache[Y].zIndex},E));for(var D=0,G=E.length;D<G;D++){var O=E[D];v[O]=T,x[v[O]]={type:"node",id:O},T++;var R=this.nodeDataCache[O];this.addNodeToProgram(O,v[O],m[R.type]++)}for(var H={},$=i.edges(),w=0,p=$.length;w<p;w++){var g=$[w],z=this.edgeDataCache[g];H[z.type]=(H[z.type]||0)+1}this.settings.zIndex&&this.edgeZExtent[0]!==this.edgeZExtent[1]&&($=qn(this.edgeZExtent,function(Y){return e.edgeDataCache[Y].zIndex},$));for(var M in this.edgePrograms){if(!We.call(this.edgePrograms,M))throw new Error('Sigma: could not find a suitable program for edge type "'.concat(M,'"!'));this.edgePrograms[M].reallocate(H[M]||0),H[M]=0}for(var P=0,k=$.length;P<k;P++){var F=$[P];b[F]=T,x[b[F]]={type:"edge",id:F},T++;var B=this.edgeDataCache[F];this.addEdgeToProgram(F,b[F],H[B.type]++)}return this.itemIDsIndex=x,this.nodeIndices=v,this.edgeIndices=b,this.emit("afterProcess"),this}},{key:"handleSettingsUpdate",value:function(e){var i=this,o=this.settings;if(this.camera.minRatio=o.minCameraRatio,this.camera.maxRatio=o.maxCameraRatio,this.camera.enabledZooming=o.enableCameraZooming,this.camera.enabledPanning=o.enableCameraPanning,this.camera.enabledRotation=o.enableCameraRotation,o.cameraPanBoundaries?this.camera.clean=function(c){return i.cleanCameraState(c,o.cameraPanBoundaries&&en(o.cameraPanBoundaries)==="object"?o.cameraPanBoundaries:{})}:this.camera.clean=null,this.camera.setState(this.camera.validateState(this.camera.getState())),e){if(e.edgeProgramClasses!==o.edgeProgramClasses){for(var a in o.edgeProgramClasses)o.edgeProgramClasses[a]!==e.edgeProgramClasses[a]&&this.registerEdgeProgram(a,o.edgeProgramClasses[a]);for(var s in e.edgeProgramClasses)o.edgeProgramClasses[s]||this.unregisterEdgeProgram(s)}if(e.nodeProgramClasses!==o.nodeProgramClasses||e.nodeHoverProgramClasses!==o.nodeHoverProgramClasses){for(var u in o.nodeProgramClasses)(o.nodeProgramClasses[u]!==e.nodeProgramClasses[u]||o.nodeHoverProgramClasses[u]!==e.nodeHoverProgramClasses[u])&&this.registerNodeProgram(u,o.nodeProgramClasses[u],o.nodeHoverProgramClasses[u]);for(var l in e.nodeProgramClasses)o.nodeProgramClasses[l]||this.unregisterNodeProgram(l)}}return this.mouseCaptor.setSettings(this.settings),this.touchCaptor.setSettings(this.settings),this}},{key:"cleanCameraState",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=i.tolerance,a=o===void 0?0:o,s=i.boundaries,u=re({},e),l=s||this.nodeExtent,c=bt(l.x,2),d=c[0],f=c[1],h=bt(l.y,2),m=h[0],v=h[1],b=[this.graphToViewport({x:d,y:m},{cameraState:e}),this.graphToViewport({x:f,y:m},{cameraState:e}),this.graphToViewport({x:d,y:v},{cameraState:e}),this.graphToViewport({x:f,y:v},{cameraState:e})],x=1/0,T=-1/0,E=1/0,_=-1/0;b.forEach(function(H){var $=H.x,w=H.y;x=Math.min(x,$),T=Math.max(T,$),E=Math.min(E,w),_=Math.max(_,w)});var A=T-x,L=_-E,y=this.getDimensions(),C=y.width,S=y.height,D=0,G=0;if(A>=C?T<C-a?D=T-(C-a):x>a&&(D=x-a):T>C+a?D=T-(C+a):x<-a&&(D=x+a),L>=S?_<S-a?G=_-(S-a):E>a&&(G=E-a):_>S+a?G=_-(S+a):E<-a&&(G=E+a),D||G){var O=this.viewportToFramedGraph({x:0,y:0},{cameraState:e}),R=this.viewportToFramedGraph({x:D,y:G},{cameraState:e});D=R.x-O.x,G=R.y-O.y,u.x+=D,u.y+=G}return u}},{key:"renderLabels",value:function(){if(!this.settings.renderLabels)return this;var e=this.camera.getState(),i=this.labelGrid.getLabelsToDisplay(e.ratio,this.settings.labelDensity);Yn(i,this.nodesWithForcedLabels),this.displayedNodeLabels=new Set;for(var o=this.canvasContexts.labels,a=0,s=i.length;a<s;a++){var u=i[a],l=this.nodeDataCache[u];if(!this.displayedNodeLabels.has(u)&&!l.hidden){var c=this.framedGraphToViewport(l),d=c.x,f=c.y,h=this.scaleSize(l.size);if(!(!l.forceLabel&&h<this.settings.labelRenderedSizeThreshold)&&!(d<-Ni||d>this.width+Ni||f<-Oi||f>this.height+Oi)){this.displayedNodeLabels.add(u);var m=this.settings.defaultDrawNodeLabel,v=this.nodePrograms[l.type],b=(v==null?void 0:v.drawLabel)||m;b(o,re(re({key:u},l),{},{size:h,x:d,y:f}),this.settings)}}}return this}},{key:"renderEdgeLabels",value:function(){if(!this.settings.renderEdgeLabels)return this;var e=this.canvasContexts.edgeLabels;e.clearRect(0,0,this.width,this.height);var i=Fc({graph:this.graph,hoveredNode:this.hoveredNode,displayedNodeLabels:this.displayedNodeLabels,highlightedNodes:this.highlightedNodes});Yn(i,this.edgesWithForcedLabels);for(var o=new Set,a=0,s=i.length;a<s;a++){var u=i[a],l=this.graph.extremities(u),c=this.nodeDataCache[l[0]],d=this.nodeDataCache[l[1]],f=this.edgeDataCache[u];if(!o.has(u)&&!(f.hidden||c.hidden||d.hidden)){var h=this.settings.defaultDrawEdgeLabel,m=this.edgePrograms[f.type],v=(m==null?void 0:m.drawLabel)||h;v(e,re(re({key:u},f),{},{size:this.scaleSize(f.size)}),re(re(re({key:l[0]},c),this.framedGraphToViewport(c)),{},{size:this.scaleSize(c.size)}),re(re(re({key:l[1]},d),this.framedGraphToViewport(d)),{},{size:this.scaleSize(d.size)}),this.settings),o.add(u)}}return this.displayedEdgeLabels=o,this}},{key:"renderHighlightedNodes",value:function(){var e=this,i=this.canvasContexts.hovers;i.clearRect(0,0,this.width,this.height);var o=function(h){var m=e.nodeDataCache[h],v=e.framedGraphToViewport(m),b=v.x,x=v.y,T=e.scaleSize(m.size),E=e.settings.defaultDrawNodeHover,_=e.nodePrograms[m.type],A=(_==null?void 0:_.drawHover)||E;A(i,re(re({key:h},m),{},{size:T,x:b,y:x}),e.settings)},a=[];this.hoveredNode&&!this.nodeDataCache[this.hoveredNode].hidden&&a.push(this.hoveredNode),this.highlightedNodes.forEach(function(f){f!==e.hoveredNode&&a.push(f)}),a.forEach(function(f){return o(f)});var s={};a.forEach(function(f){var h=e.nodeDataCache[f].type;s[h]=(s[h]||0)+1});for(var u in this.nodeHoverPrograms)this.nodeHoverPrograms[u].reallocate(s[u]||0),s[u]=0;a.forEach(function(f){var h=e.nodeDataCache[f];e.nodeHoverPrograms[h.type].process(0,s[h.type]++,h)}),this.webGLContexts.hoverNodes.clear(this.webGLContexts.hoverNodes.COLOR_BUFFER_BIT);var l=this.getRenderParams();for(var c in this.nodeHoverPrograms){var d=this.nodeHoverPrograms[c];d.render(l)}}},{key:"scheduleHighlightedNodesRender",value:function(){var e=this;this.renderHighlightedNodesFrame||this.renderFrame||(this.renderHighlightedNodesFrame=requestAnimationFrame(function(){e.renderHighlightedNodesFrame=null,e.renderHighlightedNodes(),e.renderEdgeLabels()}))}},{key:"render",value:function(){var e=this;this.emit("beforeRender");var i=function(){return e.emit("afterRender"),e};if(this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.resize(),this.needToProcess&&this.process(),this.needToProcess=!1,this.clear(),this.pickingLayers.forEach(function(b){return e.resetWebGLTexture(b)}),!this.graph.order)return i();var o=this.mouseCaptor,a=this.camera.isAnimated()||o.isMoving||o.draggedEvents||o.currentWheelDirection,s=this.camera.getState(),u=this.getDimensions(),l=this.getGraphDimensions(),c=this.getStagePadding();this.matrix=Ct(s,u,l,c),this.invMatrix=Ct(s,u,l,c,!0),this.correctionRatio=qs(this.matrix,s,u),this.graphToViewportRatio=this.getGraphToViewportRatio();var d=this.getRenderParams();for(var f in this.nodePrograms){var h=this.nodePrograms[f];h.render(d)}if(!this.settings.hideEdgesOnMove||!a)for(var m in this.edgePrograms){var v=this.edgePrograms[m];v.render(d)}return this.settings.hideLabelsOnMove&&a||(this.renderLabels(),this.renderEdgeLabels(),this.renderHighlightedNodes()),i()}},{key:"addNode",value:function(e){var i=Object.assign({},this.graph.getNodeAttributes(e));this.settings.nodeReducer&&(i=this.settings.nodeReducer(e,i));var o=$c(this.settings,e,i);this.nodeDataCache[e]=o,this.nodesWithForcedLabels.delete(e),o.forceLabel&&!o.hidden&&this.nodesWithForcedLabels.add(e),this.highlightedNodes.delete(e),o.highlighted&&!o.hidden&&this.highlightedNodes.add(e),this.settings.zIndex&&(o.zIndex<this.nodeZExtent[0]&&(this.nodeZExtent[0]=o.zIndex),o.zIndex>this.nodeZExtent[1]&&(this.nodeZExtent[1]=o.zIndex))}},{key:"updateNode",value:function(e){this.addNode(e);var i=this.nodeDataCache[e];this.normalizationFunction.applyTo(i)}},{key:"removeNode",value:function(e){delete this.nodeDataCache[e],delete this.nodeProgramIndex[e],this.highlightedNodes.delete(e),this.hoveredNode===e&&(this.hoveredNode=null),this.nodesWithForcedLabels.delete(e)}},{key:"addEdge",value:function(e){var i=Object.assign({},this.graph.getEdgeAttributes(e));this.settings.edgeReducer&&(i=this.settings.edgeReducer(e,i));var o=Mc(this.settings,e,i);this.edgeDataCache[e]=o,this.edgesWithForcedLabels.delete(e),o.forceLabel&&!o.hidden&&this.edgesWithForcedLabels.add(e),this.settings.zIndex&&(o.zIndex<this.edgeZExtent[0]&&(this.edgeZExtent[0]=o.zIndex),o.zIndex>this.edgeZExtent[1]&&(this.edgeZExtent[1]=o.zIndex))}},{key:"updateEdge",value:function(e){this.addEdge(e)}},{key:"removeEdge",value:function(e){delete this.edgeDataCache[e],delete this.edgeProgramIndex[e],this.hoveredEdge===e&&(this.hoveredEdge=null),this.edgesWithForcedLabels.delete(e)}},{key:"clearNodeIndices",value:function(){this.labelGrid=new Pi,this.nodeExtent={x:[0,1],y:[0,1]},this.nodeDataCache={},this.edgeProgramIndex={},this.nodesWithForcedLabels=new Set,this.nodeZExtent=[1/0,-1/0],this.highlightedNodes=new Set}},{key:"clearEdgeIndices",value:function(){this.edgeDataCache={},this.edgeProgramIndex={},this.edgesWithForcedLabels=new Set,this.edgeZExtent=[1/0,-1/0]}},{key:"clearIndices",value:function(){this.clearEdgeIndices(),this.clearNodeIndices()}},{key:"clearNodeState",value:function(){this.displayedNodeLabels=new Set,this.highlightedNodes=new Set,this.hoveredNode=null}},{key:"clearEdgeState",value:function(){this.displayedEdgeLabels=new Set,this.highlightedNodes=new Set,this.hoveredEdge=null}},{key:"clearState",value:function(){this.clearEdgeState(),this.clearNodeState()}},{key:"addNodeToProgram",value:function(e,i,o){var a=this.nodeDataCache[e],s=this.nodePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for node type "'.concat(a.type,'"!'));s.process(i,o,a),this.nodeProgramIndex[e]=o}},{key:"addEdgeToProgram",value:function(e,i,o){var a=this.edgeDataCache[e],s=this.edgePrograms[a.type];if(!s)throw new Error('Sigma: could not find a suitable program for edge type "'.concat(a.type,'"!'));var u=this.graph.extremities(e),l=this.nodeDataCache[u[0]],c=this.nodeDataCache[u[1]];s.process(i,o,l,c,a),this.edgeProgramIndex[e]=o}},{key:"getRenderParams",value:function(){return{matrix:this.matrix,invMatrix:this.invMatrix,width:this.width,height:this.height,pixelRatio:this.pixelRatio,zoomRatio:this.camera.ratio,cameraAngle:this.camera.angle,sizeRatio:1/this.scaleSize(),correctionRatio:this.correctionRatio,downSizingRatio:this.pickingDownSizingRatio,minEdgeThickness:this.settings.minEdgeThickness,antiAliasingFeather:this.settings.antiAliasingFeather}}},{key:"getStagePadding",value:function(){var e=this.settings,i=e.stagePadding,o=e.autoRescale;return o&&i||0}},{key:"createLayer",value:function(e,i){var o=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};if(this.elements[e])throw new Error('Sigma: a layer named "'.concat(e,'" already exists'));var a=Ks(i,{position:"absolute"},{class:"sigma-".concat(e)});return o.style&&Object.assign(a.style,o.style),this.elements[e]=a,"beforeLayer"in o&&o.beforeLayer?this.elements[o.beforeLayer].before(a):"afterLayer"in o&&o.afterLayer?this.elements[o.afterLayer].after(a):this.container.appendChild(a),a}},{key:"createCanvas",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.createLayer(e,"canvas",i)}},{key:"createCanvasContext",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=this.createCanvas(e,i),a={preserveDrawingBuffer:!1,antialias:!1};return this.canvasContexts[e]=o.getContext("2d",a),this}},{key:"createWebGLContext",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=(i==null?void 0:i.canvas)||this.createCanvas(e,i);i.hidden&&o.remove();var a=re({preserveDrawingBuffer:!1,antialias:!1},i),s;s=o.getContext("webgl2",a),s||(s=o.getContext("webgl",a)),s||(s=o.getContext("experimental-webgl",a));var u=s;if(this.webGLContexts[e]=u,u.blendFunc(u.ONE,u.ONE_MINUS_SRC_ALPHA),i.picking){this.pickingLayers.add(e);var l=u.createFramebuffer();if(!l)throw new Error("Sigma: cannot create a new frame buffer for layer ".concat(e));this.frameBuffers[e]=l}return u}},{key:"killLayer",value:function(e){var i=this.elements[e];if(!i)throw new Error("Sigma: cannot kill layer ".concat(e,", which does not exist"));if(this.webGLContexts[e]){var o,a=this.webGLContexts[e];(o=a.getExtension("WEBGL_lose_context"))===null||o===void 0||o.loseContext(),delete this.webGLContexts[e]}else this.canvasContexts[e]&&delete this.canvasContexts[e];return i.remove(),delete this.elements[e],this}},{key:"getCamera",value:function(){return this.camera}},{key:"setCamera",value:function(e){this.unbindCameraHandlers(),this.camera=e,this.bindCameraHandlers()}},{key:"getContainer",value:function(){return this.container}},{key:"getGraph",value:function(){return this.graph}},{key:"setGraph",value:function(e){e!==this.graph&&(this.hoveredNode&&!e.hasNode(this.hoveredNode)&&(this.hoveredNode=null),this.hoveredEdge&&!e.hasEdge(this.hoveredEdge)&&(this.hoveredEdge=null),this.unbindGraphHandlers(),this.checkEdgesEventsFrame!==null&&(cancelAnimationFrame(this.checkEdgesEventsFrame),this.checkEdgesEventsFrame=null),this.graph=e,this.bindGraphHandlers(),this.refresh())}},{key:"getMouseCaptor",value:function(){return this.mouseCaptor}},{key:"getTouchCaptor",value:function(){return this.touchCaptor}},{key:"getDimensions",value:function(){return{width:this.width,height:this.height}}},{key:"getGraphDimensions",value:function(){var e=this.customBBox||this.nodeExtent;return{width:e.x[1]-e.x[0]||1,height:e.y[1]-e.y[0]||1}}},{key:"getNodeDisplayData",value:function(e){var i=this.nodeDataCache[e];return i?Object.assign({},i):void 0}},{key:"getEdgeDisplayData",value:function(e){var i=this.edgeDataCache[e];return i?Object.assign({},i):void 0}},{key:"getNodeDisplayedLabels",value:function(){return new Set(this.displayedNodeLabels)}},{key:"getEdgeDisplayedLabels",value:function(){return new Set(this.displayedEdgeLabels)}},{key:"getSettings",value:function(){return re({},this.settings)}},{key:"getSetting",value:function(e){return this.settings[e]}},{key:"setSetting",value:function(e,i){var o=re({},this.settings);return this.settings[e]=i,Mr(this.settings),this.handleSettingsUpdate(o),this.scheduleRefresh(),this}},{key:"updateSetting",value:function(e,i){return this.setSetting(e,i(this.settings[e])),this}},{key:"setSettings",value:function(e){var i=re({},this.settings);return this.settings=re(re({},this.settings),e),Mr(this.settings),this.handleSettingsUpdate(i),this.scheduleRefresh(),this}},{key:"resize",value:function(e){var i=this.width,o=this.height;if(this.width=this.container.offsetWidth,this.height=this.container.offsetHeight,this.pixelRatio=Vn(),this.width===0)if(this.settings.allowInvalidContainer)this.width=1;else throw new Error("Sigma: Container has no width. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(this.height===0)if(this.settings.allowInvalidContainer)this.height=1;else throw new Error("Sigma: Container has no height. You can set the allowInvalidContainer setting to true to stop seeing this error.");if(!e&&i===this.width&&o===this.height)return this;for(var a in this.elements){var s=this.elements[a];s.style.width=this.width+"px",s.style.height=this.height+"px"}for(var u in this.canvasContexts)this.elements[u].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[u].setAttribute("height",this.height*this.pixelRatio+"px"),this.pixelRatio!==1&&this.canvasContexts[u].scale(this.pixelRatio,this.pixelRatio);for(var l in this.webGLContexts){this.elements[l].setAttribute("width",this.width*this.pixelRatio+"px"),this.elements[l].setAttribute("height",this.height*this.pixelRatio+"px");var c=this.webGLContexts[l];if(c.viewport(0,0,this.width*this.pixelRatio,this.height*this.pixelRatio),this.pickingLayers.has(l)){var d=this.textures[l];d&&c.deleteTexture(d)}}return this.emit("resize"),this}},{key:"clear",value:function(){return this.emit("beforeClear"),this.webGLContexts.nodes.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.nodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.edges.bindFramebuffer(WebGLRenderingContext.FRAMEBUFFER,null),this.webGLContexts.edges.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.webGLContexts.hoverNodes.clear(WebGLRenderingContext.COLOR_BUFFER_BIT),this.canvasContexts.labels.clearRect(0,0,this.width,this.height),this.canvasContexts.hovers.clearRect(0,0,this.width,this.height),this.canvasContexts.edgeLabels.clearRect(0,0,this.width,this.height),this.emit("afterClear"),this}},{key:"refresh",value:function(e){var i=this,o=(e==null?void 0:e.skipIndexation)!==void 0?e==null?void 0:e.skipIndexation:!1,a=(e==null?void 0:e.schedule)!==void 0?e.schedule:!1,s=!e||!e.partialGraph;if(s)this.clearEdgeIndices(),this.clearNodeIndices(),this.graph.forEachNode(function(_){return i.addNode(_)}),this.graph.forEachEdge(function(_){return i.addEdge(_)});else{for(var u,l,c=((u=e.partialGraph)===null||u===void 0?void 0:u.nodes)||[],d=0,f=(c==null?void 0:c.length)||0;d<f;d++){var h=c[d];if(this.updateNode(h),o){var m=this.nodeProgramIndex[h];if(m===void 0)throw new Error('Sigma: node "'.concat(h,`" can't be repaint`));this.addNodeToProgram(h,this.nodeIndices[h],m)}}for(var v=(e==null||(l=e.partialGraph)===null||l===void 0?void 0:l.edges)||[],b=0,x=v.length;b<x;b++){var T=v[b];if(this.updateEdge(T),o){var E=this.edgeProgramIndex[T];if(E===void 0)throw new Error('Sigma: edge "'.concat(T,`" can't be repaint`));this.addEdgeToProgram(T,this.edgeIndices[T],E)}}}return(s||!o)&&(this.needToProcess=!0),a?this.scheduleRender():this.render(),this}},{key:"scheduleRender",value:function(){var e=this;return this.renderFrame||(this.renderFrame=requestAnimationFrame(function(){e.render()})),this}},{key:"scheduleRefresh",value:function(e){return this.refresh(re(re({},e),{},{schedule:!0}))}},{key:"getViewportZoomedState",value:function(e,i){var o=this.camera.getState(),a=o.ratio,s=o.angle,u=o.x,l=o.y,c=this.settings,d=c.minCameraRatio,f=c.maxCameraRatio;typeof f=="number"&&(i=Math.min(i,f)),typeof d=="number"&&(i=Math.max(i,d));var h=i/a,m={x:this.width/2,y:this.height/2},v=this.viewportToFramedGraph(e),b=this.viewportToFramedGraph(m);return{angle:s,x:(v.x-b.x)*(1-h)+u,y:(v.y-b.y)*(1-h)+l,ratio:i}}},{key:"viewRectangle",value:function(){var e=this.viewportToFramedGraph({x:0,y:0}),i=this.viewportToFramedGraph({x:this.width,y:0}),o=this.viewportToFramedGraph({x:0,y:this.height});return{x1:e.x,y1:e.y,x2:i.x,y2:i.y,height:i.y-o.y}}},{key:"framedGraphToViewport",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!i.cameraState||!!i.viewportDimensions||!!i.graphDimensions,a=i.matrix?i.matrix:o?Ct(i.cameraState||this.camera.getState(),i.viewportDimensions||this.getDimensions(),i.graphDimensions||this.getGraphDimensions(),i.padding||this.getStagePadding()):this.matrix,s=Qr(a,e);return{x:(1+s.x)*this.width/2,y:(1-s.y)*this.height/2}}},{key:"viewportToFramedGraph",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},o=!!i.cameraState||!!i.viewportDimensions||!i.graphDimensions,a=i.matrix?i.matrix:o?Ct(i.cameraState||this.camera.getState(),i.viewportDimensions||this.getDimensions(),i.graphDimensions||this.getGraphDimensions(),i.padding||this.getStagePadding(),!0):this.invMatrix,s=Qr(a,{x:e.x/this.width*2-1,y:1-e.y/this.height*2});return isNaN(s.x)&&(s.x=0),isNaN(s.y)&&(s.y=0),s}},{key:"viewportToGraph",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.normalizationFunction.inverse(this.viewportToFramedGraph(e,i))}},{key:"graphToViewport",value:function(e){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};return this.framedGraphToViewport(this.normalizationFunction(e),i)}},{key:"getGraphToViewportRatio",value:function(){var e={x:0,y:0},i={x:1,y:1},o=Math.sqrt(Math.pow(e.x-i.x,2)+Math.pow(e.y-i.y,2)),a=this.graphToViewport(e),s=this.graphToViewport(i),u=Math.sqrt(Math.pow(a.x-s.x,2)+Math.pow(a.y-s.y,2));return u/o}},{key:"getBBox",value:function(){return this.nodeExtent}},{key:"getCustomBBox",value:function(){return this.customBBox}},{key:"setCustomBBox",value:function(e){return this.customBBox=e,this.scheduleRender(),this}},{key:"kill",value:function(){this.emit("kill"),this.removeAllListeners(),this.unbindCameraHandlers(),window.removeEventListener("resize",this.activeListeners.handleResize),this.mouseCaptor.kill(),this.touchCaptor.kill(),this.unbindGraphHandlers(),this.clearIndices(),this.clearState(),this.nodeDataCache={},this.edgeDataCache={},this.highlightedNodes.clear(),this.renderFrame&&(cancelAnimationFrame(this.renderFrame),this.renderFrame=null),this.renderHighlightedNodesFrame&&(cancelAnimationFrame(this.renderHighlightedNodesFrame),this.renderHighlightedNodesFrame=null);for(var e=this.container;e.firstChild;)e.removeChild(e.firstChild);for(var i in this.nodePrograms)this.nodePrograms[i].kill();for(var o in this.nodeHoverPrograms)this.nodeHoverPrograms[o].kill();for(var a in this.edgePrograms)this.edgePrograms[a].kill();this.nodePrograms={},this.nodeHoverPrograms={},this.edgePrograms={};for(var s in this.elements)this.killLayer(s);this.canvasContexts={},this.webGLContexts={},this.elements={}}},{key:"scaleSize",value:function(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:1,i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.camera.ratio;return e/this.settings.zoomToSizeRatioFunction(i)*(this.getSetting("itemSizesReference")==="positions"?i*this.graphToViewportRatio:1)}},{key:"getCanvases",value:function(){var e={};for(var i in this.elements)this.elements[i]instanceof HTMLCanvasElement&&(e[i]=this.elements[i]);return e}}])}(En),jc=Uc;function aa(n,r,t,e){const i=(1-n)**2*r.x+2*(1-n)*n*t.x+n**2*e.x,o=(1-n)**2*r.y+2*(1-n)*n*t.y+n**2*e.y;return{x:i,y:o}}function Hc(n,r,t){let i=0,o=n;for(let a=0;a<20;a++){const s=aa((a+1)/20,n,r,t);i+=Math.sqrt((o.x-s.x)**2+(o.y-s.y)**2),o=s}return i}function Wc({curvatureAttribute:n,defaultCurvature:r,keepLabelUpright:t=!0}){return(e,i,o,a,s)=>{const u=s.edgeLabelSize,l=i[n]||r,c=s.edgeLabelFont,d=s.edgeLabelWeight;let f=i.color??s.defaultEdgeColor;i.selected&&(f="#f00"),i.highlight&&(f="#F54A4A");let h=i.label;if(!h||i.opacity<1)return;e.font=`${d} ${u}px ${c}`;const m=!t||o.x<a.x;let v=m?o.x:a.x,b=m?o.y:a.y,x=m?a.x:o.x,T=m?a.y:o.y;const E=(v+x)/2,_=(b+T)/2,A=x-v,L=T-b,y=Math.sqrt(A**2+L**2),C=m?1:-1;let S=E+L*l*C,D=_-A*l*C;const G=i.size*.7+5,O={x:D-b,y:-(S-v)},R=Math.sqrt(O.x**2+O.y**2),H={x:T-D,y:-(x-S)},$=Math.sqrt(H.x**2+H.y**2);v+=G*O.x/R,b+=G*O.y/R,x+=G*H.x/$,T+=G*H.y/$,S+=G*L/y,D-=G*A/y;const w={x:S,y:D},p={x:v,y:b},g={x,y:T},z=Hc(p,w,g);if(z<o.size+a.size)return;let M=e.measureText(h).width;const P=z-o.size-a.size;if(M>P){const B="…";for(h=h+B,M=e.measureText(h).width;M>P&&h.length>1;)h=h.slice(0,-2)+B,M=e.measureText(h).width;if(h.length<4)return}const k={};for(let B=0,Y=h.length;B<Y;B++){const ee=h[B];k[ee]||(k[ee]=e.measureText(ee).width*(1+l*.35))}let F=.5-M/z/2;for(let B=0,Y=h.length;B<Y;B++){const ee=h[B],q=aa(F,p,w,g),W=2*(1-F)*(S-v)+2*F*(x-S),oe=2*(1-F)*(D-b)+2*F*(T-D),Z=Math.atan2(oe,W);e.save(),e.translate(q.x,q.y),e.rotate(Z),e.fillStyle=f,e.fillText(ee,0,0),e.restore(),F+=k[ee]/z}}}const Bc=`
precision highp float;

varying vec4 v_color;
varying float v_opacity;
varying float v_thickness;
varying float v_feather;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;
varying float v_sourceSize;
varying vec2 v_sourcePoint;
varying float v_targetSize;
varying vec2 v_targetPoint;

uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

float det(vec2 a, vec2 b) {
  return a.x * b.y - b.x * a.y;
}

vec2 getDistanceVector(vec2 b0, vec2 b1, vec2 b2) {
  float a = det(b0, b2), b = 2.0 * det(b1, b0), d = 2.0 * det(b2, b1);
  float f = b * d - a * a;
  vec2 d21 = b2 - b1, d10 = b1 - b0, d20 = b2 - b0;
  vec2 gf = 2.0 * (b * d21 + d * d10 + a * d20);
  gf = vec2(gf.y, -gf.x);
  vec2 pp = -f * gf / dot(gf, gf);
  vec2 d0p = b0 - pp;
  float ap = det(d0p, d20), bp = 2.0 * det(d10, d0p);
  float t = clamp((ap + bp) / (2.0 * a + b + d), 0.0, 1.0);
  return mix(mix(b0, b1, t), mix(b1, b2, t), t);
}

float distToQuadraticBezierCurve(vec2 p, vec2 b0, vec2 b1, vec2 b2) {
  return length(getDistanceVector(b0 - p, b1 - p, b2 - p));
}

const float epsilon = 0.7;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float dist = distToQuadraticBezierCurve(gl_FragCoord.xy, v_cpA, v_cpB, v_cpC);
  float thickness = v_thickness;

  if(v_sourceSize > 0.0) {
    float distToSource = length(gl_FragCoord.xy - v_sourcePoint);
    float sourceArrowLength = v_sourceSize + (thickness) * u_lengthToThicknessRatio;
    if (distToSource < sourceArrowLength) {
      thickness = (distToSource - v_sourceSize) / (sourceArrowLength - v_sourceSize) * u_widenessToThicknessRatio * thickness;
    }
  }

  if(v_targetSize > 0.0) {
    float distToTarget = length(gl_FragCoord.xy - v_targetPoint);
    float targetArrowLength = v_targetSize + (thickness) * u_lengthToThicknessRatio;
    if (distToTarget < targetArrowLength) {
      thickness = (distToTarget - v_targetSize) / (targetArrowLength - v_targetSize) * u_widenessToThicknessRatio * thickness;
    }
  }

  float halfThickness = thickness / 2.0;
  if (dist < halfThickness) {
    #ifdef PICKING_MODE
    gl_FragColor = v_color;
    #else
    float t = smoothstep(
      halfThickness - v_feather,
      halfThickness,
      dist
    );

    gl_FragColor = mix(v_color, transparent, t);
    gl_FragColor = mix(transparent, gl_FragColor, v_opacity);
    #endif
  } else {
    gl_FragColor = transparent;
  }
}
`,Vc=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute float a_direction;
attribute float a_thickness;
attribute float a_opacity;
attribute vec2 a_source;
attribute vec2 a_target;
attribute float a_current;
attribute float a_curvature;
attribute float a_sourceSize;
attribute float a_targetSize;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_pixelRatio;
uniform vec2 u_dimensions;
uniform float u_minEdgeThickness;
uniform float u_feather;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;
varying float v_opacity;
varying float v_thickness;
varying float v_feather;
varying vec2 v_cpA;
varying vec2 v_cpB;
varying vec2 v_cpC;
varying float v_sourceSize;
varying vec2 v_sourcePoint;
varying float v_targetSize;
varying vec2 v_targetPoint;

const float bias = 255.0 / 254.0;
const float epsilon = 0.7;

vec2 clipspaceToViewport(vec2 pos, vec2 dimensions) {
  return vec2(
    (pos.x + 1.0) * dimensions.x / 2.0,
    (pos.y + 1.0) * dimensions.y / 2.0
  );
}

vec2 viewportToClipspace(vec2 pos, vec2 dimensions) {
  return vec2(
    pos.x / dimensions.x * 2.0 - 1.0,
    pos.y / dimensions.y * 2.0 - 1.0
  );
}

void main() {
  float minThickness = u_minEdgeThickness;
  // Selecting the correct position
  // Branchless "position = a_source if a_current == 1.0 else a_target"
  vec2 position = a_source * max(0.0, a_current) + a_target * max(0.0, 1.0 - a_current);
  position = (u_matrix * vec3(position, 1)).xy;

  vec2 source = (u_matrix * vec3(a_source, 1)).xy;
  vec2 target = (u_matrix * vec3(a_target, 1)).xy;

  vec2 viewportPosition = clipspaceToViewport(position, u_dimensions);
  vec2 viewportSource = clipspaceToViewport(source, u_dimensions);
  vec2 viewportTarget = clipspaceToViewport(target, u_dimensions);

  vec2 delta = viewportTarget.xy - viewportSource.xy;
  float len = length(delta);
  vec2 normal = vec2(-delta.y, delta.x) * a_direction;
  vec2 unitNormal = normal / len;
  float boundingBoxThickness = len * a_curvature;
  float curveThickness = max(minThickness, a_thickness / 2.0 / u_sizeRatio * u_pixelRatio);

  v_thickness = curveThickness;
  v_feather = u_feather;

  v_cpA = viewportSource;
  v_cpB = 0.5 * (viewportSource + viewportTarget) + unitNormal * a_direction * boundingBoxThickness;
  v_cpC = viewportTarget;

  vec2 viewportOffsetPosition = (
    viewportPosition +
    unitNormal * (boundingBoxThickness / 2.0 + sign(boundingBoxThickness) * (curveThickness + epsilon)) *
    max(0.0, a_direction) // NOTE: cutting the bounding box in half to avoid overdraw
  );

  position = viewportToClipspace(viewportOffsetPosition, u_dimensions);
  gl_Position = vec4(position, 0, 1);

  v_sourceSize = a_sourceSize * u_pixelRatio / u_sizeRatio;
  v_sourcePoint = viewportSource;
  
  v_targetSize = a_targetSize * u_pixelRatio / u_sizeRatio;
  v_targetPoint = viewportTarget;
    
  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  v_opacity = a_opacity;
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:Ii,FLOAT:je}=WebGLRenderingContext,qc=["u_matrix","u_sizeRatio","u_dimensions","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"];class Xc extends st{getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Vc,FRAGMENT_SHADER_SOURCE:Bc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:qc,ATTRIBUTES:[{name:"a_source",size:2,type:je},{name:"a_target",size:2,type:je},{name:"a_thickness",size:1,type:je},{name:"a_curvature",size:1,type:je},{name:"a_color",size:4,type:Ii,normalized:!0},{name:"a_opacity",size:1,type:je},{name:"a_id",size:4,type:Ii,normalized:!0},{name:"a_sourceSize",size:1,type:je},{name:"a_targetSize",size:1,type:je}],CONSTANT_ATTRIBUTES:[{name:"a_current",size:1,type:je},{name:"a_direction",size:1,type:je}],CONSTANT_DATA:[[0,1],[0,-1],[1,1],[0,-1],[1,1],[1,-1]]}}processVisibleItem(r,t,e,i,o){let a=o.color??this.renderer.getSetting("defaultEdgeColor");o.selected&&(a="#f00"),o.highlight&&(a="#F54A4A");const s=Math.min(o.size||1,.5)*(o.selected||o.highlight?16:8),u=e.x,l=e.y,c=i.x,d=i.y,f=o.curvature??Ht,h=e.size||1,m=i.size||1,v=this.array;v[t++]=u,v[t++]=l,v[t++]=c,v[t++]=d,v[t++]=s,v[t++]=f,v[t++]=ge(a),v[t++]=o.opacity??1,v[t++]=r,v[t++]=["both","source"].includes(o.arrow??"")?h:0,v[t++]=["both","target"].includes(o.arrow??"")?m:0}setUniforms(r,{gl:t,uniformLocations:e}){const{u_matrix:i,u_pixelRatio:o,u_feather:a,u_sizeRatio:s,u_dimensions:u,u_minEdgeThickness:l,u_lengthToThicknessRatio:c,u_widenessToThicknessRatio:d}=e;t.uniformMatrix3fv(i,!1,r.matrix),t.uniform1f(o,r.pixelRatio),t.uniform1f(s,r.sizeRatio),t.uniform1f(a,r.antiAliasingFeather),t.uniform2f(u,r.width*r.pixelRatio,r.height*r.pixelRatio),t.uniform1f(l,r.minEdgeThickness),t.uniform1f(c,2.5),t.uniform1f(d,2)}}const Yc=pn([Xc],Wc({curvatureAttribute:"curvature",defaultCurvature:Ht})),Kc=`
precision mediump float;

varying vec4 v_color;
varying float v_opacity;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  gl_FragColor = v_color;
  gl_FragColor = mix(transparent, gl_FragColor, v_opacity);
}
`,Zc=`
attribute vec2 a_position;
attribute vec2 a_normal;
attribute float a_radius;
attribute vec3 a_barycentric;
attribute float a_opacity;

#ifdef PICKING_MODE
attribute vec4 a_id;
#else
attribute vec4 a_color;
#endif

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_widenessToThicknessRatio;

varying vec4 v_color;
varying float v_opacity;

const float bias = 255.0 / 254.0;

void main() {
  float minThickness = u_minEdgeThickness;

  float normalLength = length(a_normal);
  vec2 unitNormal = a_normal / normalLength;

  // These first computations are taken from edge.vert.glsl and
  // edge.clamped.vert.glsl. Please read it to get better comments on what's
  // happening:
  float pixelsThickness = max(normalLength / u_sizeRatio, minThickness);
  float webGLThickness = pixelsThickness * u_correctionRatio;
  float webGLNodeRadius = a_radius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  float webGLArrowHeadThickness = webGLThickness * u_widenessToThicknessRatio;

  float da = a_barycentric.x;
  float db = a_barycentric.y;
  float dc = a_barycentric.z;

  vec2 delta = vec2(
      da * (webGLNodeRadius * unitNormal.y)
    + db * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y + webGLArrowHeadThickness * unitNormal.x)
    + dc * ((webGLNodeRadius + webGLArrowHeadLength) * unitNormal.y - webGLArrowHeadThickness * unitNormal.x),

      da * (-webGLNodeRadius * unitNormal.x)
    + db * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x + webGLArrowHeadThickness * unitNormal.y)
    + dc * (-(webGLNodeRadius + webGLArrowHeadLength) * unitNormal.x - webGLArrowHeadThickness * unitNormal.y)
  );

  vec2 position = (u_matrix * vec3(a_position + delta, 1)).xy;

  gl_Position = vec4(position, 0, 1);

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  v_opacity = a_opacity;
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:zi,FLOAT:Nt}=WebGLRenderingContext,Jc=["u_matrix","u_sizeRatio","u_correctionRatio","u_minEdgeThickness","u_lengthToThicknessRatio","u_widenessToThicknessRatio"],Qc={extremity:"target",lengthToThicknessRatio:2.5,widenessToThicknessRatio:2};function Fi(n){const r={...Qc,...n||{}};return class extends st{getDefinition(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Zc,FRAGMENT_SHADER_SOURCE:Kc,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Jc,ATTRIBUTES:[{name:"a_position",size:2,type:Nt},{name:"a_normal",size:2,type:Nt},{name:"a_radius",size:1,type:Nt},{name:"a_color",size:4,type:zi,normalized:!0},{name:"a_opacity",size:1,type:Nt},{name:"a_id",size:4,type:zi,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_barycentric",size:3,type:Nt}],CONSTANT_DATA:[[1,0,0],[0,1,0],[0,0,1]]}}processVisibleItem(e,i,o,a,s){r.extremity==="source"&&([o,a]=[a,o]);const u=Math.min(s.size||1,.5)*8,l=a.size||1,c=o.x,d=o.y,f=a.x,h=a.y;let m=s.color;s.selected&&(m="#f00"),s.highlight&&(m="#F54A4A");const v=f-c,b=h-d;let x=v*v+b*b,T=0,E=0;x&&(x=1/Math.sqrt(x),T=-b*x*u,E=v*x*u);const _=this.array;_[i++]=f,_[i++]=h,_[i++]=-T,_[i++]=-E,_[i++]=l,_[i++]=ge(m),_[i++]=["both",r.extremity].includes(s.arrow??"")?s.opacity??1:0,_[i++]=e}setUniforms(e,{gl:i,uniformLocations:o}){const{u_matrix:a,u_sizeRatio:s,u_correctionRatio:u,u_minEdgeThickness:l,u_lengthToThicknessRatio:c,u_widenessToThicknessRatio:d}=o;i.uniformMatrix3fv(a,!1,e.matrix),i.uniform1f(s,e.sizeRatio),i.uniform1f(u,e.correctionRatio),i.uniform1f(l,e.minEdgeThickness),i.uniform1f(c,2.5),i.uniform1f(d,2)}}}function ed(n,r,t,e,i){const o=i.edgeLabelSize,a=i.edgeLabelFont,s=i.edgeLabelWeight;let u=r.color??i.defaultEdgeColor;r.selected&&(u="#f00"),r.highlight&&(u="#F54A4A");let l=r.label;if(!l||r.opacity<1)return;n.font=`${s} ${o}px ${a}`;const c=t.size,d=e.size;let f=t.x,h=t.y,m=e.x,v=e.y,b=(f+m)/2,x=(h+v)/2,T=m-f,E=v-h,_=Math.sqrt(T*T+E*E);if(_<c+d)return;f+=T*c/_,h+=E*c/_,m-=T*d/_,v-=E*d/_,b=(f+m)/2,x=(h+v)/2,T=m-f,E=v-h,_=Math.sqrt(T*T+E*E);let A=n.measureText(l).width;if(A>_){const y="…";for(l=l+y,A=n.measureText(l).width;A>_&&l.length>1;)l=l.slice(0,-2)+y,A=n.measureText(l).width;if(l.length<4)return}let L;T>0?E>0?L=Math.acos(T/_):L=Math.asin(E/_):E>0?L=Math.acos(T/_)+Math.PI:L=Math.asin(T/_)+Math.PI/2,n.save(),n.translate(b,x),n.rotate(L),n.fillStyle=i.defaultNodeColor||"#fff",n.fillRect(-A/2-4,r.size-o+2,A+8,o+2),n.fillStyle=u,n.fillText(l,-A/2,r.size),n.restore()}const td=`
precision mediump float;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_opacity;
varying float v_thickness;
varying float v_feather;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  // We only handle antialiasing for normal mode:
  #ifdef PICKING_MODE
  gl_FragColor = v_color;
  #else
  float dist = length(v_normal) * v_thickness;

  float t = smoothstep(
    v_thickness - v_feather,
    v_thickness,
    dist
  );

  gl_FragColor = mix(v_color, transparent, t);
  gl_FragColor = mix(transparent, gl_FragColor, v_opacity);
  #endif
}
`,rd=`
attribute vec4 a_id;
attribute vec4 a_color;
attribute vec2 a_normal;
attribute float a_opacity;
attribute float a_normalCoef;
attribute vec2 a_positionStart;
attribute vec2 a_positionEnd;
attribute float a_positionCoef;
attribute float a_sourceRadius;
attribute float a_targetRadius;
attribute float a_sourceRadiusCoef;
attribute float a_targetRadiusCoef;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_zoomRatio;
uniform float u_pixelRatio;
uniform float u_correctionRatio;
uniform float u_minEdgeThickness;
uniform float u_lengthToThicknessRatio;
uniform float u_feather;

varying vec4 v_color;
varying vec2 v_normal;
varying float v_opacity;
varying float v_thickness;
varying float v_feather;

const float minThickness = 1.7;
const float bias = 255.0 / 254.0;

void main() {
  vec2 normal = a_normal * a_normalCoef;
  vec2 position = a_positionStart * (1.0 - a_positionCoef) + a_positionEnd * a_positionCoef;

  float normalLength = length(normal);
  vec2 unitNormal = normal / normalLength;

  // We require edges to be at least "minThickness" pixels thick *on screen*
  // (so we need to compensate the size ratio):
  float pixelsThickness = max(normalLength, minThickness * u_sizeRatio);

  // Then, we need to retrieve the normalized thickness of the edge in the WebGL
  // referential (in a ([0, 1], [0, 1]) space), using our "magic" correction
  // ratio:
  float webGLThickness = pixelsThickness * u_correctionRatio / u_sizeRatio;

  // Here, we move the point to leave space for the arrow heads:
  // Source arrow head
  float sourceRadius = a_sourceRadius * a_sourceRadiusCoef;
  float sourceDirection = sign(sourceRadius);
  float webGLSourceRadius = sourceDirection * sourceRadius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLSourceArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  vec2 sourceCompensationVector =
    vec2(-sourceDirection * unitNormal.y, sourceDirection * unitNormal.x)
    * (webGLSourceRadius + webGLSourceArrowHeadLength);
    
  // Target arrow head
  float targetRadius = a_targetRadius * a_targetRadiusCoef;
  float targetDirection = sign(targetRadius);
  float webGLTargetRadius = targetDirection * targetRadius * 2.0 * u_correctionRatio / u_sizeRatio;
  float webGLTargetArrowHeadLength = webGLThickness * u_lengthToThicknessRatio * 2.0;
  vec2 targetCompensationVector =
  vec2(-targetDirection * unitNormal.y, targetDirection * unitNormal.x)
    * (webGLTargetRadius + webGLTargetArrowHeadLength);

  if(a_sourceRadius == 0.0) {
    sourceCompensationVector = vec2(0.0, 0.0);
  }
  if(a_targetRadius == 0.0) {
    targetCompensationVector = vec2(0.0, 0.0);
  }

  // Here is the proper position of the vertex
  gl_Position = vec4((u_matrix * vec3(position + unitNormal * webGLThickness + sourceCompensationVector + targetCompensationVector, 1)).xy, 0, 1);

  // For the fragment shader though, we need a thickness that takes the "magic"
  // correction ratio into account (as in webGLThickness), but so that the
  // antialiasing effect does not depend on the zoom level. So here's yet
  // another thickness version:
  v_thickness = webGLThickness / u_zoomRatio;

  v_normal = unitNormal;

  v_feather = u_feather * u_correctionRatio / u_zoomRatio / u_pixelRatio * 2.0;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_color = a_color;
  v_opacity = a_opacity;
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:$i,FLOAT:Fe}=WebGLRenderingContext,nd=["u_matrix","u_zoomRatio","u_sizeRatio","u_correctionRatio","u_pixelRatio","u_feather","u_minEdgeThickness","u_lengthToThicknessRatio"];class id extends st{getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:rd,FRAGMENT_SHADER_SOURCE:td,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:nd,ATTRIBUTES:[{name:"a_positionStart",size:2,type:Fe},{name:"a_positionEnd",size:2,type:Fe},{name:"a_normal",size:2,type:Fe},{name:"a_color",size:4,type:$i,normalized:!0},{name:"a_opacity",size:1,type:Fe},{name:"a_id",size:4,type:$i,normalized:!0},{name:"a_sourceRadius",size:1,type:Fe},{name:"a_targetRadius",size:1,type:Fe}],CONSTANT_ATTRIBUTES:[{name:"a_positionCoef",size:1,type:Fe},{name:"a_normalCoef",size:1,type:Fe},{name:"a_sourceRadiusCoef",size:1,type:Fe},{name:"a_targetRadiusCoef",size:1,type:Fe}],CONSTANT_DATA:[[0,1,-1,0],[0,-1,1,0],[1,1,0,1],[1,1,0,1],[0,-1,1,0],[1,-1,0,-1]]}}processVisibleItem(r,t,e,i,o){let a=o.color??this.renderer.getSetting("defaultEdgeColor");o.selected&&(a="#f00"),o.highlight&&(a="#F54A4A");const s=Math.min(o.size||1,.5)*(o.selected||o.highlight?8:4),u=e.x,l=e.y,c=i.x,d=i.y,f=c-u,h=d-l,m=e.size||1,v=i.size||1;let b=f*f+h*h,x=0,T=0;b&&(b=1/Math.sqrt(b),x=-h*b*s,T=f*b*s);const E=this.array;E[t++]=u,E[t++]=l,E[t++]=c,E[t++]=d,E[t++]=x,E[t++]=T,E[t++]=ge(a),E[t++]=o.opacity??1,E[t++]=r,E[t++]=["both","source"].includes(o.arrow??"")?m:0,E[t++]=["both","target"].includes(o.arrow??"")?v:0}setUniforms(r,{gl:t,uniformLocations:e}){const{u_matrix:i,u_zoomRatio:o,u_feather:a,u_pixelRatio:s,u_correctionRatio:u,u_sizeRatio:l,u_minEdgeThickness:c,u_lengthToThicknessRatio:d}=e;t.uniformMatrix3fv(i,!1,r.matrix),t.uniform1f(o,r.zoomRatio),t.uniform1f(l,r.sizeRatio),t.uniform1f(u,r.correctionRatio),t.uniform1f(s,r.pixelRatio),t.uniform1f(a,r.antiAliasingFeather),t.uniform1f(c,r.minEdgeThickness),t.uniform1f(d,2.5)}}const od=pn([id,Fi({extremity:"source"}),Fi({extremity:"target"})],ed),ad=`
precision highp float;

varying vec4 v_fill;
varying vec4 v_color;
varying vec4 v_texture;
varying vec2 v_diffVector;
varying float v_opacity;
varying float v_radius;

uniform sampler2D u_atlas;
uniform float u_correctionRatio;
uniform float u_cameraAngle;
uniform float u_percentagePadding;
uniform bool u_keepWithinCircle;
uniform bool u_shape;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

const float radius = 0.5;

void main(void) {
  float border = 2.0 * u_correctionRatio;
  float dist = length(v_diffVector);
  vec4 color = v_fill;

  float c = cos(-u_cameraAngle);
  float s = sin(-u_cameraAngle);
  vec2 diffVector = mat2(c, s, -s, c) * (v_diffVector);

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  border = 0.0;
  gl_FragColor = v_color;

  #else
  // First case: No image to display
  if (v_texture.w <= 0.0) {
     color = v_fill;
  }

  // Second case: Image loaded into the texture
  else {
    float paddingRatio = 1.0 + 2.0 * u_percentagePadding;
    float coef = 1.0;
    vec2 coordinateInTexture = diffVector * vec2(paddingRatio, -paddingRatio) / v_radius / 2.0 * coef + vec2(0.5, 0.5);
    vec4 texel = texture2D(u_atlas, (v_texture.xy + coordinateInTexture * v_texture.zw), -1.0);

    // Colorize all visible image pixels:
    color = mix(v_fill, v_color, texel.a);
    
    // Erase pixels "in the padding":
    if (abs(diffVector.x) > v_radius / paddingRatio || abs(diffVector.y) > v_radius / paddingRatio) {
      color = v_fill;
    }
  }

  // Crop in a circle when u_keepWithinCircle is truthy:
  if(v_opacity == 0.0) {
    gl_FragColor = transparent;
  }
  else if (dist - v_radius + border > border)
    gl_FragColor = transparent;
  else if (dist - v_radius + border > 0.0) {
    gl_FragColor = mix(v_fill, transparent, (dist - v_radius + border) / border);
  }
  else  {
    gl_FragColor = mix(v_fill, color, v_opacity);
  }
  #endif
  

}
`,sa={size:{mode:"max",value:512},objectFit:"cover",correctCentering:!1},sd=100,ud=1;async function ld(n){return await new Promise((r,t)=>{const e=new Image;e.addEventListener("load",()=>{r(e)},{once:!0}),e.addEventListener("error",i=>{t(i.error)},{once:!0}),e.setAttribute("crossOrigin",""),e.src=n})}const cd=(n="")=>`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 26 26" width="128px" height="128px"><path fill="#000" d="${n}"></path></svg>`;async function dd(n,{size:r}={}){const t=new DOMParser().parseFromString(cd(n),"image/svg+xml"),e=t.documentElement,i=e.getAttribute("width"),o=e.getAttribute("height");if(!i||!o)throw new Error("loadSVGImage: cannot use `size` if target SVG has no definite dimensions.");typeof r=="number"&&(e.setAttribute("width",""+r),e.setAttribute("height",""+r));const a=new XMLSerializer().serializeToString(t),s=new Blob([a],{type:"image/svg+xml"}),u=URL.createObjectURL(s),l=ld(u);return l.finally(()=>URL.revokeObjectURL(u)),await l}async function hd(n,{size:r}={}){return await dd(n,{size:128})}function fd(n,r,{objectFit:t,size:e,correctCentering:i}){const o=t==="contain"?Math.max(n.width,n.height):Math.min(n.width,n.height),a=e.mode==="auto"?o:e.mode==="force"?e.value:Math.min(e.value,o);let s=(n.width-o)/2,u=(n.height-o)/2;if(i){const l=r.getCorrectionOffset(n,o);s=l.x,u=l.y}return{sourceX:s,sourceY:u,sourceSize:o,destinationSize:a}}function gd(n,r){const i=[];let o=0,a=0;for(const b in r){const x=r[b];x.status==="ready"&&(a=Math.max(a,x.destinationSize),o+=x.destinationSize**2,i.push({key:b,...x}))}i.sort((b,x)=>b.destinationSize>x.destinationSize?-1:1);const s=o/.6,u=Math.min(Math.max(Math.sqrt(s),a),3072),l=[];let c=0,d=0,f=0,h=0;const m={};for(let b=0,x=i.length;b<x;b++){const{key:T,image:E,sourceSize:_,sourceX:A,sourceY:L,destinationSize:y}=i[b],C=y+ud;c+C>u&&(h=Math.max(h,c),c=0,d+=f,f=C),l.push({key:T,image:E,sourceX:A,sourceY:L,sourceSize:_,destinationX:c,destinationY:d,destinationSize:y}),m[T]={x:c,y:d,size:y},c+=C,f=Math.max(f,C)}h=Math.max(h,c);const v=n.canvas;v.width=h,v.height=d+f;for(let b=0,x=l.length;b<x;b++){const{image:T,sourceSize:E,sourceX:_,sourceY:A,destinationSize:L,destinationX:y,destinationY:C}=l[b];n.drawImage(T,_,A,E,E,y,C,L,L)}return m}let vd=class{constructor(){ue(this,"canvas");ue(this,"context");this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",{willReadFrequently:!0})}getCorrectionOffset(r,t){this.canvas.width=t,this.canvas.height=t,this.context.clearRect(0,0,t,t),this.context.drawImage(r,0,0,t,t);const e=this.context.getImageData(0,0,t,t).data,i=new Uint8ClampedArray(e.length/4);for(let c=0;c<e.length;c++)i[c]=e[c*4+3];let o=0,a=0,s=0;for(let c=0;c<t;c++)for(let d=0;d<t;d++){const f=i[c*t+d];s+=f,o+=f*d,a+=f*c}const u=o/s,l=a/s;return{x:u-t/2,y:l-t/2}}};var ot;let jr=(ot=class extends hr.EventEmitter{constructor(t={}){super();ue(this,"options");ue(this,"canvas",document.createElement("canvas"));ue(this,"ctx",this.canvas.getContext("2d",{willReadFrequently:!0}));ue(this,"frameId");ue(this,"corrector",new vd);ue(this,"imageStates",{});ue(this,"texture",this.ctx.getImageData(0,0,1,1));ue(this,"atlas",{});this.options={...sa,...t}}scheduleGenerateTexture(){typeof this.frameId!="number"&&(this.frameId=window.setTimeout(()=>{this.generateTexture(),this.frameId=void 0},sd))}generateTexture(){this.atlas=gd(this.ctx,this.imageStates),this.texture=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.emit(ot.NEW_TEXTURE_EVENT,{atlas:this.atlas,texture:this.texture})}async registerImage(t){if(!this.imageStates[t]){this.imageStates[t]={status:"loading"};try{const{size:e}=this.options,i=await hd(t,{size:e.mode==="force"?e.value:void 0});this.imageStates[t]={status:"ready",image:i,...fd(i,this.corrector,this.options)},this.scheduleGenerateTexture()}catch{this.imageStates[t]={status:"error"}}}}getAtlas(){return this.atlas}getTexture(){return this.texture}},ue(ot,"NEW_TEXTURE_EVENT","newTexture"),ot);const Ze={"top-left":"0.0","top-right":"1.0","bottom-left":"2.0","bottom-right":"3.0",top:"4.0",left:"5.0",right:"6.0",bottom:"7.0"},pd=`
attribute vec4 a_id;
attribute vec4 a_fill;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_circle;
attribute float a_placement;
attribute float a_size;
attribute float a_angle;
attribute float a_opacity;
attribute vec4 a_texture;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_fill;
varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_opacity;
varying vec4 v_texture;

const float bias = 255.0 / 254.0;
const float marginRatio = 1.1;
const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main() {
  float size = (a_size / 4.0) * u_correctionRatio / u_sizeRatio * 4.0;
  float originalSize = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector * marginRatio;
  float divisor = a_circle == 1.0 ? 2.5 : 2.0;
  if(a_placement == ${Ze["top-left"]}) {
    position.x -= originalSize / divisor;
    position.y += originalSize / divisor;
  }
  if(a_placement == ${Ze["top-right"]}) {
    position.x += originalSize / divisor;
    position.y += originalSize / divisor;
  }
  if(a_placement == ${Ze["bottom-left"]}) {
    position.x -= originalSize / divisor;
    position.y -= originalSize / divisor;
  }
  if(a_placement == ${Ze["bottom-right"]}) {
    position.x += originalSize / divisor;
    position.y -= originalSize / divisor;
  }
  if(a_placement == ${Ze.top}) {
    position.y += originalSize / 2.0;
  }
  if(a_placement == ${Ze.bottom}) {
    position.y -= originalSize / 2.0;
  }
  if(a_placement == ${Ze.left}) {
    position.x -= originalSize / 2.0;
  }
  if(a_placement == ${Ze.right}) {
    position.x += originalSize / 2.0;
  }
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0 / marginRatio;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_fill = mix(transparent, a_fill, a_opacity * bias);
  v_color = vec4(a_color.rgb, a_opacity * bias);
  v_opacity = a_opacity;
  // Pass the texture coordinates:
  v_texture = a_texture;
  #endif
}
`,md={star:"M12,17.27L18.18,21L16.54,13.97L22,9.24L14.81,8.62L12,2L9.19,8.62L2,9.24L7.45,13.97L5.82,21L12,17.27Z",exclaim:"M13,13H11V7H13M13,17H11V15H13M12,2A10,10 0 0,0 2,12A10,10 0 0,0 12,22A10,10 0 0,0 22,12A10,10 0 0,0 12,2Z",thumbUp:"M23,10C23,8.89 22.1,8 21,8H14.68L15.64,3.43C15.66,3.33 15.67,3.22 15.67,3.11C15.67,2.7 15.5,2.32 15.23,2.05L14.17,1L7.59,7.58C7.22,7.95 7,8.45 7,9V19A2,2 0 0,0 9,21H18C18.83,21 19.54,20.5 19.84,19.78L22.86,12.73C22.95,12.5 23,12.26 23,12V10M1,21H5V9H1V21Z",thumbDown:"M19,15H23V3H19M15,3H6C5.17,3 4.46,3.5 4.16,4.22L1.14,11.27C1.05,11.5 1,11.74 1,12V14A2,2 0 0,0 3,16H9.31L8.36,20.57C8.34,20.67 8.33,20.77 8.33,20.88C8.33,21.3 8.5,21.67 8.77,21.94L9.83,23L16.41,16.41C16.78,16.05 17,15.55 17,15V5C17,3.89 16.1,3 15,3Z"},yd={"top-left":0,"top-right":1,"bottom-left":2,"bottom-right":3,top:4,left:5,right:6,bottom:7},{UNSIGNED_BYTE:Hr,FLOAT:nt}=WebGLRenderingContext,bd={...sa,drawingMode:"background",keepWithinCircle:!0,drawLabel:void 0,drawHover:void 0,padding:0,colorAttribute:"color"},_d=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_percentagePadding","u_matrix","u_colorizeImages","u_keepWithinCircle","u_atlas"];function it(n){var c;const{drawHover:r,drawLabel:t,drawingMode:e,keepWithinCircle:i,padding:o,colorAttribute:a,badgePosition:s,...u}={badgePosition:"top-right",...bd,...n??{},drawLabel:void 0,drawHover:void 0},l=new jr(u);return c=class extends jt{constructor(h,m,v){super(h,m,v);ue(this,"atlas");ue(this,"texture");ue(this,"textureImage");ue(this,"latestRenderParams");ue(this,"textureManagerCallback");this.textureManagerCallback=()=>{this&&(this.bindTexture&&(this.atlas=l.getAtlas(),this.textureImage=l.getTexture(),this.bindTexture(),this.latestRenderParams&&this.render(this.latestRenderParams)),v!=null&&v.refresh&&v.refresh())},l.on(jr.NEW_TEXTURE_EVENT,this.textureManagerCallback),this.atlas=l.getAtlas(),this.textureImage=l.getTexture(),this.texture=h.createTexture(),this.bindTexture()}getDefinition(){return{VERTICES:4,VERTEX_SHADER_SOURCE:pd,FRAGMENT_SHADER_SOURCE:ad,METHOD:WebGLRenderingContext.TRIANGLE_FAN,UNIFORMS:_d,ATTRIBUTES:[{name:"a_position",size:2,type:nt},{name:"a_size",size:1,type:nt},{name:"a_opacity",size:1,type:nt},{name:"a_circle",size:1,type:nt},{name:"a_placement",size:1,type:nt},{name:"a_fill",size:4,type:Hr,normalized:!0},{name:"a_color",size:4,type:Hr,normalized:!0},{name:"a_id",size:4,type:Hr,normalized:!0},{name:"a_texture",size:4,type:nt}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:nt}],CONSTANT_DATA:[[c.ANGLE_1],[c.ANGLE_2],[c.ANGLE_3],[c.ANGLE_4]]}}kill(){l.off(jr.NEW_TEXTURE_EVENT,this.textureManagerCallback)}bindTexture(){const h=this.normalProgram.gl;h.bindTexture(h.TEXTURE_2D,this.texture),h.texImage2D(h.TEXTURE_2D,0,h.RGBA,h.RGBA,h.UNSIGNED_BYTE,this.textureImage),h.generateMipmap(h.TEXTURE_2D)}renderProgram(h,m){if(!m.isPicking){const v=m.gl;v.bindTexture(v.TEXTURE_2D,this.texture)}super.renderProgram(h,m)}processVisibleItem(h,m,v){var L;const b=this.array,x=(L=v.badge)==null?void 0:L.find(y=>y.position===s);let T=ge((x==null?void 0:x.color)??"#00000000"),E=ge((x==null?void 0:x.iconColor)??this.renderer.getSetting("labelColor").color??"#000"),_=x?md[x.type]??x.path:void 0;const A=_?this.atlas[_]:void 0;if(typeof _=="string"&&!A&&l.registerImage(_),b[m++]=v.x,b[m++]=v.y,b[m++]=v.size,b[m++]=_?v.opacity??1:0,b[m++]=i?1:0,b[m++]=yd[s]??0,b[m++]=T,b[m++]=E,b[m++]=h,A){const{width:y,height:C}=this.textureImage;b[m++]=A.x/y,b[m++]=A.y/C,b[m++]=A.size/y,b[m++]=A.size/C}else b[m++]=0,b[m++]=0,b[m++]=0,b[m++]=0}setUniforms(h,{gl:m,uniformLocations:v}){const{u_sizeRatio:b,u_correctionRatio:x,u_matrix:T,u_atlas:E,u_keepWithinCircle:_,u_cameraAngle:A,u_percentagePadding:L}=v;this.latestRenderParams=h,m.uniform1f(x,h.correctionRatio),m.uniform1f(b,h.sizeRatio),m.uniform1f(A,h.cameraAngle),m.uniform1f(L,o),m.uniformMatrix3fv(T,!1,h.matrix),m.uniform1i(E,0),m.uniform1i(_,i?1:0)}},ue(c,"ANGLE_1",1*Math.PI/4),ue(c,"ANGLE_2",3*Math.PI/4),ue(c,"ANGLE_3",5*Math.PI/4),ue(c,"ANGLE_4",7*Math.PI/4),ue(c,"drawLabel",t),ue(c,"drawHover",r),c}const ua=n=>[it({keepWithinCircle:n,badgePosition:"top-right"}),it({keepWithinCircle:n,badgePosition:"top-left"}),it({keepWithinCircle:n,badgePosition:"bottom-right"}),it({keepWithinCircle:n,badgePosition:"bottom-left"}),it({keepWithinCircle:n,badgePosition:"top"}),it({keepWithinCircle:n,badgePosition:"left"}),it({keepWithinCircle:n,badgePosition:"right"})],wd=`
precision highp float;

varying vec4 v_fill;
varying vec4 v_color;
varying vec4 v_texture;
varying vec2 v_diffVector;
varying float v_opacity;
varying float v_radius;
varying float v_colorMode;

uniform sampler2D u_atlas;
uniform float u_correctionRatio;
uniform float u_cameraAngle;
uniform float u_percentagePadding;
uniform bool u_keepWithinCircle;
uniform bool u_shape;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

const float radius = 0.5;

void main(void) {
  float border = 2.0 * u_correctionRatio;
  float dist = length(v_diffVector);
  vec4 color = v_fill;

  float c = cos(-u_cameraAngle);
  float s = sin(-u_cameraAngle);
  vec2 diffVector = mat2(c, s, -s, c) * (v_diffVector);

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
  border = 0.0;
  gl_FragColor = v_color;

  #else
  // First case: No image to display
  if (v_texture.w <= 0.0) {
    if (v_colorMode==0.0) {
      color = v_fill;
    }
  }

  // Second case: Image loaded into the texture
  else {
    float paddingRatio = 1.0 + 2.0 * u_percentagePadding;
    float coef = u_keepWithinCircle ? 1.0 : ${Math.SQRT2};
    vec2 coordinateInTexture = diffVector * vec2(paddingRatio, -paddingRatio) / v_radius / 2.0 * coef + vec2(0.5, 0.5);
    vec4 texel = texture2D(u_atlas, (v_texture.xy + coordinateInTexture * v_texture.zw), -1.0);

    // Colorize all visible image pixels:
    if (v_colorMode==1.0) {
      color = mix(v_fill, v_color, texel.a);
    }

    // Colorize background pixels, keep image pixel colors:
    else {
      color = vec4(mix(v_color, texel, texel.a).rgb, max(texel.a, v_color.a));
    }

    // Erase pixels "in the padding":
    if (abs(diffVector.x) > v_radius / paddingRatio || abs(diffVector.y) > v_radius / paddingRatio) {
      color = v_colorMode == 1.0 ? gl_FragColor : v_fill;
    }
  }

  // Crop in a circle when u_keepWithinCircle is truthy:
  if (u_keepWithinCircle) {
    if (dist - v_radius + border > border)
      gl_FragColor = transparent;
    else if (dist - v_radius + border > 0.0) {
      gl_FragColor = mix(v_fill, transparent, (dist - v_radius + border) / border);
    }
    else  {
      gl_FragColor = mix(v_fill, color, v_opacity);
    }
  }

  // Crop in a square else:
  else {
    float squareHalfSize = v_radius * ${Math.SQRT1_2*Math.cos(Math.PI/12)};
    if (abs(diffVector.x) > squareHalfSize || abs(diffVector.y) > squareHalfSize) {
      gl_FragColor = transparent;
    } else {
      gl_FragColor = mix(v_fill, color, v_opacity);
    }
  }
  #endif

}
`,la={size:{mode:"max",value:512},objectFit:"cover",correctCentering:!1},Ed=100,Td=1;async function ca(n){return await new Promise((r,t)=>{const e=new Image;e.addEventListener("load",()=>{r(e)},{once:!0}),e.addEventListener("error",i=>{t(i.error)},{once:!0}),e.setAttribute("crossOrigin",""),e.src=n})}const Rd=(n="")=>`<svg version="1.1" xmlns="http://www.w3.org/2000/svg" viewBox="-1 -1 26 26" width="128px" height="128px"><path fill="#000" d="${n}"></path></svg>`;async function Sd(n,{size:r}={}){const t=new DOMParser().parseFromString(Rd(n),"image/svg+xml"),e=t.documentElement,i=e.getAttribute("width"),o=e.getAttribute("height");if(!i||!o)throw new Error("loadSVGImage: cannot use `size` if target SVG has no definite dimensions.");typeof r=="number"&&(e.setAttribute("width",""+r),e.setAttribute("height",""+r));const a=new XMLSerializer().serializeToString(t),s=new Blob([a],{type:"image/svg+xml"}),u=URL.createObjectURL(s),l=ca(u);return l.finally(()=>URL.revokeObjectURL(u)),await l}async function xd(n,{size:r}={}){const t=no(n);let e;return t?e=await Sd(n,{size:128}):e=await ca(n),e}function Cd(n,r,{objectFit:t,size:e,correctCentering:i}){const o=t==="contain"?Math.max(n.width,n.height):Math.min(n.width,n.height),a=e.mode==="auto"?o:e.mode==="force"?e.value:Math.min(e.value,o);let s=(n.width-o)/2,u=(n.height-o)/2;if(i){const l=r.getCorrectionOffset(n,o);s=l.x,u=l.y}return{sourceX:s,sourceY:u,sourceSize:o,destinationSize:a}}function Ad(n,r){const i=[];let o=0,a=0;for(const b in r){const x=r[b];x.status==="ready"&&(a=Math.max(a,x.destinationSize),o+=x.destinationSize**2,i.push({key:b,...x}))}i.sort((b,x)=>b.destinationSize>x.destinationSize?-1:1);const s=o/.6,u=Math.min(Math.max(Math.sqrt(s),a),3072),l=[];let c=0,d=0,f=0,h=0;const m={};for(let b=0,x=i.length;b<x;b++){const{key:T,image:E,sourceSize:_,sourceX:A,sourceY:L,destinationSize:y}=i[b],C=y+Td;c+C>u&&(h=Math.max(h,c),c=0,d+=f,f=C),l.push({key:T,image:E,sourceX:A,sourceY:L,sourceSize:_,destinationX:c,destinationY:d,destinationSize:y}),m[T]={x:c,y:d,size:y},c+=C,f=Math.max(f,C)}h=Math.max(h,c);const v=n.canvas;v.width=h,v.height=d+f;for(let b=0,x=l.length;b<x;b++){const{image:T,sourceSize:E,sourceX:_,sourceY:A,destinationSize:L,destinationX:y,destinationY:C}=l[b];n.drawImage(T,_,A,E,E,y,C,L,L)}return m}class kd{constructor(){ue(this,"canvas");ue(this,"context");this.canvas=document.createElement("canvas"),this.context=this.canvas.getContext("2d",{willReadFrequently:!0})}getCorrectionOffset(r,t){this.canvas.width=t,this.canvas.height=t,this.context.clearRect(0,0,t,t),this.context.drawImage(r,0,0,t,t);const e=this.context.getImageData(0,0,t,t).data,i=new Uint8ClampedArray(e.length/4);for(let c=0;c<e.length;c++)i[c]=e[c*4+3];let o=0,a=0,s=0;for(let c=0;c<t;c++)for(let d=0;d<t;d++){const f=i[c*t+d];s+=f,o+=f*d,a+=f*c}const u=o/s,l=a/s;return{x:u-t/2,y:l-t/2}}}const ur=class ur extends hr.EventEmitter{constructor(t={}){super();ue(this,"options");ue(this,"canvas",document.createElement("canvas"));ue(this,"ctx",this.canvas.getContext("2d",{willReadFrequently:!0}));ue(this,"frameId");ue(this,"corrector",new kd);ue(this,"imageStates",{});ue(this,"texture",this.ctx.getImageData(0,0,1,1));ue(this,"atlas",{});this.options={...la,...t}}scheduleGenerateTexture(){typeof this.frameId!="number"&&(this.frameId=window.setTimeout(()=>{this.generateTexture(),this.frameId=void 0},Ed))}generateTexture(){this.atlas=Ad(this.ctx,this.imageStates),this.texture=this.ctx.getImageData(0,0,this.canvas.width,this.canvas.height),this.emit(ur.NEW_TEXTURE_EVENT,{atlas:this.atlas,texture:this.texture})}async registerImage(t){if(!this.imageStates[t]){this.imageStates[t]={status:"loading"};try{const{size:e}=this.options,i=await xd(t,{size:e.mode==="force"?e.value:void 0});this.imageStates[t]={status:"ready",image:i,...Cd(i,this.corrector,this.options)},this.scheduleGenerateTexture()}catch{this.imageStates[t]={status:"error"}}}}getAtlas(){return this.atlas}getTexture(){return this.texture}};ue(ur,"NEW_TEXTURE_EVENT","newTexture");let Mt=ur;const Ld=`
attribute vec4 a_id;
attribute vec4 a_fill;
attribute vec4 a_color;
attribute vec2 a_position;
attribute float a_size;
attribute float a_angle;
attribute float a_colorMode;
attribute float a_opacity;
attribute vec4 a_texture;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_fill;
varying vec4 v_color;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_opacity;
varying vec4 v_texture;
varying float v_colorMode;

const float bias = 255.0 / 254.0;
const float marginRatio = 1.05;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector * marginRatio;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0 / marginRatio;

  #ifdef PICKING_MODE
  // For picking mode, we use the ID as the color:
  v_color = a_id;
  #else
  // For normal mode, we use the color:
  v_fill = vec4(0.0, 0.0, 0.0, 0.0);
  v_color = vec4(a_color.rgb, a_opacity * bias);
  v_opacity = a_opacity;
  v_colorMode = a_colorMode;
  // Pass the texture coordinates:
  v_texture = a_texture;
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:Wr,FLOAT:dt}=WebGLRenderingContext,Dd={...la,drawingMode:"background",keepWithinCircle:!0,drawLabel:void 0,drawHover:void 0,padding:0,colorAttribute:"color"},Gd=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_percentagePadding","u_matrix","u_colorizeImages","u_keepWithinCircle","u_atlas"];function Pd(n){var l;const{drawHover:r,drawLabel:t,drawingMode:e,keepWithinCircle:i,padding:o,colorAttribute:a,...s}={...Dd,...n??{},drawLabel:void 0,drawHover:void 0},u=new Mt(s);return l=class extends jt{constructor(f,h,m){super(f,h,m);ue(this,"atlas");ue(this,"texture");ue(this,"textureImage");ue(this,"latestRenderParams");ue(this,"textureManagerCallback");this.textureManagerCallback=()=>{this&&(this.bindTexture&&(this.atlas=u.getAtlas(),this.textureImage=u.getTexture(),this.bindTexture(),this.latestRenderParams&&this.render(this.latestRenderParams)),m!=null&&m.refresh&&m.refresh())},u.on(Mt.NEW_TEXTURE_EVENT,this.textureManagerCallback),this.atlas=u.getAtlas(),this.textureImage=u.getTexture(),this.texture=f.createTexture(),this.bindTexture()}getDefinition(){return{VERTICES:4,VERTEX_SHADER_SOURCE:Ld,FRAGMENT_SHADER_SOURCE:wd,METHOD:WebGLRenderingContext.TRIANGLE_FAN,UNIFORMS:Gd,ATTRIBUTES:[{name:"a_position",size:2,type:dt},{name:"a_size",size:1,type:dt},{name:"a_opacity",size:1,type:dt},{name:"a_colorMode",size:1,type:dt},{name:"a_fill",size:4,type:Wr,normalized:!0},{name:"a_color",size:4,type:Wr,normalized:!0},{name:"a_id",size:4,type:Wr,normalized:!0},{name:"a_texture",size:4,type:dt}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:dt}],CONSTANT_DATA:[[l.ANGLE_1],[l.ANGLE_2],[l.ANGLE_3],[l.ANGLE_4]]}}kill(){u.off(Mt.NEW_TEXTURE_EVENT,this.textureManagerCallback)}bindTexture(){const f=this.normalProgram.gl;f.bindTexture(f.TEXTURE_2D,this.texture),f.texImage2D(f.TEXTURE_2D,0,f.RGBA,f.RGBA,f.UNSIGNED_BYTE,this.textureImage),f.generateMipmap(f.TEXTURE_2D)}renderProgram(f,h){if(!h.isPicking){const m=h.gl;m.bindTexture(m.TEXTURE_2D,this.texture)}super.renderProgram(f,h)}processVisibleItem(f,h,m){var _;const v=this.array,b=ge(m.color??this.renderer.getSetting("defaultNodeColor")),x=ge(m.iconColor??this.renderer.getSetting("labelColor").color),T=m.image??m.path,E=T?this.atlas[T]:void 0;if(typeof T=="string"&&!E&&u.registerImage(T),v[h++]=m.x,v[h++]=m.y,v[h++]=m.size-(m.border??0)-((_=m.pie)!=null&&_.length?4:2),v[h++]=m.opacity??1,v[h++]=no(T)?1:0,v[h++]=b,v[h++]=x,v[h++]=f,E){const{width:A,height:L}=this.textureImage;v[h++]=E.x/A,v[h++]=E.y/L,v[h++]=E.size/A,v[h++]=E.size/L}else v[h++]=0,v[h++]=0,v[h++]=0,v[h++]=0}setUniforms(f,{gl:h,uniformLocations:m}){const{u_sizeRatio:v,u_correctionRatio:b,u_matrix:x,u_atlas:T,u_keepWithinCircle:E,u_cameraAngle:_,u_percentagePadding:A}=m;this.latestRenderParams=f,h.uniform1f(b,f.correctionRatio),h.uniform1f(v,i?f.sizeRatio:f.sizeRatio/Math.SQRT2),h.uniform1f(_,f.cameraAngle),h.uniform1f(A,o),h.uniformMatrix3fv(x,!1,f.matrix),h.uniform1i(T,0),h.uniform1i(E,i?1:0)}},ue(l,"ANGLE_1",1*Math.PI/4),ue(l,"ANGLE_2",3*Math.PI/4),ue(l,"ANGLE_3",5*Math.PI/4),ue(l,"ANGLE_4",7*Math.PI/4),ue(l,"drawLabel",t),ue(l,"drawHover",r),l}const da=n=>Pd({keepWithinCircle:n}),Nd=`
precision highp float;

varying vec4 v_color;
varying vec4 v_stroke;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;
varying float v_segmentAngle;
varying vec4 v_colors_0;
varying vec4 v_colors_1;
varying vec4 v_colors_2;
varying vec4 v_colors_3;
varying vec4 v_colors_4;
varying vec4 v_colors_5;
varying vec4 v_colors_6;

uniform float u_sizeRatio;
uniform float u_correctionRatio;

const vec4 transparent = vec4(0.0, 0.0, 0.0, 0.0);

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) - v_radius + border;

  float angle = atan(v_diffVector.y / v_diffVector.x);
  if (v_diffVector.x < 0.0 && v_diffVector.y < 0.0) angle += ${Math.PI};
  else if (v_diffVector.x < 0.0) angle += ${Math.PI};
  else if (v_diffVector.y < 0.0) angle += ${2*Math.PI};

  // No antialiasing for picking mode:
  #ifdef PICKING_MODE
    if (dist > border)
      gl_FragColor = transparent;
    else
      gl_FragColor = v_color;
  #else
    float t = 0.0;
    vec4 color = v_color;
    vec4 piecolor = vec4(0.0);
    float pieSize = 4.0 * u_correctionRatio / u_sizeRatio * 4.0;
    if(v_segmentAngle > 0.0) {
      float segment = angle / v_segmentAngle;
      if(segment >= 0.0) { piecolor = v_colors_0; }
      if(segment >= 1.0) { piecolor = v_colors_1; }
      if(segment >= 2.0) { piecolor = v_colors_2; }
      if(segment >= 3.0) { piecolor = v_colors_3; }
      if(segment >= 4.0) { piecolor = v_colors_4; }
      if(segment >= 5.0) { piecolor = v_colors_5; }
      if(segment >= 6.0) { piecolor = v_colors_6; }
    }

    if (dist > (v_radius - v_border) / 2.0) {
      color = v_stroke;
    }
    else if (v_segmentAngle > 0.0 && dist > (v_radius - (v_border + pieSize)) / 2.0) {
      color = piecolor;
    }
    if (dist > 0.0) {
      t = dist / border;
    }

    gl_FragColor = mix(color, transparent, t);
  #endif
}
`,Od=`
attribute vec4 a_id;
attribute vec4 a_base;
attribute vec4 a_color;
attribute vec4 a_stroke;
attribute vec2 a_position;
attribute float a_size;
attribute float a_border;
attribute float a_angle;
attribute float a_opacity;
attribute float a_segments;
attribute vec4 a_colors_0;
attribute vec4 a_colors_1;
attribute vec4 a_colors_2;
attribute vec4 a_colors_3;
attribute vec4 a_colors_4;
attribute vec4 a_colors_5;
attribute vec4 a_colors_6;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec4 v_stroke;
varying vec2 v_diffVector;
varying float v_radius;
varying float v_border;
varying float v_segmentAngle;
varying vec4 v_colors_0;
varying vec4 v_colors_1;
varying vec4 v_colors_2;
varying vec4 v_colors_3;
varying vec4 v_colors_4;
varying vec4 v_colors_5;
varying vec4 v_colors_6;

const float bias = 255.0 / 254.0;

void main() {
  float size = a_size * u_correctionRatio / u_sizeRatio * 4.0;
  vec2 diffVector = size * vec2(cos(a_angle), sin(a_angle));
  vec2 position = a_position + diffVector;
  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_radius = size / 2.0;
  v_border = (a_border + 8.0) * u_correctionRatio / u_sizeRatio * 4.0;

  #ifdef PICKING_MODE
    // For picking mode, we use the ID as the color:
    v_color = a_id;
  #else
    // For normal mode, we use the color:
    v_color = mix(a_base, a_color, a_opacity * bias);
    v_stroke = mix(a_base, a_stroke, a_opacity * bias);

    // pie colors
    v_segmentAngle = 0.0;
    if(a_segments > 0.0) {
      v_segmentAngle = ${Math.PI*2} / a_segments;
      v_colors_0 = mix(a_base, a_colors_0, a_opacity * bias);
      v_colors_1 = mix(a_base, a_colors_1, a_opacity * bias);
      v_colors_2 = mix(a_base, a_colors_2, a_opacity * bias);
      v_colors_3 = mix(a_base, a_colors_3, a_opacity * bias);
      v_colors_4 = mix(a_base, a_colors_4, a_opacity * bias);
      v_colors_5 = mix(a_base, a_colors_5, a_opacity * bias);
      v_colors_6 = mix(a_base, a_colors_6, a_opacity * bias);
    }
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:Ot,FLOAT:ht}=WebGLRenderingContext,Id=["u_sizeRatio","u_correctionRatio","u_matrix"],Je=class Je extends jt{getDefinition(){return{VERTICES:3,VERTEX_SHADER_SOURCE:Od,FRAGMENT_SHADER_SOURCE:Nd,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Id,ATTRIBUTES:[{name:"a_position",size:2,type:ht},{name:"a_size",size:1,type:ht},{name:"a_border",size:1,type:ht},{name:"a_opacity",size:1,type:ht},{name:"a_base",size:4,type:Ot,normalized:!0},{name:"a_color",size:4,type:Ot,normalized:!0},{name:"a_stroke",size:4,type:Ot,normalized:!0},{name:"a_segments",size:1,type:ht},...Array(7).fill(0).map((r,t)=>({name:"a_colors_"+t,size:4,type:Ot,normalized:!0})),{name:"a_id",size:4,type:Ot,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:ht}],CONSTANT_DATA:[[Je.ANGLE_1],[Je.ANGLE_2],[Je.ANGLE_3]]}}processVisibleItem(r,t,e){var u;const i=this.array,o=ge(this.renderer.getSetting("defaultNodeColor")),a=ge(e.color??this.renderer.getSetting("defaultNodeColor")),s=ge(e.borderColor??this.renderer.getSetting("defaultEdgeColor"));i[t++]=e.x,i[t++]=e.y,i[t++]=e.size,i[t++]=Math.min(e.border??0,4),i[t++]=e.opacity??1,i[t++]=o,i[t++]=a,i[t++]=s,i[t++]=Math.min(7,((u=e.pie)==null?void 0:u.length)??0),Array(7).fill(0).forEach((l,c)=>{var d;i[t++]=ge(((d=e.pie)==null?void 0:d[c])??"#0000")}),i[t++]=r}setUniforms(r,{gl:t,uniformLocations:e}){const{u_sizeRatio:i,u_correctionRatio:o,u_matrix:a}=e;t.uniform1f(o,r.correctionRatio),t.uniform1f(i,r.sizeRatio),t.uniformMatrix3fv(a,!1,r.matrix)}};ue(Je,"ANGLE_1",0),ue(Je,"ANGLE_2",2*Math.PI/3),ue(Je,"ANGLE_3",4*Math.PI/3);let ln=Je;function ha(n,r,t){var c,d;const e=r.size,i=t.labelSize,o=t.labelFont,a=t.labelWeight,s=t.defaultNodeColor||"#fff",u=r.labelColor||t.labelColor.color||"#000";if(r.highlight){n.strokeStyle=r.highlightColor??"#44BD87",n.lineWidth=1,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=48,n.shadowColor=r.highlightColor??"#44BD87";const f=2;n.beginPath(),n.arc(r.x,r.y,e+f,0,Math.PI*2),n.closePath(),n.stroke()}if(n.shadowColor="transparent",n.shadowBlur=0,r.selected){n.strokeStyle="#f00",n.lineWidth=2,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0;const f=r.selected?4:2;n.beginPath(),n.arc(r.x,r.y,e+f,0,Math.PI*2),n.closePath(),n.stroke()}if(r.isGroup){const f=(d=(c=n.canvas.parentElement)==null?void 0:c.parentElement)==null?void 0:d.querySelector(".sigma-groupHandles");let h=f.querySelector(`[data-id="${r.id}"]`);h||(h=document.createElement("div"),h.className="sigma-groupHandle",h.dataset.id=r.id,f.appendChild(h)),h.innerText=r.expanded?"−":"+",h.style.transform="translate(-50%, -50%)",h.style.left=`${r.x}px`,h.style.top=`${r.y+e}px`}if(!r.label||r.opacity<1)return;const l=n.measureText(r.label).width;n.fillStyle=s,n.fillRect(r.x-l/2,r.y+e*1.25,l,i+2),n.fillStyle=u,n.font=`${a} ${i}px ${o}`,n.fillText(r.label,r.x-l/2,r.y+i+e*1.25)}function zd(n,r,t){const e=r.size,i=t.labelSize,o=t.labelFont,a=t.labelWeight,s=t.defaultNodeColor||"#fff",u=r.labelColor||t.labelColor.color||"#000";n.font=`${a} ${i}px ${o}`,n.fillStyle=s,n.strokeStyle=u,n.lineWidth=.25;const l=r.selected?4:2;n.beginPath(),n.arc(r.x,r.y,e+l,0,Math.PI*2),n.closePath(),n.lineWidth=1,n.strokeStyle="#F00",r.selected&&(n.lineWidth=3),n.stroke(),n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,n.lineWidth=0,n.strokeStyle="",ha(n,r,t)}const Fd=So([ln,da(!0),...ua(!0)],ha,zd),$d=`
precision highp float;

varying vec4 v_color;
varying vec4 v_stroke;
varying vec2 v_diffVector;
varying float v_border;
varying float v_segmentAngle;
varying vec4 v_colors_0;
varying vec4 v_colors_1;
varying vec4 v_colors_2;
varying vec4 v_colors_3;
varying vec4 v_colors_4;
varying vec4 v_colors_5;
varying vec4 v_colors_6;

uniform float u_sizeRatio;
uniform float u_correctionRatio;

void main(void) {
  float border = u_correctionRatio * 2.0;
  float dist = length(v_diffVector) + border;

  float angle = atan(v_diffVector.y / v_diffVector.x);
  if (v_diffVector.x < 0.0 && v_diffVector.y < 0.0) angle += ${Math.PI};
  else if (v_diffVector.x < 0.0) angle += ${Math.PI};
  else if (v_diffVector.y < 0.0) angle += ${2*Math.PI};

  #ifdef PICKING_MODE
    gl_FragColor = v_color;
  #else
    vec4 color = v_color;
    vec4 piecolor = vec4(0.0);
    float pieSize = 4.0 * u_correctionRatio / u_sizeRatio * 4.0;
    
    if(v_segmentAngle > 0.0) {
      float segment = angle / v_segmentAngle;
      if(segment >= 0.0) { piecolor = v_colors_0; }
      if(segment >= 1.0) { piecolor = v_colors_1; }
      if(segment >= 2.0) { piecolor = v_colors_2; }
      if(segment >= 3.0) { piecolor = v_colors_3; }
      if(segment >= 4.0) { piecolor = v_colors_4; }
      if(segment >= 5.0) { piecolor = v_colors_5; }
      if(segment >= 6.0) { piecolor = v_colors_6; }
    }
    if(v_segmentAngle > 0.0) {
      float pieCheck = v_border - (pieSize / 2.0);
      if (v_diffVector.x > pieCheck || v_diffVector.y > pieCheck ||
        v_diffVector.x < -pieCheck || v_diffVector.y < -pieCheck) {
        color = piecolor;
      }
    }
    if(v_border > 0.0) {
      if (v_diffVector.x > v_border || v_diffVector.y > v_border ||
        v_diffVector.x < -v_border || v_diffVector.y < -v_border) {
        color = v_stroke;
      }
    }
    gl_FragColor = color;
  #endif
}
`,Md=`
attribute vec4 a_id;
attribute vec4 a_base;
attribute vec4 a_color;
attribute vec4 a_stroke;
attribute vec2 a_position;
attribute float a_size;
attribute float a_border;
attribute float a_angle;
attribute float a_opacity;
attribute float a_segments;
attribute vec4 a_colors_0;
attribute vec4 a_colors_1;
attribute vec4 a_colors_2;
attribute vec4 a_colors_3;
attribute vec4 a_colors_4;
attribute vec4 a_colors_5;
attribute vec4 a_colors_6;

uniform mat3 u_matrix;
uniform float u_sizeRatio;
uniform float u_cameraAngle;
uniform float u_correctionRatio;

varying vec4 v_color;
varying vec4 v_stroke;
varying float v_border;
varying vec2 v_diffVector;
varying float v_segmentAngle;
varying vec4 v_colors_0;
varying vec4 v_colors_1;
varying vec4 v_colors_2;
varying vec4 v_colors_3;
varying vec4 v_colors_4;
varying vec4 v_colors_5;
varying vec4 v_colors_6;

const float bias = 255.0 / 254.0;
const float sqrt_8 = sqrt(8.0);

void main() {
  float angle = a_angle + u_cameraAngle; 

  float size = a_size * u_correctionRatio / u_sizeRatio * sqrt_8;
  vec2 diffVector = size * vec2(cos(angle), sin(angle));
  vec2 position = a_position + diffVector;

  float borderLessSize = (a_size - a_border) * u_correctionRatio / u_sizeRatio * sqrt_8;

  gl_Position = vec4(
    (u_matrix * vec3(position, 1)).xy,
    0,
    1
  );

  v_diffVector = diffVector;
  v_border = a_border * u_correctionRatio / u_sizeRatio * sqrt_8;
  v_border = borderLessSize / ${Math.PI/2.2};

  #ifdef PICKING_MODE
    v_color = a_id;
  #else
    v_color = mix(a_base, a_color, a_opacity * bias);
    v_stroke = mix(a_base, a_stroke, a_opacity * bias);

    // pie colors
    v_segmentAngle = 0.0;
    if(a_segments > 0.0) {
      v_segmentAngle = ${Math.PI*2} / a_segments;
      v_colors_0 = mix(a_base, a_colors_0, a_opacity * bias);
      v_colors_1 = mix(a_base, a_colors_1, a_opacity * bias);
      v_colors_2 = mix(a_base, a_colors_2, a_opacity * bias);
      v_colors_3 = mix(a_base, a_colors_3, a_opacity * bias);
      v_colors_4 = mix(a_base, a_colors_4, a_opacity * bias);
      v_colors_5 = mix(a_base, a_colors_5, a_opacity * bias);
      v_colors_6 = mix(a_base, a_colors_6, a_opacity * bias);
    }
  #endif

  v_color.a *= bias;
}
`,{UNSIGNED_BYTE:It,FLOAT:ft}=WebGLRenderingContext,Ud=["u_sizeRatio","u_correctionRatio","u_cameraAngle","u_matrix"],gt=Math.PI;class jd extends jt{getDefinition(){return{VERTICES:6,VERTEX_SHADER_SOURCE:Md,FRAGMENT_SHADER_SOURCE:$d,METHOD:WebGLRenderingContext.TRIANGLES,UNIFORMS:Ud,ATTRIBUTES:[{name:"a_position",size:2,type:ft},{name:"a_size",size:1,type:ft},{name:"a_border",size:1,type:ft},{name:"a_opacity",size:1,type:ft},{name:"a_base",size:4,type:It,normalized:!0},{name:"a_color",size:4,type:It,normalized:!0},{name:"a_stroke",size:4,type:It,normalized:!0},{name:"a_segments",size:1,type:ft},...Array(7).fill(0).map((r,t)=>({name:"a_colors_"+t,size:4,type:It,normalized:!0})),{name:"a_id",size:4,type:It,normalized:!0}],CONSTANT_ATTRIBUTES:[{name:"a_angle",size:1,type:ft}],CONSTANT_DATA:[[gt/4],[3*gt/4],[-gt/4],[3*gt/4],[-gt/4],[-3*gt/4]]}}processVisibleItem(r,t,e){var u;const i=this.array,o=ge(this.renderer.getSetting("defaultNodeColor")),a=ge(e.color??this.renderer.getSetting("defaultNodeColor")),s=ge(e.borderColor??this.renderer.getSetting("defaultEdgeColor"));i[t++]=e.x,i[t++]=e.y,i[t++]=e.size,i[t++]=Math.min(e.border??0,4),i[t++]=e.opacity??1,i[t++]=o,i[t++]=a,i[t++]=s,i[t++]=Math.min(7,((u=e.pie)==null?void 0:u.length)??0),Array(7).fill(0).forEach((l,c)=>{var d;i[t++]=ge(((d=e.pie)==null?void 0:d[c])??"#0000")}),i[t++]=r}setUniforms(r,{gl:t,uniformLocations:e}){const{u_sizeRatio:i,u_correctionRatio:o,u_cameraAngle:a,u_matrix:s}=e;t.uniform1f(i,r.sizeRatio),t.uniform1f(a,r.cameraAngle),t.uniform1f(o,r.correctionRatio),t.uniformMatrix3fv(s,!1,r.matrix)}}function fa(n,r,t){var c,d;const e=r.size,i=t.labelSize,o=t.labelFont,a=t.labelWeight,s=t.defaultNodeColor||"#fff",u=r.labelColor||t.labelColor.color||"#000";if(r.highlight){n.strokeStyle=r.highlightColor??"#44BD87",n.lineWidth=1,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=48,n.shadowColor=r.color??"#44BD87";const h=e+2;n.strokeRect(r.x-h,r.y-h,h*2,h*2)}if(n.shadowColor="transparent",n.shadowBlur=0,r.selected){n.strokeStyle="#f00",n.lineWidth=2,n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0;const f=r.selected?4:2,h=e+f;n.strokeRect(r.x-h,r.y-h,h*2,h*2)}if(r.isGroup){const f=(d=(c=n.canvas.parentElement)==null?void 0:c.parentElement)==null?void 0:d.querySelector(".sigma-groupHandles");let h=f.querySelector(`[data-id="${r.id}"]`);h||(h=document.createElement("div"),h.className="sigma-groupHandle",h.dataset.id=r.id,f.appendChild(h)),h.innerText=r.expanded?"−":"+",h.style.transform="translate(-50%, -50%)",h.style.left=`${r.x}px`,h.style.top=`${r.y+e}px`}if(!r.label||r.opacity<1)return;const l=n.measureText(r.label).width;n.fillStyle=s,n.fillRect(r.x-l/2,r.y+e*1.25,l,i+2),n.fillStyle=u,n.font=`${a} ${i}px ${o}`,n.fillText(r.label,r.x-l/2,r.y+i+e*1.25)}function Hd(n,r,t){const e=r.size,i=t.labelSize,o=t.labelFont,a=t.labelWeight,s=t.defaultNodeColor||"#fff",u=r.labelColor||t.labelColor.color||"#000";n.font=`${a} ${i}px ${o}`,n.fillStyle=s,n.strokeStyle=u,n.lineWidth=.25;const l=r.selected?4:2,c=e+l;n.lineWidth=1,n.strokeStyle="#F00",r.selected&&(n.lineWidth=3),n.strokeRect(r.x-c,r.y-c,c*2,c*2),n.shadowOffsetX=0,n.shadowOffsetY=0,n.shadowBlur=0,n.lineWidth=0,n.strokeStyle="",fa(n,r,t)}const Wd=So([jd,da(!1),...ua(!1)],fa,Hd),Bd=n=>{const r=(s,u)=>{try{const l=u.neighbors(s);u.forEachNode(c=>{u.setNodeAttribute(c,"opacity",c!==s&&!l.includes(c)?.1:1)}),u.forEachEdge(c=>{u.setEdgeAttribute(c,"opacity",u.hasExtremity(c,s)?1:.1)})}catch{}},t=s=>{s.forEachNode(u=>{s.setNodeAttribute(u,"opacity",1)}),s.forEachEdge(u=>{s.setEdgeAttribute(u,"opacity",1)})},e=(s,u)=>{try{const l=u.source(s),c=u.target(s);u.setEdgeAttribute(s,"zIndex",2),u.setNodeAttribute(l,"zIndex",2),u.setNodeAttribute(c,"zIndex",2),u.setEdgeAttribute(s,"highlight",!0),u.setNodeAttribute(l,"highlight",!0),u.setNodeAttribute(c,"highlight",!0),u.forEachNode(d=>{u.setNodeAttribute(d,"opacity",d!==l&&d!==c?.1:1)}),u.forEachEdge(d=>{u.setEdgeAttribute(d,"opacity",d!==s?.1:1)})}catch{}},i=(s,u)=>{const l=u.source(s),c=u.target(s);u.setEdgeAttribute(s,"zIndex",0),u.setNodeAttribute(l,"zIndex",0),u.setNodeAttribute(c,"zIndex",0),u.setEdgeAttribute(s,"highlight",!1),u.setNodeAttribute(l,"highlight",!1),u.setNodeAttribute(c,"highlight",!1),u.forEachNode(d=>{u.setNodeAttribute(d,"opacity",1),u.setNodeAttribute(d,"highlight",!1)}),u.forEachEdge(d=>{u.setEdgeAttribute(d,"opacity",1),u.setEdgeAttribute(d,"highlight",!1)})},o=yt(s=>{r(s.node,n.getGraph())}),a=yt(s=>{e(s.edge,n.getGraph())},100);n.on("enterNode",o),n.on("leaveNode",s=>{o.cancel(),t(n.getGraph())}),n.on("enterEdge",a),n.on("leaveEdge",s=>{a.cancel(),i(s.edge,n.getGraph())})},Vd=n=>{let r=!1,t=!1,e={x:0,y:0},i;const o=c=>d=>{if(!r||!i)return;t=!0;const f=c.viewportToGraph(d),h={x:f.x-e.x,y:f.y-e.y},m=c.getGraph();Object.entries(i).forEach(([v,b])=>{m.setNodeAttribute(v,"x",b.x+h.x),m.setNodeAttribute(v,"y",b.y+h.y)}),d.preventSigmaDefault(),d.original.preventDefault(),d.original.stopPropagation()},a=c=>{r=!1,i=void 0},s=c=>{c.on("downNode",d=>{if("button"in d.event.original&&d.event.original.button===0){const f=c.getGraph();r=!0,i={};const{x:h=0,y:m=0}=f.getNodeAttributes(d.node);i[d.node]={x:h,y:m},e={x:h,y:m},f.forEachNode((v,b)=>{b.selected&&(i[v]={x:b.x,y:b.y})})}}),c.getMouseCaptor().on("mousemovebody",o(c)),c.getMouseCaptor().on("mouseup",d=>{r&&(a(c.getGraph()),d.original.preventDefault(),d.preventSigmaDefault())}),c.getMouseCaptor().on("mousedown",()=>{c.getCustomBBox()||c.setCustomBBox(c.getBBox())})},u=c=>{c.forEachNode((d,f)=>f.selected&&c.setNodeAttribute(d,"selected",!1)),c.forEachEdge((d,f)=>f.selected&&c.setEdgeAttribute(d,"selected",!1))};(c=>{c.on("downNode",d=>{if("button"in d.event.original&&d.event.original.button===2){const f=c.getGraph().getNodeAttribute(d.node,"selected");!f&&u(c.getGraph()),!f&&c.getGraph().setNodeAttribute(d.node,"selected",!0)}}),c.on("downEdge",d=>{if("button"in d.event.original&&d.event.original.button===2){const f=c.getGraph().getEdgeAttribute(d.edge,"selected");!f&&u(c.getGraph()),!f&&c.getGraph().setEdgeAttribute(d.edge,"selected",!0)}}),c.on("clickNode",d=>{if(!t&&"button"in d.event.original&&d.event.original.button===0){const f=c.getGraph().getNodeAttribute(d.node,"selected");!d.event.original.shiftKey&&u(c.getGraph()),c.getGraph().setNodeAttribute(d.node,"selected",!f)}t=!1}),c.on("downStage",d=>{u(c.getGraph())})})(n),s(n)},qd=(n,r,t)=>{const[e,i]=I.useState(null),[o,a]=I.useState(null),s=Qa(),[u,l]=I.useState();return I.useEffect(()=>{if(e){const c=new jc(n,e,{allowInvalidContainer:!0,enableEdgeEvents:!0,renderEdgeLabels:!0,renderLabels:!0,labelSize:14,defaultEdgeType:"line",defaultNodeType:"circle",edgeProgramClasses:{line:od,curved:Yc},maxCameraRatio:10,minCameraRatio:.01,nodeProgramClasses:{rect:Wd,circle:Fd},nodeReducer(d,f){const h=(r==null?void 0:r(f))||f;return!h.size&&h.weight&&(h.size=Math.max(16,h.weight*3)),(h.size??0)<16&&(h.size=16),h.label=h.label||"",h.id=d,h},edgeReducer(d,f){const h=(t==null?void 0:t(f))||f;return!h.size&&h.weight&&(h.size=Math.max(.5,h.weight*6)),(h.size??0)<.5&&(h.size=.5),h.id=d,h}});return Vd(c),Bd(c),window.sigma=c,l(c),()=>{c.kill()}}},[n,e,o]),I.useEffect(()=>{u==null||u.setSettings({defaultNodeColor:s?"#000":"#fff",defaultEdgeColor:s?"#fff":"#000",labelColor:{color:s?"#fff":"#000",attribute:"labelColor"}})},[s,u]),{instance:u,containerRef:i,componentsRef:a}},ga=I.createContext({}),Rn=()=>I.useContext(ga),va=({ref:n,data:r,children:t,nodeReducer:e,edgeReducer:i,onSelectChange:o,onNodeDoubleClick:a,onContextMenu:s})=>{const{graph:u,selected:l}=Ec(r),c=qd(u,e,i),d=nu(c.instance),[f,h]=I.useState(!1),m=()=>{u.size!==0&&c.instance&&Jn(c.instance,u.nodes(),{animate:!0})},v=()=>{var x;u.size!==0&&((x=c.instance)==null||x.getCamera().animatedZoom())},b=()=>{var x;u.size!==0&&((x=c.instance)==null||x.getCamera().animatedUnzoom())};return I.useEffect(()=>{const x=()=>{c.instance&&Jn(c.instance,u.nodes(),{animate:!0})};return u.on("layoutRunning",h),u.on("layoutDone",x),o&&u.on("nodesSelected",o),()=>{u.off("layoutDone",x),u.off("layoutRunning",h),o&&u.off("nodesSelected",o)}},[u,c,o]),I.useEffect(()=>{var T;const x=E=>(a==null||a(E.node,u.getNodeAttributes(E.node)),E.event.original.preventDefault(),E.event.preventSigmaDefault(),E.preventSigmaDefault(),!1);return(T=c.instance)==null||T.on("doubleClickNode",x),()=>{var E;(E=c.instance)==null||E.off("doubleClickNode",x)}},[c,u,a]),I.useImperativeHandle(n,()=>({graph:u,sigma:c}),[u,c]),j.jsxs(ga.Provider,{value:{sigma:c,graph:u,selected:l,dragSelector:d,resetViewport:m,zoomIn:v,zoomOut:b},children:[t,f&&j.jsx("div",{className:"absolute top-0 end-0 p-1",children:j.jsx(Qe,{icon:pe.spinner,animate:"spin"})})]})};va.__docgenInfo={description:"",methods:[],displayName:"GraphProvider",props:{ref:{required:!1,tsType:{name:"RefObject",elements:[{name:"union",raw:"GraphRef<N, E> | null",elements:[{name:"GraphRef",elements:[{name:"N"},{name:"E"}],raw:"GraphRef<N, E>"},{name:"null"}]}],raw:"RefObject<GraphRef<N, E> | null>"},description:""},data:{required:!0,tsType:{name:"union",raw:"RawGraph<N, E> | Graph<N, E>",elements:[{name:"RawGraph",elements:[{name:"N"},{name:"E"}],raw:"RawGraph<N, E>"},{name:"Graph",elements:[{name:"N"},{name:"E"}],raw:"Graph<N, E>"}]},description:""},nodeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(node: NodeAttributes<N>) => NodeAttributes<N>",signature:{arguments:[{type:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"},name:"node"}],return:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"}}},description:""},edgeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(edge: EdgeAttributes<E>) => EdgeAttributes<E>",signature:{arguments:[{type:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"},name:"edge"}],return:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"}}},description:""},onSelectChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(selected: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"selected"}],return:{name:"void"}}},description:""},onNodeDoubleClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(node: string, attributes: NodeAttributes<N>) => void",signature:{arguments:[{type:{name:"string"},name:"node"},{type:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"},name:"attributes"}],return:{name:"void"}}},description:""},onContextMenu:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  type: "canvas" | "node" | "edge",
  nodesOrEdge?: string | string[],
) => void`,signature:{arguments:[{type:{name:"union",raw:'"canvas" | "node" | "edge"',elements:[{name:"literal",value:'"canvas"'},{name:"literal",value:'"node"'},{name:"literal",value:'"edge"'}]},name:"type"},{type:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},name:"nodesOrEdge"}],return:{name:"void"}}},description:""}}};const Ae={focus:"M17 12C17 7.55 11.62 5.31 8.46 8.46C5.31 11.61 7.55 17 12 17C14.76 17 17 14.76 17 12M12 15C9.33 15 8 11.77 9.88 9.88C11.77 8 15 9.33 15 12C15 13.66 13.66 15 12 15M5 15H3V19C3 20.1 3.9 21 5 21H9V19H5M5 5H9V3H5C3.9 3 3 3.9 3 5V9H5M19 3H15V5H19V9H21V5C21 3.9 20.1 3 19 3M19 19H15V21H19C20.1 21 21 20.1 21 19V15H19",zoomIn:"M15.5,14L20.5,19L19,20.5L14,15.5V14.71L13.73,14.43C12.59,15.41 11.11,16 9.5,16A6.5,6.5 0 0,1 3,9.5A6.5,6.5 0 0,1 9.5,3A6.5,6.5 0 0,1 16,9.5C16,11.11 15.41,12.59 14.43,13.73L14.71,14H15.5M9.5,14C12,14 14,12 14,9.5C14,7 12,5 9.5,5C7,5 5,7 5,9.5C5,12 7,14 9.5,14M12,10H10V12H9V10H7V9H9V7H10V9H12V10Z",zoomOut:"M15.5,14H14.71L14.43,13.73C15.41,12.59 16,11.11 16,9.5A6.5,6.5 0 0,0 9.5,3A6.5,6.5 0 0,0 3,9.5A6.5,6.5 0 0,0 9.5,16C11.11,16 12.59,15.41 13.73,14.43L14,14.71V15.5L19,20.5L20.5,19L15.5,14M9.5,14C7,14 5,12 5,9.5C5,7 7,5 9.5,5C12,5 14,7 14,9.5C14,12 12,14 9.5,14M7,9H12V10H7V9Z",lasso:"M22 9C22 5.13 17.5 2 12 2C6.5 2 2 5.13 2 9C2 9.00843 2.00002 9.01685 2.00006 9.02527C2.00952 10.8953 3.06771 12.5956 4.78 13.85C4.78103 13.847 4.78207 13.844 4.7831 13.841C5.18858 14.1369 5.63069 14.408 6.10419 14.6507C6.03614 14.9227 6 15.2072 6 15.5C6 16.76 6.67 17.87 7.67 18.5C7.46 19.11 6.97 20.96 8.3 22.05C9.91 23.38 11.66 22.97 12.56 22.69C12.8116 22.6126 13.0655 22.5076 13.3395 22.3944C14.0563 22.0981 14.9105 21.7451 16.22 21.68C17.6764 21.5995 18.9321 21.8104 19.5651 21.9167C19.7188 21.9425 19.8358 21.9622 19.91 21.97C19.91 21.97 20.86 21.97 20.97 21.04C21.08 20.1 20.03 19.97 20.03 19.97C20.03 19.97 18.43 19.7 16.39 19.71C14.9823 19.7145 13.7447 20.1595 12.703 20.5341C11.4434 20.987 10.4704 21.3368 9.83 20.68C9.18 20 9.39 19.36 9.6 19C11.3416 18.9542 12.7471 17.6481 12.9693 15.9673C13.4921 15.9319 14.0034 15.8699 14.5 15.78C18.6753 15.0244 21.7995 12.4293 21.9907 9.30406C21.9969 9.20324 22 9.10187 22 9ZM20 9C20 10.2554 19.2572 11.4047 18.032 12.2843C16.6998 13.2393 14.7966 13.8752 12.6542 13.9835C12.0881 12.8109 10.887 12 9.5 12C8.57261 12 7.72834 12.3625 7.10143 12.9533C6.61638 12.7181 6.17578 12.4489 5.78883 12.1513L5.79 12.15C4.6875 11.3034 4.02105 10.2243 4.00049 9.05571C4.00016 9.03717 4 9.01859 4 9C4 6.24 7.58 4 12 4C16.42 4 20 6.24 20 9ZM10.9988 15.5603C10.9933 15.6993 10.9689 15.8333 10.9281 15.96C10.7345 16.5641 10.1694 17 9.5 17C8.67 17 8 16.33 8 15.5C8 15.4718 8.00078 15.4437 8.00231 15.4159C8.04595 14.6266 8.69981 14 9.5 14C10.3284 14 11 14.6716 11 15.5C11 15.5202 10.9996 15.5403 10.9988 15.5603Z",select:"M13,17H17V13H19V17H23V19H19V23H17V19H13V17M11,17V19H9V17H11M7,17V19H5V17H7M19,9V11H17V9H19M19,5V7H17V5H19M15,5V7H13V5H15M11,5V7H9V5H11M7,5V7H5V5H7M7,13V15H5V13H7M7,9V11H5V9H7Z",cancel:"M3,16.74L7.76,12L3,7.26L7.26,3L12,7.76L16.74,3L21,7.26L16.24,12L21,16.74L16.74,21L12,16.24L7.26,21L3,16.74M12,13.41L16.74,18.16L18.16,16.74L13.41,12L18.16,7.26L16.74,5.84L12,10.59L7.26,5.84L5.84,7.26L10.59,12L5.84,16.74L7.26,18.16L12,13.41Z",delete:"M9,3V4H4V6H5V19A2,2 0 0,0 7,21H17A2,2 0 0,0 19,19V6H20V4H15V3H9M9,8H11V17H9V8M13,8H15V17H13V8Z",clear:"M16.24,3.56L21.19,8.5C21.97,9.29 21.97,10.55 21.19,11.34L12,20.53C10.44,22.09 7.91,22.09 6.34,20.53L2.81,17C2.03,16.21 2.03,14.95 2.81,14.16L13.41,3.56C14.2,2.78 15.46,2.78 16.24,3.56M4.22,15.58L7.76,19.11C8.54,19.9 9.8,19.9 10.59,19.11L14.12,15.58L9.17,10.63L4.22,15.58Z"},pa=()=>{const{dragSelector:n,graph:r,selected:t,resetViewport:e,zoomIn:i,zoomOut:o}=Rn();return j.jsxs("div",{className:"flex flex-nowrap outline absolute top-0 start-0 p-0 z-1 bg-base",children:[j.jsxs(Ft,{variant:"link",children:[j.jsx(ye,{"aria-label":"Home",icon:Ae.focus,onClick:e}),j.jsx(ye,{"aria-label":"Zoomin",icon:Ae.zoomIn,onClick:i}),j.jsx(ye,{"aria-label":"Zoomout",icon:Ae.zoomOut,onClick:o})]}),j.jsxs(Ft,{variant:"link",children:[n.selectionMode!=="lasso"&&j.jsx(ye,{"aria-label":"lasso",icon:Ae.lasso,disabled:!!n.selectionMode,onClick:()=>n.startLassoSelection()}),n.selectionMode&&j.jsx(ye,{color:"danger","aria-label":"cancel",icon:Ae.cancel,onClick:()=>n.cancelSelection()}),n.selectionMode!=="rectangle"&&j.jsx(ye,{"aria-label":"rectselect",icon:Ae.select,disabled:!!n.selectionMode,onClick:()=>n.startRectangleSelection()})]}),j.jsxs(Ft,{variant:"link",children:[j.jsx(ye,{"aria-label":"circular",icon:"M20.8 8.8c-0.43 0-0.84 0.086-1.216 0.241l-4.742-4.377c0.227-0.439 0.358-0.936 0.358-1.464 0-1.764-1.436-3.2-3.2-3.2s-3.2 1.436-3.2 3.2c0 0.528 0.13 1.025 0.358 1.464l-4.742 4.377c-0.375-0.155-0.785-0.241-1.216-0.241-1.764 0-3.2 1.436-3.2 3.2s1.436 3.2 3.2 3.2c0.43 0 0.84-0.087 1.216-0.242l4.742 4.378c-0.227 0.439-0.358 0.936-0.358 1.464-0 1.764 1.436 3.2 3.2 3.2s3.2-1.436 3.2-3.2c0-0.528-0.131-1.025-0.358-1.464l4.742-4.378c0.375 0.155 0.785 0.242 1.216 0.242 1.764 0 3.2-1.436 3.2-3.2s-1.436-3.2-3.2-3.2zM18.86 14.539l-4.477 4.133c-0.586-0.656-1.436-1.072-2.383-1.072s-1.796 0.416-2.383 1.072l-4.477-4.133c0.764-0.585 1.26-1.504 1.26-2.539s-0.496-1.954-1.26-2.539l4.477-4.133c0.586 0.656 1.436 1.072 2.383 1.072s1.796-0.416 2.383-1.072l4.477 4.133c-0.764 0.585-1.26 1.504-1.26 2.539s0.496 1.954 1.26 2.539z",onClick:()=>r.circularLayout()}),j.jsx(ye,{"aria-label":"force",icon:"M21.763 15.051c-0.434 0-0.835 0.139-1.165 0.372l-3.733-2.24c0.006-0.055 0.017-0.109 0.017-0.166 0-0.756-0.52-1.388-1.22-1.569v-3.76c0.927-0.189 1.627-1.011 1.627-1.993 0-0.293-0.065-0.571-0.178-0.823l2.175-1.864c0.248 0.153 0.538 0.247 0.851 0.247 0.897 0 1.627-0.73 1.627-1.627s-0.73-1.627-1.627-1.627-1.627 0.73-1.627 1.627c0 0.289 0.082 0.556 0.214 0.792l-2.089 1.791c-0.363-0.337-0.846-0.548-1.379-0.548-0.629 0-1.185 0.293-1.559 0.744l-2.317-1.986c0.133-0.235 0.214-0.503 0.214-0.792 0-0.897-0.73-1.627-1.627-1.627s-1.627 0.73-1.627 1.627c0 0.897 0.73 1.627 1.627 1.627 0.313 0 0.602-0.093 0.851-0.247l2.49 2.134c-0.050 0.177-0.086 0.36-0.086 0.553 0 0.982 0.7 1.804 1.627 1.993v3.76c-0.365 0.095-0.68 0.312-0.898 0.607l-3.609-0.984c-0.155-0.969-0.99-1.715-2.002-1.715-0.408 0-0.788 0.124-1.107 0.332l-3.307-3.674c0.218-0.324 0.346-0.713 0.346-1.132 0-1.121-0.912-2.034-2.034-2.034s-2.034 0.912-2.034 2.034 0.912 2.034 2.034 2.034c0.408 0 0.788-0.124 1.107-0.332l3.307 3.674c-0.218 0.324-0.346 0.713-0.346 1.132 0 0.051 0.011 0.098 0.015 0.148l-2.996 1.497c-0.289-0.261-0.668-0.425-1.087-0.425-0.897 0-1.627 0.73-1.627 1.627s0.73 1.627 1.627 1.627 1.627-0.73 1.627-1.627c0-0.181-0.037-0.353-0.092-0.516l2.775-1.388c0.281 0.53 0.78 0.926 1.384 1.049v3.353c-0.7 0.182-1.22 0.813-1.22 1.569 0 0.191 0.039 0.371 0.1 0.541l-2.503 2.146c-0.248-0.153-0.538-0.247-0.851-0.247-0.897 0-1.627 0.73-1.627 1.627s0.73 1.627 1.627 1.627c0.897 0 1.627-0.73 1.627-1.627 0-0.289-0.082-0.556-0.214-0.792l2.401-2.058c0.287 0.251 0.657 0.409 1.068 0.409s0.781-0.157 1.068-0.409l2.401 2.058c-0.133 0.235-0.214 0.503-0.214 0.792 0 0.897 0.73 1.627 1.627 1.627s1.627-0.73 1.627-1.627c0-0.897-0.73-1.627-1.627-1.627-0.313 0-0.602 0.093-0.851 0.247l-2.503-2.146c0.061-0.17 0.1-0.351 0.1-0.541 0-0.756-0.52-1.388-1.22-1.569v-3.353c0.759-0.155 1.359-0.737 1.553-1.48l3.348 0.913c-0.008 0.067-0.020 0.132-0.020 0.201 0 0.897 0.73 1.627 1.627 1.627 0.545 0 1.026-0.272 1.322-0.685l3.455 2.073c-0.188 0.308-0.302 0.666-0.302 1.053 0 1.121 0.912 2.034 2.034 2.034s2.034-0.912 2.034-2.034-0.912-2.034-2.034-2.034z",onClick:()=>r.forceLayout()})]}),j.jsxs(Ft,{variant:"link",children:[j.jsx(ye,{"aria-label":"delete",color:"danger",icon:Ae.delete,disabled:!t.length,onClick:()=>r.dropNodes(t)}),j.jsx(ye,{"aria-label":"clear",color:"danger",icon:Ae.clear,onClick:()=>r.clear()})]})]})};pa.__docgenInfo={description:"",methods:[],displayName:"Tools"};function vr(){return typeof window<"u"}function ma(n){return ya(n)?(n.nodeName||"").toLowerCase():"#document"}function Wt(n){var r;return(n==null||(r=n.ownerDocument)==null?void 0:r.defaultView)||window}function Xd(n){var r;return(r=(ya(n)?n.ownerDocument:n.document)||window.document)==null?void 0:r.documentElement}function ya(n){return vr()?n instanceof Node||n instanceof Wt(n).Node:!1}function Oe(n){return vr()?n instanceof Element||n instanceof Wt(n).Element:!1}function pr(n){return vr()?n instanceof HTMLElement||n instanceof Wt(n).HTMLElement:!1}function cn(n){return!vr()||typeof ShadowRoot>"u"?!1:n instanceof ShadowRoot||n instanceof Wt(n).ShadowRoot}function Yd(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Br(n){return["html","body","#document"].includes(ma(n))}function Kd(n){return Wt(n).getComputedStyle(n)}function Zd(n){if(ma(n)==="html")return n;const r=n.assignedSlot||n.parentNode||cn(n)&&n.host||Xd(n);return cn(r)?r.host:r}function Jd(){return/apple/i.test(navigator.vendor)}const Qd="input:not([type='hidden']):not([disabled]),[contenteditable]:not([contenteditable='false']),textarea:not([disabled])";function eh(n){let r=n.activeElement;for(;((t=r)==null||(t=t.shadowRoot)==null?void 0:t.activeElement)!=null;){var t;r=r.shadowRoot.activeElement}return r}function dn(n,r){if(!n||!r)return!1;const t=r.getRootNode==null?void 0:r.getRootNode();if(n.contains(r))return!0;if(t&&cn(t)){let e=r;for(;e;){if(n===e)return!0;e=e.parentNode||e.host}}return!1}function zt(n){return"composedPath"in n?n.composedPath()[0]:n.target}function Vr(n,r){if(r==null)return!1;if("composedPath"in n)return n.composedPath().includes(r);const t=n;return t.target!=null&&r.contains(t.target)}function th(n){return n.matches("html,body")}function Ut(n){return(n==null?void 0:n.ownerDocument)||document}function rh(n){return pr(n)&&n.matches(Qd)}function qr(n,r){let t=n.filter(i=>{var o;return i.parentId===r&&((o=i.context)==null?void 0:o.open)}),e=t;for(;e.length;)e=n.filter(i=>{var o;return(o=e)==null?void 0:o.some(a=>{var s;return i.parentId===a.id&&((s=i.context)==null?void 0:s.open)})}),t=t.concat(e);return t}function nh(n){return"nativeEvent"in n}function Mi(n,r){return["mouse","pen"].includes(n)}var ih=typeof document<"u",oh=function(){},et=ih?I.useLayoutEffect:oh;const ah={...io},sh=ah.useInsertionEffect,uh=sh||(n=>n());function vt(n){const r=I.useRef(()=>{});return uh(()=>{r.current=n}),I.useCallback(function(){for(var t=arguments.length,e=new Array(t),i=0;i<t;i++)e[i]=arguments[i];return r.current==null?void 0:r.current(...e)},[])}const ba=()=>({getShadowRoot:!0,displayCheck:typeof ResizeObserver=="function"&&ResizeObserver.toString().includes("[native code]")?"full":"none"});function _a(n,r){const t=oo(n,ba()),e=t.length;if(e===0)return;const i=eh(Ut(n)),o=t.indexOf(i),a=o===-1?r===1?0:e-1:o+r;return t[a]}function lh(n){return _a(Ut(n).body,1)||n}function ch(n){return _a(Ut(n).body,-1)||n}function Xr(n,r){const t=r||n.currentTarget,e=n.relatedTarget;return!e||!dn(t,e)}function dh(n){oo(n,ba()).forEach(t=>{t.dataset.tabindex=t.getAttribute("tabindex")||"",t.setAttribute("tabindex","-1")})}function Ui(n){n.querySelectorAll("[data-tabindex]").forEach(t=>{const e=t.dataset.tabindex;delete t.dataset.tabindex,e?t.setAttribute("tabindex",e):t.removeAttribute("tabindex")})}var hh=typeof document<"u",fh=function(){},nr=hh?I.useLayoutEffect:fh;function sr(n,r){if(n===r)return!0;if(typeof n!=typeof r)return!1;if(typeof n=="function"&&n.toString()===r.toString())return!0;let t,e,i;if(n&&r&&typeof n=="object"){if(Array.isArray(n)){if(t=n.length,t!==r.length)return!1;for(e=t;e--!==0;)if(!sr(n[e],r[e]))return!1;return!0}if(i=Object.keys(n),t=i.length,t!==Object.keys(r).length)return!1;for(e=t;e--!==0;)if(!{}.hasOwnProperty.call(r,i[e]))return!1;for(e=t;e--!==0;){const o=i[e];if(!(o==="_owner"&&n.$$typeof)&&!sr(n[o],r[o]))return!1}return!0}return n!==n&&r!==r}function wa(n){return typeof window>"u"?1:(n.ownerDocument.defaultView||window).devicePixelRatio||1}function ji(n,r){const t=wa(n);return Math.round(r*t)/t}function Yr(n){const r=I.useRef(n);return nr(()=>{r.current=n}),r}function gh(n){n===void 0&&(n={});const{placement:r="bottom",strategy:t="absolute",middleware:e=[],platform:i,elements:{reference:o,floating:a}={},transform:s=!0,whileElementsMounted:u,open:l}=n,[c,d]=I.useState({x:0,y:0,strategy:t,placement:r,middlewareData:{},isPositioned:!1}),[f,h]=I.useState(e);sr(f,e)||h(e);const[m,v]=I.useState(null),[b,x]=I.useState(null),T=I.useCallback(g=>{g!==L.current&&(L.current=g,v(g))},[]),E=I.useCallback(g=>{g!==y.current&&(y.current=g,x(g))},[]),_=o||m,A=a||b,L=I.useRef(null),y=I.useRef(null),C=I.useRef(c),S=u!=null,D=Yr(u),G=Yr(i),O=Yr(l),R=I.useCallback(()=>{if(!L.current||!y.current)return;const g={placement:r,strategy:t,middleware:f};G.current&&(g.platform=G.current),Da(L.current,y.current,g).then(z=>{const M={...z,isPositioned:O.current!==!1};H.current&&!sr(C.current,M)&&(C.current=M,ao.flushSync(()=>{d(M)}))})},[f,r,t,G,O]);nr(()=>{l===!1&&C.current.isPositioned&&(C.current.isPositioned=!1,d(g=>({...g,isPositioned:!1})))},[l]);const H=I.useRef(!1);nr(()=>(H.current=!0,()=>{H.current=!1}),[]),nr(()=>{if(_&&(L.current=_),A&&(y.current=A),_&&A){if(D.current)return D.current(_,A,R);R()}},[_,A,R,D,S]);const $=I.useMemo(()=>({reference:L,floating:y,setReference:T,setFloating:E}),[T,E]),w=I.useMemo(()=>({reference:_,floating:A}),[_,A]),p=I.useMemo(()=>{const g={position:t,left:0,top:0};if(!w.floating)return g;const z=ji(w.floating,c.x),M=ji(w.floating,c.y);return s?{...g,transform:"translate("+z+"px, "+M+"px)",...wa(w.floating)>=1.5&&{willChange:"transform"}}:{position:t,left:z,top:M}},[t,s,w.floating,c.x,c.y]);return I.useMemo(()=>({...c,update:R,refs:$,elements:w,floatingStyles:p}),[c,R,$,w,p])}const vh=(n,r)=>({...ka(n),options:[n,r]}),ph=(n,r)=>({...La(n),options:[n,r]}),mh="data-floating-ui-focusable",Hi="active",Wi="selected",yh={...io};let Bi=!1,bh=0;const Vi=()=>"floating-ui-"+Math.random().toString(36).slice(2,6)+bh++;function _h(){const[n,r]=I.useState(()=>Bi?Vi():void 0);return et(()=>{n==null&&r(Vi())},[]),I.useEffect(()=>{Bi=!0},[]),n}const wh=yh.useId,Sn=wh||_h;function Eh(){const n=new Map;return{emit(r,t){var e;(e=n.get(r))==null||e.forEach(i=>i(t))},on(r,t){n.has(r)||n.set(r,new Set),n.get(r).add(t)},off(r,t){var e;(e=n.get(r))==null||e.delete(t)}}}const Th=I.createContext(null),Rh=I.createContext(null),Ea=()=>{var n;return((n=I.useContext(Th))==null?void 0:n.id)||null},xn=()=>I.useContext(Rh);function Sh(n){const r=Sn(),t=xn(),i=Ea();return et(()=>{if(!r)return;const o={id:r,parentId:i};return t==null||t.addNode(o),()=>{t==null||t.removeNode(o)}},[t,r,i]),r}function Cn(n){return"data-floating-ui-"+n}function xh(n){n.current!==-1&&(clearTimeout(n.current),n.current=-1)}const Ta={border:0,clip:"rect(0 0 0 0)",height:"1px",margin:"-1px",overflow:"hidden",padding:0,position:"fixed",whiteSpace:"nowrap",width:"1px",top:0,left:0},qi=I.forwardRef(function(r,t){const[e,i]=I.useState();et(()=>{Jd()&&i("button")},[]);const o={ref:t,tabIndex:0,role:e,"aria-hidden":e?void 0:!0,[Cn("focus-guard")]:"",style:Ta};return j.jsx("span",{...r,...o})}),Ra=I.createContext(null),Xi=Cn("portal");function Ch(n){n===void 0&&(n={});const{id:r,root:t}=n,e=Sn(),i=kh(),[o,a]=I.useState(null),s=I.useRef(null);return et(()=>()=>{o==null||o.remove(),queueMicrotask(()=>{s.current=null})},[o]),et(()=>{if(!e||s.current)return;const u=r?document.getElementById(r):null;if(!u)return;const l=document.createElement("div");l.id=e,l.setAttribute(Xi,""),u.appendChild(l),s.current=l,a(l)},[r,e]),et(()=>{if(t===null||!e||s.current)return;let u=t||(i==null?void 0:i.portalNode);u&&!Oe(u)&&(u=u.current),u=u||document.body;let l=null;r&&(l=document.createElement("div"),l.id=r,u.appendChild(l));const c=document.createElement("div");c.id=e,c.setAttribute(Xi,""),u=l||u,u.appendChild(c),s.current=c,a(c)},[r,t,e,i]),o}function Ah(n){const{children:r,id:t,root:e,preserveTabOrder:i=!0}=n,o=Ch({id:t,root:e}),[a,s]=I.useState(null),u=I.useRef(null),l=I.useRef(null),c=I.useRef(null),d=I.useRef(null),f=a==null?void 0:a.modal,h=a==null?void 0:a.open,m=!!a&&!a.modal&&a.open&&i&&!!(e||o);return I.useEffect(()=>{if(!o||!i||f)return;function v(b){o&&Xr(b)&&(b.type==="focusin"?Ui:dh)(o)}return o.addEventListener("focusin",v,!0),o.addEventListener("focusout",v,!0),()=>{o.removeEventListener("focusin",v,!0),o.removeEventListener("focusout",v,!0)}},[o,i,f]),I.useEffect(()=>{o&&(h||Ui(o))},[h,o]),j.jsxs(Ra.Provider,{value:I.useMemo(()=>({preserveTabOrder:i,beforeOutsideRef:u,afterOutsideRef:l,beforeInsideRef:c,afterInsideRef:d,portalNode:o,setFocusManagerState:s}),[i,o]),children:[m&&o&&j.jsx(qi,{"data-type":"outside",ref:u,onFocus:v=>{if(Xr(v,o)){var b;(b=c.current)==null||b.focus()}else{const x=a?a.domReference:null,T=ch(x);T==null||T.focus()}}}),m&&o&&j.jsx("span",{"aria-owns":o.id,style:Ta}),o&&ao.createPortal(r,o),m&&o&&j.jsx(qi,{"data-type":"outside",ref:l,onFocus:v=>{if(Xr(v,o)){var b;(b=d.current)==null||b.focus()}else{const x=a?a.domReference:null,T=lh(x);T==null||T.focus(),a!=null&&a.closeOnFocusOut&&(a==null||a.onOpenChange(!1,v.nativeEvent,"focus-out"))}}})]})}const kh=()=>I.useContext(Ra);function Yi(n){return pr(n.target)&&n.target.tagName==="BUTTON"}function Lh(n){return pr(n.target)&&n.target.tagName==="A"}function Ki(n){return rh(n)}function Dh(n,r){r===void 0&&(r={});const{open:t,onOpenChange:e,dataRef:i,elements:{domReference:o}}=n,{enabled:a=!0,event:s="click",toggle:u=!0,ignoreMouse:l=!1,keyboardHandlers:c=!0,stickIfOpen:d=!0}=r,f=I.useRef(),h=I.useRef(!1),m=I.useMemo(()=>({onPointerDown(v){f.current=v.pointerType},onMouseDown(v){const b=f.current;v.button===0&&s!=="click"&&(Mi(b)&&l||(t&&u&&(!(i.current.openEvent&&d)||i.current.openEvent.type==="mousedown")?e(!1,v.nativeEvent,"click"):(v.preventDefault(),e(!0,v.nativeEvent,"click"))))},onClick(v){const b=f.current;if(s==="mousedown"&&f.current){f.current=void 0;return}Mi(b)&&l||(t&&u&&(!(i.current.openEvent&&d)||i.current.openEvent.type==="click")?e(!1,v.nativeEvent,"click"):e(!0,v.nativeEvent,"click"))},onKeyDown(v){f.current=void 0,!(v.defaultPrevented||!c||Yi(v))&&(v.key===" "&&!Ki(o)&&(v.preventDefault(),h.current=!0),!Lh(v)&&v.key==="Enter"&&e(!(t&&u),v.nativeEvent,"click"))},onKeyUp(v){v.defaultPrevented||!c||Yi(v)||Ki(o)||v.key===" "&&h.current&&(h.current=!1,e(!(t&&u),v.nativeEvent,"click"))}}),[i,o,s,l,c,e,t,d,u]);return I.useMemo(()=>a?{reference:m}:{},[a,m])}const Gh={pointerdown:"onPointerDown",mousedown:"onMouseDown",click:"onClick"},Ph={pointerdown:"onPointerDownCapture",mousedown:"onMouseDownCapture",click:"onClickCapture"},Zi=n=>{var r,t;return{escapeKey:typeof n=="boolean"?n:(r=n==null?void 0:n.escapeKey)!=null?r:!1,outsidePress:typeof n=="boolean"?n:(t=n==null?void 0:n.outsidePress)!=null?t:!0}};function Nh(n,r){r===void 0&&(r={});const{open:t,onOpenChange:e,elements:i,dataRef:o}=n,{enabled:a=!0,escapeKey:s=!0,outsidePress:u=!0,outsidePressEvent:l="pointerdown",referencePress:c=!1,referencePressEvent:d="pointerdown",ancestorScroll:f=!1,bubbles:h,capture:m}=r,v=xn(),b=vt(typeof u=="function"?u:()=>!1),x=typeof u=="function"?b:u,T=I.useRef(!1),{escapeKey:E,outsidePress:_}=Zi(h),{escapeKey:A,outsidePress:L}=Zi(m),y=I.useRef(!1),C=I.useRef(-1),S=vt($=>{var w;if(!t||!a||!s||$.key!=="Escape"||y.current)return;const p=(w=o.current.floatingContext)==null?void 0:w.nodeId,g=v?qr(v.nodesRef.current,p):[];if(!E&&($.stopPropagation(),g.length>0)){let z=!0;if(g.forEach(M=>{var P;if((P=M.context)!=null&&P.open&&!M.context.dataRef.current.__escapeKeyBubbles){z=!1;return}}),!z)return}e(!1,nh($)?$.nativeEvent:$,"escape-key")}),D=vt($=>{var w;const p=()=>{var g;S($),(g=zt($))==null||g.removeEventListener("keydown",p)};(w=zt($))==null||w.addEventListener("keydown",p)}),G=vt($=>{var w;const p=o.current.insideReactTree;o.current.insideReactTree=!1;const g=T.current;if(T.current=!1,l==="click"&&g||p||typeof x=="function"&&!x($))return;const z=zt($),M="["+Cn("inert")+"]",P=Ut(i.floating).querySelectorAll(M);let k=Oe(z)?z:null;for(;k&&!Br(k);){const ee=Zd(k);if(Br(ee)||!Oe(ee))break;k=ee}if(P.length&&Oe(z)&&!th(z)&&!dn(z,i.floating)&&Array.from(P).every(ee=>!dn(k,ee)))return;if(pr(z)&&H){const ee=Br(z),q=Kd(z),W=/auto|scroll/,oe=ee||W.test(q.overflowX),Z=ee||W.test(q.overflowY),ne=oe&&z.clientWidth>0&&z.scrollWidth>z.clientWidth,te=Z&&z.clientHeight>0&&z.scrollHeight>z.clientHeight,ce=q.direction==="rtl",J=te&&(ce?$.offsetX<=z.offsetWidth-z.clientWidth:$.offsetX>z.clientWidth),X=ne&&$.offsetY>z.clientHeight;if(J||X)return}const F=(w=o.current.floatingContext)==null?void 0:w.nodeId,B=v&&qr(v.nodesRef.current,F).some(ee=>{var q;return Vr($,(q=ee.context)==null?void 0:q.elements.floating)});if(Vr($,i.floating)||Vr($,i.domReference)||B)return;const Y=v?qr(v.nodesRef.current,F):[];if(Y.length>0){let ee=!0;if(Y.forEach(q=>{var W;if((W=q.context)!=null&&W.open&&!q.context.dataRef.current.__outsidePressBubbles){ee=!1;return}}),!ee)return}e(!1,$,"outside-press")}),O=vt($=>{var w;const p=()=>{var g;G($),(g=zt($))==null||g.removeEventListener(l,p)};(w=zt($))==null||w.addEventListener(l,p)});I.useEffect(()=>{if(!t||!a)return;o.current.__escapeKeyBubbles=E,o.current.__outsidePressBubbles=_;let $=-1;function w(P){e(!1,P,"ancestor-scroll")}function p(){window.clearTimeout($),y.current=!0}function g(){$=window.setTimeout(()=>{y.current=!1},Yd()?5:0)}const z=Ut(i.floating);s&&(z.addEventListener("keydown",A?D:S,A),z.addEventListener("compositionstart",p),z.addEventListener("compositionend",g)),x&&z.addEventListener(l,L?O:G,L);let M=[];return f&&(Oe(i.domReference)&&(M=mr(i.domReference)),Oe(i.floating)&&(M=M.concat(mr(i.floating))),!Oe(i.reference)&&i.reference&&i.reference.contextElement&&(M=M.concat(mr(i.reference.contextElement)))),M=M.filter(P=>{var k;return P!==((k=z.defaultView)==null?void 0:k.visualViewport)}),M.forEach(P=>{P.addEventListener("scroll",w,{passive:!0})}),()=>{s&&(z.removeEventListener("keydown",A?D:S,A),z.removeEventListener("compositionstart",p),z.removeEventListener("compositionend",g)),x&&z.removeEventListener(l,L?O:G,L),M.forEach(P=>{P.removeEventListener("scroll",w)}),window.clearTimeout($)}},[o,i,s,x,l,t,e,f,a,E,_,S,A,D,G,L,O]),I.useEffect(()=>{o.current.insideReactTree=!1},[o,x,l]);const R=I.useMemo(()=>({onKeyDown:S,...c&&{[Gh[d]]:$=>{e(!1,$.nativeEvent,"reference-press")},...d!=="click"&&{onClick($){e(!1,$.nativeEvent,"reference-press")}}}}),[S,e,c,d]),H=I.useMemo(()=>({onKeyDown:S,onMouseDown(){T.current=!0},onMouseUp(){T.current=!0},[Ph[l]]:()=>{o.current.insideReactTree=!0},onBlurCapture(){v||(xh(C),o.current.insideReactTree=!0,C.current=window.setTimeout(()=>{o.current.insideReactTree=!1}))}}),[S,l,o,v]);return I.useMemo(()=>a?{reference:R,floating:H}:{},[a,R,H])}function Oh(n){const{open:r=!1,onOpenChange:t,elements:e}=n,i=Sn(),o=I.useRef({}),[a]=I.useState(()=>Eh()),s=Ea()!=null,[u,l]=I.useState(e.reference),c=vt((h,m,v)=>{o.current.openEvent=h?m:void 0,a.emit("openchange",{open:h,event:m,reason:v,nested:s}),t==null||t(h,m,v)}),d=I.useMemo(()=>({setPositionReference:l}),[]),f=I.useMemo(()=>({reference:u||e.reference||null,floating:e.floating||null,domReference:e.reference}),[u,e.reference,e.floating]);return I.useMemo(()=>({dataRef:o,open:r,onOpenChange:c,elements:f,events:a,floatingId:i,refs:d}),[r,c,f,a,i,d])}function Ih(n){n===void 0&&(n={});const{nodeId:r}=n,t=Oh({...n,elements:{reference:null,floating:null,...n.elements}}),e=n.rootContext||t,i=e.elements,[o,a]=I.useState(null),[s,u]=I.useState(null),c=(i==null?void 0:i.domReference)||o,d=I.useRef(null),f=xn();et(()=>{c&&(d.current=c)},[c]);const h=gh({...n,elements:{...i,...s&&{reference:s}}}),m=I.useCallback(E=>{const _=Oe(E)?{getBoundingClientRect:()=>E.getBoundingClientRect(),getClientRects:()=>E.getClientRects(),contextElement:E}:E;u(_),h.refs.setReference(_)},[h.refs]),v=I.useCallback(E=>{(Oe(E)||E===null)&&(d.current=E,a(E)),(Oe(h.refs.reference.current)||h.refs.reference.current===null||E!==null&&!Oe(E))&&h.refs.setReference(E)},[h.refs]),b=I.useMemo(()=>({...h.refs,setReference:v,setPositionReference:m,domReference:d}),[h.refs,v,m]),x=I.useMemo(()=>({...h.elements,domReference:c}),[h.elements,c]),T=I.useMemo(()=>({...h,...e,refs:b,elements:x,nodeId:r}),[h,b,x,r,e]);return et(()=>{e.dataRef.current.floatingContext=T;const E=f==null?void 0:f.nodesRef.current.find(_=>_.id===r);E&&(E.context=T)}),I.useMemo(()=>({...h,context:T,refs:b,elements:x}),[h,b,x,T])}function Kr(n,r,t){const e=new Map,i=t==="item";let o=n;if(i&&n){const{[Hi]:a,[Wi]:s,...u}=n;o=u}return{...t==="floating"&&{tabIndex:-1,[mh]:""},...o,...r.map(a=>{const s=a?a[t]:null;return typeof s=="function"?n?s(n):null:s}).concat(n).reduce((a,s)=>(s&&Object.entries(s).forEach(u=>{let[l,c]=u;if(!(i&&[Hi,Wi].includes(l)))if(l.indexOf("on")===0){if(e.has(l)||e.set(l,[]),typeof c=="function"){var d;(d=e.get(l))==null||d.push(c),a[l]=function(){for(var f,h=arguments.length,m=new Array(h),v=0;v<h;v++)m[v]=arguments[v];return(f=e.get(l))==null?void 0:f.map(b=>b(...m)).find(b=>b!==void 0)}}}else a[l]=c}),a),{})}}function zh(n){n===void 0&&(n=[]);const r=n.map(s=>s==null?void 0:s.reference),t=n.map(s=>s==null?void 0:s.floating),e=n.map(s=>s==null?void 0:s.item),i=I.useCallback(s=>Kr(s,n,"reference"),r),o=I.useCallback(s=>Kr(s,n,"floating"),t),a=I.useCallback(s=>Kr(s,n,"item"),e);return I.useMemo(()=>({getReferenceProps:i,getFloatingProps:o,getItemProps:a}),[i,o,a])}const Sa=()=>{var m;const[n,r]=I.useState(!1),t=Sh(),{sigma:e,graph:i}=Rn(),[o,a]=I.useState([]),{refs:s,floatingStyles:u,context:l}=Ih({open:n,nodeId:t,onOpenChange:(v,b,x)=>{const T=b==null?void 0:b.target;T!=null&&T.closest(".menu-list")||r(v)},strategy:"absolute",placement:"bottom-start",whileElementsMounted:Ga,middleware:[vh(8),ph()]}),c=Dh(l,{toggle:!0,ignoreMouse:!0}),d=Nh(l,{bubbles:!0}),{getFloatingProps:f}=zh([d,c]),h=I.useRef(v=>{var b;(b=v.target)!=null&&b.closest("[data-dropdown-dismiss='true']")&&setTimeout(()=>r(!1),50)});return I.useEffect(()=>{var b,x,T;const v=E=>{"node"in E?a([j.jsx(ut,{label:"Select neighbors"}),j.jsx(Gn,{}),j.jsx(ut,{label:"Delete node(s)",color:"danger",icon:Ae.delete}),j.jsx(ut,{label:"Clear graph",color:"danger",icon:Ae.clear})]):"edge"in E?a([j.jsx(ut,{label:"Select neighbors"}),j.jsx(Gn,{}),j.jsx(ut,{label:"Clear graph",color:"danger",icon:Ae.clear})]):a([j.jsx(ut,{label:"Clear graph",color:"danger",icon:Ae.clear})]);const _={getBoundingClientRect(){return{width:0,height:0,x:E.event.x,y:E.event.y,top:E.event.y,left:E.event.x,right:E.event.x,bottom:E.event.y}}};return r(!0),s.setReference(_),E.event.original.preventDefault(),!1};return(b=e.instance)==null||b.on("rightClickNode",v),(x=e.instance)==null||x.on("rightClickEdge",v),(T=e.instance)==null||T.on("rightClickStage",v),()=>{var E,_,A;(E=e.instance)==null||E.off("rightClickNode",v),(_=e.instance)==null||_.off("rightClickEdge",v),(A=e.instance)==null||A.off("rightClickStage",v)}},[e]),n&&j.jsx(Ah,{root:((m=s.domReference.current)==null?void 0:m.closest(".theme-base"))??void 0,children:I.cloneElement(j.jsx(es,{children:o}),{...f(),style:{...u,borderRadius:"var(--rounding)",zIndex:"var(--z-popover)",fontSize:"0.75rem"},className:"bg-base outline rounded-capped shadow-lg",ref:s.setFloating,onMouseUp:h.current})})};Sa.__docgenInfo={description:"",methods:[],displayName:"GraphContextMenu"};const Fh=()=>{const{sigma:n,graph:r}=Rn(),t=I.useRef(null);return I.useEffect(()=>{const e=({key:i})=>{var a;const o=(a=t.current)==null?void 0:a.querySelector(`[data-id="${i}"]`);o==null||o.remove()};return r.on("nodeDropped",e),()=>{r.off("nodeDropped",e)}},[r]),j.jsxs("div",{className:"area-content relative bg-base graph-viewer",children:[j.jsx("div",{dir:"ltr",ref:n.containerRef,className:"absolute inset-0"}),j.jsx("div",{ref:t,dir:"ltr",onClick:e=>{const i=e.target.dataset.id;i&&r.toggleExpanded(i)},className:"absolute inset-0 overflow-hidden pointer-events-none sigma-groupHandles"})]})},An=n=>j.jsx(Ja,{className:"relative",children:j.jsxs(va,{...n,children:[j.jsx(pa,{}),j.jsx(Fh,{}),j.jsx(Sa,{})]})});An.__docgenInfo={description:"",methods:[],displayName:"SigmaGraph",props:{ref:{required:!1,tsType:{name:"RefObject",elements:[{name:"union",raw:"GraphRef<N, E> | null",elements:[{name:"GraphRef",elements:[{name:"N"},{name:"E"}],raw:"GraphRef<N, E>"},{name:"null"}]}],raw:"RefObject<GraphRef<N, E> | null>"},description:""},data:{required:!0,tsType:{name:"union",raw:"RawGraph<N, E> | Graph<N, E>",elements:[{name:"RawGraph",elements:[{name:"N"},{name:"E"}],raw:"RawGraph<N, E>"},{name:"Graph",elements:[{name:"N"},{name:"E"}],raw:"Graph<N, E>"}]},description:""},nodeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(node: NodeAttributes<N>) => NodeAttributes<N>",signature:{arguments:[{type:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"},name:"node"}],return:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"}}},description:""},edgeReducer:{required:!1,tsType:{name:"signature",type:"function",raw:"(edge: EdgeAttributes<E>) => EdgeAttributes<E>",signature:{arguments:[{type:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"},name:"edge"}],return:{name:"EdgeAttributes",elements:[{name:"E"}],raw:"EdgeAttributes<E>"}}},description:""},onSelectChange:{required:!1,tsType:{name:"signature",type:"function",raw:"(selected: string[]) => void",signature:{arguments:[{type:{name:"Array",elements:[{name:"string"}],raw:"string[]"},name:"selected"}],return:{name:"void"}}},description:""},onNodeDoubleClick:{required:!1,tsType:{name:"signature",type:"function",raw:"(node: string, attributes: NodeAttributes<N>) => void",signature:{arguments:[{type:{name:"string"},name:"node"},{type:{name:"NodeAttributes",elements:[{name:"N"}],raw:"NodeAttributes<N>"},name:"attributes"}],return:{name:"void"}}},description:""},onContextMenu:{required:!1,tsType:{name:"signature",type:"function",raw:`(
  type: "canvas" | "node" | "edge",
  nodesOrEdge?: string | string[],
) => void`,signature:{arguments:[{type:{name:"union",raw:'"canvas" | "node" | "edge"',elements:[{name:"literal",value:'"canvas"'},{name:"literal",value:'"node"'},{name:"literal",value:'"edge"'}]},name:"type"},{type:{name:"union",raw:"string | string[]",elements:[{name:"string"},{name:"Array",elements:[{name:"string"}],raw:"string[]"}]},name:"nodesOrEdge"}],return:{name:"void"}}},description:""}}};window.__GRAPH_LAYOUT_DURATION_MULTIPLIER__=10;const Sf={component:An,title:"@graph/_Playground_",parameters:{layout:"fullscreen",controls:{exclude:"children"}}},$h=fe.helpers.uniqueArray(()=>fe.string.hexadecimal({length:9}),fe.number.int({min:18,max:45})),Mh=[Oa,Ia,za,Fa,$a],hn={nodes:[{key:"root",attributes:{x:-1,y:-1,border:2,type:"rect",pie:["#fc0","#cf0","#f0c","#0cf"],borderColor:"#2F66E5FF",iconColor:fe.color.rgb(),path:Pa}}],edges:[]};$h.forEach(n=>{hn.nodes.push({key:n,attributes:{label:fe.word.sample(),x:fe.number.int({min:-1,max:1}),y:fe.number.int({min:-1,max:1}),border:1,borderColor:fe.color.rgb(),iconColor:fe.color.rgb(),path:fe.helpers.arrayElement(Mh),badge:[{position:fe.helpers.arrayElement(["top","left","right","top-left","top-right","bottom-left","bottom-right"]),type:fe.helpers.arrayElement(["exclaim","star","thumbUp","thumbDown"]),iconColor:"#fff",color:fe.color.rgb()}]}}),new Array(fe.number.int({min:1,max:4})).fill(0).forEach(()=>{hn.edges.push({key:"root::"+fe.string.hexadecimal({length:9}),source:"root",target:n,attributes:{color:fe.color.rgb(),label:fe.word.sample(),arrow:fe.helpers.arrayElement(["target"]),size:fe.number.float({min:.25,max:4})}})})});const tr={render:n=>{const r=I.useRef(null),[t,e]=I.useState([]);return j.jsx("div",{className:"min-h-[600px]",children:j.jsxs(Xa,{children:[j.jsx(An,{ref:r,data:hn,onSelectChange:e}),j.jsx(ts,{align:"end",children:j.jsxs(qa,{children:[j.jsx(ye,{disabled:t.length===0,onClick:()=>{var i;(i=r.current)==null||i.graph.groupNodes(fe.string.hexadecimal(),t,{label:fe.word.sample(),color:fe.color.rgb(),iconColor:fe.color.rgb(),path:Na,type:"rect",x:.1,y:.1})},children:"Group"}),j.jsx("hr",{}),t.map(i=>{var o;return j.jsx("div",{children:j.jsx(Ts,{json:((o=r.current)==null?void 0:o.graph.getNodeAttributes(i))??{}})},i)})]})})]})})},args:{}};var Ji,Qi,eo;tr.parameters={...tr.parameters,docs:{...(Ji=tr.parameters)==null?void 0:Ji.docs,source:{originalSource:`{
  render: args => {
    const graphRef = useRef<GraphRef>(null);
    const [selection, setSelection] = useState<string[]>([]);
    return <div className="min-h-[600px]">
        <Viewport>
          <SigmaGraph ref={graphRef} data={rawGraph} onSelectChange={setSelection} />
          <Aside align="end">
            <Content>
              <Button disabled={selection.length === 0} onClick={() => {
              graphRef.current?.graph.groupNodes(faker.string.hexadecimal(), selection, {
                label: faker.word.sample(),
                color: faker.color.rgb(),
                iconColor: faker.color.rgb(),
                path: mdiFolder,
                type: "rect",
                x: 0.1,
                y: 0.1
              });
            }}>
                Group
              </Button>
              <hr />
              {selection.map(key => <div key={key}>
                  <JsonViewer json={graphRef.current?.graph.getNodeAttributes(key) ?? {}} />
                </div>)}
            </Content>
          </Aside>
        </Viewport>
      </div>;
  },
  args: {}
}`,...(eo=(Qi=tr.parameters)==null?void 0:Qi.docs)==null?void 0:eo.source}}};const xf=["Playground"];export{tr as Playground,xf as __namedExportsOrder,Sf as default};
