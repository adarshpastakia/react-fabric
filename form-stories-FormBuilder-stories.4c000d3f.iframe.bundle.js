"use strict";(self.webpackChunkreact_fabric=self.webpackChunkreact_fabric||[]).push([[9173],{"./packages/form/stories/FormBuilder.stories.tsx":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.r(__webpack_exports__),__webpack_require__.d(__webpack_exports__,{FormBuilder:()=>FormBuilder,__namedExportsOrder:()=>__namedExportsOrder,default:()=>__WEBPACK_DEFAULT_EXPORT__});var react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/react/jsx-runtime.js"),_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./packages/core/dist/esm/index.js"),_react_fabric_monaco__WEBPACK_IMPORTED_MODULE_2__=__webpack_require__("./packages/monaco/dist/esm/index.js"),_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__=__webpack_require__("./node_modules/@storybook/addon-actions/dist/index.mjs"),axios__WEBPACK_IMPORTED_MODULE_8__=__webpack_require__("./node_modules/axios/lib/axios.js"),msw__WEBPACK_IMPORTED_MODULE_6__=__webpack_require__("./node_modules/msw/lib/core/http.mjs"),msw__WEBPACK_IMPORTED_MODULE_7__=__webpack_require__("./node_modules/msw/lib/core/HttpResponse.mjs"),react__WEBPACK_IMPORTED_MODULE_4__=__webpack_require__("./node_modules/react/index.js"),_src__WEBPACK_IMPORTED_MODULE_5__=__webpack_require__("./packages/form/src/index.ts");const __WEBPACK_DEFAULT_EXPORT__={component:_src__WEBPACK_IMPORTED_MODULE_5__.lV,title:"@form/_Form Builder_",parameters:{layout:"fullscreen",controls:{exclude:"children"},msw:{handlers:[msw__WEBPACK_IMPORTED_MODULE_6__.L.post("/api/upload",(async({request})=>{const file=(await request.formData()).get("file");return msw__WEBPACK_IMPORTED_MODULE_7__.c.json({path:"storage://fullpath/"+file?.name})}))]}}},defaultSchema=[{id:"avatar",label:"Avatar",datatype:"avatar",required:!0},{id:"name",label:"Name",datatype:"string",required:!0},{id:"age",label:"Age",datatype:"number",required:!0,min:16,max:65},{id:"skills",label:"skills",datatype:"string",required:!0,multiple:!0},{id:"range",label:"range",datatype:"range",min:1,max:10,step:.5,defaultValue:[2,4]},{id:"notes",label:"Notes",datatype:"text"},{id:"option",label:"Option",datatype:"string",options:["One","Two","Three"]},{id:"files",label:"Files",datatype:"file",required:!0,multiple:!0},{id:"agree",label:"Agreement?",datatype:"boolean"}],FormBuilder={render:args=>{const http=axios__WEBPACK_IMPORTED_MODULE_8__.A.create({}),[json,setJson]=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(JSON.stringify(defaultSchema,null,4)),[badJson,setBadJson]=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(!1),[schema,setSchema]=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)(defaultSchema),[formValues,setFormValues]=(0,react__WEBPACK_IMPORTED_MODULE_4__.useState)({name:"Person name",age:36,avatar:"storage://fullpath/avatar.png",files:[{path:"storage://fullpath/test.png",filename:"test.png",size:800,mime:"image/png"}]}),{formDef,schemaDef}=(0,_src__WEBPACK_IMPORTED_MODULE_5__.Pv)(schema,{uploadHandler:(data,config)=>http.postForm("/api/upload",data,config).then((resp=>resp.data?.path??"pathfor file"))}),changeSchema=(0,react__WEBPACK_IMPORTED_MODULE_4__.useCallback)((()=>{try{setBadJson(!1),setSchema(JSON.parse(json??"[]"))}catch{setBadJson(!0)}}),[json]);return(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"min-h-[600px]",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.LM,{children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.Y9,{flex:!0,className:"px-2 py-1 bg-base",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.hE,{children:"Form Builder"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"p-2 bg-tint-100 font-medium rounded",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.In,{icon:"mdi mdi-flask"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("span",{children:"Experimental"})]})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"grid grid-cols-4 overflow-hidden area-content p-2 gap-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)("div",{className:"grid col-span-2 rounded-capped outline overflow-hidden bg-base",style:{gridTemplate:'"content" 1fr "foot" auto / 1fr'},children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_monaco__WEBPACK_IMPORTED_MODULE_2__.B,{value:json,onChange:setJson}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.wi,{flex:!0,justify:"end",className:"border-t p-2",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.$n,{iconColor:"danger",icon:badJson?_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.OO.alert:void 0,variant:"solid",onClick:changeSchema,children:"Apply"})})]}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"overflow-auto bg-base outline rounded-capped",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_src__WEBPACK_IMPORTED_MODULE_5__.lV,{schema:schemaDef,defaultValues:formValues,onChange:setFormValues,onSubmit:(0,_storybook_addon_actions__WEBPACK_IMPORTED_MODULE_3__.XI)("onSubmit"),children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"p-6",children:formDef}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsxs)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.wi,{flex:!0,justify:"end",className:"sticky bottom-0 border-t bg-base px-6 py-2",children:[(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.$n,{type:"reset",variant:"link",children:"Reset"}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)(_react_fabric_core__WEBPACK_IMPORTED_MODULE_1__.$n,{type:"submit",variant:"solid",children:"Submit"})]})]})}),(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("div",{className:"overflow-auto p-6 bg-base outline rounded-capped",children:(0,react_jsx_runtime__WEBPACK_IMPORTED_MODULE_0__.jsx)("pre",{children:JSON.stringify(formValues,null,4)})})]})]})})},args:{}},__namedExportsOrder=["FormBuilder"];FormBuilder.parameters={...FormBuilder.parameters,docs:{...FormBuilder.parameters?.docs,source:{originalSource:'{\n  render: args => {\n    const http = axios.create({});\n    const uploadHandler = (data: FormData, config: AnyObject) => http.postForm("/api/upload", data, config).then(resp => resp.data?.path ?? "pathfor file");\n    const [json, setJson] = useState(JSON.stringify(defaultSchema, null, 4));\n    const [badJson, setBadJson] = useState(false);\n    const [schema, setSchema] = useState<AnyObject[]>(defaultSchema);\n    const [formValues, setFormValues] = useState<AnyObject>({\n      name: "Person name",\n      age: 36,\n      avatar: "storage://fullpath/avatar.png",\n      files: [{\n        path: "storage://fullpath/test.png",\n        filename: "test.png",\n        size: 800,\n        mime: "image/png"\n      }]\n    });\n    const {\n      formDef,\n      schemaDef\n    } = useFormBuilder(schema, {\n      uploadHandler\n    });\n    const changeSchema = useCallback(() => {\n      try {\n        setBadJson(false);\n        setSchema(JSON.parse(json ?? "[]"));\n      } catch {\n        setBadJson(true);\n      }\n    }, [json]);\n    return <div className="min-h-[600px]">\n        <Viewport>\n          <Header flex className="px-2 py-1 bg-base">\n            <Title>Form Builder</Title>\n            <div className="p-2 bg-tint-100 font-medium rounded">\n              <Icon icon="mdi mdi-flask" />\n              <span>Experimental</span>\n            </div>\n          </Header>\n          <div className="grid grid-cols-4 overflow-hidden area-content p-2 gap-2">\n            <div className="grid col-span-2 rounded-capped outline overflow-hidden bg-base" style={{\n            gridTemplate: `"content" 1fr "foot" auto / 1fr`\n          }}>\n              <CodeEditor value={json} onChange={setJson} />\n              <Footer flex justify="end" className="border-t p-2">\n                <Button iconColor="danger" icon={badJson ? CoreIcons.alert : undefined} variant="solid" onClick={changeSchema}>\n                  Apply\n                </Button>\n              </Footer>\n            </div>\n            <div className="overflow-auto bg-base outline rounded-capped">\n              <Form schema={schemaDef} defaultValues={formValues} onChange={setFormValues} onSubmit={action("onSubmit")}>\n                <div className="p-6">{formDef}</div>\n\n                <Footer flex justify="end" className="sticky bottom-0 border-t bg-base px-6 py-2">\n                  <Button type="reset" variant="link">\n                    Reset\n                  </Button>\n                  <Button type="submit" variant="solid">\n                    Submit\n                  </Button>\n                </Footer>\n              </Form>\n            </div>\n            <div className="overflow-auto p-6 bg-base outline rounded-capped">\n              <pre>{JSON.stringify(formValues, null, 4)}</pre>\n            </div>\n          </div>\n        </Viewport>\n      </div>;\n  },\n  args: {}\n}',...FormBuilder.parameters?.docs?.source}}}},"./packages/monaco/dist/esm/index.js":(__unused_webpack_module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{B:()=>CodeEditor});var slicedToArray=__webpack_require__("./node_modules/@babel/runtime/helpers/esm/slicedToArray.js"),dist=__webpack_require__("./node_modules/@monaco-editor/react/dist/index.mjs"),esm=__webpack_require__("./packages/core/dist/esm/index.js"),dist_esm=__webpack_require__("./packages/utilities/dist/esm/index.js"),classnames=__webpack_require__("./node_modules/classnames/index.js"),classnames_default=__webpack_require__.n(classnames),react=__webpack_require__("./node_modules/react/index.js"),injectStylesIntoStyleTag=__webpack_require__("./node_modules/style-loader/dist/runtime/injectStylesIntoStyleTag.js"),injectStylesIntoStyleTag_default=__webpack_require__.n(injectStylesIntoStyleTag),styleDomAPI=__webpack_require__("./node_modules/style-loader/dist/runtime/styleDomAPI.js"),styleDomAPI_default=__webpack_require__.n(styleDomAPI),insertBySelector=__webpack_require__("./node_modules/style-loader/dist/runtime/insertBySelector.js"),insertBySelector_default=__webpack_require__.n(insertBySelector),setAttributesWithoutAttributes=__webpack_require__("./node_modules/style-loader/dist/runtime/setAttributesWithoutAttributes.js"),setAttributesWithoutAttributes_default=__webpack_require__.n(setAttributesWithoutAttributes),insertStyleElement=__webpack_require__("./node_modules/style-loader/dist/runtime/insertStyleElement.js"),insertStyleElement_default=__webpack_require__.n(insertStyleElement),styleTagTransform=__webpack_require__("./node_modules/style-loader/dist/runtime/styleTagTransform.js"),styleTagTransform_default=__webpack_require__.n(styleTagTransform),CodeEditor_module=__webpack_require__("./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[7].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[7].use[2]!./packages/monaco/dist/esm/components/CodeEditor.module.css"),options={};options.styleTagTransform=styleTagTransform_default(),options.setAttributes=setAttributesWithoutAttributes_default(),options.insert=insertBySelector_default().bind(null,"head"),options.domAPI=styleDomAPI_default(),options.insertStyleElement=insertStyleElement_default();injectStylesIntoStyleTag_default()(CodeEditor_module.A,options);const components_CodeEditor_module=CodeEditor_module.A&&CodeEditor_module.A.locals?CodeEditor_module.A.locals:void 0;var jsx_runtime=__webpack_require__("./node_modules/react/jsx-runtime.js"),CodeEditor=function CodeEditor(_ref){var ref=_ref.ref,value=_ref.value,readOnly=_ref.readOnly,minimal=_ref.minimal,onChange=_ref.onChange,_ref$language=_ref.language,language=void 0===_ref$language?"json":_ref$language,_useState=(0,react.useState)(),_useState2=(0,slicedToArray.A)(_useState,2),editorRef=_useState2[0],setEditorRef=_useState2[1],_useState3=(0,react.useState)(),_useState4=(0,slicedToArray.A)(_useState3,2),monacoRef=_useState4[0],setMonacoRef=_useState4[1],isDark=(0,esm.Yf)(),_useState5=(0,react.useState)(""),_useState6=(0,slicedToArray.A)(_useState5,2),theme=_useState6[0],setTheme=_useState6[1];(0,react.useLayoutEffect)((function(){editorRef&&setTheme(isDark?"vs-dark":"light")}),[isDark,editorRef]);var resizeHandler=(0,react.useCallback)((function(size){return null==editorRef?void 0:editorRef.layout(size)}),[editorRef]),containerRef=(0,esm.wY)(resizeHandler),deferredValue=(0,react.useDeferredValue)(value),codeValue=(0,react.useMemo)((function(){return(0,dist_esm.Kg)(deferredValue)?deferredValue:JSON.stringify(deferredValue,null,4)}),[deferredValue]),handleChange=(0,esm.d7)((function(value){var model=null==editorRef?void 0:editorRef.getModel();if(model){var markers=null==monacoRef?void 0:monacoRef.editor.getModelMarkers({owner:model.getLanguageId()});0===(null==markers?void 0:markers.filter((function(m){return m.severity>7})).length)&&(null==onChange||onChange(value))}}),[onChange,editorRef],1e3);return(0,react.useImperativeHandle)(ref,(function(){return{getValue:function getValue(){return null==editorRef?void 0:editorRef.getValue()},validate:function validate(){var model=null==editorRef?void 0:editorRef.getModel();if(model){var markers=null==monacoRef?void 0:monacoRef.editor.getModelMarkers({owner:model.getLanguageId()});return 0===(null==markers?void 0:markers.filter((function(m){return m.severity>8})).length)}return!0}}}),[]),(0,jsx_runtime.jsx)(esm.wn,{children:(0,jsx_runtime.jsx)("div",{ref:containerRef,className:classnames_default()(components_CodeEditor_module.codeEditor,"area-content"),children:(0,jsx_runtime.jsx)(dist.Ay,{onMount:function onMount(e,m){return[!!e&&setEditorRef(e),!!m&&setMonacoRef(m)]},value:codeValue,language,onChange:handleChange,theme,className:components_CodeEditor_module.editor,options:{readOnly,minimap:{enabled:!minimal},scrollBeyondLastLine:!1,folding:!minimal,lineNumbers:minimal?"off":void 0,wordWrap:"on",fontFamily:'Menlo, Monaco, "Courier New", monospace'}})})})}},"./node_modules/css-loader/dist/cjs.js??ruleSet[1].rules[7].use[1]!./node_modules/postcss-loader/dist/cjs.js??ruleSet[1].rules[7].use[2]!./packages/monaco/dist/esm/components/CodeEditor.module.css":(module,__webpack_exports__,__webpack_require__)=>{__webpack_require__.d(__webpack_exports__,{A:()=>__WEBPACK_DEFAULT_EXPORT__});var _node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__=__webpack_require__("./node_modules/css-loader/dist/runtime/sourceMaps.js"),_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default=__webpack_require__.n(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0__),_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__=__webpack_require__("./node_modules/css-loader/dist/runtime/api.js"),___CSS_LOADER_EXPORT___=__webpack_require__.n(_node_modules_css_loader_dist_runtime_api_js__WEBPACK_IMPORTED_MODULE_1__)()(_node_modules_css_loader_dist_runtime_sourceMaps_js__WEBPACK_IMPORTED_MODULE_0___default());___CSS_LOADER_EXPORT___.push([module.id,"@layer util{.bL3zkOOukzVicBejJjmE{direction:ltr;overflow:hidden;}.bL3zkOOukzVicBejJjmE .u6sLbLS6bARCfiZpgHQS>.monaco-editor{--vscode-menu-background:color-mix(in lab, color(from var(--tint) srgb r g b / 1) 10%,  color(from var(--fabric-bg) srgb r g b / 1))!important;--vscode-menu-border:color-mix(in lab, color(from var(--fabric-bg) srgb r g b / 1) 65%,  color(from var(--tint) srgb r g b / 1))!important;--vscode-menu-selectionBackground:color(from var(--primary) srgb r g b/80%)!important;--vscode-editor-background:var(--fabric-bg)!important;--vscode-editor-foreground:var(--fabric-text)!important;--vscode-breadcrumb-background:var(--fabric-bg)!important;--vscode-editorGutter-background:color(from color-mix(in lab, color(from var(--tint) srgb r g b / 1) 10%,  color(from var(--fabric-bg) srgb r g b / 1)) srgb r g g/50%)!important;--vscode-minimapSlider-background:color(from var(--tint) srgb r g b/20%)!important;--vscode-minimapSlider-hoverBackground:color(from var(--tint) srgb r g b/25%)!important;--vscode-minimapSlider-activeBackground:color(from var(--tint) srgb r g b/30%)!important;--vscode-input-border:var(--primary)!important;--vscode-editorStickyScroll-background:var(--fabric-bg)!important;--vscode-editorMarkerNavigation-background:var(--fabric-bg)!important;--vscode-editor-wordHighlightTextBackground:color(from color-mix(in lab, color(from var(--accent) srgb r g b / 1) 62%,  color(from var(--fabric-text) srgb r g b / 1)) srgb r g b/20%)!important}.bL3zkOOukzVicBejJjmE .u6sLbLS6bARCfiZpgHQS .minimap-decorations-layer{background-color:color(from color-mix(in lab, color(from var(--tint) srgb r g b / 1) 10%,  color(from var(--fabric-bg) srgb r g b / 1)) srgb r g g/50%)!important}.bL3zkOOukzVicBejJjmE .u6sLbLS6bARCfiZpgHQS .folded-background{opacity:.5}.bL3zkOOukzVicBejJjmE .u6sLbLS6bARCfiZpgHQS .monaco-findInput textarea{min-height:unset;resize:none}.bL3zkOOukzVicBejJjmE .u6sLbLS6bARCfiZpgHQS span{padding:0}.tX0oDkKeWkO5MiEOfVQZ{--tw-bg-opacity:1;background-color:color-mix(in lab, color(from var(--fabric-bg) srgb r g b / var(--tw-bg-opacity)) 99%,  color(from var(--tint) srgb r g b / var(--tw-bg-opacity)));}}","",{version:3,sources:["webpack://./packages/monaco/dist/esm/components/CodeEditor.module.css"],names:[],mappings:"AAAA,YAAY,sBAAY,aAAa,CAAC,eAAe,CAAkwC,CAAzvC,2DAA0B,8IAAwD,CAAC,0IAAsD,CAAC,qFAAqF,CAAC,qDAAqD,CAAC,uDAAuD,CAAC,yDAAyD,CAAC,iLAA2F,CAAC,kFAAkF,CAAC,uFAAuF,CAAC,wFAAwF,CAAC,8CAA8C,CAAC,iEAAiE,CAAC,qEAAqE,CAAC,gMAAyG,CAAC,uEAAsC,iKAA2E,CAAC,+DAA8B,UAAU,CAAC,uEAAsC,gBAAgB,CAAC,WAAW,CAAC,iDAAO,SAAS,CAAgB,sBAAA,iBAAa,CAAb,mKAAa,CAAE",sourcesContent:["@layer util{.codeEditor{direction:ltr;overflow:hidden;.editor{&>:global(.monaco-editor){--vscode-menu-background:theme(colors.tint.50)!important;--vscode-menu-border:theme(borderColor.base)!important;--vscode-menu-selectionBackground:color(from var(--primary) srgb r g b/80%)!important;--vscode-editor-background:var(--fabric-bg)!important;--vscode-editor-foreground:var(--fabric-text)!important;--vscode-breadcrumb-background:var(--fabric-bg)!important;--vscode-editorGutter-background:color(from theme(colors.tint.50) srgb r g g/50%)!important;--vscode-minimapSlider-background:color(from var(--tint) srgb r g b/20%)!important;--vscode-minimapSlider-hoverBackground:color(from var(--tint) srgb r g b/25%)!important;--vscode-minimapSlider-activeBackground:color(from var(--tint) srgb r g b/30%)!important;--vscode-input-border:var(--primary)!important;--vscode-editorStickyScroll-background:var(--fabric-bg)!important;--vscode-editorMarkerNavigation-background:var(--fabric-bg)!important;--vscode-editor-wordHighlightTextBackground:color(from theme(colors.accent.700) srgb r g b/20%)!important}& :global(.minimap-decorations-layer){background-color:color(from theme(colors.tint.50) srgb r g g/50%)!important}& :global(.folded-background){opacity:.5}& :global(.monaco-findInput) textarea{min-height:unset;resize:none}& span{padding:0}}}.editorTools{@apply bg-base}}"],sourceRoot:""}]),___CSS_LOADER_EXPORT___.locals={codeEditor:"bL3zkOOukzVicBejJjmE",editor:"u6sLbLS6bARCfiZpgHQS",editorTools:"tX0oDkKeWkO5MiEOfVQZ"};const __WEBPACK_DEFAULT_EXPORT__=___CSS_LOADER_EXPORT___}}]);